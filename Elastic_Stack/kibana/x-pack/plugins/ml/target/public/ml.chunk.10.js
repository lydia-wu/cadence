/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[10,11],{197:function(e,t,a){"use strict";a.r(t),a.d(t,"AnomalyDetectorService",(function(){return AnomalyDetectorService}));var l=a(4),n=a.n(l),s=a(25),o=a(67);class AnomalyDetectorService{constructor(e){n()(this,"apiBasePath",Object(o.basePath)()+"/anomaly_detectors"),this.httpService=e}getJobById$(e){return this.httpService.http$({path:`${this.apiBasePath}/${e}`}).pipe(Object(s.map)((e=>e.jobs[0])))}getJobs$(e){return this.httpService.http$({path:`${this.apiBasePath}/${e.join(",")}`}).pipe(Object(s.map)((e=>e.jobs)))}extractInfluencers(e){Array.isArray(e)||(e=[e]);const t=new Set;for(const a of e)for(const e of a.analysis_config.influencers)t.add(e);return Array.from(t)}}},268:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var l=a(21),n=a.n(l),s=a(25),o=a(23),i=a(15),c=a(198),r=a(42),u=a(259),d=a(55),b=a(262),m=a(11);const p=({selectedIds:e,withTimeRangeSelector:t,dateFormatTz:a,singleSelection:l,timeseriesOnly:n,onFlyoutClose:s,onSelectionConfirmed:o,maps:c})=>{const[r,u]=Object(i.useState)(!0);return Object(m.jsx)(b.b,{selectedIds:e,withTimeRangeSelector:t,dateFormatTz:a,singleSelection:l,timeseriesOnly:n,onFlyoutClose:s,onSelectionConfirmed:o,onTimeRangeConfigChange:u,applyTimeRangeConfig:r,maps:c})};async function j(e,t){const{http:a,uiSettings:l,application:{currentAppId$:i}}=e;return new Promise((async(b,j)=>{try{const y={groupsMap:Object(c.b)([]),jobsMap:{}},w=l.get("dateFormat:tz"),O="Browser"!==w?w:n.a.tz.guess(),g=()=>{x.close(),j()},f=async({jobIds:e,groups:t})=>{await x.close(),b({jobIds:e,groups:t})},x=e.overlays.openFlyout(Object(r.toMountPoint)(Object(m.jsx)(r.KibanaContextProvider,{services:{...e,mlServices:Object(u.getMlGlobalServices)(a)}},Object(m.jsx)(p,{selectedIds:t,withTimeRangeSelector:!1,dateFormatTz:O,singleSelection:!1,timeseriesOnly:!0,onFlyoutClose:g,onSelectionConfirmed:f,maps:y}))),{"data-test-subj":"mlFlyoutJobSelector",ownFocus:!0,closeButtonAriaLabel:"jobSelectorFlyout"});i.pipe(Object(s.takeUntil)(Object(o.from)(x.onClose))).subscribe((e=>{e!==d.DashboardConstants.DASHBOARDS_ID&&x.close()}))}catch(e){j(e)}}))}},819:function(e,t,a){"use strict";a.r(t),a.d(t,"resolveAnomalySwimlaneUserInput",(function(){return y}));var l=a(15),n=a.n(l),s=a(78),o=a(42),i=a(40),c=a(41),r=a(2),u=a(11);const d=({defaultTitle:e,influencers:t,onCreate:a,onCancel:o,initialInput:d})=>{var b;const[m,p]=Object(l.useState)(e),[j,y]=Object(l.useState)(null!==(b=null==d?void 0:d.swimlaneType)&&void 0!==b?b:s.h.OVERALL),[w,O]=Object(l.useState)(null==d?void 0:d.viewBy),g=[{id:s.h.OVERALL,label:r.i18n.translate("xpack.ml.explorer.overallLabel",{defaultMessage:"Overall"})},{id:s.h.VIEW_BY,label:r.i18n.translate("xpack.ml.explorer.viewByLabel",{defaultMessage:"View by"})}],f=["",...t].map((e=>({value:e,text:e}))),x=m.length>0,v=x&&(j===s.h.OVERALL||j===s.h.VIEW_BY&&!!w);return Object(u.jsx)(i.EuiModal,{initialFocus:"[name=panelTitle]",onClose:o},Object(u.jsx)(i.EuiModalHeader,null,Object(u.jsx)(i.EuiModalHeaderTitle,null,Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.title",defaultMessage:"Anomaly swim lane configuration"}))),Object(u.jsx)(i.EuiModalBody,null,Object(u.jsx)(i.EuiForm,null,Object(u.jsx)(i.EuiFormRow,{label:Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.panelTitleLabel",defaultMessage:"Panel title"}),isInvalid:!x},Object(u.jsx)(i.EuiFieldText,{id:"panelTitle",name:"panelTitle",value:m,onChange:e=>p(e.target.value),isInvalid:!x})),Object(u.jsx)(i.EuiFormRow,{label:Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.swimlaneTypeLabel",defaultMessage:"Swim lane type"})},Object(u.jsx)(i.EuiButtonGroup,{id:"selectSwimlaneType",name:"selectSwimlaneType",color:"primary",isFullWidth:!0,legend:r.i18n.translate("xpack.ml.swimlaneEmbeddable.setupModal.swimlaneTypeLabel",{defaultMessage:"Swim lane type"}),options:g,idSelected:j,onChange:e=>y(e)})),j===s.h.VIEW_BY&&Object(u.jsx)(n.a.Fragment,null,Object(u.jsx)(i.EuiFormRow,{label:Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.explorer.viewByLabel",defaultMessage:"View by"})},Object(u.jsx)(i.EuiSelect,{id:"selectViewBy",name:"selectViewBy",options:f,value:w,onChange:e=>O(e.target.value)}))))),Object(u.jsx)(i.EuiModalFooter,null,Object(u.jsx)(i.EuiButtonEmpty,{onClick:o},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(u.jsx)(i.EuiButton,{isDisabled:!v,onClick:a.bind(null,{panelTitle:m,swimlaneType:j,viewBy:w}),fill:!0},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.confirmButtonLabel",defaultMessage:"Confirm"}))))};var b=a(197),m=a(265),p=a(102),j=a(268);async function y(e,t){const{http:a,overlays:l}=e,n=new b.AnomalyDetectorService(new p.a(a));return new Promise((async(a,i)=>{try{var c;const{jobIds:r}=await Object(j.a)(e,null==t?void 0:t.jobIds),b=null!==(c=null==t?void 0:t.title)&&void 0!==c?c:Object(m.getDefaultSwimlanePanelTitle)(r),p=await n.getJobs$(r).toPromise(),y=n.extractInfluencers(p);y.push(s.j);const w=l.openModal(Object(o.toMountPoint)(Object(u.jsx)(d,{defaultTitle:b,influencers:y,initialInput:t,onCreate:({panelTitle:e,viewBy:t,swimlaneType:l})=>{w.close(),a({jobIds:r,title:e,swimlaneType:l,viewBy:t})},onCancel:()=>{w.close(),i()}})))}catch(e){i(e)}}))}}}]);