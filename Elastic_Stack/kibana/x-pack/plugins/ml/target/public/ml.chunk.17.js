/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[17],{102:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return HttpService}));var o=n(23),a=n(22);function r(t){var e,n;if(!t.path)throw new Error("URL path is missing");return{path:t.path,fetchOptions:{asSystemRequest:!0,credentials:"same-origin",method:t.method||"GET",...t.body?{body:t.body}:{},...t.query?{query:t.query}:{},headers:(n=null!==(e=t.headers)&&void 0!==e?e:{},{"Content-Type":"application/json",...n})}}}async function s(t){const{path:e,fetchOptions:n}=r(t);return Object(a.f)().fetch(e,n)}function i(t){const{path:e,fetchOptions:n}=r(t);return s=e,i=n,new o.Observable((t=>{const e=new AbortController,n=e.signal;let o=!0,r=!1;null!=i&&i.signal&&(i.signal.aborted?e.abort():i.signal.addEventListener("abort",(()=>{n.aborted||e.abort()})));const l={...i||{},signal:n};return Object(a.f)().fetch(s,l).then((e=>{o=!1,t.next(e),t.complete()})).catch((e=>{o=!1,r||t.error(e)})),()=>{r=!0,o&&e.abort()}}));var s,i}class HttpService{constructor(t){this.httpStart=t}getResultHeaders(t){return{"Content-Type":"application/json",...t}}getFetchOptions(t){var e;if(!t.path)throw new Error("URL path is missing");return{path:t.path,fetchOptions:{asSystemRequest:!0,credentials:"same-origin",method:t.method||"GET",...t.body?{body:t.body}:{},...t.query?{query:t.query}:{},headers:this.getResultHeaders(null!==(e=t.headers)&&void 0!==e?e:{})}}}fromHttpHandler(t,e){return new o.Observable((n=>{const o=new AbortController,a=o.signal;let r=!0,s=!1;null!=e&&e.signal&&(e.signal.aborted?o.abort():e.signal.addEventListener("abort",(()=>{a.aborted||o.abort()})));const i={...e||{},signal:a};return this.httpStart.fetch(t,i).then((t=>{r=!1,n.next(t),n.complete()})).catch((t=>{r=!1,s||n.error(t)})),()=>{s=!0,r&&o.abort()}}))}async http(t){const{path:e,fetchOptions:n}=this.getFetchOptions(t);return this.httpStart.fetch(e,n)}http$(t){const{path:e,fetchOptions:n}=this.getFetchOptions(t);return this.fromHttpHandler(e,n)}}},811:function(t,e,n){"use strict";n.r(e);var o=n(15),a=n.n(o),r=n(40),s=n(41),i=n(42),l=n(96),c=n(67),d=n(102),u=n(84),h=n(11);function f(t){return void 0===t.node&&t.state===l.c.OPENING}e.default=({jobIds:t})=>{const{http:e}=Object(i.useKibana)().services,n=Object(o.useMemo)((()=>Object(c.mlApiServicesProvider)(new d.a(e))),[e]),[l,b]=Object(o.useState)(0),[p,m]=Object(o.useState)(null),g=Object(o.useCallback)((async()=>{try{if(0===t.length)return void b(0);const{lazyNodeCount:e}=await n.mlNodeCount();if(0===e)return void b(0);const{jobs:o}=await n.getJobStats({jobId:t.join(",")}),a=o.filter(f);b(a.length)}catch(t){b(0),console.error("Could not determine ML node information",t)}}),[t]),j=Object(o.useCallback)((async()=>{if(0!==l)try{var t;const e=null!==(t=(await n.mlInfo()).cloudId)&&void 0!==t?t:null;m({isCloud:null!==e,cloudId:e,deploymentId:null===e?null:Object(u.a)(e)})}catch(t){m(null),console.error("Could not determine cloud information",t)}}),[l]);return Object(o.useEffect)((()=>{j()}),[l]),Object(o.useEffect)((()=>{g()}),[t]),0===l?null:Object(h.jsx)(a.a.Fragment,null,Object(h.jsx)(r.EuiCallOut,{title:Object(h.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarningShared.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},Object(h.jsx)("div",null,Object(h.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarningShared.noMLNodesAvailableDescription",defaultMessage:"There {jobCount, plural, one {is} other {are}} {jobCount, plural, one {# job} other {# jobs}} waiting for machine learning nodes to start.",values:{jobCount:l}}),Object(h.jsx)(r.EuiSpacer,{size:"s"}),p&&(p.isCloud?Object(h.jsx)(a.a.Fragment,null,Object(h.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarningShared.isCloud",defaultMessage:"Elastic Cloud deployments can autoscale to add more ML capacity. This may take 5-20 minutes. "}),null===p.deploymentId?null:Object(h.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarningShared.isCloud.link",defaultMessage:"You can monitor progress in the {link}.",values:{link:Object(h.jsx)(r.EuiLink,{href:`https://cloud.elastic.co/deployments?q=${p.deploymentId}`},Object(h.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarningShared.linkToCloud.linkText",defaultMessage:"Elastic Cloud admin console"}))}})):Object(h.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarningShared.notCloud",defaultMessage:"Only Elastic Cloud deployments can autoscale; you must add machine learning nodes. {link}",values:{link:Object(h.jsx)(r.EuiLink,{href:"https://www.elastic.co/guide/en/elasticsearch/reference/master/modules-node.html#ml-node"},Object(h.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarningShared.linkToCloud.learnMore",defaultMessage:"Learn more."}))}})))),Object(h.jsx)(r.EuiSpacer,{size:"m"}))}},84:function(t,e,n){"use strict";n.d(e,"f",(function(){return i})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return d})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return h}));var o=n(67);let a={anomaly_detectors:{},datafeeds:{}},r={};const s={cloudId:null,isCloud:!1,deploymentId:null};async function i(){try{const t=await o.ml.mlInfo();return a=t.defaults,r=t.limits,s.cloudId=t.cloudId||null,s.isCloud=void 0!==t.cloudId,s.deploymentId=t.cloudId?h(t.cloudId):null,{defaults:a,limits:r,cloudId:s}}catch(t){return{defaults:a,limits:r,cloudId:s}}}function l(){return a}function c(){return r}function d(){return s.isCloud}function u(){return s.deploymentId}function h(t){const e=t.replace(/^(.+)?:/,"");try{const t=atob(e).match(/^.+\$(.+)(?=\$)/);return null!==t&&2===t.length?t[1]:null}catch(t){return null}}},96:function(t,e,n){"use strict";let o,a,r;n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return r})),function(t){t.STARTED="started",t.STARTING="starting",t.STOPPED="stopped",t.STOPPING="stopping",t.DELETED="deleted"}(o||(o={})),function(t){t.FAILED="failed",t.FINISHED="finished",t.SCHEDULED="scheduled",t.STARTED="started"}(a||(a={})),function(t){t.CLOSED="closed",t.CLOSING="closing",t.FAILED="failed",t.OPENED="opened",t.OPENING="opening",t.DELETED="deleted"}(r||(r={}))}}]);