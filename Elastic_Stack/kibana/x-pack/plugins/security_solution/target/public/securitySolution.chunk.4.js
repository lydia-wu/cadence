/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[4],{136:function(e,t,r){"use strict";r.d(t,"J",(function(){return n.k})),r.d(t,"H",(function(){return n.h})),r.d(t,"K",(function(){return n.l})),r.d(t,"L",(function(){return n.m})),r.d(t,"I",(function(){return n.j})),r.d(t,"C",(function(){return n.d})),r.d(t,"D",(function(){return n.e})),r.d(t,"b",(function(){return n.b})),r.d(t,"a",(function(){return n.a})),r.d(t,"M",(function(){return n.n})),r.d(t,"c",(function(){return u})),r.d(t,"f",(function(){return p})),r.d(t,"i",(function(){return d})),r.d(t,"A",(function(){return l})),r.d(t,"z",(function(){return f})),r.d(t,"B",(function(){return m})),r.d(t,"g",(function(){return b})),r.d(t,"h",(function(){return g})),r.d(t,"y",(function(){return y})),r.d(t,"o",(function(){return v})),r.d(t,"e",(function(){return h})),r.d(t,"k",(function(){return w})),r.d(t,"p",(function(){return _})),r.d(t,"m",(function(){return O})),r.d(t,"d",(function(){return j})),r.d(t,"G",(function(){return S})),r.d(t,"q",(function(){return E})),r.d(t,"s",(function(){return A})),r.d(t,"v",(function(){return x})),r.d(t,"t",(function(){return k})),r.d(t,"n",(function(){return L})),r.d(t,"r",(function(){return I})),r.d(t,"l",(function(){return P})),r.d(t,"u",(function(){return q})),r.d(t,"w",(function(){return R})),r.d(t,"x",(function(){return $})),r.d(t,"j",(function(){return s.a})),r.d(t,"E",(function(){return s.b})),r.d(t,"F",(function(){return s.c}));var n=r(418),o=r(112),i=r(19),c=r(106),a=r(180),s=r(408);const u=e=>({loading:Object(a.h)(e.artifacts.assignedList),hasTrustedApps:!!Object(a.g)(e.artifacts.assignedList)&&!Object(i.isEmpty)(e.artifacts.assignedList.data.artifacts.data)}),p=e=>{var t;return null===(t=Object(a.e)(e.artifacts.assignableList))||void 0===t?void 0:t.data},d=e=>Object(a.h)(e.artifacts.assignableList),l=e=>Object(a.h)(e.artifacts.trustedAppsToUpdate),f=e=>Object(a.f)(e.artifacts.trustedAppsToUpdate),m=e=>Object(a.g)(e.artifacts.trustedAppsToUpdate),b=e=>Object(a.g)(e.artifacts.assignableListEntriesExist)&&e.artifacts.assignableListEntriesExist.data,g=e=>Object(a.h)(e.artifacts.assignableListEntriesExist),y=e=>"LoadedResourceState"===e.artifacts.trustedAppsToUpdate.type?e.artifacts.trustedAppsToUpdate.data:void 0,v=e=>Object(a.g)(e.artifacts.doesAnyTrustedAppExists)&&e.artifacts.doesAnyTrustedAppExists.data,h=e=>Object(a.h)(e.artifacts.doesAnyTrustedAppExists),w=e=>e.artifacts.assignedList,_=Object(o.createSelector)(w,(e=>Object(a.e)(e))),O=Object(o.createSelector)(s.a,(({filter:e,page_index:t,page_size:r})=>({filter:e,page_index:t,page_size:r}))),j=Object(o.createSelector)(w,O,((e,t)=>!Object(a.g)(e)||Object(a.g)(e)&&Object.keys(t).some((r=>e.data.location[r]!==t[r])))),S=Object(o.createSelector)(w,(e=>Object(a.h)(e))),E=Object(o.createSelector)(_,(e=>{var t;return null!==(t=null==e?void 0:e.data.artifacts.data)&&void 0!==t?t:[]})),A=Object(o.createSelector)(_,(e=>{var t;const r=null==e?void 0:e.data.artifacts;return{pageIndex:null!=r&&r.page?r.page-1:0,pageSize:null!==(t=null==r?void 0:r.per_page)&&void 0!==t?t:c.d[0],totalItemCount:(null==r?void 0:r.total)||0,pageSizeOptions:[...c.d]}})),x=e=>e.artifacts.policies,T=Object(o.createSelector)(x,(e=>{var t,r;return null!==(t=null===(r=Object(a.e)(e))||void 0===r?void 0:r.data.items)&&void 0!==t?t:[]})),k=Object(o.createSelector)(T,(e=>e.reduce(((e,t)=>(e[t.id]=t,e)),{}))),L=Object(o.createSelector)((e=>e.artifacts.doesAnyTrustedAppExists),(e=>Object(a.h)(e))),I=Object(o.createSelector)(w,(e=>{if(Object(a.f)(e))return e.error})),P=e=>e.artifacts.removeList,q=Object(o.createSelector)(P,(e=>Object(a.h)(e))),R=Object(o.createSelector)(P,(e=>{if(Object(a.f)(e))return e.error})),$=Object(o.createSelector)(P,(e=>Object(a.g)(e)))},180:function(e,t,r){"use strict";var n=r(219);r.d(t,"e",(function(){return n.b})),r.d(t,"f",(function(){return n.c})),r.d(t,"g",(function(){return n.d})),r.d(t,"h",(function(){return n.e})),r.d(t,"i",(function(){return n.h}));var o=r(486);r.d(t,"a",(function(){return o.a})),r.d(t,"b",(function(){return o.b})),r.d(t,"c",(function(){return o.c})),r.d(t,"d",(function(){return o.d}))},308:function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return c})),r.d(t,"c",(function(){return a}));var n=r(107);const o=e=>e.field===n.b.SIGNER||!0,i=e=>e.field!==n.b.SIGNER,c=e=>"global"===e.type,a=e=>"policy"===e.type},344:function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"f",(function(){return c})),r.d(t,"a",(function(){return a})),r.d(t,"g",(function(){return s})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return p})),r.d(t,"b",(function(){return d}));var n=r(65);const o="/api/fleet/package_policies",i=(e,t={})=>{var r;return e.get(o,{...t,query:{...t.query,kuery:`${null!=t&&null!==(r=t.query)&&void 0!==r&&r.kuery?`${t.query.kuery} and `:""}${n.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`}})},c=(e,t,r)=>e.get(`/api/fleet/package_policies/${t}`,r),a=(e,t)=>e.get("/api/fleet/agent_policies",t),s=(e,t,r,n={})=>e.put(`/api/fleet/package_policies/${t}`,{...n,body:JSON.stringify(r)}),u=(e,t,r={})=>e.get("/api/fleet/agent-status",{...r,query:{policyId:t}}),p=(e,t={})=>e.get("/api/fleet/agents",{...t,query:{page:1,perPage:1,kuery:'packages : "endpoint"'}}),d=async e=>{const t=(await e.get("/api/fleet/epm/packages",{query:{category:"security"}})).response.find((e=>"endpoint"===e.name));if(!t)throw new Error("Endpoint package was not found.");return t}},345:function(e,t,r){"use strict";r.d(t,"a",(function(){return TrustedAppsHttpService}));var n=r(516),o=r.n(n),i=r(26),c=r(317),a=r(344),s=r(410),u=r(308);const p=Object.freeze({concurrency:5,stopOnError:!1});class TrustedAppsHttpService{constructor(e){this.http=e}async getTrustedApp(e){return this.http.get(Object(c.a)(i.k,e))}async getTrustedAppsList(e){return this.http.get(i.l,{query:e})}async deleteTrustedApp(e){return this.http.delete(Object(c.a)(i.j,e))}async createTrustedApp(e){return this.http.post(i.i,{body:JSON.stringify(e)})}async updateTrustedApp(e,t){return this.http.put(Object(c.a)(i.n,e),{body:JSON.stringify(t)})}async getTrustedAppsSummary(e){return this.http.get(i.m,{query:e})}getPolicyList(e){return Object(a.c)(this.http,e)}assignPolicyToTrustedApps(e,t){return this._handleAssignOrRemovePolicyId("assign",e,t)}removePolicyFromTrustedApps(e,t){return this._handleAssignOrRemovePolicyId("remove",e,t)}_handleAssignOrRemovePolicyId(e,t,r){if(""===t.trim())throw new Error("policy ID is required");if(0===r.length)throw new Error("at least one trusted app is required");return o()(r,(async r=>{if(Object(u.a)(r.effectScope))throw new Error(`Unable to update trusted app [${r.id}] policy assignment. It's effectScope is 'global'`);const n=Object(u.a)(r.effectScope)?[]:[...r.effectScope.policies],o=n.indexOf(t);return"assign"===e&&-1===o?n.push(t):"remove"===e&&-1!==o&&n.splice(o,1),this.updateTrustedApp({id:r.id},{...Object(s.a)(r),effectScope:{type:"policy",policies:n}})}),p)}}},407:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"e",(function(){return i})),r.d(t,"d",(function(){return c})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s}));var n=r(107);const o=()=>({windows:{events:{dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:n.h.prevent},ransomware:{mode:n.h.prevent,supported:!0},memory_protection:{mode:n.h.prevent,supported:!0},behavior_protection:{mode:n.h.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:n.h.prevent},behavior_protection:{mode:n.h.prevent,supported:!0},memory_protection:{mode:n.h.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}},linux:{events:{process:!0,file:!0,network:!0},malware:{mode:n.h.prevent},behavior_protection:{mode:n.h.prevent,supported:!0},memory_protection:{mode:n.h.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}}}),i=(e=o())=>({...e,windows:{...e.windows,ransomware:{mode:n.h.off,supported:!1},memory_protection:{mode:n.h.off,supported:!1},behavior_protection:{mode:n.h.off,supported:!1},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:n.h.off,supported:!1},memory_protection:{mode:n.h.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:n.h.off,supported:!1},memory_protection:{mode:n.h.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}),c=(e=o())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),a="Elastic Security {action} {filename}",s="Elastic Security {action} {rule}"},408:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return u}));var n=r(21),o=r(112),i=r(106);const c=e=>e.artifacts.location,a=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},s=Object(o.createSelector)(a,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:i.i,exact:!0}))),u=Object(o.createSelector)(a,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:i.k,exact:!0})))},410:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));const n=["name","effectScope","entries","description","os","version"],o=e=>{const t={};for(const r of n)t[r]=e[r];return t}},418:function(e,t,r){"use strict";r.d(t,"k",(function(){return p})),r.d(t,"h",(function(){return d})),r.d(t,"l",(function(){return l})),r.d(t,"i",(function(){return f})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return b})),r.d(t,"m",(function(){return g})),r.d(t,"c",(function(){return v})),r.d(t,"j",(function(){return O})),r.d(t,"d",(function(){return j})),r.d(t,"e",(function(){return S})),r.d(t,"b",(function(){return E})),r.d(t,"a",(function(){return A})),r.d(t,"n",(function(){return x}));var n=r(112),o=r(21),i=r(38),c=r(407);var a=r(106),s=r(785),u=r(408);const p=e=>e.policyItem,d=Object(n.createSelector)(p,(e=>e.license),((e,t)=>{if(e){const r=((e,t)=>Object(i.b)(t,"platinum")?Object(c.d)(e):Object(c.e)(e))(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:r}}}]}}return e})),l=Object(n.createSelector)(d,(e=>{if(e)return Object(s.a)(e)})),f=e=>!e.policyItem&&!e.apiError,m=e=>Object(u.b)(e)||Object(u.c)(e),b=e=>e.license,g=Object(n.createSelector)((e=>e.location),(e=>{var t,r,n,i;return null!==(t=null===(r=Object(o.matchPath)(null!==(i=null==e?void 0:e.pathname)&&void 0!==i?i:"",{path:[a.i,a.k],exact:!0}))||void 0===r||null===(n=r.params)||void 0===n?void 0:n.policyId)&&void 0!==t?t:""})),y=Object(c.c)(),v=Object(n.createSelector)(d,(e=>{var t,r,n,o;return null!==(t=null==e||null===(r=e.inputs[0])||void 0===r||null===(n=r.config)||void 0===n||null===(o=n.policy)||void 0===o?void 0:o.value)&&void 0!==t?t:y})),h=Object(n.createSelector)(v,(e=>null==e?void 0:e.windows)),w=Object(n.createSelector)(v,(e=>null==e?void 0:e.mac)),_=Object(n.createSelector)(v,(e=>null==e?void 0:e.linux)),O=Object(n.createSelector)(h,w,_,((e,t,r)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:r.advanced,events:r.events,malware:r.malware,behavior_protection:r.behavior_protection,memory_protection:r.memory_protection,popup:r.popup}}))),j=Object(n.createSelector)(O,(e=>e.windows.antivirus_registration.enabled)),S=e=>e.isLoading,E=e=>e.apiError,A=e=>e.agentStatusSummary,x=e=>e.updateStatus},486:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return c}));const n=()=>({type:"UninitialisedResourceState"}),o=e=>({type:"LoadingResourceState",previousState:e}),i=e=>({type:"LoadedResourceState",data:e}),c=(e,t)=>({type:"FailedResourceState",error:e,lastLoadedState:t})},516:function(e,t,r){"use strict";const n=r(517);e.exports=async(e,t,{concurrency:r=1/0,stopOnError:o=!0}={})=>new Promise(((i,c)=>{if("function"!=typeof t)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(r)&&r!==1/0||!(r>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);const a=[],s=[],u=e[Symbol.iterator]();let p=!1,d=!1,l=0,f=0;const m=()=>{if(p)return;const e=u.next(),r=f;if(f++,e.done)return d=!0,void(0===l&&(o||0===s.length?i(a):c(new n(s))));l++,(async()=>{try{const n=await e.value;a[r]=await t(n,r),l--,m()}catch(e){o?(p=!0,c(e)):(s.push(e),l--,m())}})()};for(let e=0;e<r&&(m(),!d);e++);}))},517:function(e,t,r){"use strict";const n=r(518),o=r(519);class AggregateError extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t=(e=[...e].map((e=>e instanceof Error?e:null!==e&&"object"==typeof e?Object.assign(new Error(e.message),e):new Error(e)))).map((e=>"string"==typeof e.stack?o(e.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(e))).join("\n");t="\n"+n(t,4),super(t),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(const e of this._errors)yield e}}e.exports=AggregateError},518:function(e,t,r){"use strict";e.exports=(e,t=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},"string"!=typeof e)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if("number"!=typeof t)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if("string"!=typeof r.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(0===t)return e;const n=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return e.replace(n,r.indent.repeat(t))}},519:function(e,t,r){"use strict";const n=r(520),o=/\s+at.*(?:\(|\s)(.*)\)?/,i=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,c=void 0===n.homedir?"":n.homedir();e.exports=(e,t)=>(t=Object.assign({pretty:!1},t),e.replace(/\\/g,"/").split("\n").filter((e=>{const t=e.match(o);if(null===t||!t[1])return!0;const r=t[1];return!r.includes(".app/Contents/Resources/electron.asar")&&!r.includes(".app/Contents/Resources/default_app.asar")&&!i.test(r)})).filter((e=>""!==e.trim())).map((e=>t.pretty?e.replace(o,((e,t)=>e.replace(t,t.replace(c,"~")))):e)).join("\n"))},520:function(e,t){},785:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(58);const o=e=>{const{id:t,revision:r,created_by:o,created_at:i,updated_by:c,updated_at:a,...s}=e,u=Object(n.cloneDeep)(s),p=u.inputs[0].config.policy.value;return[p.windows.popup.malware,p.mac.popup.malware].forEach((e=>e.message.trim())),u}}}]);