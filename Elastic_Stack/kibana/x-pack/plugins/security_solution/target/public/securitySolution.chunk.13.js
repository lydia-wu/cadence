/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[13],{1358:function(e,t,n){"use strict";n.r(t),n.d(t,"resolverPluginSetup",(function(){return p}));var i=n(91),r=n(751),a=n(747);function s({entityID:e,processName:t="process name",parentEntityID:n,timestamp:i=0,eventType:r="start",eventCategory:a="process",pid:s=0,eventID:o="event id"}){return{"@timestamp":i,event:{type:r,category:a,id:String(o)},agent:{id:"agent.id",version:"agent.version",type:"agent.type"},ecs:{version:"ecs.version"},user:{name:"user.name",domain:"user.domain"},process:{entity_id:e,executable:"executable",args:["args0","args1","args2"],name:t,pid:s,hash:{md5:"hash.md5"},parent:{pid:0,entity_id:n}}}}var o=n(199),l=n(200);function d({id:e,name:t="node",timestamp:n,parentID:i,stats:r={total:0,byCategory:{}}}){return{id:e,name:t,stats:r,parent:i,data:{"@timestamp":n,"process.entity_id":e,"process.name":t,"process.parent.entity_id":i}}}function y({originID:e,firstChildID:t,secondChildID:n}){const{resolverTree:i,nodeDataResponse:r}=function({originID:e,firstChildID:t,secondChildID:n}){const i=s({pid:0,entityID:e,processName:"c.ext",parentEntityID:"none",timestamp:1600863932316}),r=s({pid:1,entityID:t,processName:"d",parentEntityID:e,timestamp:1600863932317}),a=s({pid:2,entityID:n,processName:"really_really_really_really_really_really_really_really_really_really_really_really_really_really_long_node_name",parentEntityID:e,timestamp:1600863932318}),o=[d({id:e,name:"c.ext",stats:{total:2,byCategory:{}},timestamp:1600863932316}),d({id:t,name:"d",parentID:e,timestamp:1600863932317}),d({id:n,name:"really_really_really_really_really_really_really_really_really_really_really_really_really_really_long_node_name",parentID:e,timestamp:1600863932318})];return{treeResponse:o,resolverTree:{originID:e,nodes:o},relatedEvents:{entityID:e,events:[],nextEvent:null},nodeDataResponse:[i,r,a]}}({originID:e,firstChildID:t,secondChildID:n}),a=l.d(i.nodes.find((t=>t.id===e))),y=[s({entityID:e,parentEntityID:a,eventID:"id of first related event",eventType:"access",eventCategory:"registry"}),s({entityID:e,parentEntityID:a,eventID:"id of second related event",eventType:"access",eventCategory:"registry"})],c=["authentication","database","driver","file","host","iam","intrusion_detection","malware","network","package","process","web"];for(const t of c)y.push(s({entityID:e,parentEntityID:a,eventID:`${y.length}`,eventType:"access",eventCategory:t}));return function(e,t,n,i){const r={total:0,byCategory:{}};for(const e of t){r.total++;for(const t of o.d(e))r.byCategory[t]=r.byCategory[t]?r.byCategory[t]+1:1}const a=e.nodes.find((e=>e.id===i));return a&&(a.stats=r),{tree:e,relatedEvents:{entityID:i,events:t,nextEvent:null},nodeDataResponse:n}}(i,y,r,e)}function c(){const e={databaseDocumentID:"_id",entityIDs:{origin:"origin",firstChild:"firstChild",secondChild:"secondChild"}},{tree:t,relatedEvents:n,nodeDataResponse:i}=y({originID:e.entityIDs.origin,firstChildID:e.entityIDs.firstChild,secondChildID:e.entityIDs.secondChild});return{metadata:e,dataAccessLayer:{relatedEvents:async({entityID:t,timeRange:i,indexPatterns:r})=>({entityID:t,events:t===e.entityIDs.origin?n.events:[],nextEvent:null}),eventsWithEntityIDAndCategory:async({entityID:t,category:i,after:r,timeRange:a,indexPatterns:s})=>({events:t===e.entityIDs.origin?n.events.filter((e=>o.d(e).includes(i))):[],nextEvent:null}),async event({nodeID:e,eventID:t,eventCategory:i,eventTimestamp:r,winlogRecordID:a,timeRange:s,indexPatterns:l}){var d;return null!==(d=n.events.find((e=>o.e(e)===t)))&&void 0!==d?d:null},nodeData:async({ids:e,timeRange:t,indexPatterns:n,limit:r})=>i,resolverTree:async({dataId:e,schema:n,timeRange:i,indices:r,ancestors:a,descendants:s})=>t.nodes,entities:async()=>[{name:"endpoint",schema:{id:"process.entity_id",parent:"process.parent.entity_id",ancestry:"process.Ext.ancestry",name:"process.name"},id:e.entityIDs.origin}]}}}function p(){return{Provider:i.Provider,storeFactory:r.a,ResolverWithoutProviders:a.a,mocks:{dataAccessLayer:{noAncestorsTwoChildrenWithRelatedEventsOnOrigin:c}}}}}}]);