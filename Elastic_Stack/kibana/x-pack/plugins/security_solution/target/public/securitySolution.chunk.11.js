/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[11],{1356:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return rn})),a.d(t,"createStore",(function(){return g.c})),a.d(t,"createInitialState",(function(){return g.b}));var i=a(96),n=a.n(i),l=a(9),r=a.n(l),o=a(71),s=a(21),c=a(3),u=a(187),d=a(91),m=a(55),p=a(185),b=a(93),g=a(110),v=a(164),E=a(127);const j=({toastLifeTimeMs:e=5e3})=>{const t=Object(d.useDispatch)(),a=Object(l.useMemo)((()=>g.a.errorsSelector()),[]),i=Object(b.a)(a),[{toasts:n},r]=Object(E.h)();return Object(l.useEffect)((()=>{i.forEach((({id:a,title:i,message:l})=>{n.some((e=>e.id===a))||r({type:"addToaster",toast:{color:"danger",id:a,iconType:"alert",title:i,errors:l,toastLifeTimeMs:e}}),t(v.a.removeError({id:a}))}))}),[t,r,i,e,n]),null};j.displayName="ErrorToastDispatcherComponent";const h=r.a.memo(j);var y=a(761),O=a(90),f=a(575);const w=({children:e})=>r.a.createElement(f.a.Provider,{value:Object(l.useReducer)(((e,t)=>{switch(t.type){case"updateRoute":return t.route;case"updateRouteWithOutSearch":return{...e,...t.route};case"updateSearch":return{...e,search:t.search};default:return e}}),f.b)},e),S=Object(l.memo)(w);var T=a(94),I=a(10);const x=Object(l.memo)((({children:e})=>{const t=Object(s.useLocation)(),a=Object(d.useDispatch)();return Object(l.useEffect)((()=>{a(T.a.showTimeline({id:I.TimelineId.active,show:!1}))}),[a,t.pathname]),Object(l.useEffect)((()=>{a({type:"userChangedUrl",payload:t})})),r.a.createElement(r.a.Fragment,null,e)}));x.displayName="RouteCapture";var k=a(19),C=a(73),M=a(95),P=a.n(M),N=a(98),F=a(319),L=a(576),D=a(20),A=a(108),B=a(105),z=a(22),q=a(577);window["__react-beautiful-dnd-disable-dev-warnings"]=!0;const R=({browserFields:e,children:t})=>{const a=Object(d.useDispatch)(),i=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),n=Object(l.useMemo)((()=>g.d.getDataProvidersSelector()),[]),{timelines:o}=Object(O.j)().services,s=[o.getUseAddToTimelineSensor()],{dataProviders:c,timelineType:u}=Object(b.a)((e=>{var t;return Object(k.pick)(["dataProviders","timelineType"],null!==(t=i(e,D.q.active))&&void 0!==t?t:B.a)})),m=Object(b.a)(n),[,p]=Object(E.h)(),v=Object(l.useCallback)((e=>{const t=u===D.x.template?Object(L.b)(e):Object(L.a)(e);Object(E.e)(t,p)}),[p,u]),j=Object(l.useCallback)((t=>{try{J(),null!=m&&(({activeTimelineDataProviders:e,browserFields:t,dataProviders:a,dispatch:i,onAddedToTimeline:n,result:l})=>{if(Object(A.p)(l))Object(F.d)({dataProviders:e,destination:l.destination,dispatch:i,source:l.source,timelineId:D.q.active});else if(Object(A.o)(l))Object(A.c)({activeTimelineDataProviders:e,dataProviders:a,dispatch:i,onAddedToTimeline:n,result:l,timelineId:D.q.active});else if(Object(A.i)(l)){var r,o;Object(z.addFieldToTimelineColumns)({browserFields:t,defaultsHeader:q.b,dispatch:i,result:l,timelineId:Object(z.getTimelineIdFromColumnDroppableId)(null!==(r=null===(o=l.destination)||void 0===o?void 0:o.droppableId)&&void 0!==r?r:"")})}})({activeTimelineDataProviders:c,browserFields:e,dataProviders:m,dispatch:a,onAddedToTimeline:v,result:t})}finally{document.body.classList.remove(N.d),Object(A.e)(t)&&document.body.classList.remove(A.b)}}),[c,e,m,a,v]);return r.a.createElement(C.DragDropContext,{onDragEnd:j,onBeforeCapture:$,sensors:s},t)};R.displayName="DragDropContextWrapperComponent";const _=r.a.memo(R,((e,t)=>P()(e.children,t.children)));_.displayName="DragDropContextWrapper";const $=e=>{Object(A.e)(e)||document.body.classList.add(N.d),Object(A.e)(e)&&document.body.classList.add(A.b)},J=()=>window.onscroll=()=>k.noop;var H=a(171),Q=a(2),G=a(18);const K=r.a.memo((()=>{const{chrome:e,docLinks:t}=Object(O.j)().services;return Object(l.useEffect)((()=>{e.setHelpExtension({appName:G.a,links:[{content:Q.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation",{defaultMessage:"Security documentation"}),href:t.links.siem.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{content:Q.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation.ecs",{defaultMessage:"ECS documentation"}),href:t.links.ecs.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{linkType:"discuss",href:"https://discuss.elastic.co/c/security",target:"_blank",rel:"noopener"}]})}),[]),null}));K.displayName="HelpMenu";var U=a(243),V=a(201),W=a(210),Y=a(188),X=a(362),Z=a(172),ee=a(104);const te=(e,t)=>{const a=Object(Y.a)(e),i="global",n={linkTo:Object(k.get)("global.linkTo",a)},l=Object(k.get)("global.timerange.kind",a),r="timeline",o={linkTo:Object(k.get)("timeline.linkTo",a)},s=Object(k.get)("timeline.timerange.kind",a);if(Object(k.isEmpty)(n.linkTo)?t(V.b.removeGlobalLinkTo()):t(V.b.addGlobalLinkTo({linkToId:"timeline"})),Object(k.isEmpty)(o.linkTo)?t(V.b.removeTimelineLinkTo()):t(V.b.addTimelineLinkTo({linkToId:"global"})),s){if("absolute"===s){const e=Object(X.a)(Object(k.get)("timeline.timerange",a));t(V.b.setAbsoluteRangeDatePicker({...e,id:r}))}if("relative"===s){const e=Object(X.a)(Object(k.get)("timeline.timerange",a));t(V.b.setRelativeRangeDatePicker({...e,id:r}))}}if(l){if("absolute"===l){const e=Object(X.a)(Object(k.get)("global.timerange",a));t(V.b.setAbsoluteRangeDatePicker({...e,id:i}))}if("relative"===l){const e=Object(X.a)(Object(k.get)("global.timerange",a));t(V.b.setRelativeRangeDatePicker({...e,id:i}))}}};var ae=a(604);const ie=({search:e,urlKey:t})=>Object(Y.c)(Object(Y.d)(e),t);const ne=({indexPattern:e,navTabs:t,pageName:a,urlState:i,search:n,pathName:r,history:o})=>{const[c,u]=Object(l.useState)(!0),{filterManager:m,savedQueries:p}=Object(O.j)().services.data.query,{pathname:b}=Object(s.useLocation)(),g=function(e){const t=Object(l.useRef)(e);return Object(l.useEffect)((()=>{t.current=e})),t.current}({pathName:r,pageName:a,urlState:i,search:n}),{setInitialStateFromUrl:v,updateTimeline:E,updateTimelineIsLoading:j}=(()=>{const e=Object(d.useDispatch)(),t=Object(l.useMemo)((()=>Object(Z.b)(e)),[e]),a=Object(l.useMemo)((()=>t=>e(T.a.updateIsLoading(t))),[e]),i=Object(l.useCallback)((({filterManager:i,indexPattern:n,pageName:l,savedQueries:r,urlStateToUpdate:o})=>{o.forEach((({urlKey:o,newUrlStateString:s})=>{if(o===W.a.timerange&&te(s,e),o===W.a.sourcerer){const t=Object(Y.a)(s);null!=t&&Object.keys(t).filter((e=>!(e===ee.SourcererScopeName.default&&Object(Y.g)(l)))).forEach((a=>{var i;return e(V.c.setSelectedIndexPatterns({id:a,selectedPatterns:null!==(i=t[a])&&void 0!==i?i:[]}))}))}if(o===W.a.appQuery&&null!=n){const t=Object(Y.a)(s);null!=t&&e(V.b.setFilterQuery({id:"global",query:t.query,language:t.language}))}if(o===W.a.filters){const e=Object(Y.a)(s);i.setFilters(e||[])}if(o===W.a.savedQuery){const t=Object(Y.a)(s);null!=t&&""!==t&&r.getSavedQuery(t).then((t=>{i.setFilters(t.attributes.filters||[]),e(V.b.setFilterQuery({id:"global",...t.attributes.query})),e(V.b.setSavedQuery({id:"global",savedQuery:t}))}))}if(o===W.a.timeline){const e=Object(Y.a)(s);null!=e&&""!==e.id&&Object(Z.h)({activeTimelineTab:e.activeTab,duplicate:!1,graphEventId:e.graphEventId,timelineId:e.id,openTimeline:e.isOpen,updateIsLoading:a,updateTimeline:t})}}))}),[e,t,a]);return Object.freeze({setInitialStateFromUrl:i,updateTimeline:t,updateTimelineIsLoading:a})})(),h=Object(l.useCallback)((t=>{const l=[],s=[];Object(ae.b)(t)?ae.a.forEach((e=>{s.push({urlStateToReplace:"",urlStateKey:e})})):ae.a.forEach((e=>{const t=re({urlKey:e,search:n});if(t){const n=oe({isFirstPageLoad:c,newUrlStateString:t,updateTimerange:Object(Y.g)(a)||c,urlKey:e});n&&s.push(n);const r=n?Object(Y.b)(n.urlStateToReplace):t;(c||Object(Y.g)(a)&&r!==t)&&(e===W.a.timeline&&se(t,i.timeline)||l.push({urlKey:e,newUrlStateString:r}))}else s.push({urlStateToReplace:le(i,e),urlStateKey:e})})),Object(Y.l)(s,r,n,o),v({filterManager:m,indexPattern:e,pageName:a,savedQueries:p,urlStateToUpdate:l})}),[m,o,e,a,r,p,n,v,i,c]);return Object(l.useEffect)((()=>{if(b!==r)return;const e=Object(Y.f)(a);if(P()(i,g.urlState)||c||Object(ae.b)(e))(c&&null!=a&&""!==a||r!==g.pathName)&&(h(e),u(!1));else{const e=ae.a.map((e=>({urlStateToReplace:le(i,e),urlStateKey:e})));Object(Y.l)(e,r,n,o)}}),[c,o,r,a,g,i,b,h,n]),Object(l.useEffect)((()=>{document.title=`${Object(Y.e)(a,t)} - Kibana`}),[a,t]),Object(l.useEffect)((()=>{(({oldSearch:e,search:t,timelineIdFromReduxStore:a,updateTimeline:i,updateTimelineIsLoading:n})=>{const l=ie({urlKey:W.a.timeline,search:null!=e?e:""}),r=ie({urlKey:W.a.timeline,search:t});if(null!=l&&null!=r){var o,s;let e=null,t=null;try{e=Object(Y.a)(r)}catch(e){}try{t=Object(Y.a)(l)}catch(e){}const m=null===(o=e)||void 0===o?void 0:o.id,p=null===(s=t)||void 0===s?void 0:s.id;var c,u,d;m&&m!==p&&m!==a&&Object(Z.h)({activeTimelineTab:null!==(c=null===(u=e)||void 0===u?void 0:u.activeTab)&&void 0!==c?c:D.w.query,duplicate:!1,graphEventId:null===(d=e)||void 0===d?void 0:d.graphEventId,timelineId:m,openTimeline:!0,updateIsLoading:n,updateTimeline:i})}})({oldSearch:g.search,search:n,timelineIdFromReduxStore:i.timeline.id,updateTimeline:E,updateTimelineIsLoading:j})}),[n,g.search,i.timeline.id,E,j]),null},le=(e,t)=>Object(Y.h)(e[t],t)?"":e[t],re=({search:e,urlKey:t})=>Object(Y.c)(Object(Y.d)(e),t),oe=({isFirstPageLoad:e,newUrlStateString:t,updateTimerange:a,urlKey:i})=>{if(Object(Y.h)(Object(Y.a)(t),i))return{urlStateToReplace:"",urlStateKey:i};if(i===W.a.timerange&&a){const a=Object(Y.a)(t);if(null!=a&&null!=a.global)return{urlStateToReplace:Object(Y.m)(a,e),urlStateKey:i}}},se=(e,t)=>{const a=Object(Y.a)(e);return null!=a&&a.id===t.id},ce=r.a.memo((function(e){return ne(e),null}),((e,t)=>e.pathName===t.pathName&&P()(e.urlState,t.urlState)&&P()(e.indexPattern,t.indexPattern)&&e.search===t.search&&P()(e.navTabs,t.navTabs))),ue=Object(d.connect)(Y.i)((e=>{const[t]=Object(U.a)();return r.a.createElement(ce,n()({},t,e))}));var de=a(256),me=a(109),pe=a(65),be=a(278);const ge=()=>{const e=Object(O.j)(),t=Object(be.b)().endpointPrivileges.canAccessFleet;Object(l.useEffect)((()=>{const a=new AbortController,i=()=>{a.abort()};if(t){const t=a.signal;return(async()=>{try{var i;await(null===(i=e.services.fleet)||void 0===i?void 0:i.isInitialized()),await(async(e,t={})=>e.post(pe.epmRouteService.getBulkInstallPath(),{...t,body:JSON.stringify({packages:["endpoint","security_detection_engine"]})}))(e.services.http,{signal:t})}catch(e){a.signal.aborted||console.error(e)}})(),i}}),[t,e.services.fleet,e.services.http])};var ve=a(216),Ee=a(63),je=a(57),he=a(61),ye=a.n(he),Oe=a(56),fe=a.n(Oe),we=a(33),Se=a(768);const Te=(e,t)=>e.filter((e=>null==t||(e.id.includes(t)||e.description.includes(t)))),Ie=Q.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.searchFilterPlaceholder",{defaultMessage:"e.g. rare_process_linux"}),xe=Q.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.groupsLabel",{defaultMessage:"Groups"}),ke=Q.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.noGroupsAvailableDescription",{defaultMessage:"No Groups available"}),Ce=Q.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showAllJobsLabel",{defaultMessage:"Elastic jobs"}),Me=Q.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showSiemJobsLabel",{defaultMessage:"Custom jobs"});var Pe=a(605);const Ne=({securityJobs:e,onSelectedGroupsChanged:t})=>{const[a,i]=Object(l.useState)(!1),[n,o]=Object(l.useState)([]),s=e.map((e=>e.groups)).flat().filter((e=>"siem"!==e&&"security"!==e)),c=Array.from(new Set(s));return Object(l.useEffect)((()=>{t(n)}),[n.sort().join()]),r.a.createElement(m.EuiPopover,{ownFocus:!0,button:r.a.createElement(m.EuiFilterButton,{"data-test-subj":"groups-filter-popover-button",iconType:"arrowDown",onClick:()=>i(!a),isSelected:a,numFilters:c.length,hasActiveFilters:n.length>0,numActiveFilters:n.length},xe),isOpen:a,closePopover:()=>i(!a),panelPaddingSize:"none",repositionOnScroll:!0},c.map(((e,t)=>r.a.createElement(m.EuiFilterSelectItem,{checked:n.includes(e)?"on":void 0,key:`${t}-${e}`,onClick:()=>Object(Pe.a)(e,n,o)},`${e} (${s.filter((t=>t===e)).length})`))),0===c.length&&r.a.createElement(m.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},r.a.createElement(m.EuiFlexItem,{grow:!0},r.a.createElement(m.EuiIcon,{type:"minusInCircle"}),r.a.createElement(m.EuiSpacer,{size:"xs"}),r.a.createElement("p",null,ke))))};Ne.displayName="GroupsFilterPopoverComponent";const Fe=r.a.memo(Ne);Fe.displayName="GroupsFilterPopover";const Le=({securityJobs:e,onFilterChanged:t})=>{const[a,i]=Object(l.useState)(""),[n,o]=Object(l.useState)([]),[s,c]=Object(l.useState)(!1),[u,d]=Object(l.useState)(!1);Object(l.useEffect)((()=>{t({filterQuery:a,showCustomJobs:s,showElasticJobs:u,selectedGroups:n})}),[a,n,s,u,t]);const p=Object(l.useCallback)((e=>i(e.queryText.trim())),[i]),b=Object(l.useCallback)((()=>{d(!u),c(!1)}),[d,u,c]),g=Object(l.useCallback)((()=>{c(!s),d(!1)}),[d,s,c]);return r.a.createElement(m.EuiFlexGroup,{gutterSize:"m",justifyContent:"flexEnd"},r.a.createElement(m.EuiFlexItem,{grow:!0},r.a.createElement(m.EuiSearchBar,{"data-test-subj":"jobs-filter-bar",box:{placeholder:Ie,incremental:!0},onChange:p})),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiFilterGroup,null,r.a.createElement(Fe,{securityJobs:e,onSelectedGroupsChanged:o}))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiFilterGroup,null,r.a.createElement(m.EuiFilterButton,{hasActiveFilters:u,onClick:b,"data-test-subj":"show-elastic-jobs-filter-button",withNext:!0},Ce),r.a.createElement(m.EuiFilterButton,{hasActiveFilters:s,onClick:g,"data-test-subj":"show-custom-jobs-filter-button"},Me))))};Le.displayName="JobsTableFiltersComponent";const De=r.a.memo(Le);De.displayName="JobsTableFilters";const Ae=Q.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.jobNameColumn",{defaultMessage:"Job name"}),Be=Q.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.tagsColumn",{defaultMessage:"Groups"}),ze=Q.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.runJobColumn",{defaultMessage:"Run job"}),qe=Q.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.noItemsDescription",{defaultMessage:"No Security Machine Learning jobs found"}),Re=Q.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.createCustomJobButtonLabel",{defaultMessage:"Create custom job"});var _e=a(217);const $e=fe()(m.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-1xsgv9-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);$e.displayName="StaticSwitch";const Je=({job:e,isSecurityJobsLoading:t,onJobStateChange:a})=>{const[i,n]=Object(l.useState)(!1),o=Object(l.useCallback)((async t=>{n(!0),await a(e,e.latestTimestampMs||0,t.target.checked),n(!1)}),[e,n,a]);return r.a.createElement(m.EuiFlexGroup,{justifyContent:"spaceAround"},r.a.createElement(m.EuiFlexItem,{grow:!1},t||i||Object(_e.b)(e.jobState,e.datafeedState)?r.a.createElement(m.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):r.a.createElement($e,{"data-test-subj":"job-switch",disabled:Object(_e.a)(e.jobState,e.datafeedState),checked:Object(_e.c)(e.jobState,e.datafeedState),onChange:o,showLabel:!1,label:""})))};Je.displayName="JobSwitchComponent";const He=r.a.memo(Je);He.displayName="JobSwitch";var Qe=a(76);const Ge=fe.a.div.withConfig({displayName:"JobNameWrapper",componentId:"sc-1foobv2-0"})(["margin:5px 0;"]);Ge.displayName="JobNameWrapper";const Ke=({id:e,description:t,basePath:a})=>{const{services:{ml:i}}=Object(O.j)(),n=Object(Qe.useMlHref)(i,a,{page:Qe.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:e}});return r.a.createElement(Ge,null,r.a.createElement(m.EuiText,{size:"s"},r.a.createElement(m.EuiLink,{"data-test-subj":"jobs-table-link",href:n,target:"_blank"},e)),r.a.createElement(m.EuiText,{color:"subdued",size:"xs"},t.length>200?`${t.substring(0,200)}...`:t))},Ue=(e,t,a)=>[{name:Ae,render:({id:e,description:t})=>r.a.createElement(Ke,{id:e,description:t,basePath:a})},{name:Be,render:({groups:e})=>r.a.createElement(m.EuiFlexGroup,{wrap:!0,responsive:!0,gutterSize:"xs"},e.map((e=>r.a.createElement(m.EuiFlexItem,{grow:!1,key:e},r.a.createElement(m.EuiBadge,{color:"hollow"},e))))),width:"140px"},{name:ze,render:a=>a.isCompatible?r.a.createElement(He,{job:a,isSecurityJobsLoading:e,onJobStateChange:t}):r.a.createElement(m.EuiIcon,{"aria-label":"Warning",size:"s",type:"alert",color:"warning"}),align:m.CENTER_ALIGNMENT,width:"80px"}],Ve=(e,t,a)=>e.slice(t*a,t*a+a),We=({isLoading:e,jobs:t,onJobStateChange:a})=>{const[i,n]=Object(l.useState)(0),o=Object(O.e)(),s={hidePerPageOptions:!0,pageIndex:i,pageSize:5,totalItemCount:t.length};return Object(l.useEffect)((()=>{n(0)}),[t.length]),r.a.createElement(m.EuiBasicTable,{"data-test-subj":"jobs-table",columns:Ue(e,a,o),items:Ve(t,i,5),loading:e,noItemsMessage:r.a.createElement(Xe,{basePath:o}),pagination:s,responsive:!1,onChange:({page:e})=>{n(e.index)}})};We.displayName="JobsTableComponent";const Ye=r.a.memo(We);Ye.displayName="JobsTable";const Xe=r.a.memo((({basePath:e})=>{const{services:{ml:t}}=Object(O.j)(),a=Object(Qe.useMlHref)(t,e,{page:Qe.ML_PAGES.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});return r.a.createElement(m.EuiEmptyPrompt,{title:r.a.createElement("h3",null,qe),titleSize:"xs",actions:r.a.createElement(m.EuiButton,{href:a,iconType:"popout",iconSide:"right",size:"s",target:"_blank"},Re)})}));Xe.displayName="NoItemsMessage";const Ze=fe.a.div.withConfig({displayName:"ShowingContainer",componentId:"sc-8k6h3p-0"})(["user-select:none;margin-top:5px;"]);Ze.displayName="ShowingContainer";const et=({filterResultsLength:e})=>r.a.createElement(Ze,{"data-test-subj":"showing"},r.a.createElement(m.EuiText,{color:"subdued",size:"xs"},r.a.createElement(je.FormattedMessage,{"data-test-subj":"query-message",id:"xpack.securitySolution.components.mlPopup.showingLabel",defaultMessage:"Showing: {filterResultsLength} {filterResultsLength, plural, one {job} other {jobs}}",values:{filterResultsLength:e}})));et.displayName="ShowingCountComponent";const tt=r.a.memo(et);tt.displayName="ShowingCount";const at=()=>r.a.createElement(m.EuiText,{size:"s"},r.a.createElement(je.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.anomalyDetectionDescription",defaultMessage:"Run any of the Machine Learning jobs below to prepare for creating detection rules that produce alerts for detected anomalies, and to view anomalous events throughout the Security application. We’ve provided a collection of common detection jobs to get you started. If you wish to add your own custom ML jobs, create and add them to the “Security” group from the {machineLearning} application.",values:{machineLearning:r.a.createElement(m.EuiLink,{href:`${Object(O.e)()}/app/ml`,target:"_blank"},r.a.createElement(je.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.machineLearningLink",defaultMessage:"Machine Learning"}))}}));at.displayName="PopoverDescriptionComponent";const it=r.a.memo(at);it.displayName="PopoverDescription";const nt=Q.i18n.translate("xpack.securitySolution.components.mlPopup.mlJobSettingsButtonLabel",{defaultMessage:"ML job settings"}),lt=Q.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeTitle",{defaultMessage:"Upgrade to Elastic Platinum"}),rt=Q.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),ot=Q.i18n.translate("xpack.securitySolution.components.mlPopup.licenseButtonLabel",{defaultMessage:"Manage license"}),st=e=>Q.i18n.translate("xpack.securitySolution.components.mlPopup.moduleNotCompatibleTitle",{values:{incompatibleJobCount:e},defaultMessage:"{incompatibleJobCount} {incompatibleJobCount, plural, =1 {job} other {jobs}} are currently unavailable"}),ct=Q.i18n.translate("xpack.securitySolution.components.mlPopup.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),ut=Q.i18n.translate("xpack.securitySolution.containers.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),dt=Q.i18n.translate("xpack.securitySolution.components.mlPopup.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),mt=fe.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-fqnfg5-0"})(["width:384px;"]);mt.displayName="PopoverContentsDiv";const pt=()=>r.a.createElement(mt,{"data-test-subj":"ml-popover-upgrade-contents"},r.a.createElement(m.EuiPopoverTitle,null,lt),r.a.createElement(m.EuiText,{size:"s"},r.a.createElement(je.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.upgradeDescription",defaultMessage:"To access SIEM’s anomaly detection features, you must update your license to Platinum, start a free 30-day trial, or spin up a {cloudLink} on AWS, GCP, or Azure. You can then run Machine Learning jobs and view anomalies.",values:{cloudLink:r.a.createElement(m.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},r.a.createElement(je.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.cloudLink",defaultMessage:"cloud deployment"}))}})),r.a.createElement(m.EuiSpacer,null),r.a.createElement(m.EuiFlexGroup,{gutterSize:"s",wrap:!0},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},rt)),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiButton,{href:`${Object(O.e)()}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},ot)))),bt=r.a.memo(pt);bt.displayName="UpgradeContents";var gt=a(534);const vt=fe.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-z6keba-0"})(["max-width:684px;max-height:90vh;overflow-y:auto;overflow-x:hidden;padding-bottom:15px;"]);function Et(e,t){switch(t.type){case"refresh":return{...e,refreshToggle:!e.refreshToggle};case"loading":return{...e,isLoading:!0};case"success":case"failure":return{...e,isLoading:!1};default:return e}}vt.displayName="PopoverContentsDiv";const jt={isLoading:!1,refreshToggle:!0},ht={filterQuery:"",showCustomJobs:!1,showElasticJobs:!1,selectedGroups:[]},yt=r.a.memo((()=>{const[{isLoading:e,refreshToggle:t},a]=Object(l.useReducer)(Et,jt),[i,n]=Object(l.useState)(!1),[o,s]=Object(l.useState)(ht),{isMlAdmin:c,isLicensed:u,loading:d,jobs:p}=Object(gt.a)(t),[,b]=Object(E.h)(),g=Object(O.j)().services.docLinks,v=Object(l.useCallback)(((e,t,i)=>Ot(e,t,i,a,b)),[a,b]),j=(({jobs:e,selectedGroups:t,showCustomJobs:a,showElasticJobs:i,filterQuery:n})=>Te(e.filter((e=>!a||a&&!e.isElasticJob)).filter((e=>!i||i&&e.isElasticJob)).filter((e=>0===t.length||t.some((t=>e.groups.includes(t))))),n))({jobs:p,...o}),h=p.filter((e=>!e.isCompatible)).length,y=Object(l.useMemo)((()=>p.filter((e=>e.isInstalled)).map((e=>e.id))),[p]);return u?c?r.a.createElement(m.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:r.a.createElement(m.EuiHeaderSectionItemButton,{"aria-expanded":i,"aria-haspopup":"true","aria-label":nt,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>{n(!i),a({type:"refresh"})},textProps:{style:{fontSize:"1rem"}}},nt),isOpen:i,closePopover:()=>n(!i),repositionOnScroll:!0},r.a.createElement(vt,{"data-test-subj":"ml-popover-contents"},r.a.createElement(m.EuiPopoverTitle,null,nt),r.a.createElement(it,null),r.a.createElement(m.EuiSpacer,null),r.a.createElement(De,{securityJobs:p,onFilterChanged:s}),r.a.createElement(tt,{filterResultsLength:j.length}),r.a.createElement(m.EuiSpacer,{size:"m"}),h>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(m.EuiCallOut,{title:st(h),color:"warning",iconType:"alert",size:"s"},r.a.createElement("p",null,r.a.createElement(je.FormattedMessage,{defaultMessage:"We could not find any data, see {mlDocs} for more information on Machine Learning job requirements.",id:"xpack.securitySolution.components.mlPopup.moduleNotCompatibleDescription",values:{mlDocs:r.a.createElement("a",{href:`${g.links.siem.ml}`,rel:"noopener noreferrer",target:"_blank"},"Anomaly Detection with Machine Learning")}}))),r.a.createElement(m.EuiSpacer,{size:"m"})),r.a.createElement(Qe.MLJobsAwaitingNodeWarning,{jobIds:y}),r.a.createElement(Ye,{isLoading:d||e,jobs:j,onJobStateChange:v}))):null:r.a.createElement(m.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:r.a.createElement(m.EuiHeaderSectionItemButton,{"aria-expanded":i,"aria-haspopup":"true","aria-label":nt,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>n(!i),textProps:{style:{fontSize:"1rem"}}},nt),isOpen:i,closePopover:()=>n(!i),repositionOnScroll:!0},r.a.createElement(bt,null))})),Ot=async(e,t,a,i,n)=>{if(ft(e,a),!e.isInstalled){i({type:"loading"});try{await Object(Se.c)({configTemplate:e.moduleId,indexPatternName:e.defaultIndexPattern,jobIdErrorFilter:[e.id],groups:e.groups}),i({type:"success"})}catch(e){return Object(E.g)({title:dt,error:e,dispatchToaster:n}),i({type:"failure"}),void i({type:"refresh"})}}const l=ye.a.utc().subtract(14,"days").valueOf();if(a){const a=Math.max(t,l);try{await Object(Se.d)({datafeedIds:[`datafeed-${e.id}`],start:a})}catch(e){Object(we.e)(we.a.COUNT,we.b.JOB_ENABLE_FAILURE),Object(E.g)({title:ct,error:e,dispatchToaster:n})}}else try{await Object(Se.e)({datafeedIds:[`datafeed-${e.id}`]})}catch(e){Object(we.e)(we.a.COUNT,we.b.JOB_DISABLE_FAILURE),Object(E.g)({title:ut,error:e,dispatchToaster:n})}i({type:"refresh"})},ft=(e,t)=>{Object(we.e)(we.a.COUNT,e.isElasticJob?t?we.b.SIEM_JOB_ENABLED:we.b.SIEM_JOB_DISABLED:t?we.b.CUSTOM_JOB_ENABLED:we.b.CUSTOM_JOB_DISABLED)};yt.displayName="MlPopover";var wt=a(23);const St=Q.i18n.translate("xpack.securitySolution.globalHeader.buttonAddData",{defaultMessage:"Add integrations"}),Tt=r.a.memo((({setHeaderActionMenu:e})=>{const t=Object(l.useMemo)((()=>Object(ve.c)()),[]),{http:{basePath:{prepend:a}}}=Object(O.j)().services,{pathname:i}=Object(s.useLocation)();return Object(l.useEffect)((()=>(e((e=>Object(Ee.toMountPoint)(r.a.createElement(ve.b,{node:t}))(e))),()=>{t.unmount(),e(void 0)})),[t,e]),r.a.createElement(ve.a,{node:t},r.a.createElement(m.EuiHeaderSection,{side:"right"},Object(wt.c)(i)&&r.a.createElement(m.EuiHeaderSectionItem,null,r.a.createElement(yt,null)),r.a.createElement(m.EuiHeaderSectionItem,null,r.a.createElement(m.EuiHeaderLinks,null,r.a.createElement(m.EuiHeaderLink,{color:"primary","data-test-subj":"add-data",href:a(c.a),iconType:"indexOpen"},St)))))}));Tt.displayName="GlobalHeader";var It=a(442),xt=a(148),kt=a(369);const Ct=({navTabs:e,selectedTabId:t,...a})=>{const{navigateTo:i,getAppUrl:n}=Object(xt.i)(),r=Object(l.useCallback)((e=>{const{id:l,name:r,disabled:o}=e,s=t===l,c=Object(It.a)(e,a),u=n({deepLinkId:l,path:c});return{"data-href":u,"data-test-subj":`navigation-${l}`,disabled:o,href:u,id:l,isSelected:s,name:r,onClick:e=>{e.preventDefault(),i({deepLinkId:l,path:c})}}}),[n,i,t,a]),o=function(e){var t;const a=null===(t=Object(O.h)())||void 0===t?void 0:t.read,i=Object(kt.a)();return Object(l.useMemo)((()=>[{id:"main",name:"",items:[e.overview]},{...de.b.detect,items:[e.alerts,e.rules,e.exceptions]},{...de.b.explore,items:[e.hosts,e.network,...null!=e.ueba?[e.ueba]:[]]},{...de.b.investigate,items:a?[e.timelines,e.case]:[e.timelines]},{...de.b.manage,items:[e.endpoints,e.trusted_apps,e.event_filters,...i?[e.host_isolation_exceptions]:[]]}]),[e,a,i])}(e);return Object(l.useMemo)((()=>o.map((e=>({...e,items:e.items.map((e=>r(e)))})))),[r,o])};const Mt=Q.i18n.translate("xpack.securitySolution.navigation.mainLabel",{defaultMessage:"Security"});var Pt=a(772),Nt=a(116);const Ft=()=>{const[e]=Object(U.a)(),t=Object(Y.i)(),{urlState:a}=Object(b.a)(t),{chrome:i,application:{getUrlForApp:n,navigateToUrl:r}}=Object(O.j)().services,{detailName:o,flowTarget:s,pageName:c,pathName:u,search:d,state:m,tabName:p}=e,g=Object(Nt.a)("uebaEnabled");let v=de.a;if(!g){const{ueba:e,...t}=v;v=t}const E=Object(Pt.a)();return Object(l.useEffect)((()=>{(u||c)&&E({detailName:o,filters:a.filters,flowTarget:s,navTabs:v,pageName:c,pathName:u,query:a.query,savedQuery:a.savedQuery,search:d,sourcerer:a.sourcerer,state:m,tabName:p,timeline:a.timeline,timerange:a.timerange},i,n,r)}),[i,c,u,d,a,m,o,s,p,n,r,v,E]),(({filters:e,query:t,navTabs:a,pageName:i,savedQuery:n,sourcerer:r,tabName:o,timeline:s,timerange:c})=>{const u=Object(l.useCallback)((()=>{var e,t;return null!==(e=null===(t=o&&a[o]||a[i])||void 0===t?void 0:t.id)&&void 0!==e?e:""}),[i,o,a]),[d,m]=Object(l.useState)(u());Object(l.useEffect)((()=>{const e=u();e!==d&&m(e)}),[i,a,u,d]);const p=Ct({navTabs:a,selectedTabId:d,filters:e,query:t,savedQuery:n,sourcerer:r,timeline:s,timerange:c});return{name:Mt,icon:"logoSecurity",items:p}})({query:a.query,filters:a.filters,navTabs:v,pageName:c,sourcerer:a.sourcerer,savedQuery:a.savedQuery,tabName:p,timeline:a.timeline,timerange:a.timerange})};var Lt=a(112);const Dt=()=>Object(Lt.createSelector)(T.b.selectTimeline,(e=>{var t,a,i,n;return{activeTab:null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:D.w.query,status:null!==(a=null==e?void 0:e.status)&&void 0!==a?a:D.u.draft,show:null!==(i=null==e?void 0:e.show)&&void 0!==i&&i,updated:null!==(n=null==e?void 0:e.updated)&&void 0!==n?n:void 0}}));var At=a(607);const Bt=fe.a.div.withConfig({displayName:"StyledStickyWrapper",componentId:"sc-jbkt6d-0"})(["position:sticky;z-index:",";"],(e=>e.theme.eui.euiZHeaderBelowDataGrid)),zt=r.a.memo((()=>{const{globalKQLHeaderPortalNode:e}=Object(At.a)();return r.a.createElement(Bt,{id:"securitySolutionStickyKQL"},r.a.createElement(ve.b,{node:e}))}));zt.displayName="GlobalKQLHeader";const qt=["/cases/configure","/administration"],Rt=()=>{const[{pageName:e,pathName:t}]=Object(U.a)(),[a,i]=Object(l.useState)(!qt.includes(window.location.pathname));return Object(l.useEffect)((()=>{qt.filter((e=>window.location.pathname.includes(e))).length>0?a&&i(!1):a||i(!0)}),[e,t]),[a]};var _t=a(141);const $t=Q.i18n.translate("xpack.securitySolution.timeline.autosave.warning.title",{defaultMessage:"Auto-save disabled until refresh"}),Jt=Q.i18n.translate("xpack.securitySolution.timeline.autosave.warning.description",{defaultMessage:"Another user has made changes to this timeline. Any changes you make will not be auto-saved until you have refreshed this timeline to absorb those changes."}),Ht=Q.i18n.translate("xpack.securitySolution.timeline.autosave.warning.refresh.title",{defaultMessage:"Refresh timeline"}),Qt=()=>{const e=Object(d.useDispatch)(),t=Object(E.h)()[1],{timelineId:a,newTimelineModel:i}=Object(b.a)(T.b.autoSaveMsgSelector),n=Object(l.useCallback)((()=>{null!=a&&null!=i&&(e(T.a.updateTimeline({id:a,timeline:i})),e(T.a.updateAutoSaveMsg({timelineId:null,newTimelineModel:null})),e(Object(_t.setTimelineRangeDatePicker)({from:Object(k.getOr)(0,"dateRange.start",i),to:Object(k.getOr)(0,"dateRange.end",i)})))}),[e,i,a]),o=Object(l.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,Jt),r.a.createElement(m.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiButton,{size:"s",onClick:n},Ht))))),[n]);if(null!=a&&null!=i){t({type:"addToaster",toast:{id:"AutoSaveWarningMsg",title:$t,color:"warning",iconType:"alert",toastLifeTimeMs:1e4,text:o}})}return null};Qt.displayName="AutoSaveWarningMsgComponent";const Gt=r.a.memo(Qt);var Kt=a(763),Ut=a(117),Vt=a(325),Wt=a(14),Yt=a(111),Xt=a(4),Zt=a(267);const ea=({timelineId:e})=>{var t;const a=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),{cases:i,application:{navigateToApp:n}}=Object(O.j)().services,o=Object(d.useDispatch)(),{graphEventId:s,savedObjectId:u,status:p,title:g,timelineType:v}=Object(b.a)((t=>{var i;return Object(k.pick)(["graphEventId","savedObjectId","status","title","timelineType"],null!==(i=a(t,e))&&void 0!==i?i:B.a)})),[E,j]=Object(l.useState)(!1),[h,y]=Object(l.useState)(!1),f=Object(l.useCallback)((async t=>{y(!1),await n(c.l,{deepLinkId:Xt.a.case,path:null!=t?Object(Yt.b)({id:t.id}):Object(Yt.f)()}),o(Object(Wt.setInsertTimeline)({graphEventId:s,timelineId:e,timelineSavedObjectId:u,timelineTitle:g}))}),[o,s,n,u,e,g]),{formatUrl:w}=Object(Yt.n)(Xt.a.case),S=Object(O.h)(),I=Object(l.useCallback)((e=>{e.preventDefault(),f()}),[f]),x=Object(l.useCallback)((()=>{j((e=>!e))}),[]),C=Object(l.useCallback)((()=>j(!1)),[]),M=Object(l.useCallback)((()=>{C(),n(c.l,{deepLinkId:Xt.a.case,path:Object(Yt.f)()}).then((()=>{o(Object(Wt.setInsertTimeline)({graphEventId:s,timelineId:e,timelineSavedObjectId:u,timelineTitle:g.length>0?g:Zt.l})),o(Object(Wt.showTimeline)({id:D.q.active,show:!1}))}))}),[o,s,n,C,u,e,g]),P=Object(l.useCallback)((()=>{C(),y(!0)}),[y,C]),N=Object(l.useCallback)((()=>{j(!1)}),[]),F=Object(l.useMemo)((()=>r.a.createElement(m.EuiButton,{fill:!0,size:"m","data-test-subj":"attach-timeline-case-button",iconType:"arrowDown",iconSide:"right",onClick:x,disabled:p===D.u.draft||v!==D.x.default},Zt.c)),[x,p,v]),L=Object(l.useMemo)((()=>[r.a.createElement(m.EuiContextMenuItem,{key:"new-case","data-test-subj":"attach-timeline-new-case",onClick:M},Zt.e),r.a.createElement(m.EuiContextMenuItem,{key:"existing-case","data-test-subj":"attach-timeline-existing-case",onClick:P},Zt.d)]),[P,M]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.EuiPopover,{id:"singlePanel",button:F,isOpen:E,closePopover:N,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(m.EuiContextMenuPanel,{items:L})),h&&i.getAllCasesSelectorModal({createCaseNavigation:{href:w(Object(Yt.f)()),onClick:I},onRowClick:f,userCanCrud:null!==(t=null==S?void 0:S.crud)&&void 0!==t&&t,owner:[c.l]}))};ea.displayName="AddToCaseButtonComponent";const ta=r.a.memo(ea);var aa=a(804),ia=a(764),na=a(169),la=a(15),ra=a(12),oa=a(59),sa=a(97);const ca=Q.i18n.translate("xpack.securitySolution.timeline.kpiFailDescription",{defaultMessage:"An error has occurred"}),ua=Q.i18n.translate("xpack.securitySolution.timeline.kpiFailSearchDescription",{defaultMessage:"Failed to load KPIs"});var da=a(189),ma=a(387);const pa=Q.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close timeline"}),ba=Q.i18n.translate("xpack.securitySolution.timeline.properties.unsavedLabel",{defaultMessage:"Unsaved"}),ga=Q.i18n.translate("xpack.securitySolution.timeline.properties.autosavedLabel",{defaultMessage:"Autosaved"}),va=Q.i18n.translate("xpack.securitySolution.timeline.properties.inspectTimelineTitle",{defaultMessage:"Timeline"}),Ea=Q.i18n.translate("xpack.securitySolution.timeline.kpis.processKpiTitle",{defaultMessage:"Processes"}),ja=Q.i18n.translate("xpack.securitySolution.timeline.kpis.hostKpiTitle",{defaultMessage:"Hosts"}),ha=Q.i18n.translate("xpack.securitySolution.timeline.kpis.sourceIpKpiTitle",{defaultMessage:"Source IPs"}),ya=Q.i18n.translate("xpack.securitySolution.timeline.kpis.destinationKpiTitle",{defaultMessage:"Destination IPs"}),Oa=Q.i18n.translate("xpack.securitySolution.timeline.kpis.userKpiTitle",{defaultMessage:"Users"}),fa=Q.i18n.translate("xpack.securitySolution.timeline.properties.readMore",{defaultMessage:"Read More"}),wa=({isOpen:e,title:t})=>Q.i18n.translate("xpack.securitySolution.timeline.properties.timelineToggleButtonAriaLabel",{values:{isOpen:e,title:t},defaultMessage:"{isOpen, select, false {Open} true {Close} other {Toggle}} timeline {title}"}),Sa=fe()(m.EuiHealth).withConfig({displayName:"EuiHealthStyled",componentId:"sc-4g9vxo-0"})(["display:block;"]),Ta=fe()(m.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-4g9vxo-1"})(["> span{padding:0;}"]),Ia=fe()(m.EuiFlexItem).withConfig({displayName:"TitleConatiner",componentId:"sc-4g9vxo-2"})(["overflow:hidden;display:inline-block;text-overflow:ellipsis;"]),xa=({timelineId:e,timelineStatus:t,timelineType:a,timelineTitle:i,updated:n,isOpen:o})=>{const s=Object(d.useDispatch)(),c=Object(l.useCallback)((()=>{s(T.a.showTimeline({id:e,show:!o})),Object(Ut.j)()}),[s,o,e]),u=Object(k.isEmpty)(i)?a===D.x.template?Zt.k:Zt.l:i,p=Object(l.useMemo)((()=>t===D.u.draft?r.a.createElement(r.a.Fragment,null,ba):r.a.createElement(r.a.Fragment,null,ga," ",r.a.createElement(je.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(n)}))),[t,n]);return r.a.createElement(Ta,{"aria-label":wa({isOpen:o,title:u}),className:Ut.b,flush:"both","data-test-subj":"flyoutOverlay",size:"s",isSelected:o,onClick:c},r.a.createElement(m.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexStart",responsive:!1},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"top",content:p},r.a.createElement(Sa,{color:t===D.u.draft?"warning":"success"}))),r.a.createElement(Ia,{grow:!1},u),!o&&r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(ma.b,null))))},ka=r.a.memo(xa);var Ca=a(62),Ma=a.n(Ca),Pa=a(100);const Na=fe()(m.EuiStat).withConfig({displayName:"NoWrapEuiStat",componentId:"sc-9jxvke-0"})(["& .euiStat__description{white-space:nowrap;}"]),Fa=r.a.memo((({kpis:e,isLoading:t})=>{const a="0,0.[000]a",[i]=Object(O.o)(c.O),n=Object(l.useMemo)((()=>({process:null===e?Object(Pa.e)():Ma()(e.processCount).format(a),user:null===e?Object(Pa.e)():Ma()(e.userCount).format(a),host:null===e?Object(Pa.e)():Ma()(e.hostCount).format(a),sourceIp:null===e?Object(Pa.e)():Ma()(e.sourceIpCount).format(a),destinationIp:null===e?Object(Pa.e)():Ma()(e.destinationIpCount).format(a)})),[e]),o=Object(l.useMemo)((()=>({process:Ma()(null==e?void 0:e.processCount).format(i),user:Ma()(null==e?void 0:e.userCount).format(i),host:Ma()(null==e?void 0:e.hostCount).format(i),sourceIp:Ma()(null==e?void 0:e.sourceIpCount).format(i),destinationIp:Ma()(null==e?void 0:e.destinationIpCount).format(i)})),[e,i]);return r.a.createElement(m.EuiFlexGroup,{wrap:!0,"data-test-subj":"siem-timeline-kpis"},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"left",content:o.process},r.a.createElement(Na,{"data-test-subj":"siem-timeline-process-kpi",title:n.process,description:Ea,titleSize:"s",isLoading:t}))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"left",content:o.user},r.a.createElement(Na,{"data-test-subj":"siem-timeline-user-kpi",title:n.user,description:Oa,titleSize:"s",isLoading:t}))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"left",content:o.host},r.a.createElement(Na,{"data-test-subj":"siem-timeline-host-kpi",title:n.host,description:ja,titleSize:"s",isLoading:t}))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{position:"left",content:o.sourceIp},r.a.createElement(Na,{"data-test-subj":"siem-timeline-source-ip-kpi",title:n.sourceIp,description:ha,titleSize:"s",isLoading:t}))),r.a.createElement(m.EuiFlexItem,{grow:!1,style:{minWidth:100}},r.a.createElement(m.EuiToolTip,{position:"left",content:o.destinationIp},r.a.createElement(Na,{"data-test-subj":"siem-timeline-destination-ip-kpi",title:n.destinationIp,description:ya,titleSize:"s",isLoading:t}))))}));Fa.displayName="TimelineKPIs";var La=a(637);const Da=fe()(m.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-12xgwp3-0"})(["margin:0 -1px 0;"]),Aa=fe()(m.EuiFlexItem).withConfig({displayName:"ActiveTimelinesContainer",componentId:"sc-12xgwp3-1"})(["overflow:hidden;"]),Ba=({timelineId:e})=>{const t=Object(d.useDispatch)(),{indexPattern:a,browserFields:i}=Object(me.c)(ee.SourcererScopeName.timeline),{uiSettings:n}=Object(O.j)().services,o=Object(l.useMemo)((()=>oa.esQuery.getEsQueryConfig(n)),[n]),s=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),{activeTab:c,dataProviders:u,kqlQuery:p,title:g,timelineType:v,status:E,updated:j,show:h,filters:y,kqlMode:f}=Object(b.a)((t=>{var a;return Object(k.pick)(["activeTab","dataProviders","kqlQuery","status","title","timelineType","updated","show","filters","kqlMode"],null!==(a=s(t,e))&&void 0!==a?a:B.a)})),w=Object(l.useMemo)((()=>!Object(k.isEmpty)(u)||!Object(k.isEmpty)(Object(k.get)("filterQuery.kuery.expression",p))),[u,p]),S=Object(l.useMemo)((()=>T.b.getKqlFilterQuerySelector()),[]),I=Object(d.useSelector)((t=>S(t,e))),x=Object(k.isEmpty)(u)&&Object(k.isEmpty)(I)&&"template"===v?" ":I,C=Object(l.useMemo)((()=>({query:x,language:"kuery"})),[x]),M=Object(l.useMemo)((()=>Object(Ut.i)({config:o,dataProviders:u,indexPattern:a,browserFields:i,filters:y||[],kqlQuery:C,kqlMode:f})),[i,u,o,y,a,f,C]),P=Object(l.useCallback)((()=>{t(T.a.showTimeline({id:e,show:!1})),Object(Ut.j)()}),[t,e]);return r.a.createElement(Da,{borderRadius:"none",grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-flyout-header-panel"},r.a.createElement(m.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(aa.b,{timelineId:e}),r.a.createElement(Aa,{grow:!1},r.a.createElement(ka,{timelineId:e,timelineType:v,timelineTitle:g,timelineStatus:E,isOpen:h,updated:j})),h&&r.a.createElement(m.EuiFlexItem,null,r.a.createElement(m.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s",responsive:!1},(c===D.w.query||c===D.w.eql)&&r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(na.a,{compact:!0,queryId:`${e}-${c}`,inputId:"timeline",inspectIndex:0,isDisabled:!w||void 0===(null==M?void 0:M.filterQuery),title:va})),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiToolTip,{content:pa},r.a.createElement(m.EuiButtonIcon,{"aria-label":pa,"data-test-subj":"close-timeline",iconType:"cross",onClick:P})))))))},za=r.a.memo(Ba),qa=fe.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-12xgwp3-2"})(["display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;"]),Ra=({description:e,onclick:t})=>{const[a,i]=Object(La.a)(e);return r.a.createElement(r.a.Fragment,null,r.a.createElement(qa,{ref:i},e),a&&r.a.createElement(m.EuiButtonEmpty,{flush:"left",onClick:t},fa))},_a=fe()(m.EuiFlexGroup).withConfig({displayName:"StyledTimelineHeader",componentId:"sc-12xgwp3-3"})([""," flex:0;"],(({theme:e})=>`margin: ${e.eui.euiSizeXS} ${e.eui.euiSizeS} 0 ${e.eui.euiSizeS};`)),$a=fe.a.span.withConfig({displayName:"TimelineStatusInfoContainer",componentId:"sc-12xgwp3-4"})([""," white-space:nowrap;"],(({theme:e})=>`margin-left: ${e.eui.euiSizeS};`)),Ja=fe.a.div.withConfig({displayName:"KpisContainer",componentId:"sc-12xgwp3-5"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeM};`)),Ha=fe()(m.EuiFlexItem).withConfig({displayName:"RowFlexItem",componentId:"sc-12xgwp3-6"})(["flex-direction:row;align-items:center;"]),Qa=fe.a.h3.withConfig({displayName:"TimelineTitleContainer",componentId:"sc-12xgwp3-7"})(["display:-webkit-box;overflow:hidden;-webkit-line-clamp:1;-webkit-box-orient:vertical;word-break:break-word;"]),Ga=({timelineId:e})=>{const t=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),{title:a,timelineType:i}=Object(b.a)((a=>{var i;return Object(k.pick)(["title","timelineType"],null!==(i=t(a,e))&&void 0!==i?i:B.a)})),n=Object(l.useMemo)((()=>i===D.x.template?Zt.k:Zt.l),[i]),o=Object(l.useMemo)((()=>a||n),[a,n]);return r.a.createElement(m.EuiToolTip,{content:o,position:"bottom"},r.a.createElement(m.EuiText,null,r.a.createElement(Qa,{"data-test-subj":"timeline-title"},o)))},Ka=r.a.memo(Ga),Ua=({timelineId:e})=>{const t=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),a=Object(b.a)((a=>{var i;return(null!==(i=t(a,e))&&void 0!==i?i:B.a).description})),i=Object(d.useDispatch)(),n=Object(l.useCallback)((t=>{i(Object(Wt.setActiveTabTimeline)({id:e,activeTab:D.w.notes,scrollToTop:!0}))}),[i,e]);return r.a.createElement(m.EuiText,{size:"s","data-test-subj":"timeline-description"},r.a.createElement(Ra,{description:a||Zt.f,onclick:n}))},Va=r.a.memo(Ua),Wa=({timelineId:e})=>{const t=Object(l.useMemo)((()=>Object(Lt.createSelector)(T.b.selectTimeline,(e=>{var t,a;return{status:null!==(t=null==e?void 0:e.status)&&void 0!==t?t:D.u.draft,updated:null!==(a=null==e?void 0:e.updated)&&void 0!==a?a:void 0}}))),[]),{status:a,updated:i}=Object(b.a)((a=>t(a,e)));return Object(l.useMemo)((()=>a===D.u.draft),[a])?r.a.createElement(m.EuiText,{size:"xs"},r.a.createElement(m.EuiTextColor,{color:"warning","data-test-subj":"timeline-status"},ba)):r.a.createElement(m.EuiText,{size:"xs"},r.a.createElement(m.EuiTextColor,{color:"default"},ga," ",r.a.createElement(je.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(i)})))},Ya=r.a.memo(Wa),Xa=({timelineId:e})=>{var t,a,i;const{selectedPatterns:n,indexPattern:o,docValueFields:s,browserFields:c}=Object(me.c)(ee.SourcererScopeName.timeline),u=Object(l.useMemo)((()=>Object(da.i)()),[]),p=Object(l.useMemo)((()=>Object(da.b)()),[]),g=Object(l.useMemo)((()=>e===D.q.active),[e]),v=Object(b.a)((e=>g?{from:u(e.inputs.timeline),to:p(e.inputs.timeline),interval:""}:{from:u(e.inputs.global),to:p(e.inputs.global),interval:""})),{uiSettings:E}=Object(O.j)().services,j=Object(l.useMemo)((()=>oa.esQuery.getEsQueryConfig(E)),[E]),h=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),y=Object(d.useSelector)((t=>{var a;return null!==(a=h(t,e))&&void 0!==a?a:B.a})),{dataProviders:f,filters:w,timelineType:S,kqlMode:I,activeTab:x}=y,C=Object(l.useMemo)((()=>T.b.getKqlFilterQuerySelector()),[]),M=Object(d.useSelector)((t=>C(t,e))),N=Object(k.isEmpty)(f)&&Object(k.isEmpty)(M)&&"template"===S?" ":M,F=Object(l.useMemo)((()=>({query:N,language:"kuery"})),[N]),L=Object(l.useMemo)((()=>Object(Ut.i)({config:j,dataProviders:f,indexPattern:o,browserFields:c,filters:w||[],kqlQuery:F,kqlMode:I})),[c,f,j,w,o,I,F]),A=Object(l.useMemo)((()=>Object(k.isEmpty)(f)&&Object(k.isEmpty)(w)&&Object(k.isEmpty)(F.query)||void 0===(null==L?void 0:L.filterQuery)),[f,w,F,L]),[z,q]=(({timerange:e,filterQuery:t,docValueFields:a,defaultIndex:i,isBlankTimeline:n})=>{const{data:r}=Object(O.j)().services,o=Object(l.useRef)(k.noop),s=Object(l.useRef)(new AbortController),c=Object(l.useRef)(new la.Subscription),[u,d]=Object(l.useState)(!1),[m,p]=Object(l.useState)(null),[b,g]=Object(l.useState)(null),{addError:v,addWarning:E}=Object(sa.a)(),j=Object(l.useCallback)((e=>{if(null==e)return;const t=async()=>{s.current=new AbortController,d(!0),c.current=r.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:s.current.signal}).subscribe({next:e=>{Object(oa.isCompleteResponse)(e)?(d(!1),g(e),c.current.unsubscribe()):Object(oa.isErrorResponse)(e)&&(d(!1),E(ca),c.current.unsubscribe())},error:e=>{d(!1),v(e,{title:ua}),c.current.unsubscribe()}})};c.current.unsubscribe(),s.current.abort(),t(),o.current=t}),[r.search,v,E]);return Object(l.useEffect)((()=>{p((n=>{const l={...null!=n?n:{},docValueFields:a,defaultIndex:i,timerange:e,filterQuery:t,factoryQueryType:ra.B.kpi};return P()(n,l)?n:l}))}),[a,i,e,t]),Object(l.useEffect)((()=>(n?(d(!1),g(null)):j(m),()=>{c.current.unsubscribe(),s.current.abort()})),[n,m,j]),[u,b]})({defaultIndex:n,docValueFields:s,timerange:v,isBlankTimeline:A,filterQuery:null!==(t=null==L?void 0:L.filterQuery)&&void 0!==t?t:""}),R=null!==(a=null===(i=Object(O.h)())||void 0===i?void 0:i.crud)&&void 0!==a&&a;return r.a.createElement(_a,{alignItems:"center",gutterSize:"s"},r.a.createElement(m.EuiFlexItem,null,r.a.createElement(m.EuiFlexGroup,{"data-test-subj":"properties-left",direction:"column",gutterSize:"none"},r.a.createElement(Ha,null,r.a.createElement(Ka,{timelineId:e}),r.a.createElement(ia.a,{timelineId:e,initialFocus:"title"}),r.a.createElement($a,null,r.a.createElement(Ya,{timelineId:e}))),r.a.createElement(Ha,null,r.a.createElement(Va,{timelineId:e}),r.a.createElement(ia.a,{timelineId:e,initialFocus:"description"})))),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(Ja,null,x===D.w.query?r.a.createElement(Fa,{kpis:q,isLoading:z}):null)),r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(m.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(Vt.a,{timelineId:e})),R&&r.a.createElement(m.EuiFlexItem,{grow:!1},r.a.createElement(ta,{timelineId:e})))))};Xa.displayName="FlyoutHeaderComponent";const Za=r.a.memo(Xa),ei=fe()(m.EuiPanel).withConfig({displayName:"DataProvidersPanel",componentId:"sc-oo43db-0"})(["border-radius:0;padding:0 4px 0 4px;user-select:none;z-index:",";"],(({theme:e})=>e.eui.euiZLevel9)),ti=r.a.memo((({activeTab:e,showDataproviders:t,timelineId:a})=>r.a.createElement("div",{className:Ut.e,"data-test-subj":"flyoutBottomBar"},t&&r.a.createElement(za,{timelineId:a}),(t||!t&&e!==D.w.query)&&r.a.createElement(ei,{paddingSize:"none"},r.a.createElement(Kt.a,{timelineId:a,"data-test-subj":"dataProviders-bottomBar"})))));ti.displayName="FlyoutBottomBar";var ai=a(177),ii=a(242),ni=a(290),li=a(687);const ri=Q.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),oi=Q.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),si=Q.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),ci=Q.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),ui=Q.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),di=fe.a.div.attrs((({$isVisible:e=!1})=>({style:{display:e?"flex":"none"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-14igzi1-0"})(["flex:1;overflow:hidden;"]),mi=Object(l.lazy)((()=>Promise.all([a.e(7),a.e(17)]).then(a.bind(null,1357)))),pi=Object(l.lazy)((()=>Promise.all([a.e(7),a.e(18)]).then(a.bind(null,1360)))),bi=Object(l.lazy)((()=>a.e(22).then(a.bind(null,1353)))),gi=Object(l.lazy)((()=>a.e(19).then(a.bind(null,1361)))),vi=Object(l.lazy)((()=>Promise.all([a.e(7),a.e(23)]).then(a.bind(null,1354)))),Ei=Object(l.memo)((({renderCellValue:e,rowRenderers:t,timelineId:a})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(mi,{renderCellValue:e,rowRenderers:t,timelineId:a}))));Ei.displayName="QueryTab";const ji=Object(l.memo)((({renderCellValue:e,rowRenderers:t,timelineId:a})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(pi,{renderCellValue:e,rowRenderers:t,timelineId:a}))));ji.displayName="EqlTab";const hi=Object(l.memo)((({timelineId:e})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(bi,{timelineId:e}))));hi.displayName="GraphTab";const yi=Object(l.memo)((({timelineId:e})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(gi,{timelineId:e}))));yi.displayName="NotesTab";const Oi=Object(l.memo)((({renderCellValue:e,rowRenderers:t,timelineId:a})=>r.a.createElement(l.Suspense,{fallback:r.a.createElement(m.EuiLoadingContent,{lines:10})},r.a.createElement(vi,{renderCellValue:e,rowRenderers:t,timelineId:a}))));Oi.displayName="PinnedTab";const fi=Object(l.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:a,timelineId:i,timelineType:n})=>{const o=Object(l.useCallback)((e=>{switch(e){case D.w.graph:return r.a.createElement(hi,{timelineId:i});case D.w.notes:return r.a.createElement(yi,{timelineId:i});default:return null}}),[i]),s=Object(l.useMemo)((()=>[D.w.graph,D.w.notes].includes(e)),[e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(di,{$isVisible:D.w.query===e,"data-test-subj":`timeline-tab-content-${D.w.query}`},r.a.createElement(Ei,{renderCellValue:t,rowRenderers:a,timelineId:i})),r.a.createElement(di,{$isVisible:D.w.pinned===e,"data-test-subj":`timeline-tab-content-${D.w.pinned}`},r.a.createElement(Oi,{renderCellValue:t,rowRenderers:a,timelineId:i})),n===D.x.default&&r.a.createElement(di,{$isVisible:D.w.eql===e,"data-test-subj":`timeline-tab-content-${D.w.eql}`},r.a.createElement(ji,{renderCellValue:t,rowRenderers:a,timelineId:i})),r.a.createElement(di,{$isVisible:s,"data-test-subj":`timeline-tab-content-${D.w.graph}-${D.w.notes}`},s&&o(e)))}));fi.displayName="ActiveTimelineTab";const wi=fe()(m.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-14igzi1-1"})(["margin-left:",";"],(({theme:e})=>e.eui.paddingSizes.s)),Si=fe()(m.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-14igzi1-2"})([".euiTab__content{display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),Ti=({renderCellValue:e,rowRenderers:t,timelineId:a,timelineFullScreen:i,timelineType:n,graphEventId:o,timelineDescription:s})=>{const c=Object(d.useDispatch)(),u=Object(l.useMemo)((()=>Object(li.a)()),[]),p=Object(l.useMemo)((()=>Object(li.g)()),[]),g=Object(l.useMemo)((()=>Object(li.e)()),[]),v=Object(l.useMemo)((()=>Object(li.d)()),[]),E=Object(l.useMemo)((()=>Object(li.c)()),[]),j=Object(l.useMemo)((()=>Object(li.b)()),[]),h=Object(b.b)((e=>u(e,a))),y=Object(b.b)((e=>p(e,a))),O=Object(b.b)((e=>g(e,a))),f=Object(b.a)((e=>E(e,a))),w=Object(b.a)((e=>j(e,a))),S=Object(b.a)((e=>v(e))),I=Object(l.useMemo)((()=>{const e=Object.values(w).reduce(((e,t)=>[...e,...t]),[]);return[...f,...e]}),[f,w]),x=Object(l.useMemo)((()=>S.filter((e=>I.includes(e.id))).length+(Object(k.isEmpty)(s)?0:1)),[S,I,s]),C=Object(l.useCallback)((()=>{c(T.a.setActiveTabTimeline({id:a,activeTab:D.w.query}))}),[c,a]),M=Object(l.useCallback)((()=>{c(T.a.setActiveTabTimeline({id:a,activeTab:D.w.eql}))}),[c,a]),P=Object(l.useCallback)((()=>{c(T.a.setActiveTabTimeline({id:a,activeTab:D.w.graph}))}),[c,a]),N=Object(l.useCallback)((()=>{c(T.a.setActiveTabTimeline({id:a,activeTab:D.w.notes}))}),[c,a]),F=Object(l.useCallback)((()=>{c(T.a.setActiveTabTimeline({id:a,activeTab:D.w.pinned}))}),[c,a]);return Object(l.useEffect)((()=>{o||h!==D.w.graph||C()}),[h,o,C]),r.a.createElement(r.a.Fragment,null,!i&&r.a.createElement(m.EuiTabs,null,r.a.createElement(Si,{"data-test-subj":`timelineTabs-${D.w.query}`,onClick:C,isSelected:h===D.w.query,disabled:!1,key:D.w.query},r.a.createElement("span",null,ri),y&&r.a.createElement(ma.b,null)),n===D.x.default&&r.a.createElement(Si,{"data-test-subj":`timelineTabs-${D.w.eql}`,onClick:M,isSelected:h===D.w.eql,disabled:!1,key:D.w.eql},r.a.createElement("span",null,oi),y&&r.a.createElement(ma.a,null)),r.a.createElement(m.EuiTab,{"data-test-subj":`timelineTabs-${D.w.graph}`,onClick:P,isSelected:h===D.w.graph,disabled:!o,key:D.w.graph},si),r.a.createElement(Si,{"data-test-subj":`timelineTabs-${D.w.notes}`,onClick:N,isSelected:h===D.w.notes,disabled:!1,key:D.w.notes},r.a.createElement("span",null,ci),y&&x>0&&r.a.createElement("div",null,r.a.createElement(wi,null,x))),r.a.createElement(Si,{"data-test-subj":`timelineTabs-${D.w.pinned}`,onClick:F,isSelected:h===D.w.pinned,key:D.w.pinned},r.a.createElement("span",null,ui),y&&O>0&&r.a.createElement("div",null,r.a.createElement(wi,null,O)))),r.a.createElement(fi,{activeTimelineTab:h,renderCellValue:e,rowRenderers:t,timelineId:a,timelineType:n,timelineDescription:s}))},Ii=Object(l.memo)(Ti);var xi=a(143),ki=a(128),Ci=a(388);const Mi=fe.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-h40gwq-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),Pi=({timelineId:e})=>{const t=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]);return Object(b.b)((a=>{var i;return(null!==(i=t(a,e))&&void 0!==i?i:B.a).isSaving}))?r.a.createElement(m.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},Ni=r.a.memo(Pi),Fi=({renderCellValue:e,rowRenderers:t,timelineId:a})=>{const i=Object(d.useDispatch)(),n=Object(l.useRef)(null),o=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),{selectedPatterns:c}=Object(me.c)(ee.SourcererScopeName.timeline),{graphEventId:u,savedObjectId:p,timelineType:g,description:v}=Object(b.a)((e=>{var t;return Object(k.pick)(["graphEventId","savedObjectId","timelineType","description"],null!==(t=o(e,a))&&void 0!==t?t:B.a)})),{timelineFullScreen:E}=Object(ki.b)();Object(l.useEffect)((()=>{p||i(T.a.createTimeline({id:a,columns:ai.b,indexNames:c,expandedDetail:ii.a.getExpandedDetail(),show:!1}))}),[]);const j=Object(l.useCallback)((()=>{var e;const t=null===(e=n.current)||void 0===e?void 0:e.querySelector(Ci.a);var a,i;null!=t?t.focus():null===(a=n.current)||void 0===a||null===(i=a.querySelector(".globalFilterBar__addButton"))||void 0===i||i.focus()}),[n]),h=Object(l.useCallback)((()=>{var e,t;null===(e=n.current)||void 0===e||null===(t=e.querySelector(`.${Ut.d}`))||void 0===t||t.focus()}),[]),y=Object(l.useCallback)((e=>{Object(z.isTab)(e)&&Object(Ut.l)({containerElement:n.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:j,onSkipFocusAfterEventsTable:h})}),[n,j,h]),f=Object(l.useMemo)((()=>({timelineId:a})),[a]),w=(()=>{const{search:e,pathname:t}=Object(s.useLocation)(),{spaces:a}=Object(O.j)().services,i=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:n,savedObjectId:o,show:c,graphEventId:u,activeTab:d}=Object(b.a)((e=>{var t;return null!==(t=i(e,D.q.active))&&void 0!==t?t:B.a})),p=Object(l.useCallback)((()=>{var i,l,s;if(!a||"conflict"!==(null==n?void 0:n.outcome)||null==(null==n?void 0:n.alias_target_id))return null;const p=new URLSearchParams(e),b=null!==(i=p.get(W.a.timeline))&&void 0!==i?i:void 0,g={id:null!=o?o:"",isOpen:!!c,activeTab:d,graphEventId:u};let v=g;try{var E;v=null!==(E=Object(Y.a)(b))&&void 0!==E?E:g}catch(e){}const j=null===(l=v)||void 0===l?void 0:l.id,h=null!==(s=null==n?void 0:n.alias_target_id)&&void 0!==s?s:"",y={...v,id:h},O=Object(Y.b)(y);p.set(W.a.timeline,O);const f=`${t}?${p.toString()}${window.location.hash}`;return r.a.createElement(r.a.Fragment,null,a.ui.components.getLegacyUrlConflict({objectNoun:W.a.timeline,currentObjectId:j,otherObjectId:h,otherObjectPath:f}),r.a.createElement(m.EuiSpacer,null))}),[d,u,t,null==n?void 0:n.alias_target_id,null==n?void 0:n.outcome,o,e,c,a]);return Object(l.useMemo)((()=>p()),[p])})();return r.a.createElement(z.TimelineContext.Provider,{value:f},r.a.createElement(xi.B,{"data-test-subj":"timeline","data-timeline-id":a,onKeyDown:y,ref:n},r.a.createElement(Ni,{timelineId:a}),g===D.x.template&&r.a.createElement(Mi,null,ni.e),w,r.a.createElement(xi.y,{$isVisible:!E,"data-test-subj":"timeline-hide-show-container"},r.a.createElement(za,{timelineId:a}),r.a.createElement(Za,{timelineId:a})),r.a.createElement(Ii,{graphEventId:u,renderCellValue:e,rowRenderers:t,timelineId:a,timelineType:g,timelineDescription:v,timelineFullScreen:E})))};Fi.displayName="StatefulTimelineComponent";const Li=r.a.memo(Fi),Di=Q.i18n.translate("xpack.securitySolution.timeline.flyout.pane.timelinePropertiesAriaLabel",{defaultMessage:"Timeline Properties"});var Ai=a(352),Bi=a(416);const zi=fe()(m.EuiFlyout).withConfig({displayName:"StyledEuiFlyout",componentId:"sc-jz8ju6-0"})(["animation:none;min-width:150px;z-index:",";"],(({theme:e})=>e.eui.euiZLevel4)),qi=({timelineId:e,visible:t=!0})=>{const a=Object(d.useDispatch)(),i=Object(l.useCallback)((()=>{a(T.a.showTimeline({id:e,show:!1})),Object(Ut.j)()}),[a,e]);return r.a.createElement("div",{"data-test-subj":"flyout-pane",style:{visibility:t?"visible":"hidden"}},r.a.createElement(zi,{"aria-label":Di,className:"timeline-flyout","data-test-subj":"eui-flyout",hideCloseButton:!0,onClose:i,size:"100%",ownFocus:!1,style:{visibility:t?"visible":"hidden"}},r.a.createElement(Li,{renderCellValue:Bi.a,rowRenderers:Ai.b,timelineId:e})))},Ri=r.a.memo(qi);Ri.displayName="Pane";const _i=({timelineId:e,onAppLeave:t})=>{const a=Object(d.useDispatch)(),i=Object(l.useMemo)((()=>Dt()),[]),{activeTab:n,show:o,status:s,updated:c}=Object(b.a)((t=>i(t,e))),[u,p]=Object(l.useState)(!0),[g,v]=Object(l.useState)(!0),E=Object(l.useRef)(null),j=Object(l.useRef)(null),h=Object(l.useCallback)((()=>{o&&!1===u&&p(!0)}),[o,u]),y=Object(l.useCallback)((e=>{p(!1);e.target.classList.contains("kbnSearchBar")&&(j.current=e.target,v((e=>!e)),window.setTimeout((()=>{null!==j.current&&j.current.focus()}),0))}),[]);return Object(l.useEffect)((()=>(null!=j.current&&(null!==E.current&&j.current.removeEventListener("blur",E.current),j.current.addEventListener("blur",h),E.current=h),()=>{null!=j.current&&null!==E.current&&j.current.removeEventListener("blur",E.current)})),[h,g]),Object(l.useEffect)((()=>{t(((e,t)=>{if(o&&a(T.a.showTimeline({id:D.q.active,show:!1})),(null!=t?t:"").includes("securitySolution")||s!==D.u.draft||null==c)return e.default();{const t=()=>{a(T.a.showTimeline({id:D.q.active,show:!0})),a(T.a.setActiveTabTimeline({id:D.q.active,activeTab:D.w.query})),a(T.a.toggleModalSaveTimeline({id:D.q.active,showModalSaveTimeline:!0}))};return e.confirm(Q.i18n.translate("xpack.securitySolution.timeline.unsavedWorkMessage",{defaultMessage:"Leave Timeline with unsaved work?"}),Q.i18n.translate("xpack.securitySolution.timeline.unsavedWorkTitle",{defaultMessage:"Unsaved changes"}),t)}}))}),[a,t,o,s,c]),r.a.createElement(m.EuiOutsideClickDetector,{onOutsideClick:y},r.a.createElement(r.a.Fragment,null,r.a.createElement(m.EuiFocusTrap,{disabled:!u},r.a.createElement(Ri,{timelineId:e,visible:o})),r.a.createElement(ti,{activeTab:n,timelineId:e,showDataproviders:!o})))};_i.displayName="FlyoutComponent";const $i=r.a.memo(_i);$i.displayName="Flyout";const Ji="timeline-bottom-bar",Hi=r.a.memo((({onAppLeave:e})=>{const{pathname:t}=Object(s.useLocation)(),[a]=Rt(),{indicesExist:i}=Object(me.c)(Object(me.a)(t));return(()=>{const{search:e,pathname:t}=Object(s.useLocation)(),[a,i]=Object(l.useState)(!1),{spaces:n}=Object(O.j)().services,r=Object(l.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:c,show:u,activeTab:d,graphEventId:m}=Object(b.a)((e=>{var t;return null!==(t=r(e,D.q.active))&&void 0!==t?t:B.a})),p=Object(l.useCallback)((()=>{var l,r;const s=new URLSearchParams(e),p=null!==(l=s.get(W.a.timeline))&&void 0!==l?l:void 0,b={id:null!=c?c:"",isOpen:!!u,activeTab:d,graphEventId:m};let g=b;try{var v;g=null!==(v=Object(Y.a)(p))&&void 0!==v?v:b}catch(e){}if(a||!n||"aliasMatch"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id))return null;const E=null!==(r=null==o?void 0:o.alias_target_id)&&void 0!==r?r:"",j={...g,id:E},h=Object(Y.b)(j);s.set(W.a.timeline,h);const y=`${t}?${s.toString()}`;n.ui.redirectLegacyUrl(y,W.a.timeline),i(!0)}),[d,m,a,t,null==o?void 0:o.outcome,null==o?void 0:o.alias_target_id,c,e,u,n]);Object(l.useEffect)((()=>{p()}),[p])})(),i&&a?r.a.createElement(r.a.Fragment,null,r.a.createElement(Gt,null),r.a.createElement($i,{timelineId:D.q.active,onAppLeave:e})):null})),Qi={className:Ji,"data-test-subj":"timeline-bottom-bar-container",position:"fixed",usePortal:!1};var Gi=a(260);const Ki=()=>{const[{pageName:e}]=Object(U.a)(),{indicesExist:t}=Object(me.c)(),a=(i=e,[Xt.a.hosts,Xt.a.network,Xt.a.timelines,Xt.a.overview].includes(i)&&!t);var i;const[n,r]=Object(l.useState)(a);return Object(l.useEffect)((()=>{r(!!a)}),[a]),n},Ui=fe()(Ee.KibanaPageTemplate).withConfig({displayName:"StyledKibanaPageTemplate",componentId:"sc-1xdm1q0-0"})([".","{animation:'none !important';background:",";color:inherit;transform:",";."," &{transform:none;}}",""],Ji,(({theme:e})=>e.eui.euiColorEmptyShade),(({$isShowingTimelineOverlay:e})=>e?"none":"translateY(calc(100% - 50px))"),N.d,(({$isTimelineBottomBarVisible:e})=>e&&`\n    @media (min-width: 768px) {\n      .kbnPageTemplateSolutionNav {\n        padding-bottom: ${Gi.d};\n      }\n    }\n  `)),Vi=r.a.memo((({children:e,onAppLeave:t})=>{const a=Ft(),[i]=Rt(),o=Object(l.useMemo)((()=>Dt()),[]),{show:s}=Object(b.a)((e=>o(e,D.q.active))),c=Ki(),u=c?Ee.NO_DATA_PAGE_TEMPLATE_PROPS:{};return r.a.createElement(Ui,n()({$isTimelineBottomBarVisible:i,$isShowingTimelineOverlay:s,bottomBarProps:Qi,bottomBar:r.a.createElement(Hi,{onAppLeave:t}),paddingSize:"none",solutionNav:a,restrictWidth:!1,template:"default"},u),c?e:r.a.createElement(r.a.Fragment,null,r.a.createElement(zt,null),r.a.createElement(m.EuiPanel,{className:"securityPageWrapper","data-test-subj":"pageContainer",hasShadow:!1,paddingSize:"l"},e)))})),Wi=({children:e,onAppLeave:t,setHeaderActionMenu:a})=>{const{pathname:i}=Object(s.useLocation)();Object(me.b)(Object(me.a)(i));const{browserFields:n,indexPattern:l}=Object(me.c)(Object(me.a)(i));return ge(),r.a.createElement(H.g,{className:"kbnAppWrapper"},r.a.createElement(Tt,{setHeaderActionMenu:a}),r.a.createElement(_,{browserFields:n},r.a.createElement(ue,{indexPattern:l,navTabs:de.a}),r.a.createElement(Vi,{onAppLeave:t},e)),r.a.createElement(K,null))};Wi.displayName="HomePage";const Yi=r.a.memo(Wi),Xi=({children:e,history:t,onAppLeave:a,setHeaderActionMenu:i})=>{const n=Object(d.useDispatch)();return Object(l.useEffect)((()=>()=>{n({type:"userChangedUrl",payload:{pathname:"",search:"",hash:""}})}),[n]),r.a.createElement(S,null,r.a.createElement(s.Router,{history:t},r.a.createElement(x,null,r.a.createElement(s.Switch,null,r.a.createElement(s.Route,{path:"/"},r.a.createElement(Yi,{onAppLeave:a,setHeaderActionMenu:i},e)),r.a.createElement(s.Route,null,r.a.createElement(u.a,null))))))},Zi=Object(l.memo)(Xi);var en=a(82);const tn=({children:e,history:t,setHeaderActionMenu:a,onAppLeave:i,store:n})=>{const{i18n:l,application:{capabilities:o}}=Object(O.j)().services,[s]=Object(O.o)(c.B);return r.a.createElement(m.EuiErrorBoundary,null,r.a.createElement(l.Context,null,r.a.createElement(E.b,null,r.a.createElement(d.Provider,{store:n},r.a.createElement(en.EuiThemeProvider,{darkMode:s},r.a.createElement(y.b,null,r.a.createElement(be.a,{kibanaCapabilities:o},r.a.createElement(p.a,null,r.a.createElement(Zi,{history:t,onAppLeave:i,setHeaderActionMenu:a},e))))),r.a.createElement(h,null),r.a.createElement(E.a,null)))))},an=Object(l.memo)(tn),nn=({children:e,history:t,onAppLeave:a,services:i,setHeaderActionMenu:n,store:l})=>r.a.createElement(O.a,{services:{appName:c.n,...i}},r.a.createElement(an,{history:t,onAppLeave:a,setHeaderActionMenu:n,store:l},e)),ln=Object(l.memo)(nn),rn=({element:e,history:t,onAppLeave:a,setHeaderActionMenu:i,services:l,store:d,usageCollection:m,subPlugins:p})=>{var b;const g=null!==(b=null==m?void 0:m.components.ApplicationUsageTrackingProvider)&&void 0!==b?b:r.a.Fragment;return Object(o.render)(r.a.createElement(ln,{history:t,onAppLeave:a,services:l,setHeaderActionMenu:i,store:d},r.a.createElement(g,null,r.a.createElement(s.Switch,null,[...p.overview.routes,...p.alerts.routes,...p.rules.routes,...p.exceptions.routes,...p.hosts.routes,...p.network.routes,...null!=p.ueba?p.ueba.routes:[],...p.timelines.routes,...p.cases.routes,...p.management.routes].map(((e,t)=>r.a.createElement(s.Route,n()({key:`route-${t}`},e)))),r.a.createElement(s.Route,{path:"",exact:!0},r.a.createElement(s.Redirect,{to:c.Db})),r.a.createElement(s.Route,null,r.a.createElement(u.a,null))))),e),()=>Object(o.unmountComponentAtNode)(e)}},387:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d}));var i=a(9),n=a.n(i),l=a(216);const r=Object(l.c)(),o=Object(l.c)(),s=()=>{const[e]=Object(i.useState)(r);return{portalNode:e}},c=n.a.memo((()=>{const{portalNode:e}=s();return n.a.createElement(l.b,{node:e})}));c.displayName="TimelineEventsCountBadge";const u=()=>{const[e]=Object(i.useState)(o);return{portalNode:e}},d=n.a.memo((()=>{const{portalNode:e}=u();return n.a.createElement(l.b,{node:e})}));d.displayName="EqlEventsCountBadge"},388:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return m}));var i=a(55),n=a(9),l=a.n(n),r=a(56),o=a.n(r),s=a(468);const c="exit-full-screen",u=o()(i.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-4dkrmi-0"})(["margin:",";"],(({theme:e})=>e.eui.paddingSizes.s)),d=({fullScreen:e,setFullScreen:t})=>{const a=Object(n.useCallback)((()=>{t(!1)}),[t]),r=Object(n.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),a())}),[a]);return e?l.a.createElement(l.a.Fragment,null,l.a.createElement(i.EuiWindowEvent,{event:"keydown",handler:r}),l.a.createElement(u,{className:c,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",isDisabled:!e,onClick:a},s.a)):null};d.displayName="ExitFullScreenComponent";const m=l.a.memo(d)},687:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"e",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return m})),a.d(t,"f",(function(){return p}));var i=a(112),n=a(20),l=a(423),r=a(315);const o=()=>Object(i.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:n.w.query})),s=()=>Object(i.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),c=()=>Object(i.createSelector)(r.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),u=()=>Object(i.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(i.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),m=()=>Object(i.createSelector)(l.selectNotesById,(e=>Object.values(e))),p=()=>Object(i.createSelector)(r.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},763:function(e,t,a){"use strict";a.d(t,"a",(function(){return ae}));var i=a(202),n=a(9),l=a.n(n),r=a(56),o=a.n(r),s=a(24),c=a.n(s),u=a(98),d=a(104),m=a(109),p=a(93),b=a(96),g=a.n(b),v=a(73);const E=o.a.div.withConfig({displayName:"ReactDndDropTarget",componentId:"sc-zu5fvf-0"})(["transition:background-color 0.7s ease;width:100%;height:",";.flyout-overlay{.euiPanel{background-color:",";}}"," > div.timeline-drop-area{.drop-and-provider-timeline{display:none;}& + div{display:none !important;}}"],(({height:e})=>e),(e=>e.theme.eui.euiFormBackgroundColor),(e=>e.isDraggingOver?`\n    .drop-and-provider-timeline {\n      &:hover {\n        background-color: ${Object(i.rgba)(e.theme.eui.euiColorSuccess,.3)};\n      }\n    }\n    .drop-and-provider-timeline:hover {\n        background-color: ${Object(i.rgba)(e.theme.eui.euiColorSuccess,.3)};\n    }\n  > div.timeline-drop-area-empty {\n     color: ${e.theme.eui.euiColorSuccess};\n     background-color: ${Object(i.rgba)(e.theme.eui.euiColorSuccess,.2)};\n\n     & .euiTextColor--subdued {\n      color: ${e.theme.eui.euiColorSuccess};\n     }\n  }\n  > div.timeline-drop-area {\n    background-color: ${Object(i.rgba)(e.theme.eui.euiColorSuccess,.2)};\n    .provider-item-filter-container div:first-child{\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      transform: none !important;\n    }\n    .drop-and-provider-timeline {\n      display: block !important;\n      + div {\n        display: none;\n      }\n    }\n\n    & .euiFormHelpText {\n      color: ${e.theme.eui.euiColorSuccess};\n    }\n  }\n  .flyout-overlay {\n    .euiPanel {\n      background-color: ${e.theme.eui.euiColorLightShade};\n    }\n    + div {\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      display: none !important;\n    }\n  }\n  `:""));E.displayName="ReactDndDropTarget";const j=l.a.memo((({children:e=null,droppableId:t,height:a="100%",isDropDisabled:i=!1,type:r,render:o=null,renderClone:s})=>{const c=Object(n.useCallback)(((t,i)=>l.a.createElement(E,g()({height:a,ref:t.innerRef},t.droppableProps,{isDraggingOver:i.isDraggingOver}),null==o?e:o({isDraggingOver:i.isDraggingOver}),t.placeholder)),[e,a,o]);return l.a.createElement(v.Droppable,{isDropDisabled:i,droppableId:t,direction:"horizontal",type:r,renderClone:s},c)}));j.displayName="DroppableWrapper";var h=a(108),y=a(55),O=a(255),f=a(19),w=a(91),S=a(20),T=a(617),I=a(319),x=a(113),k=a(94),C=a(293);const M=({browserFields:e,timelineId:t})=>{const a=Object(w.useDispatch)(),[i,r]=Object(n.useState)(!1),o=Object(n.useMemo)((()=>k.b.getTimelineByIdSelector()),[]),{dataProviders:s,timelineType:u}=Object(p.a)((e=>Object(f.pick)(["dataProviders","timelineType"],o(e,t)))),d=Object(n.useCallback)((()=>r(!0)),[r]),m=Object(n.useCallback)((()=>r(!1)),[r]),b=Object(n.useCallback)((({andProviderId:e,excluded:i,field:n,id:l,operator:r,providerId:o,value:c,type:u})=>{Object(I.b)({dataProviders:s,destination:{droppableId:`droppableId.timelineProviders.${t}.group.${s.length}`,index:0},dispatch:a,onAddedToTimeline:m,providerToAdd:{id:o,name:c,enabled:!0,excluded:i,kqlQuery:"",type:u,queryMatch:{displayField:void 0,displayValue:void 0,field:n,value:c,operator:r},and:[]},timelineId:t})}),[s,t,a,m]),g=Object(n.useMemo)((()=>[{id:0,width:400,items:[{name:C.a,icon:l.a.createElement(y.EuiIcon,{type:"plusInCircle",size:"m"}),panel:1},u===S.x.template?{disabled:u!==S.x.template,name:C.b,icon:l.a.createElement(y.EuiIcon,{type:"visText",size:"m"}),panel:2}:null].filter((e=>null!==e))},{id:1,title:C.a,width:400,content:l.a.createElement(T.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:b,operator:":",timelineId:t,value:"",type:x.a.default,providerId:`${t}-${c.a.v4()}`})},{id:2,title:C.b,width:400,content:l.a.createElement(T.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:b,operator:":",timelineId:t,value:"",type:x.a.template,providerId:`${t}-${c.a.v4()}`})}]),[e,b,t,u]),v=Object(n.useMemo)((()=>u===S.x.template?l.a.createElement(y.EuiButton,{size:"s",onClick:d,"data-test-subj":"addField",iconType:"arrowDown",fill:!0,iconSide:"right"},l.a.createElement(y.EuiText,{size:"s"},C.a)):l.a.createElement(y.EuiButtonEmpty,{size:"s",onClick:d,"data-test-subj":"addField",iconSide:"right"},l.a.createElement(y.EuiText,{size:"s"},`+ ${C.a}`))),[d,u]),E=Object(n.useMemo)((()=>u===S.x.template?l.a.createElement(y.EuiContextMenu,{initialPanelId:0,panels:g}):l.a.createElement(T.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:b,operator:":",timelineId:t,value:"",type:x.a.default,providerId:`${t}-${c.a.v4()}`})),[e,b,g,t,u]);return l.a.createElement(y.EuiPopover,{id:"addFieldsPopover",button:v,isOpen:i,closePopover:m,anchorPosition:"downLeft",panelPaddingSize:"none",repositionOnScroll:!0},E)};M.displayName="AddDataProviderPopoverComponent";const P=l.a.memo(M);P.displayName="AddDataProviderPopover";const N=o()(y.EuiText).withConfig({displayName:"Text",componentId:"sc-1dcwhn2-0"})(["overflow:hidden;margin:5px 0 5px 0;padding:3px;white-space:nowrap;"]);N.displayName="Text";const F=o()(y.EuiBadge).withConfig({displayName:"BadgeHighlighted",componentId:"sc-1dcwhn2-1"})(["height:20px;margin:0 5px 0 5px;maxwidth:85px;minwidth:85px;"]);F.displayName="BadgeHighlighted";const L=o.a.span.withConfig({displayName:"HighlightedBackground",componentId:"sc-1dcwhn2-2"})(["background-color:",";"],(e=>e.theme.eui.euiColorLightShade));L.displayName="HighlightedBackground";const D=o.a.div.withConfig({displayName:"EmptyContainer",componentId:"sc-1dcwhn2-3"})(["width:",";align-items:center;display:flex;flex-direction:column;flex-wrap:wrap;justify-content:center;user-select:none;align-content:center;",""],(e=>e.showSmallMsg?"60px":"auto"),(e=>e.showSmallMsg?`\n      border-right: 1px solid ${e.theme.eui.euiColorMediumShade};\n      margin-right: 10px;\n    `:"\n  min-height: 100px;\n  + div {\n    display: none !important;\n   }\n  "));D.displayName="EmptyContainer";const A=o.a.div.withConfig({displayName:"NoWrap",componentId:"sc-1dcwhn2-4"})(["align-items:center;display:flex;flex-direction:row;flex-wrap:no-wrap;"]);A.displayName="NoWrap";const B=l.a.memo((({showSmallMsg:e=!1,browserFields:t,timelineId:a})=>l.a.createElement(D,{className:"timeline-drop-area-empty","data-test-subj":"empty",showSmallMsg:e},!e&&l.a.createElement(l.a.Fragment,null,l.a.createElement(A,null,l.a.createElement(N,{color:"subdued",size:"s"},C.f),l.a.createElement(L,null,l.a.createElement(F,{className:"highlighted-drop-target"},C.n)),l.a.createElement(N,{color:"subdued",size:"s"},C.m),l.a.createElement(O.a,{type:"or"}),l.a.createElement(N,{color:"subdued",size:"s"},C.q)),l.a.createElement(P,{browserFields:t,timelineId:a})),e&&l.a.createElement(O.a,{type:"or"}))));B.displayName="Empty";var z=a(95),q=a.n(z),R=a(777),_=a(90);const $={alignItems:"center",display:"flex",height:"36px",minWidth:"125px"},J=o.a.div.withConfig({displayName:"DroppableContainer",componentId:"sc-cfhrc0-0"})(["min-height:","px;height:auto !important;."," &:hover{background-color:"," !important;}"],36,u.d,(({theme:e})=>Object(i.rgba)(e.eui.euiColorSuccess,.2))),H=o.a.span.withConfig({displayName:"Parens",componentId:"sc-cfhrc0-1"})(["color:",";font-size:32px;padding:2px;user-select:none;"],(({theme:e})=>e.eui.euiColorMediumShade)),Q=o.a.div.withConfig({displayName:"AndOrBadgeContainer",componentId:"sc-cfhrc0-2"})(["span{visibility:",";}"],(({hideBadge:e})=>e?"hidden":"inherit")),G=o.a.div.withConfig({displayName:"LastAndOrBadgeInGroup",componentId:"sc-cfhrc0-3"})(["display:none;."," &{display:initial;}"],u.d),K=o()(y.EuiFlexItem).withConfig({displayName:"OrFlexItem",componentId:"sc-cfhrc0-4"})(["padding-left:9px;"]);o()(y.EuiFormHelpText).withConfig({displayName:"TimelineEuiFormHelpText",componentId:"sc-cfhrc0-5"})(["padding-top:0px;position:absolute;bottom:0px;left:4px;"]).displayName="TimelineEuiFormHelpText";const U=o()(y.EuiFlexItem).withConfig({displayName:"ParensContainer",componentId:"sc-cfhrc0-6"})(["align-self:center;"]),V=e=>{var t;return null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value},W=l.a.memo((({browserFields:e,timelineId:t,dataProviders:a})=>{const i=Object(n.useMemo)((()=>[...Object(I.c)(a),...I.a]),[a]),r=Object(n.useMemo)((()=>i.map(((n,r)=>l.a.createElement(X,{key:`droppable-${r}`,group:n,groupIndex:r,isLastGroup:r===i.length-1,browserFields:e,timelineId:t,dataProviders:a})))),[e,i,a,t]);return l.a.createElement("div",null,r)}));W.displayName="Providers";const Y=l.a.memo((({browserFields:e,group:t,groupIndex:a,dataProvider:i,index:r,timelineId:o})=>{const s=Object(n.useRef)(null),[c,d]=Object(n.useState)(!1),[,m]=Object(n.useState)(!1),p=Object(w.useDispatch)(),{timelines:b}=Object(_.j)().services,E=Object(n.useCallback)((()=>{m((e=>!e))}),[]),j=Object(n.useMemo)((()=>Object(h.m)({dataProviderId:i.id,groupIndex:a,timelineId:o})),[i.id,a,o]),f=Object(n.useCallback)((()=>{const e={id:o,providerId:r>0?t[0].id:i.id,andProviderId:r>0?i.id:void 0};p(k.a.removeProvider(e))}),[i.id,p,t,r,o]),S=Object(n.useCallback)((()=>{const e={id:o,providerId:r>0?t[0].id:i.id,enabled:!i.enabled,andProviderId:r>0?i.id:void 0};p(k.a.updateDataProviderEnabled(e))}),[i.enabled,i.id,p,t,r,o]),T=Object(n.useCallback)((()=>{const e={id:o,providerId:r>0?t[0].id:i.id,excluded:!i.excluded,andProviderId:r>0?i.id:void 0};p(k.a.updateDataProviderExcluded(e))}),[i.excluded,i.id,p,t,r,o]),I=Object(n.useCallback)((()=>{const e={id:o,providerId:r>0?t[0].id:i.id,type:i.type===x.a.template?x.a.default:x.a.template,andProviderId:r>0?i.id:void 0};p(k.a.updateDataProviderType(e))}),[i.id,i.type,p,t,r,o]),C=Object(n.useCallback)((({andProviderId:e,excluded:t,field:a,operator:i,providerId:n,value:l})=>p(k.a.dataProviderEdited({andProviderId:e,excluded:t,field:a,id:o,operator:i,providerId:n,value:l}))),[p,o]),M=Object(n.useCallback)((()=>{var e;null===(e=s.current)||void 0===e||e.focus()}),[]),P=Object(n.useCallback)((()=>{d(!0)}),[]),{onBlur:N,onKeyDown:F}=b.getUseDraggableKeyboardWrapper()({closePopover:E,draggableId:j,fieldName:i.queryMatch.field,keyboardHandlerRef:s,openPopover:P}),L=Object(n.useCallback)((e=>{s.current===document.activeElement&&F(e)}),[F]),D=Object(n.useCallback)(((a,n)=>{var u,m,p,b,v;return l.a.createElement("div",g()({ref:a.innerRef},a.draggableProps,a.dragHandleProps,{style:(v=a.draggableProps.style,{...v,userSelect:"none"}),"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(y.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},l.a.createElement(y.EuiFlexItem,{grow:!1},l.a.createElement(R.a,{andProviderId:r>0?i.id:void 0,browserFields:e,deleteProvider:f,field:r>0?null!==(u=i.queryMatch.displayField)&&void 0!==u?u:i.queryMatch.field:null!==(m=t[0].queryMatch.displayField)&&void 0!==m?m:t[0].queryMatch.field,kqlQuery:r>0?i.kqlQuery:t[0].kqlQuery,isEnabled:r>0?i.enabled:t[0].enabled,isExcluded:r>0?i.excluded:t[0].excluded,isPopoverOpen:c,onDataProviderEdited:C,operator:r>0?null!==(p=i.queryMatch.operator)&&void 0!==p?p:x.c:null!==(b=t[0].queryMatch.operator)&&void 0!==b?b:x.c,register:i,providerId:r>0?t[0].id:i.id,timelineId:o,setIsPopoverOpen:d,toggleEnabledProvider:S,toggleExcludedProvider:T,toggleTypeProvider:I,val:V(i),type:i.type,wrapperRef:s})),l.a.createElement(y.EuiFlexItem,{grow:!1},!n.isDragging&&(r<t.length-1?l.a.createElement(O.a,{type:"and"}):l.a.createElement(G,null,l.a.createElement(O.a,{type:"and"}))))))}),[e,i,t,C,f,S,T,I,r,c,s,d,o]);return l.a.createElement("div",{className:u.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:M,onBlur:N,onKeyDown:L,ref:s,role:"button",tabIndex:0},l.a.createElement(v.Draggable,{disableInteractiveElementBlocking:!0,draggableId:j,index:r,key:i.id},D))}),((e,t)=>e.groupIndex===t.groupIndex&&e.index===t.index&&e.timelineId===t.timelineId&&q()(e.browserFields,t.browserFields)&&q()(e.group,t.group)&&q()(e.dataProvider,t.dataProvider)));Y.displayName="DataProvidersGroupItem";const X=l.a.memo((({browserFields:e,timelineId:t,group:a,groupIndex:i,isLastGroup:r})=>{const o=Object(n.useMemo)((()=>Object(h.n)({groupIndex:i,timelineId:t})),[i,t]),s=Object(n.useMemo)((()=>a.map(((n,r)=>l.a.createElement(Y,{key:n.id,browserFields:e,dataProvider:n,index:r,timelineId:t,group:a,groupIndex:i})))),[e,a,i,t]),c=Object(n.useCallback)((e=>l.a.createElement(J,g()({className:r?"empty-providers-group":"",ref:e.innerRef,style:$},e.droppableProps),s,e.placeholder)),[s,r]);return l.a.createElement(l.a.Fragment,null,0!==i&&l.a.createElement(y.EuiSpacer,{size:"xs"}),l.a.createElement(y.EuiFlexGroup,{"aria-label":C.l(i),alignItems:"center",gutterSize:"none"},l.a.createElement(K,{grow:!1},l.a.createElement(Q,{hideBadge:0===i},l.a.createElement(O.a,{type:"or"}))),l.a.createElement(U,{grow:!1},l.a.createElement(H,null,"(")),l.a.createElement(y.EuiFlexItem,{grow:!1},l.a.createElement(v.Droppable,{droppableId:o,direction:"horizontal"},c)),l.a.createElement(U,{grow:!1},l.a.createElement(H,null,")")),r&&l.a.createElement(P,{browserFields:e,timelineId:t})))}));X.displayName="DataProvidersGroup";var Z=a(105);const ee=o.a.div.withConfig({displayName:"DropTargetDataProvidersContainer",componentId:"sc-rnh8sd-0"})(["padding:2px 0 4px 0;."," & .drop-target-data-providers{background:",";border:0.2rem dashed ",";& .euiTextColor--subdued{color:",";}& .euiFormHelpText{color:",";}}"],u.d,(({theme:e})=>Object(i.rgba)(e.eui.euiColorSuccess,.1)),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess)),te=o.a.div.withConfig({displayName:"DropTargetDataProviders",componentId:"sc-rnh8sd-1"})(["display:flex;flex-direction:column;justify-content:flex-start;padding-bottom:2px;position:relative;border:0.2rem dashed ",";border-radius:5px;padding:"," 0;margin:2px 0 2px 0;max-height:33vh;min-height:100px;overflow:auto;resize:vertical;background-color:",";"],(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiFormBackgroundColor));te.displayName="DropTargetDataProviders";const ae=l.a.memo((({timelineId:e})=>{const{browserFields:t}=Object(m.c)(d.SourcererScopeName.timeline),a=Object(n.useMemo)((()=>k.b.getManageTimelineById()),[]),{isLoading:i}=Object(p.a)((t=>a(t,e))),r=Object(n.useMemo)((()=>k.b.getTimelineByIdSelector()),[]),o=Object(p.a)((t=>{var a;return(null!==(a=r(t,e))&&void 0!==a?a:Z.a).dataProviders})),s=Object(n.useMemo)((()=>{return t=e,`${h.g}${t}${c.a.v4()}`;var t}),[e]);return l.a.createElement(ee,{"aria-label":C.r,className:"drop-target-data-providers-container"},l.a.createElement(te,{className:"drop-target-data-providers","data-test-subj":"dataProviders"},null!=o&&o.length?l.a.createElement(W,{browserFields:t,timelineId:e,dataProviders:o}):l.a.createElement(j,{isDropDisabled:i,droppableId:s},l.a.createElement(B,{browserFields:t,timelineId:e}))))}));ae.displayName="DataProviders"}}]);