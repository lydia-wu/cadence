/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[3],{104:function(e,t,n){"use strict";n.r(t),n.d(t,"SourcererScopeName",(function(){return i})),n.d(t,"initSourcererScope",(function(){return o})),n.d(t,"initialSourcererState",(function(){return a}));var r=n(40);let i;!function(e){e.default="default",e.detections="detections",e.timeline="timeline"}(i||(i={}));const o={browserFields:r.a,docValueFields:r.b,errorMessage:null,indexPattern:r.c,indicesExist:!0,loading:!1,selectedPatterns:[]},a={kibanaIndexPatterns:[],configIndexPatterns:[],signalIndexName:null,sourcererScopes:{[i.default]:{...o,id:i.default},[i.detections]:{...o,id:i.detections},[i.timeline]:{...o,id:i.timeline}}}},105:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(20),i=n(177),o=n(362);const{from:a,to:u}=Object(o.a)({from:"",to:""},!1),c={activeTab:r.w.query,prevActiveTab:r.w.query,columns:i.b,documentType:"",defaultColumns:i.b,dataProviders:[],dateRange:{start:a,end:u},deletedEventIds:[],description:"",eqlOptions:{eventCategoryField:"event.category",tiebreakerField:"",timestampField:"@timestamp",query:"",size:100},eventType:"all",eventIdToNoteIds:{},excludedRowRendererIds:[],expandedDetail:{},highlightedDropAndProviderId:"",historyIds:[],filters:[],indexNames:[],isFavorite:!1,isLive:!1,isSelectAllChecked:!1,isLoading:!1,isSaving:!1,itemsPerPage:25,itemsPerPageOptions:[10,25,50,100],kqlMode:"filter",kqlQuery:{filterQuery:null},loadingEventIds:[],resolveTimelineConfig:void 0,queryFields:[],title:"",timelineType:r.x.default,templateTimelineId:null,templateTimelineVersion:null,noteIds:[],pinnedEventIds:{},pinnedEventsSaveObject:{},savedObjectId:null,selectAll:!1,selectedEventIds:{},show:!1,showCheckboxes:!1,sort:[{columnId:"@timestamp",columnType:"number",sortDirection:"desc"}],status:r.u.draft,version:null}},110:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s.a})),n.d(t,"d",(function(){return s.b})),n.d(t,"e",(function(){return s.c})),n.d(t,"f",(function(){return s.d})),n.d(t,"c",(function(){return H})),n.d(t,"g",(function(){return z}));var r=n(164),i=n(233),o=n(156),a=n(135),u=n(209);const c=(e,{kibanaIndexPatterns:t,configIndexPatterns:n,signalIndexName:u,enableExperimental:c})=>({...e,app:{...r.d,enableExperimental:c},dragAndDrop:i.d,inputs:Object(o.a)(),sourcerer:{...a.b.initialSourcererState,sourcererScopes:{...a.b.initialSourcererState.sourcererScopes,default:{...a.b.initialSourcererState.sourcererScopes.default,indicesExist:n.length>0}},kibanaIndexPatterns:t,configIndexPatterns:n,signalIndexName:u}});var s=n(314),l=n(569),d=n(33),f=n(94),p=n(19),m=n(15),v=n(231),h=n(25),b=n(59),g=n(20),y=n(239),O=n(212),I=n(360),j=n(361),E=n(14),T=n(7),S=n.n(T);const w=new class manage_timeline_id_ManageEpicTimelineId{constructor(){S()(this,"timelineId",null),S()(this,"version",null),S()(this,"templateTimelineId",null),S()(this,"templateVersion",null)}getTimelineId(){return this.timelineId}getTimelineVersion(){return this.version}getTemplateTimelineId(){return this.templateTimelineId}getTemplateTimelineVersion(){return this.templateVersion}setTimelineId(e){this.timelineId=e}setTimelineVersion(e){this.version=e}setTemplateTimelineId(e){this.templateTimelineId=e}setTemplateTimelineVersion(e){this.templateVersion=e}},x=new m.Subject;var _=n(3),R=n(90);const N=[E.addNote.type,E.addNoteToEvent.type],P=(e,t,n,r,i,o,a)=>Object(m.from)((async({note:e,noteId:t,version:n,overrideOwner:r})=>{let i;try{i=JSON.stringify({noteId:t,version:n,note:e,overrideOwner:r})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return await R.b.get().http.patch(_.yb,{method:"PATCH",body:i})})({noteId:null,version:null,note:{eventId:e.payload.eventId,note:A(e.payload.noteId,n),timelineId:w.getTimelineId()}})).pipe(Object(h.withLatestFrom)(i,o,a),Object(h.mergeMap)((([t,n,r,i])=>{const o=e.payload.noteId,a=Object(p.get)("data.persistNote",t),u=403===a.code?[Object(E.showCallOutUnauthorizedMsg)()]:[];return null!=i.refetch&&i.refetch(),[...u,null==n[e.payload.id].savedObjectId?Object(E.updateTimeline)({id:e.payload.id,timeline:{...n[e.payload.id],savedObjectId:a.note.timelineId||null,version:a.note.timelineVersion||null}}):null,Object(y.updateNote)({note:{...r[o],created:null!=a.note.updated?new Date(a.note.updated):r[o].created,user:null!=a.note.updatedBy?a.note.updatedBy:r[o].user,saveObjectId:a.note.noteId,version:a.note.version}}),Object(E.endTimelineSaving)({id:e.payload.id})].filter((e=>null!=e))})),Object(h.startWith)(Object(E.startTimelineSaving)({id:e.payload.id})),Object(h.takeUntil)(r.pipe(Object(h.withLatestFrom)(i),Object(h.filter)((([e,t])=>e.type===y.addError.type||e.type===E.endTimelineSaving.type&&null!=t[Object(p.get)("payload.id",e)].savedObjectId&&(w.setTimelineId(t[Object(p.get)("payload.id",e)].savedObjectId),w.setTimelineVersion(t[Object(p.get)("payload.id",e)].version),!0)))))),A=(e,t)=>null!=e?t[e].note:"",k=[E.pinEvent.type,E.unPinEvent.type],L=(e,t,n,r,i)=>Object(m.from)((async({eventId:e,pinnedEventId:t,timelineId:n})=>{let r;try{r=JSON.stringify({eventId:e,pinnedEventId:t,timelineId:n})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return await R.b.get().http.patch(_.Eb,{method:"PATCH",body:r})})({pinnedEventId:null!=t[e.payload.id].pinnedEventsSaveObject[e.payload.eventId]?t[e.payload.id].pinnedEventsSaveObject[e.payload.eventId].pinnedEventId:null,eventId:e.payload.eventId,timelineId:w.getTimelineId()})).pipe(Object(h.withLatestFrom)(r,i),Object(h.mergeMap)((([t,n,r])=>{const i=n[e.payload.id],o=Object(p.get)("data.persistPinnedEventOnTimeline",t),a=o&&403===o.code?[Object(E.showCallOutUnauthorizedMsg)()]:[];return null!=r.refetch&&r.refetch(),[null!=o?Object(E.updateTimeline)({id:e.payload.id,timeline:{...i,savedObjectId:null==i.savedObjectId&&null!=o.timelineId?o.timelineId:i.savedObjectId,version:null==i.version&&null!=o.timelineVersion?o.timelineVersion:i.version,pinnedEventIds:{...i.pinnedEventIds,[e.payload.eventId]:!0},pinnedEventsSaveObject:{...i.pinnedEventsSaveObject,[e.payload.eventId]:o}}}):Object(E.updateTimeline)({id:e.payload.id,timeline:{...i,pinnedEventIds:Object(p.omit)(e.payload.eventId,i.pinnedEventIds),pinnedEventsSaveObject:Object(p.omit)(e.payload.eventId,i.pinnedEventsSaveObject)}}),...a,Object(E.endTimelineSaving)({id:e.payload.id})]})),Object(h.startWith)(Object(E.startTimelineSaving)({id:e.payload.id})),Object(h.takeUntil)(n.pipe(Object(h.withLatestFrom)(r),Object(h.filter)((([e,t])=>e.type===y.addError.type||e.type===E.endTimelineSaving.type&&null!=t[Object(p.get)("payload.id",e)].savedObjectId&&(w.setTimelineId(t[Object(p.get)("payload.id",e)].savedObjectId),w.setTimelineVersion(t[Object(p.get)("payload.id",e)].version),!0)))))),q=[E.updateIsFavorite.type];var M=n(427);const C=[E.applyKqlFilterQuery.type,E.addProvider.type,E.addTimeline.type,E.dataProviderEdited.type,E.removeProvider.type,E.saveTimeline.type,E.setExcludedRowRendererIds.type,E.setFilters.type,E.setSavedQueryId.type,E.updateDataProviderEnabled.type,E.updateDataProviderExcluded.type,E.updateDataProviderKqlQuery.type,E.updateDataProviderType.type,E.updateEqlOptions.type,E.updateEventType.type,E.updateKqlMode.type,E.updateProviders.type,E.updateTitleAndDescription.type,E.updateIndexNames.type,E.removeColumn.type,E.updateColumns.type,E.updateSort.type,E.updateRange.type,E.upsertColumn.type],F=e=>e&&e.toLowerCase().startsWith("timeline"),D=()=>(e,t,{selectAllTimelineQuery:n,selectNotesByIdSelector:r,timelineByIdSelector:i,timelineTimeRangeSelector:o,kibana$:a})=>{const u=t.pipe(Object(h.map)(i),Object(h.filter)(M.h)),c=t.pipe(Object(h.map)((e=>n()(e,I.a))),Object(h.filter)(M.h)),s=t.pipe(Object(h.map)(r),Object(h.filter)(M.h)),l=t.pipe(Object(h.map)(o),Object(h.filter)(M.h));return Object(m.merge)(e.pipe(Object(h.withLatestFrom)(u),Object(h.filter)((([e,t])=>{const n=Object(p.get)("payload.id",e),r=t[n];if(e.type===y.addError.type)return!0;if(F(n)&&null!=r&&null!=r.status&&g.u.immutable===r.status)return!1;if(e.type===E.createTimeline.type&&F(n))w.setTimelineVersion(null),w.setTimelineId(null),w.setTemplateTimelineId(null),w.setTemplateTimelineVersion(null);else{if(e.type===E.addTimeline.type&&F(n)){const t=Object(p.get)("payload.timeline",e);return w.setTimelineId(t.savedObjectId),w.setTimelineVersion(t.version),w.setTemplateTimelineId(t.templateTimelineId),w.setTemplateTimelineVersion(t.templateTimelineVersion),Object(p.getOr)(!1,"payload.savedTimeline",e)}if(C.includes(e.type)&&!r.isLoading&&F(n))return!0}})),Object(h.debounceTime)(500),Object(h.mergeMap)((([e])=>(x.next({action:e}),Object(m.empty)())))),x.pipe(Object(h.delay)(500),Object(h.withLatestFrom)(u,s,l),Object(h.concatMap)((([t,n,r,i])=>{const o=Object(p.get)("action",t),l=w.getTimelineId(),d=w.getTimelineVersion(),f=w.getTemplateTimelineId(),v=w.getTemplateTimelineVersion();return N.includes(o.type)?P(o,0,r,e,u,s,c):k.includes(o.type)?L(o,n,e,u,c):q.includes(o.type)?((e,t,n,r,i)=>{var o;return Object(m.from)(Object(O.g)({timelineId:w.getTimelineId(),templateTimelineId:t[e.payload.id].templateTimelineId,templateTimelineVersion:t[e.payload.id].templateTimelineVersion,timelineType:null!==(o=t[e.payload.id].timelineType)&&void 0!==o?o:g.x.default})).pipe(Object(h.withLatestFrom)(r,i),Object(h.mergeMap)((([t,n,r])=>{const i=n[e.payload.id],o=Object(p.get)("data.persistFavorite",t),a=403===o.code?[Object(E.showCallOutUnauthorizedMsg)()]:[];return null!=r.refetch&&r.refetch(),[...a,Object(E.updateTimeline)({id:e.payload.id,timeline:{...i,isFavorite:null!=o.favorite&&o.favorite.length>0,savedObjectId:o.savedObjectId||null,version:o.version||null}}),Object(E.endTimelineSaving)({id:e.payload.id})]})),Object(h.startWith)(Object(E.startTimelineSaving)({id:e.payload.id})),Object(h.takeUntil)(n.pipe(Object(h.withLatestFrom)(r),Object(h.filter)((([e,t])=>e.type===y.addError.type||e.type===E.endTimelineSaving.type&&null!=t[Object(p.get)("payload.id",e)].savedObjectId&&(w.setTimelineId(t[Object(p.get)("payload.id",e)].savedObjectId),w.setTimelineVersion(t[Object(p.get)("payload.id",e)].version),w.setTemplateTimelineId(t[Object(p.get)("payload.id",e)].templateTimelineId),w.setTemplateTimelineVersion(t[Object(p.get)("payload.id",e)].templateTimelineVersion),!0))))))})(o,n,e,u,c):C.includes(o.type)?Object(m.from)(Object(O.h)({timelineId:l,version:d,timeline:{...$(n[o.payload.id],i),templateTimelineId:f,templateTimelineVersion:v}})).pipe(Object(h.withLatestFrom)(u,c,a),Object(h.mergeMap)((([e,t,n,r])=>{var i,a,u,c,s;const l=e;var d;if(null!=l.status_code&&405===l.status_code)return r.notifications.toasts.addDanger({title:j.f,text:null!==(d=l.message)&&void 0!==d?d:j.e}),[Object(E.endTimelineSaving)({id:o.payload.id})];const f=t[o.payload.id],m=Object(p.get)("data.persistTimeline",e);if(null==m)return[Object(E.endTimelineSaving)({id:o.payload.id})];const v=403===m.code?[Object(E.showCallOutUnauthorizedMsg)()]:[];return null!=n.refetch&&n.refetch(),[409===m.code?Object(E.updateAutoSaveMsg)({timelineId:o.payload.id,newTimelineModel:W(f,m.timeline)}):Object(E.updateTimeline)({id:o.payload.id,timeline:{...f,updated:null!==(i=m.timeline.updated)&&void 0!==i?i:void 0,savedObjectId:m.timeline.savedObjectId,version:m.timeline.version,status:null!==(a=m.timeline.status)&&void 0!==a?a:g.u.active,timelineType:null!==(u=m.timeline.timelineType)&&void 0!==u?u:g.x.default,templateTimelineId:null!==(c=m.timeline.templateTimelineId)&&void 0!==c?c:null,templateTimelineVersion:null!==(s=m.timeline.templateTimelineVersion)&&void 0!==s?s:null,isSaving:!1}}),...v,Object(E.endTimelineSaving)({id:o.payload.id})]})),Object(h.startWith)(Object(E.startTimelineSaving)({id:o.payload.id})),Object(h.takeUntil)(e.pipe(Object(h.withLatestFrom)(u),Object(h.filter)((([e,t])=>e.type===E.endTimelineSaving.type&&null!=t[Object(p.get)("payload.id",e)].savedObjectId&&(w.setTimelineId(t[Object(p.get)("payload.id",e)].savedObjectId),w.setTimelineVersion(t[Object(p.get)("payload.id",e)].version),w.setTemplateTimelineId(t[Object(p.get)("payload.id",e)].templateTimelineId),w.setTemplateTimelineVersion(t[Object(p.get)("payload.id",e)].templateTimelineVersion),!0)))))):Object(m.empty)()}))))},U={columns:null,dataProviders:null,description:null,eqlOptions:null,eventType:null,excludedRowRendererIds:null,filters:null,kqlMode:null,kqlQuery:null,indexNames:null,title:null,timelineType:g.x.default,templateTimelineVersion:null,templateTimelineId:null,dateRange:null,savedQueryId:null,sort:null,status:null},$=(e,t)=>Object.keys(U).reduce(((n,r)=>{if(Object(p.has)(r,e)){if("kqlQuery"===r)return Object(p.set)(`${r}.filterQuery`,Object(p.get)(`${r}.filterQuery`,e),n);if("dateRange"===r)return Object(p.set)(`${r}`,{start:t.from,end:t.to},n);if("columns"===r&&null!=Object(p.get)(r,e))return Object(p.set)(r,Object(p.get)(r,e).map((e=>Object(p.omit)(["initialWidth","width","__typename"],e))),n);if("filters"===r&&null!=Object(p.get)(r,e)){const t=Object(p.get)(r,e);return Object(p.set)(r,null!=t?t.map((e=>{const t=Object(p.omit)(["$state"],e);return{...t,meta:{...t.meta,field:(b.esFilters.isMatchAllFilter(t)||b.esFilters.isPhraseFilter(t)||b.esFilters.isPhrasesFilter(t)||b.esFilters.isRangeFilter(t))&&null!=t.meta.field?V(t.meta.field):null,value:null!=t.meta.value?V(t.meta.value):null,params:null!=t.meta.params?V(t.meta.params):null},...b.esFilters.isMatchAllFilter(t)?{query:{match_all:V(t.query.match_all)}}:{match_all:null},...b.esFilters.isExistsFilter(t)&&null!=t.query.exists?{query:{exists:V(t.query.exists)}}:{exists:null},...!b.esFilters.isQueryStringFilter(t)&&null==Object(p.get)("query",t)||null==t.query?{query:null}:{query:V(t.query)},...b.esFilters.isRangeFilter(t)&&null!=t.query.range?{query:{range:V(t.query.range)}}:{range:null},...Object(v.f)(t)&&null!=t.query.script?{query:{script:V(t.query.script)}}:{script:null}}})):[],n)}return Object(p.set)(r,Object(p.get)(r,e),n)}return n}),U),B=(e,t)=>"__typename"===e?void 0:t,W=(e,t)=>JSON.parse(JSON.stringify(Object(p.merge)(e,t)),B),V=e=>{try{return Object(p.isObject)(e)?JSON.stringify(e):Object(p.toString)(e)}catch{return""}};var Q=n(259);const G=[E.removeColumn.type,E.upsertColumn.type,E.applyDeltaToColumnWidth.type,E.updateColumns.type,E.updateColumnOrder.type,E.updateColumnWidth.type,E.updateItemsPerPage.type,E.updateSort.type,E.setExcludedRowRendererIds.type],X=()=>Object(l.combineEpics)(D(),(e=>e.pipe(Object(h.filter)((e=>q.includes(e.type))),Object(h.mergeMap)((e=>(x.next({action:e}),Object(m.empty)()))))),(e=>e.pipe(Object(h.filter)((e=>N.includes(e.type))),Object(h.switchMap)((e=>(x.next({action:e}),Object(m.empty)()))))),(e=>e.pipe(Object(h.filter)((e=>k.includes(e.type))),Object(h.mergeMap)((e=>(x.next({action:e}),Object(m.empty)()))))),((e,t,{timelineByIdSelector:n,storage:r})=>{const i=t.pipe(Object(h.map)(n),Object(h.filter)(M.h));return e.pipe(Object(h.delay)(500),Object(h.withLatestFrom)(i),Object(h.filter)((([e])=>{return!((t=Object(p.get)("payload.id",e))&&t.toLowerCase().startsWith("timeline"));var t})),Object(h.tap)((([e,t])=>{if(G.includes(e.type)&&r){const n=Object(p.get)("payload.id",e);Object(Q.a)(r,n,t[n])}})),Object(h.ignoreElements)())}));let K=null;const H=(e,t,n,c,s)=>{const p=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||u.compose,m={kibana$:n,selectAllTimelineQuery:o.d.globalQueryByIdSelector,selectNotesByIdSelector:r.c.selectNotesByIdSelector,timelineByIdSelector:f.b.timelineByIdSelector,timelineTimeRangeSelector:o.d.timelineTimeRangeSelector,storage:c},v=Object(l.createEpicMiddleware)({dependencies:m});return K=Object(u.createStore)((e=>Object(u.combineReducers)({app:r.b,dragAndDrop:i.b,inputs:o.c,sourcerer:a.c,...e}))(t),e,p(Object(u.applyMiddleware)(v,d.d,...null!=s?s:[]))),v.run(X()),K},z=(e,t)=>n=>{const r={...n,getState:()=>e(n.getState())};return t(r)}},113:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));const r=":",i=":*";let o;!function(e){e.default="default",e.template="template"}(o||(o={}))},135:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return q}));var r={};n.r(r),n.d(r,"setSource",(function(){return u})),n.d(r,"setIndexPatternsList",(function(){return c})),n.d(r,"setSignalIndexName",(function(){return s})),n.d(r,"setSourcererScopeLoading",(function(){return l})),n.d(r,"setSelectedIndexPatterns",(function(){return d})),n.d(r,"initTimelineIndexPatterns",(function(){return f}));var i={};n.r(i),n.d(i,"sourcererKibanaIndexPatternsSelector",(function(){return b})),n.d(i,"sourcererSignalIndexNameSelector",(function(){return g})),n.d(i,"sourcererConfigIndexPatternsSelector",(function(){return y})),n.d(i,"sourcererScopeIdSelector",(function(){return O})),n.d(i,"scopeIdSelector",(function(){return I})),n.d(i,"sourcererScopesSelector",(function(){return j})),n.d(i,"scopesSelector",(function(){return E})),n.d(i,"kibanaIndexPatternsSelector",(function(){return T})),n.d(i,"signalIndexNameSelector",(function(){return S})),n.d(i,"configIndexPatternsSelector",(function(){return w})),n.d(i,"getIndexNamesSelectedSelector",(function(){return x})),n.d(i,"getAllExistingIndexNamesSelector",(function(){return _})),n.d(i,"getSourcererScopeSelector",(function(){return R}));var o=n(29);const a=n.n(o)()("x-pack/security_solution/local/sourcerer"),u=a("SET_SOURCE"),c=a("SET_INDEX_PATTERNS_LIST"),s=a("SET_SIGNAL_INDEX_NAME"),l=a("SET_SOURCERER_SCOPE_LOADING"),d=a("SET_SELECTED_INDEX_PATTERNS"),f=a("INIT_TIMELINE_INDEX_PATTERNS");var p=n(104),m=n(240),v=n.n(m),h=n(112);const b=({sourcerer:e})=>e.kibanaIndexPatterns,g=({sourcerer:e})=>e.signalIndexName,y=({sourcerer:e})=>e.configIndexPatterns,O=({sourcerer:e},t)=>e.sourcererScopes[t],I=()=>Object(h.createSelector)(O,(e=>e)),j=({sourcerer:e})=>e.sourcererScopes,E=()=>Object(h.createSelector)(j,(e=>e)),T=()=>Object(h.createSelector)(b,(e=>e)),S=()=>Object(h.createSelector)(g,(e=>e)),w=()=>Object(h.createSelector)(y,(e=>e)),x=()=>{const e=I(),t=w();return(n,r)=>{const i=e(n,r),o=t(n);return{indexNames:0===i.selectedPatterns.length?o:i.selectedPatterns,previousIndexNames:i.indexPattern.title}}},_=()=>{const e=S(),t=w();return n=>{const r=e(n),i=t(n);return null!=r?[...i,r]:i}},R=()=>{const e=I(),t=v()((e=>{const t=e.length>0?e.split(","):[];return t.some((e=>"logs-*"===e))?[...t,"-*elastic-cloud-logs-*"]:t})),n=v()(((e,t)=>({...e,title:t})),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length));return(r,i)=>{const o=e(r,i),a=t(o.selectedPatterns.sort().join()),u=n(o.indexPattern,a.join());return{...o,selectedPatterns:a,indexPattern:u}}};var N=n(19),P=n(241),A=n(58);const k=({eventType:e,id:t,selectedPatterns:n,state:r})=>{const i=r.kibanaIndexPatterns.map((e=>e.title)),o=n.filter((e=>r.configIndexPatterns.includes(e)||i.includes(e)||!Object(A.isEmpty)(r.signalIndexName)&&r.signalIndexName===e));if(Object(A.isEmpty)(o)){let n=r.configIndexPatterns;if(t===p.SourcererScopeName.timeline&&Object(A.isEmpty)(o))n=L({state:r,eventType:e});else if(t===p.SourcererScopeName.detections&&Object(A.isEmpty)(o)){var a;n=[null!==(a=r.signalIndexName)&&void 0!==a?a:""]}return n}return o},L=({state:e,eventType:t})=>{let n=e.configIndexPatterns;var r;if("all"!==t||Object(A.isEmpty)(e.signalIndexName)){if("raw"===t)n=e.configIndexPatterns;else if(!Object(A.isEmpty)(e.signalIndexName)&&("signal"===t||"alert"===t)){var i;n=[null!==(i=e.signalIndexName)&&void 0!==i?i:""]}}else n=[...e.configIndexPatterns,null!==(r=e.signalIndexName)&&void 0!==r?r:""];return n},q=Object(P.reducerWithInitialState)(p.initialSourcererState).case(c,((e,{kibanaIndexPatterns:t,configIndexPatterns:n})=>({...e,kibanaIndexPatterns:t,configIndexPatterns:n}))).case(s,((e,{signalIndexName:t})=>({...e,signalIndexName:t}))).case(l,((e,{id:t,loading:n})=>({...e,sourcererScopes:{...e.sourcererScopes,[t]:{...e.sourcererScopes[t],loading:n}}}))).case(d,((e,{id:t,selectedPatterns:n,eventType:r})=>({...e,sourcererScopes:{...e.sourcererScopes,[t]:{...e.sourcererScopes[t],selectedPatterns:k({eventType:r,id:t,selectedPatterns:n,state:e})}}}))).case(f,((e,{id:t,selectedPatterns:n,eventType:r})=>({...e,sourcererScopes:{...e.sourcererScopes,[t]:{...e.sourcererScopes[t],selectedPatterns:Object(N.isEmpty)(n)?L({state:e,eventType:r}):n}}}))).case(u,((e,{id:t,payload:n})=>{const{...r}=n;return{...e,sourcererScopes:{...e.sourcererScopes,[t]:{...e.sourcererScopes[t],...r,...0===e.sourcererScopes[t].selectedPatterns.length?{selectedPatterns:e.configIndexPatterns}:{}}}}})).build()},141:function(e,t,n){"use strict";n.r(t),n.d(t,"setAbsoluteRangeDatePicker",(function(){return o})),n.d(t,"setTimelineRangeDatePicker",(function(){return a})),n.d(t,"setRelativeRangeDatePicker",(function(){return u})),n.d(t,"setDuration",(function(){return c})),n.d(t,"startAutoReload",(function(){return s})),n.d(t,"stopAutoReload",(function(){return l})),n.d(t,"setFullScreen",(function(){return d})),n.d(t,"setQuery",(function(){return f})),n.d(t,"deleteOneQuery",(function(){return p})),n.d(t,"setInspectionParameter",(function(){return m})),n.d(t,"deleteAllQuery",(function(){return v})),n.d(t,"toggleTimelineLinkTo",(function(){return h})),n.d(t,"removeTimelineLinkTo",(function(){return b})),n.d(t,"addTimelineLinkTo",(function(){return g})),n.d(t,"removeGlobalLinkTo",(function(){return y})),n.d(t,"addGlobalLinkTo",(function(){return O})),n.d(t,"setFilterQuery",(function(){return I})),n.d(t,"setSavedQuery",(function(){return j})),n.d(t,"setSearchBarFilter",(function(){return E}));var r=n(29);const i=n.n(r)()("x-pack/security_solution/local/inputs"),o=i("SET_ABSOLUTE_RANGE_DATE_PICKER"),a=i("SET_TIMELINE_RANGE_DATE_PICKER"),u=i("SET_RELATIVE_RANGE_DATE_PICKER"),c=i("SET_DURATION"),s=i("START_KQL_AUTO_RELOAD"),l=i("STOP_KQL_AUTO_RELOAD"),d=i("SET_FULL_SCREEN"),f=i("SET_QUERY"),p=i("DELETE_QUERY"),m=i("SET_INSPECTION_PARAMETER"),v=i("DELETE_ALL_QUERY"),h=i("TOGGLE_TIMELINE_LINK_TO"),b=i("REMOVE_TIMELINE_LINK_TO"),g=i("ADD_TIMELINE_LINK_TO"),y=i("REMOVE_GLOBAL_LINK_TO"),O=i("ADD_GLOBAL_LINK_TO"),I=i("SET_FILTER_QUERY"),j=i("SET_SAVED_QUERY"),E=i("SET_SEARCH_BAR_FILTER")},156:function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"c",(function(){return L})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r}));var r={};n.r(r),n.d(r,"inputsSelector",(function(){return d})),n.d(r,"timelineTimeRangeSelector",(function(){return f})),n.d(r,"globalFullScreenSelector",(function(){return p})),n.d(r,"timelineFullScreenSelector",(function(){return m})),n.d(r,"globalTimeRangeSelector",(function(){return v})),n.d(r,"globalPolicySelector",(function(){return h})),n.d(r,"globalQuery",(function(){return b})),n.d(r,"globalQueryByIdSelector",(function(){return g})),n.d(r,"timelineQueryByIdSelector",(function(){return y})),n.d(r,"globalSelector",(function(){return O})),n.d(r,"globalQuerySelector",(function(){return j})),n.d(r,"globalSavedQuerySelector",(function(){return E})),n.d(r,"globalFiltersQuerySelector",(function(){return S})),n.d(r,"getTimelineSelector",(function(){return w})),n.d(r,"getTimelinePolicySelector",(function(){return x}));var i=n(141);n(210);var o=n(112);const a=e=>e.inputs,u=e=>e.inputs.global,c=e=>e.inputs.timeline,s=(e,t)=>e.inputs.global.queries.find((e=>e.id===t))||{id:"",inspect:null,isInspected:!1,loading:!1,refetch:null,selectedInspectIndex:0},l=(e,t)=>e.inputs.timeline.queries.find((e=>e.id===t))||e.inputs.global.queries.find((e=>e.id===t))||{id:"",inspect:null,isInspected:!1,loading:!1,refetch:null,selectedInspectIndex:0},d=()=>Object(o.createSelector)(a,(e=>e)),f=Object(o.createSelector)(c,(e=>e.timerange)),p=Object(o.createSelector)(u,(e=>e.fullScreen)),m=Object(o.createSelector)(c,(e=>e.fullScreen)),v=Object(o.createSelector)(u,(e=>e.timerange)),h=Object(o.createSelector)(u,(e=>e.policy)),b=()=>Object(o.createSelector)(u,(e=>e.queries)),g=()=>Object(o.createSelector)(s,(e=>e)),y=()=>Object(o.createSelector)(l,(e=>e)),O=()=>Object(o.createSelector)(u,(e=>e)),I={query:"",language:"kuery"},j=()=>Object(o.createSelector)(u,(e=>e.query||I)),E=()=>Object(o.createSelector)(u,(e=>e.savedQuery||null)),T=[],S=()=>Object(o.createSelector)(u,(e=>e.filters||T)),w=()=>Object(o.createSelector)(c,(e=>e)),x=()=>Object(o.createSelector)(c,(e=>e.policy));var _=n(19),R=n(241),N=n(359);const P=(e,t,n)=>{const r=Object(_.get)(e,n);return null!=r?{...[e,...r.linkTo].reduce(((e,r)=>({...e,[r]:{...Object(_.get)(r,n),timerange:t}})),"timeline"===e?{...n,global:{...n.global,linkTo:[]}}:n)}:n},A={global:{timerange:{kind:"relative",...Object(N.d)(!1)},queries:[],policy:Object(N.c)(!1),linkTo:["timeline"],query:{query:"",language:"kuery"},filters:[],fullScreen:!1},timeline:{timerange:{kind:"relative",...Object(N.d)(!1)},queries:[],policy:Object(N.c)(!1),linkTo:["global"],query:{query:"",language:"kuery"},filters:[],fullScreen:!1}},k=()=>{const{from:e,fromStr:t,to:n,toStr:r}=Object(N.d)(),{kind:i,duration:o}=Object(N.c)();return{global:{timerange:{kind:"relative",fromStr:t,toStr:r,from:e,to:n},queries:[],policy:{kind:i,duration:o},linkTo:["timeline"],query:{query:"",language:"kuery"},filters:[],fullScreen:!1},timeline:{timerange:{kind:"relative",fromStr:t,toStr:r,from:e,to:n},queries:[],policy:{kind:i,duration:o},linkTo:["global"],query:{query:"",language:"kuery"},filters:[],fullScreen:!1}}},L=Object(R.reducerWithInitialState)(A).case(i.setTimelineRangeDatePicker,((e,{from:t,to:n})=>({...e,global:{...e.global,linkTo:[]},timeline:{...e.timeline,timerange:{kind:"absolute",fromStr:void 0,toStr:void 0,from:t,to:n},linkTo:[]}}))).case(i.setAbsoluteRangeDatePicker,((e,{id:t,from:n,to:r,fromStr:i,toStr:o})=>P(t,{kind:"absolute",fromStr:i,toStr:o,from:n,to:r},e))).case(i.setRelativeRangeDatePicker,((e,{id:t,fromStr:n,from:r,to:i,toStr:o})=>P(t,{kind:"relative",fromStr:n,toStr:o,from:r,to:i},e))).case(i.setFullScreen,((e,{id:t,fullScreen:n})=>((e,t,n)=>({...n,global:{...n.global,fullScreen:"global"===e?t:n.global.fullScreen},timeline:{...n.timeline,fullScreen:"timeline"===e?t:n.timeline.fullScreen}}))(t,n,e))).case(i.deleteAllQuery,((e,{id:t})=>({...e,[t]:{...Object(_.get)(t,e),queries:e.global.queries.slice(e.global.queries.length)}}))).case(i.setQuery,((e,{inputId:t,id:n,inspect:r,loading:i,refetch:o})=>(({inputId:e,id:t,inspect:n,loading:r,refetch:i,state:o})=>{const a=o[e].queries.findIndex((e=>e.id===t));return{...o,[e]:{...Object(_.get)(e,o),queries:a>-1?[...o[e].queries.slice(0,a),{id:t,inspect:n,isInspected:o[e].queries[a].isInspected,loading:r,refetch:i,selectedInspectIndex:o[e].queries[a].selectedInspectIndex},...o[e].queries.slice(a+1)]:[...o[e].queries,{id:t,inspect:n,isInspected:!1,loading:r,refetch:i,selectedInspectIndex:0}]}}})({inputId:t,id:n,inspect:r,loading:i,refetch:o,state:e}))).case(i.deleteOneQuery,((e,{inputId:t,id:n})=>(({inputId:e,id:t,state:n})=>{const r=n[e].queries.findIndex((e=>e.id===t));return{...n,[e]:{...Object(_.get)(e,n),queries:r>-1?[...n[e].queries.slice(0,r),...n[e].queries.slice(r+1)]:[...n[e].queries]}}})({inputId:t,id:n,state:e}))).case(i.setDuration,((e,{id:t,duration:n})=>({...e,[t]:{...Object(_.get)(t,e),policy:{...Object(_.get)(`${t}.policy`,e),duration:n}}}))).case(i.startAutoReload,((e,{id:t})=>({...e,[t]:{...Object(_.get)(t,e),policy:{...Object(_.get)(`${t}.policy`,e),kind:"interval"}}}))).case(i.stopAutoReload,((e,{id:t})=>({...e,[t]:{...Object(_.get)(t,e),policy:{...Object(_.get)(`${t}.policy`,e),kind:"manual"}}}))).case(i.toggleTimelineLinkTo,((e,{linkToId:t})=>((e,t)=>{const n=t.global.linkTo.indexOf(e);return{...t,global:{...t.global,timerange:n>-1?t.global.timerange:t.timeline.timerange,linkTo:n>-1?[...t.global.linkTo.slice(0,n),...t.global.linkTo.slice(n+1)]:[...t.global.linkTo,e]},timeline:{...t.timeline,linkTo:n>-1?[]:["global"]}}})(t,e))).case(i.setInspectionParameter,((e,{id:t,inputId:n,isInspected:r,selectedInspectIndex:i})=>(({id:e,inputId:t,isInspected:n,selectedInspectIndex:r,state:i})=>{const o=i[t].queries.findIndex((t=>t.id===e)),a=o>-1?i[t].queries[o]:null;return{...i,[t]:{...Object(_.get)(t,i),queries:o>-1?[...i[t].queries.slice(0,o),{...a,isInspected:n,selectedInspectIndex:r},...i[t].queries.slice(o+1)]:[...i[t].queries]}}})({id:t,inputId:n,isInspected:r,selectedInspectIndex:i,state:e}))).case(i.removeGlobalLinkTo,(e=>(e=>({...e,global:{...e.global,linkTo:[]}}))(e))).case(i.addGlobalLinkTo,((e,{linkToId:t})=>((e,t)=>({...t,global:{...t.global,linkTo:[e]}}))(t,e))).case(i.removeTimelineLinkTo,(e=>(e=>({...e,timeline:{...e.timeline,linkTo:[]}}))(e))).case(i.addTimelineLinkTo,((e,{linkToId:t})=>((e,t)=>({...t,timeline:{...t.timeline,linkTo:[e]}}))(t,e))).case(i.setFilterQuery,((e,{id:t,query:n,language:r})=>({...e,[t]:{...Object(_.get)(t,e),query:{query:n,language:r}}}))).case(i.setSavedQuery,((e,{id:t,savedQuery:n})=>({...e,[t]:{...Object(_.get)(t,e),savedQuery:n}}))).case(i.setSearchBarFilter,((e,{id:t,filters:n})=>({...e,[t]:{...Object(_.get)(t,e),filters:n}}))).build()},163:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d}));var r=n(131),i=n.n(r),o=n(9),a=function(){var e=Object(o.useRef)(!1),t=Object(o.useCallback)((function(){return e.current}),[]),n=Object(o.useCallback)((function(){e.current=!1}),[]);return Object(o.useEffect)((function(){return e.current=!0,n}),[n]),t},u=function(e){var t=a(),n=Object(o.useState)(!1),r=i()(n,2),u=r[0],c=r[1],s=Object(o.useState)(),l=i()(s,2),d=l[0],f=l[1],p=Object(o.useState)(),m=i()(p,2),v=m[0],h=m[1];return{error:d,loading:u,result:v,start:Object(o.useCallback)((function(){c(!0),h(void 0),f(void 0),e.apply(void 0,arguments).then((function(e){return t()&&h(e)})).catch((function(e){return t()&&f(e)})).finally((function(){return t()&&c(!1)}))}),[e,t])}},c=function(e){var t=a(),n=Object(o.useState)(!1),r=i()(n,2),u=r[0],c=r[1],s=Object(o.useState)(),l=i()(s,2),d=l[0],f=l[1],p=Object(o.useState)(),m=i()(p,2),v=m[0],h=m[1],b=Object(o.useRef)(),g=Object(o.useCallback)((function(){b.current&&b.current.unsubscribe(),c(!0),h(void 0),f(void 0),b.current=e.apply(void 0,arguments).subscribe((function(e){t()&&(h(e),c(!1))}),(function(e){t()&&(f(e),c(!1))}))}),[e,t]);return Object(o.useEffect)((function(){return function(){b.current&&b.current.unsubscribe()}}),[]),{error:d,loading:u,result:v,start:g}},s=n(123),l=n.n(s),d=function(e){return function(t){var n=null!=t.signal?t.signal:(new AbortController).signal;return e(l()(l()({},t),{},{signal:n}))}}},164:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(239),i=n(423),o=n(241);const a={notesById:{},errors:[],enableExperimental:{...n(35).a}},u=({note:e,notesById:t})=>({...t,[e.id]:e}),c=Object(o.reducerWithInitialState)(a).case(r.addNotes,((e,{notes:t})=>({...e,notesById:t.reduce(((e,t)=>({...e,[t.id]:t})),{})}))).case(r.updateNote,((e,{note:t})=>({...e,notesById:u({note:t,notesById:e.notesById})}))).case(r.addError,((e,{id:t,title:n,message:r})=>({...e,errors:e.errors.concat({id:t,title:n,message:r})}))).case(r.removeError,((e,{id:t})=>({...e,errors:e.errors.filter((e=>e.id!==t))}))).case(r.addErrorHash,((e,{id:t,hash:n,title:r,message:i})=>{const o=e.errors.findIndex((e=>e.id===t)),a=e.errors.find((e=>e.id===t))||{id:t,title:r,message:i};return-1===o?{...e,errors:e.errors.concat({...a,hash:n,displayError:!e.errors.some((e=>e.hash===n))})}:{...e,errors:[...e.errors.slice(0,o),{...a,hash:n,displayError:!e.errors.some((e=>e.hash===n))},...e.errors.slice(o+1)]}})).build()},165:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));const r=180,i=70,o=190},168:function(e,t,n){"use strict";n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return E})),n.d(t,"r",(function(){return S})),n.d(t,"s",(function(){return x})),n.d(t,"l",(function(){return R})),n.d(t,"j",(function(){return P})),n.d(t,"m",(function(){return k})),n.d(t,"k",(function(){return q})),n.d(t,"e",(function(){return C})),n.d(t,"f",(function(){return D})),n.d(t,"a",(function(){return $})),n.d(t,"h",(function(){return B})),n.d(t,"n",(function(){return V})),n.d(t,"o",(function(){return G})),n.d(t,"g",(function(){return K})),n.d(t,"i",(function(){return z})),n.d(t,"p",(function(){return Y})),n.d(t,"q",(function(){return Z})),n.d(t,"d",(function(){return te}));var r=n(123),i=n.n(r),o=n(149),a=n.n(o),u=n(214),c=n.n(u),s=n(215),l=n.n(s),d=n(428),f=n(48),p=n(351),m=n(154),v=n(137),h=n(281),b=n(17),g=function(){var e=c()(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=h.pipe,e.next=3,t();case 3:return e.t1=e.sent,e.t2=Object(b.fold)((function(e){return Promise.reject(e)}),(function(e){return Promise.resolve(e)})),e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(e){return e instanceof Error?e:new Error(String(e))},O=function(){var e=c()(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.list,i=t.signal,e.abrupt("return",n.fetch(v.m,{body:JSON.stringify(r),method:"POST",signal:i}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=c()(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.list,i=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return O({http:n,list:r,signal:i})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.p,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=c()(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.listItem,i=t.signal,e.abrupt("return",n.fetch(v.j,{body:JSON.stringify(r),method:"POST",signal:i}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=c()(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.listItem,i=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return j({http:n,listItem:r,signal:i})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.o,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=c()(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.list,i=t.signal,e.abrupt("return",n.fetch(v.m,{body:JSON.stringify(r),method:"PUT",signal:i}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=c()(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.list,i=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return T({http:n,list:r,signal:i})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.p,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=c()(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.listItem,i=t.signal,e.abrupt("return",n.fetch(v.j,{body:JSON.stringify(r),method:"PUT",signal:i}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=c()(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.listItem,i=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return w({http:n,listItem:r,signal:i})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.o,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o,a,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.filters,i=t.namespaceTypes,o=t.pagination,a=t.signal,u={filter:r,namespace_type:i,page:o.page?"".concat(o.page):"1",per_page:o.perPage?"".concat(o.perPage):"20",sort_field:"exception-list.created_at",sort_order:"desc"},e.abrupt("return",n.fetch("".concat(v.m,"/_find"),{method:"GET",query:u,signal:a}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filters,r=t.http,i=t.namespaceTypes,o=t.pagination,a=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return _({filters:n,http:r,namespaceTypes:i,pagination:o,signal:a})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.t,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.id,i=t.namespaceType,o=t.signal,e.abrupt("return",n.fetch(v.m,{method:"GET",query:{id:r,namespace_type:i},signal:o}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.id,i=t.namespaceType,o=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return N({http:n,id:r,namespaceType:i,signal:o})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.p,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=c()(l.a.mark((function e(t){var n,r,o,u,c,s,d,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.listIds,o=t.namespaceTypes,u=t.filterOptions,c=t.pagination,s=t.signal,d=u.map((function(e,t){var n="agnostic"===o[t]?v.l:v.k;return[].concat(a()(e.filter.length?["".concat(n,".attributes.entries.field:").concat(e.filter,"*")]:[]),a()(e.tags.length?e.tags.map((function(e){return"".concat(n,".attributes.tags:").concat(e)})):[])).join(" AND ")})).join(","),f=i()({list_id:r.join(","),namespace_type:o.join(","),page:c.page?"".concat(c.page):"1",per_page:c.perPage?"".concat(c.perPage):"20",sort_field:"exception-list.created_at",sort_order:"desc"},""!==d.trim()?{filter:d}:{}),e.abrupt("return",n.fetch("".concat(v.j,"/_find"),{method:"GET",query:f,signal:s}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o,a,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filterOptions,r=t.http,i=t.listIds,o=t.namespaceTypes,a=t.pagination,u=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return A({filterOptions:n,http:r,listIds:i,namespaceTypes:o,pagination:a,signal:u})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.s,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.id,i=t.namespaceType,o=t.signal,e.abrupt("return",n.fetch(v.j,{method:"GET",query:{id:r,namespace_type:i},signal:o}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.id,i=t.namespaceType,o=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return L({http:n,id:r,namespaceType:i,signal:o})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.o,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.id,i=t.namespaceType,o=t.signal,e.abrupt("return",n.fetch(v.m,{method:"DELETE",query:{id:r,namespace_type:i},signal:o}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.id,i=t.namespaceType,o=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return M({http:n,id:r,namespaceType:i,signal:o})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.p,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.id,i=t.namespaceType,o=t.signal,e.abrupt("return",n.fetch(v.j,{method:"DELETE",query:{id:r,namespace_type:i},signal:o}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.id,i=t.namespaceType,o=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return F({http:n,id:r,namespaceType:i,signal:o})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.o,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=c()(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.signal,e.abrupt("return",n.fetch(v.h,{method:"POST",signal:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=c()(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return U({http:n,signal:r})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.f,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.id,i=t.listId,o=t.namespaceType,a=t.signal,e.abrupt("return",n.fetch("".concat(v.m,"/_export"),{method:"POST",query:{id:r,list_id:i,namespace_type:o},signal:a}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.cursor,i=t.page,o=t.per_page,a=t.signal,e.abrupt("return",n.fetch("".concat(v.q,"/_find"),{method:"GET",query:{cursor:r,page:i,per_page:o},signal:a}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=c()(l.a.mark((function e(t){var n,r,o,a,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.cursor,r=t.http,o=t.pageIndex,a=t.pageSize,u=t.signal,e.abrupt("return",Object(h.pipe)({cursor:null!=n?n.toString():void 0,page:null!=o?o.toString():void 0,per_page:null!=a?a.toString():void 0},(function(e){return Object(d.fromEither)(Object(p.c)(m.r,e))}),Object(d.chain)((function(e){return Object(d.tryCatch)((function(){return W(i()({http:r,signal:u},e))}),y)})),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.u,e))})),Object(f.flow)(g)));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o,a,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.file,r=t.http,i=t.list_id,o=t.type,a=t.signal,(u=new FormData).append("file",n),e.abrupt("return",r.fetch("".concat(v.o,"/_import"),{body:u,headers:{"Content-Type":void 0},method:"POST",query:{list_id:i,type:o},signal:a}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=c()(l.a.mark((function e(t){var n,r,o,a,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.file,r=t.http,o=t.listId,a=t.type,u=t.signal,e.abrupt("return",Object(h.pipe)({list_id:o,type:a},(function(e){return Object(d.fromEither)(Object(p.c)(m.v,e))}),Object(d.chain)((function(e){return Object(h.pipe)(Object(d.fromEither)(Object(p.c)(m.w,{file:n})),Object(d.map)((function(t){return i()(i()({},t),e)})))})),Object(d.chain)((function(e){return Object(d.tryCatch)((function(){return Q(i()({http:r,signal:u},e))}),y)})),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.z,e))})),g));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=c()(l.a.mark((function e(t){var n,r,i,o,a,u,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.deleteReferences,r=void 0!==n&&n,i=t.http,o=t.id,a=t.ignoreReferences,u=void 0!==a&&a,c=t.signal,e.abrupt("return",i.fetch(v.q,{method:"DELETE",query:{deleteReferences:r,id:o,ignoreReferences:u},signal:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=c()(l.a.mark((function e(t){var n,r,o,a,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.deleteReferences,r=t.http,o=t.id,a=t.ignoreReferences,u=t.signal,e.abrupt("return",Object(h.pipe)({deleteReferences:n,id:o,ignoreReferences:a},(function(e){return Object(d.fromEither)(Object(p.c)(m.h,e))}),Object(d.chain)((function(e){return Object(d.tryCatch)((function(){return X(i()({http:r,signal:u},e))}),y)})),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.z,e))})),Object(f.flow)(g)));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=c()(l.a.mark((function e(t){var n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.list_id,i=t.signal,e.abrupt("return",n.fetch("".concat(v.o,"/_export"),{method:"POST",query:{list_id:r},signal:i}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=c()(l.a.mark((function e(t){var n,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.listId,o=t.signal,e.abrupt("return",Object(h.pipe)({list_id:r},(function(e){return Object(d.fromEither)(Object(p.c)(m.q,e))}),Object(d.chain)((function(e){return Object(d.tryCatch)((function(){return H(i()({http:n,signal:o},e))}),y)})),Object(f.flow)(g)));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=c()(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.signal,e.abrupt("return",n.fetch(v.n,{method:"GET",signal:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=c()(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return J({http:n,signal:r})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.y,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=c()(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.signal,e.abrupt("return",n.fetch(v.p,{method:"GET",signal:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=c()(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.signal,e.abrupt("return",n.fetch(v.n,{method:"POST",signal:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=c()(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.http,r=t.signal,e.abrupt("return",Object(f.flow)((function(){return Object(d.tryCatch)((function(){return ee({http:n,signal:r})}),y)}),Object(d.chain)((function(e){return Object(d.fromEither)(Object(p.c)(m.d,e))})),Object(f.flow)(g))());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},177:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(165);const i="not-filtered",o=[{columnHeaderType:i,id:"@timestamp",type:"number",initialWidth:r.b},{columnHeaderType:i,id:"message",initialWidth:r.a},{columnHeaderType:i,id:"event.category",initialWidth:r.a},{columnHeaderType:i,id:"event.action",initialWidth:r.a},{columnHeaderType:i,id:"host.name",initialWidth:r.a},{columnHeaderType:i,id:"source.ip",initialWidth:r.a},{columnHeaderType:i,id:"destination.ip",initialWidth:r.a},{columnHeaderType:i,id:"user.name",initialWidth:r.a}]},207:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return _})),n.d(t,"f",(function(){return N})),n.d(t,"g",(function(){return P})),n.d(t,"h",(function(){return k})),n.d(t,"i",(function(){return q})),n.d(t,"j",(function(){return C})),n.d(t,"k",(function(){return D})),n.d(t,"l",(function(){return $}));var r=n(123),i=n.n(r),o=n(48),a=n(363),u=function(e){return Object(o.flow)(d)(e)},c=function(e){return Object(o.flow)(d)(e)},s=function(e){return Object(o.flow)(l)(e)},l=function(e){var t=e.entries.map((function(e){return"nested"===e.type?Object(a.addIdToItem)(i()(i()({},e),{},{entries:e.entries.map((function(e){return Object(a.addIdToItem)(e)}))})):Object(a.addIdToItem)(e)}));return i()(i()({},e),{},{entries:t})},d=function(e){var t=e.entries.map((function(e){return"nested"===e.type?Object(a.removeIdFromItem)(i()(i()({},e),{},{entries:e.entries.map((function(e){return Object(a.removeIdFromItem)(e)}))})):Object(a.removeIdFromItem)(e)}));return i()(i()({},e),{},{entries:t})},f=n(214),p=n.n(f),m=n(215),v=n.n(m),h=n(9),b=n(168),g=n(232),y=function(e){return Object(h.useMemo)((function(){return{addExceptionListItem:function(t){return p()(v.a.mark((function n(){var r,i,o;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.listItem,i=new AbortController,o=c(r),n.abrupt("return",b.c({http:e,listItem:o,signal:i.signal}));case 4:case"end":return n.stop()}}),n)})))()},deleteExceptionItem:function(t){return p()(v.a.mark((function n(){var r,i,o,a,u;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.id,i=t.namespaceType,o=t.onSuccess,a=t.onError,u=new AbortController,n.prev=2,n.next=5,b.f({http:e,id:r,namespaceType:i,signal:u.signal});case 5:o(),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),a(n.t0);case 11:case"end":return n.stop()}}),n,null,[[2,8]])})))()},deleteExceptionList:function(t){return p()(v.a.mark((function n(){var r,i,o,a,u;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.id,i=t.namespaceType,o=t.onSuccess,a=t.onError,u=new AbortController,n.prev=2,n.next=5,b.e({http:e,id:r,namespaceType:i,signal:u.signal});case 5:o(),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),a(n.t0);case 11:case"end":return n.stop()}}),n,null,[[2,8]])})))()},exportExceptionList:function(t){return p()(v.a.mark((function n(){var r,i,o,a,u,c,s;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.id,i=t.listId,o=t.namespaceType,a=t.onError,u=t.onSuccess,c=new AbortController,n.prev=2,n.next=5,b.h({http:e,id:r,listId:i,namespaceType:o,signal:c.signal});case 5:s=n.sent,u(s),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),a(n.t0);case 12:case"end":return n.stop()}}),n,null,[[2,9]])})))()},getExceptionItem:function(t){return p()(v.a.mark((function n(){var r,i,o,a,u,c;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.id,i=t.namespaceType,o=t.onSuccess,a=t.onError,u=new AbortController,n.prev=2,n.t0=s,n.next=6,b.k({http:e,id:r,namespaceType:i,signal:u.signal});case 6:n.t1=n.sent,c=(0,n.t0)(n.t1),o(c),n.next=14;break;case 11:n.prev=11,n.t2=n.catch(2),a(n.t2);case 14:case"end":return n.stop()}}),n,null,[[2,11]])})))()},getExceptionList:function(t){return p()(v.a.mark((function n(){var r,i,o,a,u,c;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.id,i=t.namespaceType,o=t.onSuccess,a=t.onError,u=new AbortController,n.prev=2,n.next=5,b.j({http:e,id:r,namespaceType:i,signal:u.signal});case 5:c=n.sent,o(c),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),a(n.t0);case 12:case"end":return n.stop()}}),n,null,[[2,9]])})))()},getExceptionListsItems:function(t){return p()(v.a.mark((function n(){var r,i,o,a,u,c,l,d,f,p,m,h,y,O,I,j;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.lists,i=t.filterOptions,o=t.pagination,a=t.showDetectionsListsOnly,u=t.showEndpointListsOnly,c=t.onSuccess,l=t.onError,d=new AbortController,f=Object(g.j)({lists:r,showDetection:a,showEndpoint:u}),p=f.ids,m=f.namespaces,n.prev=3,!(p.length>0&&m.length>0)){n.next=15;break}return n.next=7,b.m({filterOptions:i,http:e,listIds:p,namespaceTypes:m,pagination:o,signal:d.signal});case 7:h=n.sent,y=h.data,O=h.page,I=h.per_page,j=h.total,c({exceptions:y.map((function(e){return s(e)})),pagination:{page:O,perPage:I,total:j}}),n.next=16;break;case 15:c({exceptions:[],pagination:{page:0,perPage:null!=o.perPage?o.perPage:0,total:0}});case 16:n.next=21;break;case 18:n.prev=18,n.t0=n.catch(3),l(n.t0);case 21:case"end":return n.stop()}}),n,null,[[3,18]])})))()},updateExceptionListItem:function(t){return p()(v.a.mark((function n(){var r,i,o;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.listItem,i=new AbortController,o=u(r),n.abrupt("return",b.s({http:e,listItem:o,signal:i.signal}));case 4:case"end":return n.stop()}}),n)})))()}}}),[e])},O=n(163),I=Object(O.c)(b.d),j=function(){return Object(O.a)(I)},E=n(7),T=n.n(E),S=n(131),w=n.n(S),x=function(e){return JSON.stringify(e)},_=function(e){for(var t,n=e.pageIndex,r=e.pageSize,o=Object(h.useState)({}),a=w()(o,2),u=a[0],c=a[1],s=Object(h.useCallback)((function(e){c(i()(i()({},u),{},T()({},x({pageIndex:n+1,pageSize:r}),e)))}),[n,r]),l=n;l>=0;l--){if(t=u[x({pageIndex:l,pageSize:r})])break}return[t,s]},R=Object(O.c)(b.g),N=function(){return Object(O.a)(R)},P=function(e){var t=e.http,n=e.lists,r=e.pagination,i=void 0===r?{page:1,perPage:20,total:0}:r,o=e.filterOptions,a=e.showDetectionsListsOnly,u=e.showEndpointListsOnly,c=e.matchFilters,l=e.onError,d=e.onSuccess,f=Object(h.useState)([]),m=w()(f,2),y=m[0],O=m[1],I=Object(h.useState)(i),j=w()(I,2),E=j[0],T=j[1],S=Object(h.useRef)(null),x=Object(h.useState)(!0),_=w()(x,2),R=_[0],N=_[1],P=Object(g.j)({lists:n,showDetection:a,showEndpoint:u}),A=P.ids,k=P.namespaces,L=c&&o.length>0?A.map((function(){return o[0]})):o,q=A.join(","),M=k.join(","),C=o.map((function(e){return e.filter})).join(","),F=o.map((function(e){return e.tags.join(",")})).join(",");return Object(h.useEffect)((function(){var e=!0,n=new AbortController,r=function(){var r=p()(v.a.mark((function r(){var o,a,u,c,f,p;return v.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,N(!0),0!==A.length||!e){r.next=9;break}T({page:0,perPage:i.perPage,total:0}),O([]),null!=d&&d({exceptions:[],pagination:{page:0,perPage:i.perPage,total:0}}),N(!1),r.next=18;break;case 9:return r.next=11,Object(b.m)({filterOptions:L,http:t,listIds:A,namespaceTypes:k,pagination:{page:i.page,perPage:i.perPage},signal:n.signal});case 11:o=r.sent,a=o.page,u=o.per_page,c=o.total,f=o.data,p=f.map((function(e){return s(e)})),e&&(T({page:a,perPage:u,total:c}),O(p),null!=d&&d({exceptions:p,pagination:{page:a,perPage:u,total:c}}));case 18:r.next=23;break;case 20:r.prev=20,r.t0=r.catch(0),e&&(O([]),T({page:1,perPage:20,total:0}),null!=l&&l(r.t0));case 23:e&&N(!1);case 24:case"end":return r.stop()}}),r,null,[[0,20]])})));return function(){return r.apply(this,arguments)}}();return r(),S.current=r,function(){e=!1,n.abort()}}),[t,q,M,O,i.page,i.perPage,C,F]),[R,y,E,S.current]},A={page:1,perPage:20,total:0},k=function(e){var t=e.errorMessage,n=e.http,r=e.initialPagination,i=void 0===r?A:r,o=e.filterOptions,a=void 0===o?{}:o,u=e.namespaceTypes,c=e.notifications,s=e.showTrustedApps,l=void 0!==s&&s,d=e.showEventFilters,f=void 0!==d&&d,m=e.showHostIsolationExceptions,y=void 0!==m&&m,O=Object(h.useState)([]),I=w()(O,2),j=I[0],E=I[1],T=Object(h.useState)(i),S=w()(T,2),x=S[0],_=S[1],R=Object(h.useState)(!0),N=w()(R,2),P=N[0],k=N[1],L=Object(h.useRef)(),q=Object(h.useMemo)((function(){return u.join(",")}),[u]),M=Object(h.useMemo)((function(){return Object(g.i)({filters:a,namespaceTypes:u,showTrustedApps:l,showEventFilters:f,showHostIsolationExceptions:y})}),[u,a,l,f,y]),C=Object(h.useCallback)(p()(v.a.mark((function e(){var r,i,o,a,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,k(!0),L.current=new AbortController,e.next=5,Object(b.l)({filters:M,http:n,namespaceTypes:q,pagination:{page:x.page,perPage:x.perPage},signal:L.current.signal});case 5:r=e.sent,i=r.page,o=r.per_page,a=r.total,u=r.data,_({page:i,perPage:o,total:a}),E(u),k(!1),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),"AbortError"!==e.t0.name&&(c.toasts.addError(e.t0,{title:t}),E([]),_(A),k(!1));case 18:case"end":return e.stop()}}),e,null,[[0,15]])}))),[t,M,n,q,c.toasts,x.page,x.perPage]);return Object(h.useEffect)((function(){return C(),function(){var e;null===(e=L.current)||void 0===e||e.abort()}}),[C]),[P,j,x,_,C]},L=(Object(O.c)(b.i),Object(O.c)(b.n)),q=function(){return Object(O.a)(L)},M=Object(O.c)(b.o),C=function(){return Object(O.a)(M)},F=Object(O.c)(b.p),D=function(){return Object(O.a)(F)},U=Object(O.c)(b.q),$=function(){return Object(O.a)(U)}},210:function(e,t,n){"use strict";let r;n.d(t,"a",(function(){return r})),function(e){e.appQuery="query",e.alertsPage="alerts.page",e.caseDetails="case.details",e.casePage="case.page",e.filters="filters",e.hostsDetails="hosts.details",e.hostsPage="hosts.page",e.management="management",e.networkDetails="network.details",e.networkPage="network.page",e.overviewPage="overview.page",e.savedQuery="savedQuery",e.sourcerer="sourcerer",e.timeline="timeline",e.timelinePage="timeline.page",e.timerange="timerange",e.unknown="unknown"}(r||(r={}))},211:function(e,t,n){e.exports=n(46)(114)},212:function(e,t,n){"use strict";n.d(t,"h",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"f",(function(){return O})),n.d(t,"i",(function(){return I})),n.d(t,"d",(function(){return j})),n.d(t,"c",(function(){return E})),n.d(t,"g",(function(){return T})),n.d(t,"a",(function(){return S}));var r=n(17),i=n(48),o=n(281),a=n(58),u=n(34),c=n(20),s=n(3),l=n(90),d=n(127);const f=e=>new d.c([e]),p=e=>Object(o.pipe)(c.s.decode(e),Object(r.fold)(Object(u.throwErrors)(f),i.identity)),m=e=>Object(o.pipe)(c.k.decode(e),Object(r.fold)(Object(u.throwErrors)(f),i.identity)),v=async({timelineId:e,timeline:t,version:n})=>{let a=null,d=null;try{d=JSON.stringify({timeline:t,timelineId:e,version:n})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}try{a=await l.b.get().http.patch(s.Tb,{method:"PATCH",body:d})}catch(e){return Promise.resolve((m=e.body,Object(o.pipe)(c.p.decode(m),Object(r.fold)(Object(u.throwErrors)(f),i.identity))))}var m;return p(a)},h=async({timelineId:e,timeline:t,version:n})=>{try{if(Object(a.isEmpty)(e)&&t.status===c.u.draft&&t){var r,i,o,u,d;const e=await y({timelineType:t.timelineType,templateTimelineId:null!==(r=t.templateTimelineId)&&void 0!==r?r:void 0,templateTimelineVersion:null!==(i=t.templateTimelineVersion)&&void 0!==i?i:void 0}),n=p(e),a=t.timelineType===c.x.template?{templateTimelineId:null!==(o=n.data.persistTimeline.timeline.templateTimelineId)&&void 0!==o?o:t.templateTimelineId,templateTimelineVersion:null!==(u=n.data.persistTimeline.timeline.templateTimelineVersion)&&void 0!==u?u:t.templateTimelineVersion}:{};return v({timelineId:n.data.persistTimeline.timeline.savedObjectId,timeline:{...t,...a},version:null!==(d=n.data.persistTimeline.timeline.version)&&void 0!==d?d:""})}return Object(a.isEmpty)(e)?(async({timeline:e})=>{let t;try{t=JSON.stringify({timeline:e})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}const n=await l.b.get().http.post(s.Tb,{method:"POST",body:t});return p(n)})({timeline:t}):v({timelineId:null!=e?e:"-1",timeline:t,version:null!=n?n:""})}catch(e){return 403===e.status_code||403===e.body.status_code?Promise.resolve({data:{persistTimeline:{code:403,message:e.message||e.body.message,timeline:{...t,savedObjectId:"",version:""}}}}):Promise.resolve(e)}},b=async({fileToImport:e,signal:t})=>{const n=new FormData;return n.append("file",e),l.b.get().http.fetch(`${s.Qb}`,{method:"POST",headers:{"Content-Type":void 0},body:n,signal:t})},g=({filename:e="timelines_export.ndjson",ids:t=[],signal:n})=>{let r;try{r=t.length>0?JSON.stringify({ids:t}):void 0}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return l.b.get().http.fetch(`${s.Ob}`,{method:"POST",body:r,query:{file_name:e},signal:n})},y=async({timelineType:e,templateTimelineId:t,templateTimelineVersion:n})=>{let r;const i=e===c.x.template?{templateTimelineId:t,templateTimelineVersion:n}:{};try{r=JSON.stringify({timelineType:e,...i})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}const o=await l.b.get().http.post(s.Nb,{body:r});return p(o)},O=async()=>{const e=await l.b.get().http.post(s.Rb,{});return t=e,Object(o.pipe)(c.D.decode(t),Object(r.fold)(Object(u.throwErrors)(f),i.identity));var t},I=async e=>{const t=await l.b.get().http.get(s.Sb,{query:{id:e}});return n=t,Object(o.pipe)(c.f.decode(n),Object(r.fold)(Object(u.throwErrors)(f),i.identity));var n},j=async e=>{const t=await l.b.get().http.get(s.Tb,{query:{template_timeline_id:e}});return m(t)},E=async(e,t)=>{var n,a,d,p,m,v;const h=await l.b.get().http.fetch(s.Mb,{method:"GET",query:{...e.onlyUserFavorite?{only_user_favorite:e.onlyUserFavorite}:{},...null!=e&&null!==(n=e.pageInfo)&&void 0!==n&&n.pageSize?{page_size:e.pageInfo.pageSize}:{},...null!=e&&null!==(a=e.pageInfo)&&void 0!==a&&a.pageIndex?{page_index:e.pageInfo.pageIndex}:{},...e.search?{search:e.search}:{},...null!=e&&null!==(d=e.sort)&&void 0!==d&&d.sortField?{sort_field:null==e||null===(p=e.sort)||void 0===p?void 0:p.sortField}:{},...null!=e&&null!==(m=e.sort)&&void 0!==m&&m.sortOrder?{sort_order:null==e||null===(v=e.sort)||void 0===v?void 0:v.sortOrder}:{},...e.status?{status:e.status}:{},...e.timelineType?{timeline_type:e.timelineType}:{}},signal:t});return b=h,Object(o.pipe)(c.A.decode(b),Object(r.fold)(Object(u.throwErrors)(f),i.identity));var b},T=async({timelineId:e,templateTimelineId:t,templateTimelineVersion:n,timelineType:a})=>{let d;try{d=JSON.stringify({timelineId:e,templateTimelineId:t,templateTimelineVersion:n,timelineType:a})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}const p=await l.b.get().http.patch(s.Pb,{method:"PATCH",body:d});return m=p,Object(o.pipe)(c.F.decode(m),Object(r.fold)(Object(u.throwErrors)(f),i.identity));var m},S=async e=>{let t;try{t=JSON.stringify({savedObjectIds:e})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return await l.b.get().http.delete(s.Tb,{method:"DELETE",body:t})}},214:function(e,t){function n(e,t,n,r,i,o,a){try{var u=e[o](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function u(e){n(a,i,o,u,c,"next",e)}function c(e){n(a,i,o,u,c,"throw",e)}u(void 0)}))}},e.exports.default=e.exports,e.exports.__esModule=!0},215:function(e,t,n){e.exports=n(828)},219:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l}));const r=e=>"UninitialisedResourceState"===e.type,i=e=>"LoadingResourceState"===e.type,o=e=>"LoadedResourceState"===e.type,a=e=>"FailedResourceState"===e.type,u=e=>r(e)||o(e)||a(e),c=e=>o(e)?e:i(e)?c(e.previousState):a(e)?e.lastLoadedState:void 0,s=e=>a(e)?e.error:void 0,l=(e,t)=>r(e)||o(e)&&!t(e.data)||a(e)&&(!e.lastLoadedState||!t(e.lastLoadedState.data))},231:function(e,t,n){"use strict";n.d(t,"b",(function(){return lt})),n.d(t,"f",(function(){return k})),n.d(t,"a",(function(){return b})),n.d(t,"g",(function(){return Ze})),n.d(t,"c",(function(){return Je})),n.d(t,"e",(function(){return re})),n.d(t,"d",(function(){return ie}));var r={};n.r(r),n.d(r,"buildNode",(function(){return W})),n.d(r,"toElasticsearchQuery",(function(){return V}));var i={};n.r(i),n.d(i,"wildcardSymbol",(function(){return Q})),n.d(i,"buildNode",(function(){return K})),n.d(i,"test",(function(){return H})),n.d(i,"toElasticsearchQuery",(function(){return z})),n.d(i,"toQueryStringQuery",(function(){return J})),n.d(i,"hasLeadingWildcard",(function(){return Y}));var o={};n.r(o),n.d(o,"buildNodeParams",(function(){return ae})),n.d(o,"toElasticsearchQuery",(function(){return ue}));var a={};n.r(a),n.d(a,"buildNodeParams",(function(){return ce})),n.d(a,"toElasticsearchQuery",(function(){return se}));var u={};n.r(u),n.d(u,"buildNodeParams",(function(){return le})),n.d(u,"toElasticsearchQuery",(function(){return de}));var c={};n.r(c),n.d(c,"buildNodeParams",(function(){return fe})),n.d(c,"toElasticsearchQuery",(function(){return pe}));var s={};n.r(s),n.d(s,"buildNodeParams",(function(){return he})),n.d(s,"toElasticsearchQuery",(function(){return be}));var l={};n.r(l),n.d(l,"buildNodeParams",(function(){return ye})),n.d(l,"toElasticsearchQuery",(function(){return Oe}));var d={};n.r(d),n.d(d,"buildNodeParams",(function(){return Ie})),n.d(d,"toElasticsearchQuery",(function(){return je}));var f={};n.r(f),n.d(f,"buildNodeParams",(function(){return Ee})),n.d(f,"toElasticsearchQuery",(function(){return Te}));var p={};n.r(p),n.d(p,"buildNodeParams",(function(){return Se})),n.d(p,"toElasticsearchQuery",(function(){return we}));var m={};n.r(m),n.d(m,"buildNode",(function(){return _e})),n.d(m,"buildNodeWithArgumentNodes",(function(){return Re})),n.d(m,"toElasticsearchQuery",(function(){return Ne}));var v={};n.r(v),n.d(v,"buildNode",(function(){return Pe})),n.d(v,"toElasticsearchQuery",(function(){return Ae}));var h,b,g=n(7),y=n.n(g),O=n(123),I=n.n(O),j=n(58),E=n.n(j),T=n(425),S=n.n(T),w=function(e,t){if("boolean"!=typeof t&&"boolean"===e.type){if([1,"true"].includes(t))return!0;if([0,"false"].includes(t))return!1;throw new Error("".concat(t," is not a valid boolean value for boolean field ").concat(e.name))}return"number"!=typeof t&&"number"===e.type?Number(t):t},x=function(e){var t=Object(j.has)(e,"query.match_phrase"),n=Object(j.get)(e,"query.match",[]),r=void 0!==Object.values(n).find((function(e){return"phrase"===e.type}));return t||r},_=function(e,t){var n=w(e,t);return{script:{source:R(e),lang:e.lang,params:{value:n}}}},R=function(e){return"painless"===e.lang?"boolean compare(Supplier s, def v) {return s.get() == v;}"+"compare(() -> { ".concat(e.script," }, params.value);"):"(".concat(e.script,") == value")};!function(e){e.CUSTOM="custom",e.PHRASES="phrases",e.PHRASE="phrase",e.EXISTS="exists",e.MATCH_ALL="match_all",e.QUERY_STRING="query_string",e.RANGE="range",e.RANGE_FROM_VALUE="range_from_value",e.SPATIAL_FILTER="spatial_filter"}(h||(h={})),function(e){e.APP_STATE="appState",e.GLOBAL_STATE="globalState"}(b||(b={}));var N={gt:">",gte:">=",lte:"<=",lt:"<"},P={gt:"boolean gt(Supplier s, def v) {return s.get() > v}",gte:"boolean gte(Supplier s, def v) {return s.get() >= v}",lte:"boolean lte(Supplier s, def v) {return s.get() <= v}",lt:"boolean lt(Supplier s, def v) {return s.get() < v}"},A={gt:"boolean gt(Supplier s, def v) {return s.get().toInstant().isAfter(Instant.parse(v))}",gte:"boolean gte(Supplier s, def v) {return !s.get().toInstant().isBefore(Instant.parse(v))}",lte:"boolean lte(Supplier s, def v) {return !s.get().toInstant().isAfter(Instant.parse(v))}",lt:"boolean lt(Supplier s, def v) {return s.get().toInstant().isBefore(Instant.parse(v))}"},k=function(e){return function(e){return Boolean(Object(j.keys)(e).find((function(e){return["gte","gt","lte","lt","from","to"].includes(e)})))}(Object(j.get)(e,"query.script.script.params",{}))},L=function(e,t){var n=Object(j.mapValues)(Object(j.pickBy)(t,(function(e,t){return t in N})),(function(t){return"number"===e.type&&"string"==typeof t?parseFloat(t):t})),r=Object(j.map)(n,(function(t,n){return"("+e.script+")"+Object(j.get)(N,n)+n})).join(" && ");if("painless"===e.lang){var i="date"===e.type?A:P,o=Object(j.reduce)(n,(function(e,t,n){return e.concat(Object(j.get)(i,n))}),[]).join(" "),a=Object(j.map)(n,(function(t,n){return"".concat(n,"(() -> { ").concat(e.script," }, params.").concat(n,")")})).join(" && ");r="".concat(o).concat(a)}return{script:{source:r,params:n,lang:e.lang}}};var q=function(e){return function(e){return Object(j.has)(e,"query.exists")}(e)?function(e){return e.query.exists&&e.query.exists.field}(e):x(e)?function(e){var t,n,r=null!==(t=null!==(n=e.query.match_phrase)&&void 0!==n?n:e.query.match)&&void 0!==t?t:{};return Object.keys(r)[0]}(e):function(e){var t;return(null==e||null===(t=e.meta)||void 0===t?void 0:t.type)===h.PHRASES}(e)?function(e){return e.meta.key}(e):function(e){return Object(j.has)(e,"query.range")}(e)?function(e){return e.query.range&&Object.keys(e.query.range)[0]}(e):void 0};var M=function(e){return Object(j.get)(e,"meta.disabled",!1)},C=function(e){return Object(j.omit)(e,["meta","$state"])};function F(e,t){if(function(e){var t,n,r=Object.keys(null!==(t=e.match||(null===(n=e.query)||void 0===n?void 0:n.match))&&void 0!==t?t:{})[0];return Boolean(r&&("phrase"===Object(j.get)(e,["query","match",r,"type"])||"phrase"===Object(j.get)(e,["match",r,"type"])))}(e)){var n=e.match||e.query.match,r=Object.keys(n)[0],i=Object(j.get)(n,[r]),o=i.query;if(t){var a=t.fields.find((function(e){return e.name===r}));a&&(o=w(a,i.query))}return{meta:e.meta,$state:e.$state,query:{match_phrase:y()({},r,Object(j.omit)(I()(I()({},i),{},{query:o}),"type"))}}}return e.query||(e.query={}),e.exists&&(e.query.exists=e.exists,delete e.exists),e.range&&(e.query.range=e.range,delete e.range),e.match_all&&(e.query.match_all=e.match_all,delete e.match_all),Object.keys(e).forEach((function(t){"meta"!==t&&"query"!==t&&"$state"!==t&&(e.query[t]=e[t],delete e[t])})),e}var D=n(149),U=n.n(D),$=n(131),B=n.n($);function W(e){return{type:"literal",value:e}}function V(e){return e.value}var Q="@kuery-wildcard@";function G(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function X(e){return e.replace(/[+-=&|><!(){}[\]^"~*?:\\/]/g,"\\$&")}function K(e){return e.includes(Q)?{type:"wildcard",value:e}:ze(e)}function H(e,t){var n=e.value.split(Q).map(G).join("[\\s\\S]*");return new RegExp("^".concat(n,"$")).test(t)}function z(e){return e.value.split(Q).join("*")}function J(e){return e.value.split(Q).map(X).join("*")}function Y(e){var t=e.value;return t.startsWith(Q)&&t.replace(Q,"").length>0}function Z(e,t){if(!t)return[];if("literal"===e.type){var n=V(e),r=t.fields.find((function(e){return e.name===n}));return r?[r]:[]}return"wildcard"===e.type?t.fields.filter((function(t){return H(e,t.name)})):void 0}var ee=n(75),te=n.n(ee);function ne(e){var t=te.a.tz.guess();return"Browser"===e?t:e}function re(e){var t,n=null==e?void 0:e.subType;return!(null==n||null===(t=n.nested)||void 0===t||!t.path)}function ie(e){return re(e)?e.subType:void 0}function oe(e,t,n){var r=I()(I()({},e),{},{value:n?"".concat(n,".").concat(e.value):e.value});if(!t||"wildcard"===r.type&&!n)return r;var i=Z(r,t).reduce((function(e,t){var r=ie(t),i=null==r?void 0:r.nested.path;return n&&!i?[].concat(U()(e),["".concat(t.name,' is not a nested field but is in nested group "').concat(n,'" in the KQL expression.')]):i&&!n?[].concat(U()(e),["".concat(t.name," is a nested field, but is not in a nested group in the KQL expression.")]):i!==n?[].concat(U()(e),["Nested field ".concat(t.name," is being queried with the incorrect nested path. The correct path is ").concat(null==r?void 0:r.nested.path,".")]):e}),[]);if(i.length>0)throw new Error(i.join("\n"));return r}function ae(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(j.isUndefined)(e))throw new Error("fieldName is a required argument");if(Object(j.isUndefined)(t))throw new Error("value is a required argument");var r="string"==typeof e?ze(e):W(e),i="string"==typeof t?ze(t):W(t),o=W(n);return{arguments:[r,i,o]}}function ue(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=B()(e.arguments,3),o=i[0],a=i[1],u=i[2],c="wildcard"===a.type&&a.value===Q,s="wildcard"===o.type&&o.value===Q,l=c&&s;if(l)return{match_all:{}};var d=oe(o,t,null!=r&&r.nested?r.nested.path:void 0),f=Object(j.isUndefined)(a)?a:Ye(a),p=u.value?"phrase":"best_fields";if(null===d.value)return"wildcard"===a.type?{query_string:{query:J(a)}}:{multi_match:{type:p,query:f,lenient:!0}};var m=t?Z(d,t):[];if(m&&0===m.length&&m.push({name:Ye(d),scripted:!1,type:""}),c&&(null==m||!m.length||(null==m?void 0:m.length)===(null==t?void 0:t.fields.length)))return{match_all:{}};var v=m.reduce((function(e,t){var i=function(e){var n=ie(t);return"wildcard"!==d.type||null==n||!n.nested||null!=r&&r.nested?e:{nested:{path:n.nested.path,query:e,score_mode:"none"}}};if(!t.scripted){if(c)return[].concat(U()(e),[i({exists:{field:t.name}})]);if("wildcard"===a.type)return[].concat(U()(e),[i({query_string:{fields:[t.name],query:J(a)}})]);if("date"===t.type){var o=n.dateFormatTZ?{time_zone:ne(n.dateFormatTZ)}:{};return[].concat(U()(e),[i({range:y()({},t.name,I()({gte:f,lte:f},o))})])}var u="phrase"===p?"match_phrase":"match";return[].concat(U()(e),[i(y()({},u,y()({},t.name,f)))])}if(!c)return[].concat(U()(e),[{script:I()({},_(t,f))}])}),[]);return{bool:{should:v||[],minimum_should_match:1}}}function ce(e){return{arguments:e}}function se(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.filtersInMustClause,o=e.arguments||[],a=i?"must":"filter";return{bool:y()({},a,o.map((function(e){return Ye(e,t,n,r)})))}}function le(e){return{arguments:e}}function de(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.arguments||[];return{bool:{should:i.map((function(e){return Ye(e,t,n,r)})),minimum_should_match:1}}}function fe(e){return{arguments:[e]}}function pe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=B()(e.arguments,1),o=i[0];return{bool:{must_not:Ye(o,t,n,r)}}}var me=n(426),ve=n.n(me);function he(e,t){var n=Object(j.pick)(t,"gt","lt","gte","lte","format"),r="string"==typeof e?ze(e):ke.literal.buildNode(e),i=Object(j.map)(n,(function(e,t){return ke.namedArg.buildNode(t,e)}));return{arguments:[r].concat(U()(i))}}function be(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=ve()(e.arguments),o=i[0],a=i.slice(1),u=oe(o,t,null!=r&&r.nested?r.nested.path:void 0),c=t?Z(u,t):[],s=ge(a),l=Object(j.mapValues)(s,(function(e){return Ye(e)}));c&&0===c.length&&c.push({name:Ye(u),scripted:!1,type:""});var d=c.map((function(e){var t=function(t){var n=ie(e);return"wildcard"!==u.type||null==n||!n.nested||r.nested?t:{nested:{path:n.nested.path,query:t,score_mode:"none"}}};if(e.scripted)return{script:L(e,l)};if("date"===e.type){var i=n.dateFormatTZ?{time_zone:ne(n.dateFormatTZ)}:{};return t({range:y()({},e.name,I()(I()({},l),i))})}return t({range:y()({},e.name,l)})}));return{bool:{should:d,minimum_should_match:1}}}function ge(e){if(e.gt&&e.gte||e.lt&&e.lte)throw new Error("range ends cannot be both inclusive and exclusive");var t=["gte","lte","format"];return e.reduce((function(e,n,r){return"namedArg"===n.type?e[n.name]=n.value:e[t[r]]=n,e}),{})}function ye(e){return{arguments:[W(e)]}}function Oe(e,t){var n,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=B()(e.arguments,1),o=i[0],a=I()(I()({},o),{},{value:null!=r&&r.nested?"".concat(r.nested.path,".").concat(o.value):o.value}),u=V(a),c=null==t||null===(n=t.fields)||void 0===n?void 0:n.find((function(e){return e.name===u}));if(null!=c&&c.scripted)throw new Error("Exists query does not support scripted fields");return{exists:{field:u}}}function Ie(e,t){t=E.a.pick(t,"topLeft","bottomRight");var n=ke.literal.buildNode(e),r=E.a.map(t,(function(e,t){var n="".concat(e.lat,", ").concat(e.lon);return ke.namedArg.buildNode(t,n)}));return{arguments:[n].concat(U()(r))}}function je(e,t){var n,r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=ve()(e.arguments),a=o[0],u=o.slice(1),c=I()(I()({},a),{},{value:null!=i&&i.nested?"".concat(i.nested.path,".").concat(a.value):a.value}),s=ke.literal.toElasticsearchQuery(c),l=null!==(n=null==t?void 0:t.fields)&&void 0!==n?n:[],d=l.find((function(e){return e.name===s})),f=u.reduce((function(e,t){var n=E.a.snakeCase(t.name);return I()(I()({},e),{},y()({},n,Ye(t)))}),{});if(null!=d&&d.scripted)throw new Error("Geo bounding box query does not support scripted fields");return{geo_bounding_box:(r={},y()(r,s,f),y()(r,"ignore_unmapped",!0),r)}}function Ee(e,t){var n=ke.literal.buildNode(e),r=t.map((function(e){var t="".concat(e.lat,", ").concat(e.lon);return ke.literal.buildNode(t)}));return{arguments:[n].concat(U()(r))}}function Te(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=ve()(e.arguments),u=a[0],c=a.slice(1),s=I()(I()({},u),{},{value:null!=o&&o.nested?"".concat(o.nested.path,".").concat(u.value):u.value}),l=ke.literal.toElasticsearchQuery(s),d=null!==(n=null==t?void 0:t.fields)&&void 0!==n?n:[],f=d.find((function(e){return e.name===l})),p={points:c.map((function(e){return Ye(e,t,i,o)}))};if(null!=f&&f.scripted)throw new Error("Geo polygon query does not support scripted fields");return{geo_polygon:(r={},y()(r,l,p),y()(r,"ignore_unmapped",!0),r)}}function Se(e,t){return{arguments:["string"==typeof e?ze(e):W(e),t]}}function we(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=B()(e.arguments,2),a=o[0],u=o[1],c=Ye(a),s=null!=i&&null!==(n=i.nested)&&void 0!==n&&n.path?"".concat(i.nested.path,".").concat(c):c;return{nested:{path:s,query:Ye(u,t,r,I()(I()({},i),{},{nested:{path:s}})),score_mode:"none"}}}var xe={is:o,and:a,or:u,not:c,range:s,exists:l,geoBoundingBox:d,geoPolygon:f,nested:p};function _e(e){var t=xe[e];if(E.a.isUndefined(t))throw new Error('Unknown function "'.concat(e,'"'));for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return I()({type:"function",function:e},t.buildNodeParams.apply(t,r))}function Re(e,t){if(E.a.isUndefined(xe[e]))throw new Error('Unknown function "'.concat(e,'"'));return{type:"function",function:e,arguments:t}}function Ne(e,t,n,r){return xe[e.function].toElasticsearchQuery(e,t,n,r)}function Pe(e,t){return{type:"namedArg",name:e,value:"literal"===E.a.get(t,"type")?t:ke.literal.buildNode(t)}}function Ae(e){return Ye(e.value)}var ke={function:m,literal:r,namedArg:v,wildcard:i},Le=n(820),qe=n.n(Le),Me=n(565),Ce=n.n(Me),Fe=n(821),De=n.n(Fe),Ue=n(822),$e=n.n(Ue),Be=n(566),We=n.n(Be),Ve=n(2),Qe=Ve.i18n.translate("esQuery.kql.errors.endOfInputText",{defaultMessage:"end of input"}),Ge={fieldName:Ve.i18n.translate("esQuery.kql.errors.fieldNameText",{defaultMessage:"field name"}),value:Ve.i18n.translate("esQuery.kql.errors.valueText",{defaultMessage:"value"}),literal:Ve.i18n.translate("esQuery.kql.errors.literalText",{defaultMessage:"literal"}),whitespace:Ve.i18n.translate("esQuery.kql.errors.whitespaceText",{defaultMessage:"whitespace"})},Xe=function(e){De()(n,e);var t=$e()(n);function n(e,r){var i;qe()(this,n);var o=e.message;if(e.expected){var a=e.expected.map((function(e){var t,n="other"===(t=e).type?t.description:"literal"===t.type?'"'.concat(t.text,'"'):"end"===t.type?"end of input":t.text||t.description||"";return Ge[n]||n})),u=Object(j.uniq)(a).filter((function(e){return void 0!==e})).sort().join(", ");o=Ve.i18n.translate("esQuery.kql.errors.syntaxError",{defaultMessage:"Expected {expectedList} but {foundInput} found.",values:{expectedList:u,foundInput:e.found?'"'.concat(e.found,'"'):Qe}})}var c=[o,r,Object(j.repeat)("-",e.location.start.offset)+"^"].join("\n");return i=t.call(this,c),y()(Ce()(i),"shortMessage",void 0),i.name="KQLSyntaxError",i.shortMessage=o,i}return n}(We()(Error)),Ke=n(567),He=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ke.parse;if(void 0===e)throw new Error("expression must be a string, got undefined instead");return n(e,I()(I()({},t),{},{helpers:{nodeTypes:ke}}))},ze=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return He(e,I()(I()({},t),{},{startRule:"Literal"}),Ke.parse)},Je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return He(e,t,Ke.parse)}catch(t){throw"SyntaxError"===t.name?new Xe(t,e):t}},Ye=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!t||!t.type||!ke[t.type])return e(ke.function.buildNode("and",[]),n);var o=ke[t.type];return o.toElasticsearchQuery(t,n,r,i)},Ze=function(){return Ye.apply(void 0,arguments)};function et(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=t.map((function(e){return Je(e.query,{allowLeadingWildcards:n})}));return tt(e,o,{dateFormatTZ:r,filtersInMustClause:i})}function tt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=ke.function.buildNode("and",t),i=Ze(r,e,n);return Object.assign({must:[],filter:[],should:[],must_not:[]},i.bool)}function nt(e,t){var n,r;return null===(n=e.meta)||void 0===n||!n.key||!t||("custom"===(null===(r=e.meta)||void 0===r?void 0:r.type)?e.meta.index===t.id:t.fields.some((function(t){return t.name===e.meta.key})))}var rt=function(e,t){if(!t)return e;var n=q(e);if(!n)return e;var r=t.fields.find((function(e){return e.name===n})),i=r&&ie(r);if(!i)return e;var o=C(e);return{meta:e.meta,query:{nested:{path:i.nested.path,query:o.query||o}}}},it=function(e){return function(t){return Object(j.isUndefined)(t.meta)||Object(j.isUndefined)(t.meta.negate)?!e:t.meta&&t.meta.negate===e}},ot=function(e){return e.query||e},at=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=e.filter((function(e){return e&&!M(e)}));var r=function(r){return e.filter((function(e){return!!e})).filter(it(r)).filter((function(e){return!n||nt(e,t)})).map((function(e){return F(e,t)})).map((function(e){return rt(e,t)})).map(C).map(ot)};return{must:[],filter:r(!1),should:[],must_not:r(!0)}};function ut(e,t,n){return function(e){return Object(j.has)(e,"query_string.query")}(e)&&("string"==typeof t&&(t=JSON.parse(t)),Object(j.extend)(e.query_string,t),n&&Object(j.defaults)(e.query_string,{time_zone:ne(n)})),e}function ct(e,t,n){return{must:(e||[]).map((function(e){return ut(function(e){return Object(j.isString)(e)?""===e.trim()?{match_all:{}}:{query_string:{query:e}}:e}(e.query),t,n)})),filter:[],should:[],must_not:[]}}function st(e){return e.filter((function(e){return!e||"object"!==S()(e)||!Object(j.isEqual)(e,{match_all:{}})}))}function lt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{allowLeadingWildcards:!1,queryStringOptions:{},ignoreFilterIfFieldNotInIndex:!1};t=Array.isArray(t)?t:[t],n=Array.isArray(n)?n:[n];var i=t.filter((function(e){return Object(j.has)(e,"query")})),o=Object(j.groupBy)(i,"language"),a=et(e,o.kuery,r.allowLeadingWildcards,r.dateFormatTZ,r.filtersInMustClause),u=ct(o.lucene,r.queryStringOptions,r.dateFormatTZ),c=at(n,e,r.ignoreFilterIfFieldNotInIndex);return{bool:{must:st([].concat(U()(a.must),U()(u.must),U()(c.must))),filter:st([].concat(U()(a.filter),U()(u.filter),U()(c.filter))),should:st([].concat(U()(a.should),U()(u.should),U()(c.should))),must_not:[].concat(U()(a.must_not),U()(u.must_not),U()(c.must_not))}}}},232:function(e,t,n){"use strict";n.d(t,"o",(function(){return o})),n.d(t,"n",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return x})),n.d(t,"i",(function(){return M})),n.d(t,"j",(function(){return C})),n.d(t,"m",(function(){return T})),n.d(t,"c",(function(){return $})),n.d(t,"k",(function(){return B})),n.d(t,"l",(function(){return W})),n.d(t,"h",(function(){return V})),n.d(t,"g",(function(){return Q}));var r=n(2),i=n(154),o={message:r.i18n.translate("lists.exceptions.isOperatorLabel",{defaultMessage:"is"}),operator:i.b.INCLUDED,type:i.c.MATCH,value:"is"},a={message:r.i18n.translate("lists.exceptions.isNotOperatorLabel",{defaultMessage:"is not"}),operator:i.b.EXCLUDED,type:i.c.MATCH,value:"is_not"},u={message:r.i18n.translate("lists.exceptions.isOneOfOperatorLabel",{defaultMessage:"is one of"}),operator:i.b.INCLUDED,type:i.c.MATCH_ANY,value:"is_one_of"},c={message:r.i18n.translate("lists.exceptions.isNotOneOfOperatorLabel",{defaultMessage:"is not one of"}),operator:i.b.EXCLUDED,type:i.c.MATCH_ANY,value:"is_not_one_of"},s={message:r.i18n.translate("lists.exceptions.existsOperatorLabel",{defaultMessage:"exists"}),operator:i.b.INCLUDED,type:i.c.EXISTS,value:"exists"},l={message:r.i18n.translate("lists.exceptions.doesNotExistOperatorLabel",{defaultMessage:"does not exist"}),operator:i.b.EXCLUDED,type:i.c.EXISTS,value:"does_not_exist"},d={message:r.i18n.translate("lists.exceptions.isInListOperatorLabel",{defaultMessage:"is in list"}),operator:i.b.INCLUDED,type:i.c.LIST,value:"is_in_list"},f={message:r.i18n.translate("lists.exceptions.isNotInListOperatorLabel",{defaultMessage:"is not in list"}),operator:i.b.EXCLUDED,type:i.c.LIST,value:"is_not_in_list"},p=[o,a,u,c],m=[o,a,u,c,s,l,d,f],v=n(123),h=n.n(v),b=n(131),g=n.n(b),y=n(7),O=n.n(y),I=n(149),j=n.n(I),E=n(19),T=function(e){return e.filter((function(e){return"list"===e.type})).length>0},S=function(e,t){return function(e,t){var n=e.map((function(e){return[{field:"host.os.type",operator:"included",type:"match",value:e}].concat(j()(t))})),r=e.map((function(e){return[{field:"host.os.name.caseless",operator:"included",type:"match",value:e}].concat(j()(t))}));return[].concat(j()(n),j()(r))}(e,t).map((function(e){return{bool:{filter:e.map((function(e){return P(e)}))}}}))},w=function(e){return e.flatMap((function(e){return function(e){var t=e.entries,n=e.os_types;return null!=n&&n.length>0?S(n,t):1===t.length?[P(t[0])]:[{bool:{filter:t.map((function(e){return P(e)}))}}]}(e)}))},x=function(e){var t=e.lists,n=e.excludeExceptions,r=e.chunkSize,i=t.filter((function(e){return!T(e.entries)})),o={meta:{alias:null,disabled:!1,negate:n},query:{bool:{should:void 0}}};if(0!==i.length){if(i.length<=r){var a=w(i);return o.query.bool.should=a,o}return{meta:{alias:null,disabled:!1,negate:n},query:{bool:{should:function(e,t){return Object(E.chunk)(t,e)}(i,r).map((function(e){return{meta:{alias:null,disabled:!1,negate:!1},query:{bool:{should:w(e)}}}})).map((function(e){return e.query}))}}}}},_=function(e){return{bool:{must_not:e}}},R=function(e){var t=e.operator,n=function(e){var t=e.field,n=e.value;return 1===n.length?{bool:{minimum_should_match:1,should:[{match_phrase:O()({},t,n[0])}]}}:{bool:{minimum_should_match:1,should:n.map((function(e){return{bool:{minimum_should_match:1,should:[{match_phrase:O()({},t,e)}]}}}))}}}(e);return"excluded"===t?_(n):n},N=function(e,t){if(1===e.length){var n=g()(e,1)[0],r=P(n,t);return i=r,null!=Object.keys(i).includes("bool")?r:{bool:{}}}var i;return{bool:{filter:e.map((function(e){return P(e,t)}))}}},P=function(e,t){if(i.i.is(e)){var n=null!=t?"".concat(t,".").concat(e.field):e.field;return function(e){var t={bool:{minimum_should_match:1,should:[{exists:{field:e.field}}]}};return"excluded"===e.operator?_(t):t}(h()(h()({},e),{},{field:n}))}if(i.k.is(e)){var r=null!=t?"".concat(t,".").concat(e.field):e.field;return function(e){var t=e.field,n=e.operator,r=e.value,i={bool:{minimum_should_match:1,should:[{match_phrase:O()({},t,r)}]}};return"excluded"===n?_(i):i}(h()(h()({},e),{},{field:r}))}if(i.l.is(e)){var o=null!=t?"".concat(t,".").concat(e.field):e.field;return R(h()(h()({},e),{},{field:o}))}if(i.m.is(e))return function(e){var t=e.field,n=e.entries;return{nested:{path:t,query:N(n,t),score_mode:"none"}}}(e);throw new TypeError("Unexpected exception entry: ".concat(e))},A=n(137),k=A.k,L=A.l,q=function(e){return e.namespaceType.map((function(e){return function(e){return"agnostic"===e.namespaceType?L:k}({namespaceType:e})}))},M=function(e){var t=e.filters,n=e.namespaceTypes,r=e.showTrustedApps,i=e.showEventFilters,o=e.showHostIsolationExceptions,a=q({namespaceType:n});return[function(e,t){return Object.keys(e).map((function(n){var r=Object(E.get)(n,e);if(null!=r&&""!==r.trim()){var i=t.map((function(e){var t="name"===n?"name.text":n;return"".concat(e,".attributes.").concat(t,":").concat(r)})).join(" OR ");return"(".concat(i,")")}return null})).filter((function(e){return null!=e})).join(" AND ")}(t,a),function(e,t){if(e){var n=t.map((function(e){return"".concat(e,".attributes.list_id: ").concat(A.i,"*")}));return"(".concat(n.join(" OR "),")")}var r=t.map((function(e){return"not ".concat(e,".attributes.list_id: ").concat(A.i,"*")}));return"(".concat(r.join(" AND "),")")}(r,a),function(e,t){if(e){var n=t.map((function(e){return"".concat(e,".attributes.list_id: ").concat(A.b,"*")}));return"(".concat(n.join(" OR "),")")}var r=t.map((function(e){return"not ".concat(e,".attributes.list_id: ").concat(A.b,"*")}));return"(".concat(r.join(" AND "),")")}(i,a),function(e,t){if(e){var n=t.map((function(e){return"".concat(e,".attributes.list_id: ").concat(A.e,"*")}));return"(".concat(n.join(" OR "),")")}var r=t.map((function(e){return"not ".concat(e,".attributes.list_id: ").concat(A.e,"*")}));return"(".concat(r.join(" AND "),")")}(o,a)].filter((function(e){return""!==e.trim()})).join(" AND ")},C=function(e){var t=e.lists,n=e.showDetection,r=e.showEndpoint;return t.filter((function(e){return n?"detection"===e.type:!r||"endpoint"===e.type})).reduce((function(e,t){var n=t.listId,r=t.namespaceType;return{ids:[].concat(j()(e.ids),[n]),namespaces:[].concat(j()(e.namespaces),[r])}}),{ids:[],namespaces:[]})},F=(n(833),n(24)),D=n.n(F),U=n(363),$=(n(351),n(231),function(e){return e.map((function(e){return"nested"===e.type?Object(U.addIdToItem)(h()(h()({},e),{},{entries:e.entries.map((function(e){return Object(U.addIdToItem)(e)}))})):Object(U.addIdToItem)(e)}))}),B=function(e){var t=e.listId,n=e.namespaceType,r=e.ruleName;return{comments:[],description:"".concat(r," - exception list item"),entries:$([{field:"",operator:"included",type:"match",value:""}]),item_id:void 0,list_id:t,meta:{temporaryUuid:D.a.v4()},name:"".concat(r," - exception list item"),namespace_type:n,tags:[],type:"simple"}},W=function(e){switch(e.type){case"match":return i.c.MATCH;case"match_any":return i.c.MATCH_ANY;case"list":return i.c.LIST;default:return i.c.EXISTS}},V=function(e){if("nested"===e.type)return o;var t=W(e),n=m.find((function(n){return e.operator===n.operator&&t===n.type}));return null!=n?n:o},Q=function(e){switch(e.type){case i.c.MATCH:case i.c.MATCH_ANY:return e.value;case i.c.EXISTS:return;case i.c.LIST:return e.list.id;default:return}}},233:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return v})),n.d(t,"b",(function(){return g}));var r={};n.r(r),n.d(r,"registerProvider",(function(){return u})),n.d(r,"unRegisterProvider",(function(){return c})),n.d(r,"noProviderFound",(function(){return s}));var i={};n.r(i),n.d(i,"getDataProvidersSelector",(function(){return f}));var o=n(29);const a=n.n(o)()("x-pack/security_solution/local/drag_and_drop"),u=a("REGISTER_PROVIDER"),c=a("UNREGISTER_PROVIDER"),s=a("NO_PROVIDER_FOUND");var l=n(112);const d=e=>e.dragAndDrop.dataProviders,f=()=>Object(l.createSelector)(d,(e=>e));var p=n(19),m=n(241);const v={dataProviders:{}},h=({provider:e,dataProviders:t})=>({...t,[e.id]:e}),b=({id:e,dataProviders:t})=>Object(p.omit)(e,t),g=Object(m.reducerWithInitialState)(v).case(u,((e,{provider:t})=>({...e,dataProviders:h({provider:t,dataProviders:e.dataProviders})}))).case(c,((e,{id:t})=>({...e,dataProviders:b({id:t,dataProviders:e.dataProviders})}))).build()},239:function(e,t,n){"use strict";n.r(t),n.d(t,"updateNote",(function(){return o})),n.d(t,"addNotes",(function(){return a})),n.d(t,"addError",(function(){return u})),n.d(t,"removeError",(function(){return c})),n.d(t,"addErrorHash",(function(){return s}));var r=n(29);const i=n.n(r)()("x-pack/security_solution/local/app"),o=i("UPDATE_NOTE"),a=i("ADD_NOTE"),u=i("ADD_ERRORS"),c=i("REMOVE_ERRORS"),s=i("ADD_ERROR_HASH")},240:function(e,t,n){"use strict";function r(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}e.exports=function(e,t){var n;void 0===t&&(t=r);var i,o=[],a=!1;return function(){for(var r=[],u=0;u<arguments.length;u++)r[u]=arguments[u];return a&&n===this&&t(r,o)||(i=e.apply(this,r),a=!0,n=this,o=r),i}}},241:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(e){var t={},n=o(e,t);return n.caseWithAction=function(e,r){return t[e.type]=r,n},n.case=function(e,t){return n.caseWithAction(e,(function(e,n){return t(e,n.payload)}))},n.casesWithAction=function(e,t){for(var r=0,i=e;r<i.length;r++){var o=i[r];n.caseWithAction(o,t)}return n},n.cases=function(e,t){return n.casesWithAction(e,(function(e,n){return t(e,n.payload)}))},n.withHandling=function(e){return e(n)},n.default=function(n){return o(e,r({},t),n)},n.build=function(){return o(e,r({},t))},n}function o(e,t,n){return function(r,i){var o=void 0!==r?r:e,a=t[i.type]||n;return a?a(o,i):o}}Object.defineProperty(t,"__esModule",{value:!0}),t.reducerWithInitialState=function(e){return i(e)},t.reducerWithoutInitialState=function(){return i()},t.upcastingReducer=function(){return i()}},242:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7),i=n.n(r),o=n(20);const a=new class ActiveTimelineEvents{constructor(){i()(this,"_activePage",0),i()(this,"_expandedDetail",{}),i()(this,"_pageName",""),i()(this,"_request",null),i()(this,"_response",null),i()(this,"_eqlRequest",null),i()(this,"_eqlResponse",null)}getActivePage(){return this._activePage}setActivePage(e){this._activePage=e}getExpandedDetail(){return this._expandedDetail}toggleExpandedDetail(e){const t=o.w.query,n=this._expandedDetail[t];let r;var i,a;if("eventDetail"===(null==n?void 0:n.panelView))r="eventDetail"===(null==e?void 0:e.panelView)&&(null==e||null===(i=e.params)||void 0===i?void 0:i.eventId)===(null==n||null===(a=n.params)||void 0===a?void 0:a.eventId);else if("hostDetail"===(null==n?void 0:n.panelView)){var u,c;r="hostDetail"===(null==e?void 0:e.panelView)&&(null==e||null===(u=e.params)||void 0===u?void 0:u.hostName)===(null==n||null===(c=n.params)||void 0===c?void 0:c.hostName)}else if("networkDetail"===(null==n?void 0:n.panelView)){var s,l;r="networkDetail"===(null==e?void 0:e.panelView)&&(null==e||null===(s=e.params)||void 0===s?void 0:s.ip)===(null==n||null===(l=n.params)||void 0===l?void 0:l.ip)}this._expandedDetail=r?{}:{[t]:{...e}}}setExpandedDetail(e){this._expandedDetail=e}getPageName(){return this._pageName}setPageName(e){this._pageName=e}getRequest(){return this._request}setRequest(e){this._request=e}getResponse(){return this._response}setResponse(e){this._response=e}getEqlRequest(){return this._eqlRequest}setEqlRequest(e){this._eqlRequest=e}getEqlResponse(){return this._eqlResponse}setEqlResponse(e){this._eqlResponse=e}}},245:function(e,t,n){"use strict";n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"m",(function(){return l})),n.d(t,"t",(function(){return d})),n.d(t,"q",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"l",(function(){return h})),n.d(t,"o",(function(){return b})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return y})),n.d(t,"r",(function(){return O})),n.d(t,"i",(function(){return I})),n.d(t,"h",(function(){return j})),n.d(t,"u",(function(){return E})),n.d(t,"v",(function(){return T})),n.d(t,"a",(function(){return S})),n.d(t,"s",(function(){return w})),n.d(t,"c",(function(){return x})),n.d(t,"x",(function(){return _})),n.d(t,"e",(function(){return R})),n.d(t,"y",(function(){return N})),n.d(t,"j",(function(){return P})),n.d(t,"w",(function(){return A})),n.d(t,"z",(function(){return k})),n.d(t,"d",(function(){return L}));var r=n(112),i=n(219),o=n(106);const a=e=>e.listPage,u=Object(r.createSelector)(a,(e=>e.active)),c=e=>e.listPage.data,s=Object(r.createSelector)(c,(e=>{var t;return null===(t=Object(i.b)(e))||void 0===t?void 0:t.data.content})),l=Object(r.createSelector)(s,(e=>(null==e?void 0:e.data)||[])),d=Object(r.createSelector)(s,(e=>(null==e?void 0:e.total)||0)),f=Object(r.createSelector)(c,(e=>{var t,n;return null!==(t=null===(n=Object(i.b)(e))||void 0===n?void 0:n.data.query)&&void 0!==t?t:{}})),p=Object(r.createSelector)(s,(e=>{var t,n,r;return{totalItemCount:null!==(t=null==e?void 0:e.total)&&void 0!==t?t:0,pageSize:null!==(n=null==e?void 0:e.per_page)&&void 0!==n?n:o.c,pageSizeOptions:[...o.d],pageIndex:(null!==(r=null==e?void 0:e.page)&&void 0!==r?r:1)-1}})),m=Object(r.createSelector)(c,(e=>Object(i.c)(e)&&e.error||void 0)),v=({listPage:{dataExist:e}})=>e,h=Object(r.createSelector)(c,v,((e,t)=>Object(i.e)(e)||Object(i.e)(t))),b=Object(r.createSelector)(v,(e=>{var t;return!(null===(t=Object(i.b)(e))||void 0===t||!t.data)})),g=e=>e.form.entry,y=Object(r.createSelector)((e=>e.form.entry),(e=>e)),O=Object(r.createSelector)((e=>e.form.newComment),(e=>e)),I=e=>e.form.hasNameError,j=e=>e.form.hasItemsError||e.form.hasNameError||e.form.hasOSError,E=e=>Object(i.e)(e.form.submissionResourceState),T=e=>Object(i.d)(e.form.submissionResourceState),S=e=>{const t=e.form.submissionResourceState;return Object(i.c)(t)?t.error:void 0},w=Object(r.createSelector)((e=>e.form.submissionResourceState),(e=>e)),x=e=>e.location,_=Object(r.createSelector)(x,f,(e=>e.listPage.forceRefresh),((e,t,n)=>n||e.page_index+1!==t.page||e.page_size!==t.perPage)),R=Object(r.createSelector)(a,(e=>e.deletion)),N=Object(r.createSelector)(R,(({item:e})=>Boolean(e))),P=Object(r.createSelector)(R,(({item:e})=>e)),A=Object(r.createSelector)(R,(({status:e})=>Object(i.e)(e))),k=Object(r.createSelector)(R,(({status:e})=>Object(i.d)(e))),L=Object(r.createSelector)(R,(({status:e})=>{if(Object(i.c)(e))return e.error}))},259:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n(19);n(90);const i="timelines",o={},a=e=>({...e,initialWidth:Number.isInteger(e.width)&&!Number.isInteger(e.initialWidth)?e.width:e.initialWidth}),u=e=>({...e,displayAsText:Object(r.isEmpty)(e.label)||null!=e.displayAsText?e.displayAsText:e.label}),c=(e,t)=>{const n=e.get(i);return n?t.reduce(((e,t)=>{const r=n[t];return r?{...e,[t]:{...r,...null==r.sort||Array.isArray(r.sort)?{}:{sort:[r.sort]},...Array.isArray(r.columns)?{columns:r.columns.map(a).map(u)}:{}}}:{...e}}),{}):o},s=e=>{var t;return null!==(t=e.get(i))&&void 0!==t?t:{}},l=(e,t,n)=>{const r=d(n),o=s(e);e.set(i,{...o,[t]:r})},d=e=>{const{documentType:t,filterManager:n,isLoading:r,loadingText:i,queryFields:o,selectAll:a,unit:u,...c}=e;return c}},279:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const r=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},i=["http:","https:"],o=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(i.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0}},281:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pipeable=t.pipe=void 0;var r=n(48);t.pipe=r.pipe;t.pipeable=function(e){var t={};if(function(e){return"function"==typeof e.map}(e)){t.map=function(t){return function(n){return e.map(n,t)}}}if(function(e){return"function"==typeof e.contramap}(e)){t.contramap=function(t){return function(n){return e.contramap(n,t)}}}if(function(e){return"function"==typeof e.mapWithIndex}(e)){t.mapWithIndex=function(t){return function(n){return e.mapWithIndex(n,t)}}}if(function(e){return"function"==typeof e.ap}(e)){t.ap=function(t){return function(n){return e.ap(n,t)}},t.apFirst=function(t){return function(n){return e.ap(e.map(n,(function(e){return function(){return e}})),t)}},t.apSecond=function(t){return function(n){return e.ap(e.map(n,(function(){return function(e){return e}})),t)}}}if(function(e){return"function"==typeof e.chain}(e)){t.chain=function(t){return function(n){return e.chain(n,t)}},t.chainFirst=function(t){return function(n){return e.chain(n,(function(n){return e.map(t(n),(function(){return n}))}))}},t.flatten=function(t){return e.chain(t,r.identity)}}if(function(e){return"function"==typeof e.bimap}(e)){t.bimap=function(t,n){return function(r){return e.bimap(r,t,n)}},t.mapLeft=function(t){return function(n){return e.mapLeft(n,t)}}}if(function(e){return"function"==typeof e.extend}(e)){t.extend=function(t){return function(n){return e.extend(n,t)}},t.duplicate=function(t){return e.extend(t,r.identity)}}if(function(e){return"function"==typeof e.reduce}(e)){t.reduce=function(t,n){return function(r){return e.reduce(r,t,n)}},t.foldMap=function(t){var n=e.foldMap(t);return function(e){return function(t){return n(t,e)}}},t.reduceRight=function(t,n){return function(r){return e.reduceRight(r,t,n)}}}if(function(e){return"function"==typeof e.reduceWithIndex}(e)){t.reduceWithIndex=function(t,n){return function(r){return e.reduceWithIndex(r,t,n)}},t.foldMapWithIndex=function(t){var n=e.foldMapWithIndex(t);return function(e){return function(t){return n(t,e)}}},t.reduceRightWithIndex=function(t,n){return function(r){return e.reduceRightWithIndex(r,t,n)}}}if(function(e){return"function"==typeof e.alt}(e)){t.alt=function(t){return function(n){return e.alt(n,t)}}}if(function(e){return"function"==typeof e.compact}(e)&&(t.compact=e.compact,t.separate=e.separate),function(e){return"function"==typeof e.filter}(e)){t.filter=function(t){return function(n){return e.filter(n,t)}},t.filterMap=function(t){return function(n){return e.filterMap(n,t)}},t.partition=function(t){return function(n){return e.partition(n,t)}},t.partitionMap=function(t){return function(n){return e.partitionMap(n,t)}}}if(function(e){return"function"==typeof e.filterWithIndex}(e)){t.filterWithIndex=function(t){return function(n){return e.filterWithIndex(n,t)}},t.filterMapWithIndex=function(t){return function(n){return e.filterMapWithIndex(n,t)}},t.partitionWithIndex=function(t){return function(n){return e.partitionWithIndex(n,t)}},t.partitionMapWithIndex=function(t){return function(n){return e.partitionMapWithIndex(n,t)}}}if(function(e){return"function"==typeof e.promap}(e)){t.promap=function(t,n){return function(r){return e.promap(r,t,n)}}}if(function(e){return"function"==typeof e.compose}(e)){t.compose=function(t){return function(n){return e.compose(n,t)}}}if(function(e){return"function"==typeof e.throwError}(e)){t.fromOption=function(t){return function(n){return"None"===n._tag?e.throwError(t()):e.of(n.value)}},t.fromEither=function(t){return"Left"===t._tag?e.throwError(t.left):e.of(t.right)},t.fromPredicate=function(t,n){return function(r){return t(r)?e.of(r):e.throwError(n(r))}},t.filterOrElse=function(t,n){return function(r){return e.chain(r,(function(r){return t(r)?e.of(r):e.throwError(n(r))}))}}}return t}},314:function(e,t,n){"use strict";var r=n(164);n.d(t,"a",(function(){return r.c}));var i=n(233);n.d(t,"b",(function(){return i.c}));var o=n(156);n.d(t,"c",(function(){return o.d}));var a=n(135);n.d(t,"d",(function(){return a.d}))},315:function(e,t,n){"use strict";n.r(t),n.d(t,"getManageTimelineById",(function(){return o})),n.d(t,"selectTimeline",(function(){return u})),n.d(t,"selectInsertTimeline",(function(){return c})),n.d(t,"autoSaveMsgSelector",(function(){return s})),n.d(t,"timelineByIdSelector",(function(){return l})),n.d(t,"getShowCallOutUnauthorizedMsg",(function(){return d})),n.d(t,"getTimelines",(function(){return f})),n.d(t,"getTimelineByIdSelector",(function(){return p})),n.d(t,"getKqlFilterQuerySelector",(function(){return m})),n.d(t,"getKqlFilterKuerySelector",(function(){return v}));var r=n(112),i=n(22);const{getManageTimelineById:o}=i.tGridSelectors,a=e=>e.timeline.showCallOutUnauthorizedMsg,u=(e,t)=>e.timeline.timelineById[t],c=e=>e.timeline.insertTimeline,s=Object(r.createSelector)((e=>e.timeline.autoSavedWarningMsg),(e=>e)),l=Object(r.createSelector)((e=>e.timeline.timelineById),(e=>e)),d=()=>Object(r.createSelector)(a,(e=>e)),f=()=>l,p=()=>Object(r.createSelector)(u,(e=>e)),m=()=>Object(r.createSelector)(u,(e=>e&&e.kqlQuery&&e.kqlQuery.filterQuery&&e.kqlQuery.filterQuery.kuery?e.kqlQuery.filterQuery.kuery.expression:null)),v=()=>Object(r.createSelector)(u,(e=>e&&e.kqlQuery&&e.kqlQuery.filterQuery&&e.kqlQuery.filterQuery.kuery?e.kqlQuery.filterQuery.kuery:null))},322:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"i",(function(){return c})),n.d(t,"k",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return v})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return b})),n.d(t,"c",(function(){return g})),n.d(t,"e",(function(){return y})),n.d(t,"d",(function(){return O}));var r=n(112),i=n(106),o=n(219);const a=e=>e.entries,u=Object(r.createSelector)(a,(e=>{var t;return null===(t=Object(o.b)(e))||void 0===t?void 0:t.data})),c=Object(r.createSelector)(u,(e=>(null==e?void 0:e.data)||[])),s=Object(r.createSelector)(u,(e=>(null==e?void 0:e.total)||0)),l=Object(r.createSelector)(u,(e=>{var t,n,r;return{totalItemCount:null!==(t=null==e?void 0:e.total)&&void 0!==t?t:0,pageSize:null!==(n=null==e?void 0:e.per_page)&&void 0!==n?n:i.c,pageSizeOptions:[...i.d],pageIndex:(null!==(r=null==e?void 0:e.page)&&void 0!==r?r:1)-1}})),d=Object(r.createSelector)(a,(e=>Object(o.e)(e))),f=Object(r.createSelector)(a,(e=>Object(o.c)(e)&&e.error||void 0)),p=e=>e.location,m=Object(r.createSelector)((e=>e),(e=>e.deletion)),v=(Object(r.createSelector)(m,(({item:e})=>Boolean(e))),Object(r.createSelector)(m,(({item:e})=>e))),h=Object(r.createSelector)(m,(({status:e})=>Object(o.e)(e))),b=Object(r.createSelector)(m,(({status:e})=>Object(o.d)(e))),g=Object(r.createSelector)(m,(({status:e})=>{if(Object(o.c)(e))return e.error})),y=Object(r.createSelector)((e=>e.form),(e=>{if(Object(o.c)(e.status))return e.status.error})),O=e=>e.form.entry?e.form.entry:void 0},351:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return y}));var r=n(149),i=n.n(r),o=n(19),a=function(e){var t=e.map((function(e){if(null!=e.message)return e.message;var t=e.context.filter((function(e){return null!=e.key&&!Number.isInteger(+e.key)&&""!==e.key.trim()})).map((function(e){return e.key})).join(","),n=e.context.find((function(e){return null!=e.type&&null!=e.type.name&&e.type.name.length>0})),r=""!==t?t:null!=n?n.type.name:"",i=Object(o.isObject)(e.value)?JSON.stringify(e.value):e.value;return'Invalid value "'.concat(i,'" supplied to "').concat(r,'"')}));return i()(new Set(t))},u=n(61),c=n.n(u),s=n(211),l=n.n(s),d=function(e){var t=!isNaN(Date.parse(e)),n=t||e.trim().startsWith("now"),r=t?c()(e):n?l.a.parse(e):null;return null!=r?r:null},f=n(425),p=n.n(f),m=n(17),v=n(281),h=function e(t,n){if(null===n&&null===t)return[];if(null!=n){if("object"!==p()(t)||null==t)return[];var r=Object.keys(n);return Object.keys(t).flatMap((function(a){var u=r.some((function(e){return e===a}))?[]:[a],c=Object(o.get)(a,t),s=Object(o.get)(a,n);return Object(o.isObject)(c)?[].concat(u,i()(e(c,s))):Array.isArray(c)?[].concat(u,i()(c.flatMap((function(t,n){return e(t,Object(o.get)(n,s))})))):u}))}try{return[JSON.stringify(t)]}catch(e){return["circular reference"]}},b=(Object(m.fold)((function(e){return{schema:{},errors:e}}),(function(e){return{schema:e,errors:[]}})),n(428),n(0)),g=function(e,t){var n=function(e,t){return Object(v.pipe)(t,Object(m.fold)((function(e){return Object(m.left)(e)}),(function(t){var n=h(e,t);if(0!==n.length){var r=[{value:n,context:[],message:'invalid keys "'.concat(n.join(","),'"')}];return Object(m.left)(r)}return Object(m.right)(t)})))}(e,t.decode(e));return Object(v.pipe)(n,Object(m.fold)((function(e){return[null,a(e).join(",")]}),(function(e){return[e,null]})))},y=function(e,t){return Object(v.pipe)(t,(function(t){return e.validate(t,b.getDefaultContext(e.asDecoder()))}),Object(m.mapLeft)((function(e){return new Error(a(e).join(","))})))}},359:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return p}));var r=n(211),i=n.n(r),o=n(61),a=n.n(o),u=n(19),c=n(3),s=n(90);const l=a()().subtract(24,"hours"),d=a()(),f=(e=!0)=>{const t=e?s.b.get().uiSettings.get(c.z):null,n=Object(u.isString)(null==t?void 0:t.from)&&(null==t?void 0:t.from)||c.E,r=Object(u.isString)(null==t?void 0:t.to)&&(null==t?void 0:t.to)||c.U;return{from:m(n,l).toISOString(),fromStr:n,to:m(r,d,!0).toISOString(),toStr:r}},p=(e=!0)=>{const t=e?s.b.get().uiSettings.get(c.y):null,n=Object(u.isNumber)(null==t?void 0:t.value)&&(null==t?void 0:t.value)||c.K;return{kind:!Object(u.isBoolean)(null==t?void 0:t.pause)||null!=t&&t.pause?c.J:"interval",duration:n}},m=(e,t,n=!1)=>{const r=i.a.parse(e,{roundUp:n});return null!=r&&r.isValid()?r:t}},360:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v}));var r=n(19),i=n(240),o=n.n(i),a=n(9),u=n(91),c=n(127),s=n(156),l=n(361),d=n(20),f=n(212);const p="FETCH_ALL_TIMELINES",m=o()(((e,t)=>t.map((e=>{var t;return{created:e.created,description:e.description,eventIdToNoteIds:null!=e.eventIdToNoteIds?e.eventIdToNoteIds.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(r.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):null,excludedRowRendererIds:e.excludedRowRendererIds,favorite:e.favorite,noteIds:e.noteIds,notes:null!=e.notes?e.notes.map((e=>({...e,savedObjectId:e.noteId}))):null,pinnedEventIds:null!=e.pinnedEventIds?e.pinnedEventIds.reduce(((e,t)=>({...e,[t]:!0})),{}):null,savedObjectId:e.savedObjectId,status:e.status,title:e.title,updated:e.updated,updatedBy:e.updatedBy,timelineType:null!==(t=e.timelineType)&&void 0!==t?t:d.x.default,templateTimelineId:e.templateTimelineId}})))),v=()=>{const e=Object(u.useDispatch)(),[,t]=Object(c.h)(),[n,r]=Object(a.useState)({loading:!1,totalCount:0,timelines:null,customTemplateTimelineCount:0,defaultTimelineCount:0,elasticTemplateTimelineCount:0,templateTimelineCount:0,favoriteCount:0}),i=Object(a.useCallback)((async({onlyUserFavorite:n,pageInfo:i,search:o,sort:a,status:u,timelineType:d})=>{let v=!1;const h=new AbortController,b=async()=>{try{var g,y,O,I,j,E,T;r((e=>({...e,loading:!0})));const t={onlyUserFavorite:n,pageInfo:i,search:o,sort:a,status:u,timelineType:d},c=await Object(f.c)(t,h.signal),l=null!==(g=null==c?void 0:c.totalCount)&&void 0!==g?g:0,S=null!==(y=null==c?void 0:c.timeline)&&void 0!==y?y:[],w=null!==(O=null==c?void 0:c.customTemplateTimelineCount)&&void 0!==O?O:0,x=null!==(I=null==c?void 0:c.defaultTimelineCount)&&void 0!==I?I:0,_=null!==(j=null==c?void 0:c.elasticTemplateTimelineCount)&&void 0!==j?j:0,R=null!==(E=null==c?void 0:c.templateTimelineCount)&&void 0!==E?E:0,N=null!==(T=null==c?void 0:c.favoriteCount)&&void 0!==T?T:0;v||(e(s.b.setQuery({inputId:"global",id:p,loading:!1,refetch:b,inspect:null})),r({loading:!1,totalCount:l,timelines:m(JSON.stringify(t),S),customTemplateTimelineCount:w,defaultTimelineCount:x,elasticTemplateTimelineCount:_,templateTimelineCount:R,favoriteCount:N}))}catch(e){v||(Object(c.g)({title:l.c,error:e.body&&e.body.message?new Error(e.body.message):e,dispatchToaster:t}),r({loading:!1,totalCount:0,timelines:[],customTemplateTimelineCount:0,defaultTimelineCount:0,elasticTemplateTimelineCount:0,templateTimelineCount:0,favoriteCount:0}))}};return b(),()=>{v=!0,h.abort()}}),[e,t]);return Object(a.useEffect)((()=>()=>{e(s.b.deleteOneQuery({inputId:"global",id:p}))}),[e]),{...n,fetchAllTimeline:i}}},361:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return s}));var r=n(2);const i=r.i18n.translate("xpack.securitySolution.timelines.pageTitle",{defaultMessage:"Timelines"}),o=r.i18n.translate("xpack.securitySolution.timelines.allTimelines.panelTitle",{defaultMessage:"All timelines"}),a=r.i18n.translate("xpack.securitySolution.timelines.allTimelines.importTimelineTitle",{defaultMessage:"Import"}),u=r.i18n.translate("xpack.securitySolution.timelines.allTimelines.errorFetchingTimelinesTitle",{defaultMessage:"Failed to query all timelines data"}),c=r.i18n.translate("xpack.securitySolution.timelines.updateTimelineErrorTitle",{defaultMessage:"Timeline error"}),s=r.i18n.translate("xpack.securitySolution.timelines.updateTimelineErrorText",{defaultMessage:"Something went wrong"})},362:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(359),i=n(568);const o=(e,t=!0)=>{const n=Object(i.a)(e.to),o=Object(i.a)(e.from),{to:a,from:u}=Object(r.d)(t),c=n.isValid()?n.toISOString():a,s=o.isValid()?o.toISOString():u;return{...e,to:c,from:s}}},363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(826);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var i=n(827);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}))},378:function(e,t,n){e.exports=n(46)(914)},423:function(e,t,n){"use strict";n.r(t),n.d(t,"selectNotesById",(function(){return u})),n.d(t,"getNotes",(function(){return s})),n.d(t,"getNotesAsCommentsList",(function(){return l})),n.d(t,"selectNotesByIdSelector",(function(){return d})),n.d(t,"notesByIdsSelector",(function(){return f})),n.d(t,"selectNotesAsCommentsListSelector",(function(){return p})),n.d(t,"errorsSelector",(function(){return m}));var r=n(19),i=n(240),o=n.n(i),a=n(112);const u=e=>e.app.notesById,c=e=>e.app.errors,s=o()(((e,t)=>Object(r.keys)(e).reduce(((n,r)=>{if(t.includes(r)){const t=e[r];return[...n,t]}return n}),[]))),l=e=>Object(r.values)(e).map((e=>{var t;return{eventId:e.eventId,savedObjectId:e.saveObjectId,note:e.note,noteId:e.id,updated:(null!==(t=e.lastEdit)&&void 0!==t?t:e.created).getTime(),updatedBy:e.user}})),d=Object(a.createSelector)(u,(e=>e)),f=()=>Object(a.createSelector)(u,(e=>e)),p=()=>Object(a.createSelector)(u,l),m=()=>Object(a.createSelector)(c,(e=>e))},425:function(e,t,n){e.exports=n(46)(833)},426:function(e,t,n){e.exports=n(46)(2394)},427:function(e,t,n){"use strict";n.d(t,"h",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return v})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return g})),n.d(t,"B",(function(){return y})),n.d(t,"n",(function(){return O})),n.d(t,"e",(function(){return j})),n.d(t,"g",(function(){return E})),n.d(t,"s",(function(){return T})),n.d(t,"C",(function(){return S})),n.d(t,"p",(function(){return w})),n.d(t,"q",(function(){return x})),n.d(t,"r",(function(){return _})),n.d(t,"z",(function(){return R})),n.d(t,"A",(function(){return N})),n.d(t,"u",(function(){return k})),n.d(t,"v",(function(){return M})),n.d(t,"x",(function(){return D})),n.d(t,"w",(function(){return U})),n.d(t,"y",(function(){return W})),n.d(t,"t",(function(){return V})),n.d(t,"j",(function(){return X})),n.d(t,"k",(function(){return K})),n.d(t,"o",(function(){return H})),n.d(t,"m",(function(){return z})),n.d(t,"l",(function(){return J}));var r=n(19),i=n(24),o=n.n(i),a=n(113),u=n(20),c=n(362),s=n(105),l=n(359),d=(n(165),n(242));const f=e=>null!==e,p=({id:e,historyId:t,timelineById:n})=>{const i=n[e];return{...n,[e]:{...i,historyIds:Object(r.uniq)([...i.historyIds,t])}}},m=({id:e,noteId:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,noteIds:[...r.noteIds,t]}}},v=({id:e,noteId:t,eventId:n,timelineById:i})=>{const o=i[e],a=Object(r.getOr)([],`eventIdToNoteIds.${n}`,o);return{...i,[e]:{...o,eventIdToNoteIds:{...o.eventIdToNoteIds,[n]:Object(r.uniq)([...a,t])}}}},h=({id:e,resolveTimelineConfig:t,timeline:n,timelineById:r})=>(((e,t,n)=>e===u.q.active&&t.savedObjectId!==n.savedObjectId)(e,r[e],n)&&(d.a.setActivePage(0),d.a.setExpandedDetail({})),{...r,[e]:{...n,filterManager:r[e].filterManager,isLoading:r[e].isLoading,initialized:r[e].initialized,resolveTimelineConfig:t,dateRange:n.status===u.u.immutable&&n.timelineType===u.x.template?{start:l.a.toISOString(),end:l.b.toISOString()}:n.dateRange}}),b=({id:e,timelineById:t,timelineType:n,dateRange:r,...i})=>{const a=t[e],{from:l,to:d}=Object(c.a)({from:"",to:""}),f=null!=r?r:{start:l,end:d},p=n===u.x.template?{templateTimelineId:o.a.v4(),templateTimelineVersion:1}:{};return{...t,[e]:{id:e,...a||{},...s.a,...i,dateRange:f,savedObjectId:null,version:null,isSaving:!1,isLoading:!1,timelineType:n,...p}}},g=({id:e,eventId:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,pinnedEventIds:{...r.pinnedEventIds,[t]:!0}}}},y=({id:e,show:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,show:t}}},O=({id:e,graphEventId:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,graphEventId:t,...""===t&&e===u.q.active?{activeTab:r.prevActiveTab,prevActiveTab:r.activeTab}:{}}}},I=(e,t)=>e.field===t.field&&e.value===t.value&&e.operator===t.operator,j=({id:e,provider:t,timelineById:n})=>{const i=n[e];return""!==i.highlightedDropAndProviderId?((e,t,n,i)=>{const o=n.dataProviders.findIndex((e=>e.id===n.highlightedDropAndProviderId)),a=n.dataProviders[o],u=a.and.findIndex((e=>e.id===t.id)),{and:c,...s}=t;if(Object(r.isEqualWith)(I,a.queryMatch,s.queryMatch)||-1===u&&a.and.filter((e=>Object(r.isEqualWith)(I,e.queryMatch,s.queryMatch))).length>0)return i;const l=[...n.dataProviders.slice(0,o),{...n.dataProviders[o],and:u>-1?[...a.and.slice(0,u),s,...a.and.slice(u+1)]:[...a.and,s]},...n.dataProviders.slice(o+1)];return{...i,[e]:{...n,dataProviders:l}}})(e,t,i,n):((e,t,n,i)=>{const o=n.dataProviders.findIndex((e=>e.id===t.id));o>-1&&!Object(r.isEmpty)(n.dataProviders[o].and)&&(t.id=`${t.id}-${n.dataProviders.filter((e=>e.id===t.id)).length}`);const a=o>-1&&Object(r.isEmpty)(n.dataProviders[o].and)?[...n.dataProviders.slice(0,o),t,...n.dataProviders.slice(o+1)]:[...n.dataProviders,t];return{...i,[e]:{...n,dataProviders:a}}})(e,t,i,n)},E=({id:e,filterQuery:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,kqlQuery:{...r.kqlQuery,filterQuery:t}}}},T=({id:e,kqlMode:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,kqlMode:t}}},S=({description:e,id:t,title:n,timelineById:r})=>{const i=r[t];return{...r,[t]:{...i,description:e.trim(),title:n.trim()}}},w=({id:e,eventType:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,eventType:t}}},x=({id:e,isFavorite:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,isFavorite:t}}},_=({id:e,isLive:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,isLive:t}}},R=({id:e,providers:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,dataProviders:t}}},N=({id:e,start:t,end:n,timelineById:r})=>{const i=r[e];return{...r,[e]:{...i,dateRange:{start:t,end:n}}}},P=(e,t,n,r)=>r.dataProviders.map((r=>r.id===n?{...r,and:r.and.map((n=>n.id===e?{...n,enabled:t}:n))}:r)),A=(e,t,n)=>n.dataProviders.map((n=>n.id===t?{...n,enabled:e}:n)),k=({id:e,providerId:t,enabled:n,timelineById:r,andProviderId:i})=>{const o=r[e];return{...r,[e]:{...o,dataProviders:i?P(i,n,t,o):A(n,t,o)}}},L=(e,t,n,r)=>r.dataProviders.map((r=>r.id===n?{...r,and:r.and.map((n=>n.id===e?{...n,excluded:t}:n))}:r)),q=(e,t,n)=>n.dataProviders.map((n=>n.id===t?{...n,excluded:e}:n)),M=({id:e,providerId:t,excluded:n,timelineById:r,andProviderId:i})=>{const o=r[e];return{...r,[e]:{...o,dataProviders:i?L(i,n,t,o):q(n,t,o)}}},C=({excluded:e,field:t,operator:n,providerId:r,timeline:i,value:o})=>i.dataProviders.map((i=>i.id===r?{...i,excluded:e,queryMatch:{...i.queryMatch,field:t,displayField:t,value:o,displayValue:o,operator:n}}:i)),F=({andProviderId:e,excluded:t,field:n,operator:r,providerId:i,timeline:o,value:a})=>o.dataProviders.map((o=>o.id===i?{...o,and:o.and.map((i=>i.id===e?{...i,excluded:t,queryMatch:{...i.queryMatch,field:n,displayField:n,value:a,displayValue:a,operator:r}}:i))}:o)),D=({andProviderId:e,excluded:t,field:n,id:r,operator:i,providerId:o,timelineById:a,value:u})=>{const c=a[r];return{...a,[r]:{...c,dataProviders:e?F({andProviderId:e,excluded:t,field:n,operator:i,providerId:o,timeline:c,value:u}):C({excluded:t,field:n,operator:i,providerId:o,timeline:c,value:u})}}},U=({id:e,providerId:t,kqlQuery:n,timelineById:r})=>{const i=r[e];return{...r,[e]:{...i,dataProviders:i.dataProviders.map((e=>e.id===t?{...e,kqlQuery:n}:e))}}},$=(e,t,n,r)=>r.dataProviders.map((r=>r.id===n?{...r,and:r.and.map((n=>n.id===e?{...n,type:t,name:t===a.a.template?`${n.queryMatch.field}`:"",queryMatch:{...n.queryMatch,displayField:void 0,displayValue:void 0,value:t===a.a.template?`{${n.queryMatch.field}}`:"",operator:t===a.a.template?a.c:a.b}}:n))}:r)),B=(e,t,n)=>n.dataProviders.map((n=>n.id===t?{...n,type:e,name:e===a.a.template?`${n.queryMatch.field}`:"",queryMatch:{...n.queryMatch,displayField:void 0,displayValue:void 0,value:e===a.a.template?`{${n.queryMatch.field}}`:"",operator:e===a.a.template?a.c:a.b}}:n)),W=({andProviderId:e,id:t,providerId:n,type:r,timelineById:i})=>{const o=i[t];return o.timelineType!==u.x.template&&r===a.a.template?i:{...i,[t]:{...o,dataProviders:e?$(e,r,n,o):B(r,n,o)}}},V=({id:e,activePage:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,activePage:t}}},Q=(e,t,n)=>{var r,i,o,a;const u=n.dataProviders.findIndex((e=>e.id===t)),c=null===(r=n.dataProviders[u])||void 0===r?void 0:r.and.findIndex((t=>t.id===e));return[...n.dataProviders.slice(0,u),{...n.dataProviders[u],and:null!==(i=n.dataProviders[u])&&void 0!==i&&i.and?[...null===(o=n.dataProviders[u])||void 0===o?void 0:o.and.slice(0,c),...null===(a=n.dataProviders[u])||void 0===a?void 0:a.and.slice(c+1)]:[]},...n.dataProviders.slice(u+1)]},G=(e,t)=>{var n;const r=t.dataProviders.findIndex((t=>t.id===e));return[...t.dataProviders.slice(0,r),...null!==(n=t.dataProviders[r])&&void 0!==n&&n.and.length?[{...t.dataProviders[r].and.slice(0,1)[0],and:[...t.dataProviders[r].and.slice(1)]}]:[],...t.dataProviders.slice(r+1)]},X=({id:e,providerId:t,timelineById:n,andProviderId:r})=>{const i=n[e];return{...n,[e]:{...i,dataProviders:r?Q(r,t,i):G(t,i)}}},K=({id:e,eventId:t,timelineById:n})=>{const i=n[e];return{...n,[e]:{...i,pinnedEventIds:Object(r.omit)(t,i.pinnedEventIds)}}},H=({id:e,savedQueryId:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,savedQueryId:t}}},z=({id:e,filters:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,filters:t}}},J=({id:e,excludedRowRendererIds:t,timelineById:n})=>{const r=n[e];return{...n,[e]:{...r,excludedRowRendererIds:t}}}},428:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.apSW=t.bind=t.bindW=t.bindTo=t.bracket=t.taskify=t.taskEitherSeq=t.taskEither=t.Alt=t.Bifunctor=t.ApplicativeSeq=t.ApplicativePar=t.Functor=t.getFilterable=t.getTaskValidation=t.getAltTaskValidation=t.getApplicativeTaskValidation=t.getApplyMonoid=t.getApplySemigroup=t.getSemigroup=t.URI=t.throwError=t.fromTask=t.fromIO=t.of=t.alt=t.flatten=t.chainFirst=t.chainFirstW=t.chain=t.chainW=t.apSecond=t.apFirst=t.ap=t.apW=t.mapLeft=t.bimap=t.map=t.chainIOEitherK=t.chainIOEitherKW=t.chainEitherK=t.chainEitherKW=t.fromIOEitherK=t.fromEitherK=t.tryCatchK=t.filterOrElse=t.swap=t.orElse=t.getOrElse=t.getOrElseW=t.fold=t.tryCatch=t.fromPredicate=t.fromOption=t.fromEither=t.fromIOEither=t.leftIO=t.rightIO=t.leftTask=t.rightTask=t.right=t.left=void 0;var a=o(n(17)),u=n(829),c=n(48),s=o(n(832));function l(e,t){return function(){return e().then(a.right,(function(e){return a.left(t(e))}))}}function d(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.fromEither(e.apply(void 0,n))}}function f(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.fromIOEither(e.apply(void 0,n))}}t.left=c.flow(a.left,s.of),t.right=c.flow(a.right,s.of),t.rightTask=s.map(a.right),t.leftTask=s.map(a.left),t.rightIO=c.flow(s.fromIO,t.rightTask),t.leftIO=c.flow(s.fromIO,t.leftTask),t.fromIOEither=s.fromIO,t.fromEither=a.fold(t.left,(function(e){return t.right(e)})),t.fromOption=function(e){return function(n){return"None"===n._tag?t.left(e()):t.right(n.value)}},t.fromPredicate=function(e,n){return function(r){return e(r)?t.right(r):t.left(n(r))}},t.tryCatch=l,t.fold=c.flow(a.fold,s.chain),t.getOrElseW=function(e){return function(t){return c.pipe(t,s.chain(a.fold(e,s.of)))}},t.getOrElse=t.getOrElseW,t.orElse=function(e){return s.chain(a.fold(e,t.right))},t.swap=s.map(a.swap),t.filterOrElse=function(e,n){return t.chain((function(r){return e(r)?t.right(r):t.left(n(r))}))},t.tryCatchK=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return l((function(){return e.apply(void 0,n)}),t)}},t.fromEitherK=d,t.fromIOEitherK=f,t.chainEitherKW=function(e){return t.chainW(d(e))},t.chainEitherK=t.chainEitherKW,t.chainIOEitherKW=function(e){return t.chainW(f(e))},t.chainIOEitherK=t.chainIOEitherKW;var p=function(e,n){return c.pipe(e,t.map(n))},m=function(e,n,r){return c.pipe(e,t.bimap(n,r))},v=function(e,n){return c.pipe(e,t.mapLeft(n))},h=function(e,n){return c.pipe(e,t.ap(n))},b=function(e,n){return c.pipe(e,t.chain((function(e){return c.pipe(n,t.map(e))})))},g=function(e,n){return c.pipe(e,t.chain(n))},y=function(e,n){return c.pipe(e,t.alt(n))};function O(e){return s.getSemigroup(a.getApplySemigroup(e))}function I(e,n){var r=a.getApplicativeValidation(n);return{URI:t.URI,_E:void 0,map:p,ap:function(t,n){return c.pipe(t,(i=n,function(t){return e.ap(e.map(t,(function(e){return function(t){return r.ap(e,t)}})),i)}));var i},of:t.of}}function j(e){return{URI:t.URI,_E:void 0,map:p,alt:function(t,n){return c.pipe(t,s.chain((function(t){return a.isRight(t)?s.of(t):c.pipe(n(),s.map((function(n){return a.isLeft(n)?a.left(e.concat(t.left,n.left)):n})))})))}}}t.map=function(e){return s.map(a.map(e))},t.bimap=c.flow(a.bimap,s.map),t.mapLeft=function(e){return s.map(a.mapLeft(e))},t.apW=function(e){return c.flow(s.map((function(e){return function(t){return a.apW(t)(e)}})),s.ap(e))},t.ap=t.apW,t.apFirst=function(e){return c.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return c.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.chainW=function(e){return function(n){return c.pipe(n,s.chain(a.fold(t.left,e)))}},t.chain=t.chainW,t.chainFirstW=function(e){return t.chainW((function(n){return c.pipe(e(n),t.map((function(){return n})))}))},t.chainFirst=t.chainFirstW,t.flatten=t.chain(c.identity),t.alt=function(e){return s.chain(a.fold(e,t.right))},t.of=t.right,t.fromIO=t.rightIO,t.fromTask=t.rightTask,t.throwError=t.left,t.URI="TaskEither",t.getSemigroup=function(e){return s.getSemigroup(a.getSemigroup(e))},t.getApplySemigroup=O,t.getApplyMonoid=function(e){return{concat:O(e).concat,empty:t.right(e.empty)}},t.getApplicativeTaskValidation=I,t.getAltTaskValidation=j,t.getTaskValidation=function(e){var n=I(s.ApplicativePar,e),r=j(e);return{URI:t.URI,_E:void 0,map:p,ap:n.ap,of:t.of,chain:g,bimap:m,mapLeft:v,alt:r.alt,fromIO:t.fromIO,fromTask:t.fromTask,throwError:t.throwError}},t.getFilterable=function(e){var n=a.getWitherable(e),r=u.getFilterableComposition(s.Monad,n);return{URI:t.URI,_E:void 0,map:p,compact:r.compact,separate:r.separate,filter:r.filter,filterMap:r.filterMap,partition:r.partition,partitionMap:r.partitionMap}},t.Functor={URI:t.URI,map:p},t.ApplicativePar={URI:t.URI,map:p,ap:h,of:t.of},t.ApplicativeSeq={URI:t.URI,map:p,ap:b,of:t.of},t.Bifunctor={URI:t.URI,bimap:m,mapLeft:v},t.Alt={URI:t.URI,map:p,alt:y},t.taskEither={URI:t.URI,bimap:m,mapLeft:v,map:p,of:t.of,ap:h,chain:g,alt:y,fromIO:t.fromIO,fromTask:t.fromTask,throwError:t.throwError},t.taskEitherSeq={URI:t.URI,bimap:m,mapLeft:v,map:p,of:t.of,ap:b,chain:g,alt:y,fromIO:t.fromIO,fromTask:t.fromTask,throwError:t.throwError},t.taskify=function(e){return function(){var t=Array.prototype.slice.call(arguments);return function(){return new Promise((function(n){e.apply(null,t.concat((function(e,t){return n(null!=e?a.left(e):a.right(t))})))}))}}},t.bracket=function(e,n,r){return c.pipe(e,t.chain((function(e){return c.pipe(c.pipe(n(e),s.map(a.right)),t.chain((function(n){return c.pipe(r(e,n),t.chain((function(){return a.isLeft(n)?t.left(n.left):t.of(n.right)})))})))})))},t.bindTo=function(e){return t.map(c.bindTo_(e))},t.bindW=function(e,n){return t.chainW((function(r){return c.pipe(n(r),t.map((function(t){return c.bind_(r,e,t)})))}))},t.bind=t.bindW,t.apSW=function(e,n){return c.flow(t.map((function(t){return function(n){return c.bind_(t,e,n)}})),t.apW(n))},t.apS=t.apSW},565:function(e,t,n){e.exports=n(46)(1069)},566:function(e,t,n){e.exports=n(46)(2398)},567:function(e,t,n){"use strict";function r(e,t,n,i){var o=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(o,r.prototype),o.expected=t,o.found=n,o.location=i,o.name="SyntaxError",o}function i(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,e+(n+=n.repeat(t)).slice(0,t))}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(r,Error),r.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var n,r=null;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){r=e[n].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,a=this.location.source+":"+o.line+":"+o.column;if(r){var u=this.location.end,c=i("",o.line.toString().length),s=r[o.line-1],l=o.line===u.line?u.column:s.length+1;t+="\n --\x3e "+a+"\n"+c+" |\n"+o.line+" | "+s+"\n"+c+" | "+i("",o.column-1)+i("",l-o.column,"^")}else t+="\n at "+a}return t},r.buildMessage=function(e,t){var n={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?o(e[0])+"-"+o(e[1]):o(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function a(e){return n[e.type](e)}return"Expected "+function(e){var t,n,r=e.map(a);if(r.sort(),r.length>0){for(t=1,n=1;t<r.length;t++)r[t-1]!==r[t]&&(r[n]=r[t],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:r,parse:function(e,t){var n,i={},o=(t=void 0!==t?t:{}).grammarSource,a={start:ye,Literal:Ae},u=ye,c=":",s="or",l="and",d="not",f='"',p="\\",m="<=",v=">=",h="@kuery-cursor@",b=/^[\\"]/,g=/^[^"]/,y=/^[\\():<>"*{}]/,O=/^[0-9a-f]/i,I=/^[ \t\r\n\xA0]/,j=fe("(",!1),E=fe(")",!1),T=fe(":",!1),S=fe("{",!1),w=fe("}",!1),x=me("fieldName"),_=me("value"),R=me("OR"),N=fe("or",!0),P=me("AND"),A=fe("and",!0),k=me("NOT"),L=fe("not",!0),q=me("literal"),M=fe('"',!1),C=fe("\\",!1),F=pe(["\\",'"'],!1,!1),D=pe(['"'],!0,!1),U={type:"any"},$=fe("*",!1),B=fe("\\t",!1),W=fe("\\r",!1),V=fe("\\n",!1),Q=pe(["\\","(",")",":","<",">",'"',"*","{","}"],!1,!1),G=fe("u",!1),X=pe([["0","9"],["a","f"]],!1,!0),K=fe("<=",!1),H=fe(">=",!1),z=fe("<",!1),J=fe(">",!1),Y=me("whitespace"),Z=pe([" ","\t","\r","\n",""],!1,!1),ee=fe("@kuery-cursor@",!1),te=function(e,t){return t},ne=function(e,t){return t},re=function(e){if("cursor"===e.type)return e;!Ge&&"wildcard"===e.type&&Xe.wildcard.hasLeadingWildcard(e)&&function(e,t){throw t=void 0!==t?t:he(ue,ae),function(e,t){return new r(e,null,null,t)}(e,t)}("Leading wildcards are disabled. See query:allowLeadingWildcards in Advanced Settings.");const t=He(!1);return n=>Ke("is",[n,e,t])},ie=function(){return Ve},oe=function(t,n,r){const{start:i,end:o}=he(ue,ae);return{type:"cursor",start:i.offset,end:o.offset-n.length,prefix:t.join(""),suffix:r.join(""),text:e.substring(ue,ae).replace(n,"")}},ae=0,ue=0,ce=[{line:1,column:1}],se=0,le=[],de=0;if("startRule"in t){if(!(t.startRule in a))throw new Error("Can't start parsing from rule \""+t.startRule+'".');u=a[t.startRule]}function fe(e,t){return{type:"literal",text:e,ignoreCase:t}}function pe(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function me(e){return{type:"other",description:e}}function ve(t){var n,r=ce[t];if(r)return r;for(n=t-1;!ce[n];)n--;for(r={line:(r=ce[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return ce[t]=r,r}function he(e,t){var n=ve(e),r=ve(t);return{source:o,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function be(e){ae<se||(ae>se&&(se=ae,le=[]),le.push(e))}function ge(e,t,n){return new r(r.buildMessage(e,t),e,t,n)}function ye(){var e,t,n,r,o,a;for(e=ae,t=[],n=Be();n!==i;)t.push(n),n=Be();return(n=Oe())===i&&(n=null),(r=Ce())!==i?(ue=e,o=n,e="cursor"===(a=r).type?{...a,suggestionTypes:["conjunction"]}:null!==o?o:Xe.function.buildNode("is","*","*")):(ae=e,e=i),e}function Oe(){var e,t,n,r,o;if(e=ae,(t=Ie())!==i){if(n=[],r=ae,Re()!==i&&(o=Ie())!==i?(ue=r,r=te(0,o)):(ae=r,r=i),r!==i)for(;r!==i;)n.push(r),r=ae,Re()!==i&&(o=Ie())!==i?(ue=r,r=te(0,o)):(ae=r,r=i);else n=i;n!==i?(ue=e,e=function(e,t){const n=[e,...t];return Ve&&n.find((e=>"cursor"===e.type))||Ke("or",n)}(t,n)):(ae=e,e=i)}else ae=e,e=i;return e===i&&(e=Ie()),e}function Ie(){var e,t,n,r,o;if(e=ae,(t=je())!==i){if(n=[],r=ae,Ne()!==i&&(o=je())!==i?(ue=r,r=te(0,o)):(ae=r,r=i),r!==i)for(;r!==i;)n.push(r),r=ae,Ne()!==i&&(o=je())!==i?(ue=r,r=te(0,o)):(ae=r,r=i);else n=i;n!==i?(ue=e,e=function(e,t){const n=[e,...t];return Ve&&n.find((e=>"cursor"===e.type))||Ke("and",n)}(t,n)):(ae=e,e=i)}else ae=e,e=i;return e===i&&(e=je()),e}function je(){var e,t,n;return e=ae,Pe()!==i&&(t=Ee())!==i?(ue=e,e="cursor"===(n=t).type?n:Ke("not",[n])):(ae=e,e=i),e===i&&(e=Ee()),e}function Ee(){var t,n,r,o,a,u,s,l;if(t=ae,40===e.charCodeAt(ae)?(n="(",ae++):(n=i,0===de&&be(j)),n!==i){for(r=[],o=Be();o!==i;)r.push(o),o=Be();(o=Oe())!==i&&(a=Ce())!==i?(41===e.charCodeAt(ae)?(u=")",ae++):(u=i,0===de&&be(E)),u!==i?(ue=t,s=o,t="cursor"===(l=a).type?{...l,suggestionTypes:["conjunction"]}:s):(ae=t,t=i)):(ae=t,t=i)}else ae=t,t=i;return t===i&&(t=function(){var t,n,r,o,a,u,s,l,d,f;if(t=ae,(n=Te())!==i){for(r=[],o=Be();o!==i;)r.push(o),o=Be();if(58===e.charCodeAt(ae)?(o=":",ae++):(o=i,0===de&&be(T)),o!==i){for(a=[],u=Be();u!==i;)a.push(u),u=Be();if(123===e.charCodeAt(ae)?(u="{",ae++):(u=i,0===de&&be(S)),u!==i){for(s=[],l=Be();l!==i;)s.push(l),l=Be();(l=Oe())!==i&&(d=Ce())!==i?(125===e.charCodeAt(ae)?(f="}",ae++):(f=i,0===de&&be(w)),f!==i?(ue=t,t=function(e,t,n){return"cursor"===t.type?{...t,nestedPath:t.nestedPath?`${e.value}.${t.nestedPath}`:e.value}:"cursor"===n.type?{...n,suggestionTypes:["conjunction"]}:Ke("nested",[e,t])}(n,l,d)):(ae=t,t=i)):(ae=t,t=i)}else ae=t,t=i}else ae=t,t=i}else ae=t,t=i;t===i&&(t=function(){var t;(t=function(){var t,n,r,o,a,u;if(t=ae,(n=Te())!==i){for(r=[],o=Be();o!==i;)r.push(o),o=Be();if((o=function(){var t,n;t=ae,e.substr(ae,2)===m?(n=m,ae+=2):(n=i,0===de&&be(K));n!==i&&(ue=t,n="lte");(t=n)===i&&(t=ae,e.substr(ae,2)===v?(n=v,ae+=2):(n=i,0===de&&be(H)),n!==i&&(ue=t,n="gte"),(t=n)===i&&(t=ae,60===e.charCodeAt(ae)?(n="<",ae++):(n=i,0===de&&be(z)),n!==i&&(ue=t,n="lt"),(t=n)===i&&(t=ae,62===e.charCodeAt(ae)?(n=">",ae++):(n=i,0===de&&be(J)),n!==i&&(ue=t,n="gt"),t=n)));return t}())!==i){for(a=[],u=Be();u!==i;)a.push(u),u=Be();(u=Ae())!==i?(ue=t,t=function(e,t,n){if("cursor"===n.type)return{...n,suggestionTypes:["conjunction"]};const r=Je(t,n);return Ke("range",[e,r])}(n,o,u)):(ae=t,t=i)}else ae=t,t=i}else ae=t,t=i;return t}())===i&&(t=function(){var t,n,r,o,a,u;if(t=ae,(n=Te())!==i){for(r=[],o=Be();o!==i;)r.push(o),o=Be();if(58===e.charCodeAt(ae)?(o=c,ae++):(o=i,0===de&&be(T)),o!==i){for(a=[],u=Be();u!==i;)a.push(u),u=Be();(u=Se())!==i?(ue=t,s=n,t="cursor"===(l=u).type?{...l,fieldName:s.value,suggestionTypes:["value","conjunction"]}:l(s)):(ae=t,t=i)}else ae=t,t=i}else ae=t,t=i;var s,l;return t}())===i&&(t=function(){var e,t;e=ae,(t=_e())!==i&&(ue=e,t=function(e){if("cursor"===e.type){const t=`${e.prefix}${e.suffix}`.trim();return{...e,fieldName:t,suggestionTypes:["field","operator","conjunction"]}}return e(He(null))}(t));return e=t}());return t}());return t}()),t}function Te(){var e;return de++,e=Ae(),de--,e===i&&(i,0===de&&be(x)),e}function Se(){var t,n,r,o,a,u,c,s;if(t=ae,40===e.charCodeAt(ae)?(n="(",ae++):(n=i,0===de&&be(j)),n!==i){for(r=[],o=Be();o!==i;)r.push(o),o=Be();(o=function(){var e,t,n,r,o;if(e=ae,(t=we())!==i){if(n=[],r=ae,Re()!==i&&(o=we())!==i?(ue=r,r=ne(0,o)):(ae=r,r=i),r!==i)for(;r!==i;)n.push(r),r=ae,Re()!==i&&(o=we())!==i?(ue=r,r=ne(0,o)):(ae=r,r=i);else n=i;n!==i?(ue=e,e=function(e,t){const n=[e,...t],r=Ve&&n.find((e=>"cursor"===e.type));return r?{...r,suggestionTypes:["value"]}:e=>Ke("or",n.map((t=>t(e))))}(t,n)):(ae=e,e=i)}else ae=e,e=i;e===i&&(e=we());return e}())!==i&&(a=Ce())!==i?(41===e.charCodeAt(ae)?(u=")",ae++):(u=i,0===de&&be(E)),u!==i?(ue=t,c=o,t="cursor"===(s=a).type?{...s,suggestionTypes:["conjunction"]}:c):(ae=t,t=i)):(ae=t,t=i)}else ae=t,t=i;return t===i&&(t=_e()),t}function we(){var e,t,n,r,o;if(e=ae,(t=xe())!==i){if(n=[],r=ae,Ne()!==i&&(o=xe())!==i?(ue=r,r=ne(0,o)):(ae=r,r=i),r!==i)for(;r!==i;)n.push(r),r=ae,Ne()!==i&&(o=xe())!==i?(ue=r,r=ne(0,o)):(ae=r,r=i);else n=i;n!==i?(ue=e,e=function(e,t){const n=[e,...t],r=Ve&&n.find((e=>"cursor"===e.type));return r?{...r,suggestionTypes:["value"]}:e=>Ke("and",n.map((t=>t(e))))}(t,n)):(ae=e,e=i)}else ae=e,e=i;return e===i&&(e=xe()),e}function xe(){var e,t,n;return e=ae,Pe()!==i&&(t=Se())!==i?(ue=e,e="cursor"===(n=t).type?{...list,suggestionTypes:["value"]}:e=>Ke("not",[n(e)])):(ae=e,e=i),e===i&&(e=Se()),e}function _e(){var e,t;return de++,e=ae,(t=ke())!==i&&(ue=e,t=function(e){if("cursor"===e.type)return e;const t=He(!0);return n=>Ke("is",[n,e,t])}(t)),(e=t)===i&&(e=ae,(t=qe())!==i&&(ue=e,t=re(t)),e=t),de--,e===i&&(t=i,0===de&&be(_)),e}function Re(){var t,n,r,o,a;if(de++,t=ae,n=[],(r=Be())!==i)for(;r!==i;)n.push(r),r=Be();else n=i;if(n!==i)if("or"===e.substr(ae,2).toLowerCase()?(r=e.substr(ae,2),ae+=2):(r=i,0===de&&be(N)),r!==i){if(o=[],(a=Be())!==i)for(;a!==i;)o.push(a),a=Be();else o=i;o!==i?t=n=[n,r,o]:(ae=t,t=i)}else ae=t,t=i;else ae=t,t=i;return de--,t===i&&(n=i,0===de&&be(R)),t}function Ne(){var t,n,r,o,a;if(de++,t=ae,n=[],(r=Be())!==i)for(;r!==i;)n.push(r),r=Be();else n=i;if(n!==i)if("and"===e.substr(ae,3).toLowerCase()?(r=e.substr(ae,3),ae+=3):(r=i,0===de&&be(A)),r!==i){if(o=[],(a=Be())!==i)for(;a!==i;)o.push(a),a=Be();else o=i;o!==i?t=n=[n,r,o]:(ae=t,t=i)}else ae=t,t=i;else ae=t,t=i;return de--,t===i&&(n=i,0===de&&be(P)),t}function Pe(){var t,n,r,o;if(de++,t=ae,"not"===e.substr(ae,3).toLowerCase()?(n=e.substr(ae,3),ae+=3):(n=i,0===de&&be(L)),n!==i){if(r=[],(o=Be())!==i)for(;o!==i;)r.push(o),o=Be();else r=i;r!==i?t=n=[n,r]:(ae=t,t=i)}else ae=t,t=i;return de--,t===i&&(n=i,0===de&&be(k)),t}function Ae(){var e;return de++,(e=ke())===i&&(e=qe()),de--,e===i&&(i,0===de&&be(q)),e}function ke(){var t,n,r,o,a,u,c;if(t=ae,ue=ae,(n=(n=ie())?void 0:i)!==i)if(34===e.charCodeAt(ae)?(r=f,ae++):(r=i,0===de&&be(M)),r!==i){for(o=[],a=Le();a!==i;)o.push(a),a=Le();if((a=We())!==i){for(u=[],c=Le();c!==i;)u.push(c),c=Le();34===e.charCodeAt(ae)?(c=f,ae++):(c=i,0===de&&be(M)),c!==i?(ue=t,t=oe(o,a,u)):(ae=t,t=i)}else ae=t,t=i}else ae=t,t=i;else ae=t,t=i;if(t===i)if(t=ae,34===e.charCodeAt(ae)?(n=f,ae++):(n=i,0===de&&be(M)),n!==i){for(r=[],o=Le();o!==i;)r.push(o),o=Le();34===e.charCodeAt(ae)?(o=f,ae++):(o=i,0===de&&be(M)),o!==i?(ue=t,t=He(r.join(""))):(ae=t,t=i)}else ae=t,t=i;return t}function Le(){var t,n,r;return(t=Fe())===i&&(t=Ue())===i&&(t=ae,92===e.charCodeAt(ae)?(n=p,ae++):(n=i,0===de&&be(C)),n!==i?(b.test(e.charAt(ae))?(r=e.charAt(ae),ae++):(r=i,0===de&&be(F)),r!==i?(ue=t,t=r):(ae=t,t=i)):(ae=t,t=i),t===i&&(t=ae,n=ae,de++,r=We(),de--,r===i?n=void 0:(ae=n,n=i),n!==i?(g.test(e.charAt(ae))?(r=e.charAt(ae),ae++):(r=i,0===de&&be(D)),r!==i?(ue=t,t=r):(ae=t,t=i)):(ae=t,t=i))),t}function qe(){var e,t,n,r,o,a;if(e=ae,ue=ae,(t=(t=ie())?void 0:i)!==i){for(n=[],r=Me();r!==i;)n.push(r),r=Me();if((r=We())!==i){for(o=[],a=Me();a!==i;)o.push(a),a=Me();ue=e,e=oe(n,r,o)}else ae=e,e=i}else ae=e,e=i;if(e===i){if(e=ae,t=[],(n=Me())!==i)for(;n!==i;)t.push(n),n=Me();else t=i;t!==i&&(ue=e,t=function(e){const t=e.join("").trim();return"null"===t?He(null):"true"===t?He(!0):"false"===t?He(!1):e.includes(Ye)?ze(t):He(t)}(t)),e=t}return e}function Me(){var t,n,r,o,a;return(t=Fe())===i&&(t=function(){var t,n,r;t=ae,92===e.charCodeAt(ae)?(n=p,ae++):(n=i,0===de&&be(C));n!==i&&(r=De())!==i?(ue=t,t=r):(ae=t,t=i);return t}())===i&&(t=Ue())===i&&(t=function(){var t,n,r;t=ae,92===e.charCodeAt(ae)?(n=p,ae++):(n=i,0===de&&be(C));n!==i?(e.substr(ae,2).toLowerCase()===s?(r=e.substr(ae,2),ae+=2):(r=i,0===de&&be(N)),r===i&&(e.substr(ae,3).toLowerCase()===l?(r=e.substr(ae,3),ae+=3):(r=i,0===de&&be(A)),r===i&&(e.substr(ae,3).toLowerCase()===d?(r=e.substr(ae,3),ae+=3):(r=i,0===de&&be(L)))),r!==i?(ue=t,t=r):(ae=t,t=i)):(ae=t,t=i);return t}())===i&&(t=function(){var t,n;t=ae,42===e.charCodeAt(ae)?(n="*",ae++):(n=i,0===de&&be($));n!==i&&(ue=t,n=Ye);return t=n}())===i&&(t=ae,n=ae,de++,r=De(),de--,r===i?n=void 0:(ae=n,n=i),n!==i?(r=ae,de++,o=function(){var e;(e=Re())===i&&(e=Ne())===i&&(e=Pe());return e}(),de--,o===i?r=void 0:(ae=r,r=i),r!==i?(o=ae,de++,a=We(),de--,a===i?o=void 0:(ae=o,o=i),o!==i?(e.length>ae?(a=e.charAt(ae),ae++):(a=i,0===de&&be(U)),a!==i?(ue=t,t=a):(ae=t,t=i)):(ae=t,t=i)):(ae=t,t=i)):(ae=t,t=i)),t}function Ce(){var e,t,n,r,o,a;if(e=ae,ue=ae,(t=(t=ie())?void 0:i)!==i){for(n=[],r=Be();r!==i;)n.push(r),r=Be();if((r=We())!==i){for(o=[],a=Be();a!==i;)o.push(a),a=Be();ue=e,e=oe(n,r,o)}else ae=e,e=i}else ae=e,e=i;if(e===i)for(e=[],t=Be();t!==i;)e.push(t),t=Be();return e}function Fe(){var t,n;return t=ae,"\\t"===e.substr(ae,2)?(n="\\t",ae+=2):(n=i,0===de&&be(B)),n!==i&&(ue=t,n="\t"),(t=n)===i&&(t=ae,"\\r"===e.substr(ae,2)?(n="\\r",ae+=2):(n=i,0===de&&be(W)),n!==i&&(ue=t,n="\r"),(t=n)===i&&(t=ae,"\\n"===e.substr(ae,2)?(n="\\n",ae+=2):(n=i,0===de&&be(V)),n!==i&&(ue=t,n="\n"),t=n)),t}function De(){var t;return y.test(e.charAt(ae))?(t=e.charAt(ae),ae++):(t=i,0===de&&be(Q)),t}function Ue(){var t,n,r;return t=ae,92===e.charCodeAt(ae)?(n=p,ae++):(n=i,0===de&&be(C)),n!==i&&(r=function(){var t,n,r,o,a,u,c,s;t=ae,117===e.charCodeAt(ae)?(n="u",ae++):(n=i,0===de&&be(G));n!==i?(r=ae,o=ae,(a=$e())!==i&&(u=$e())!==i&&(c=$e())!==i&&(s=$e())!==i?o=a=[a,u,c,s]:(ae=o,o=i),(r=o!==i?e.substring(r,ae):o)!==i?(ue=t,l=r,t=String.fromCharCode(parseInt(l,16))):(ae=t,t=i)):(ae=t,t=i);var l;return t}())!==i?(ue=t,t=r):(ae=t,t=i),t}function $e(){var t;return O.test(e.charAt(ae))?(t=e.charAt(ae),ae++):(t=i,0===de&&be(X)),t}function Be(){var t;return de++,I.test(e.charAt(ae))?(t=e.charAt(ae),ae++):(t=i,0===de&&be(Z)),de--,t===i&&(i,0===de&&be(Y)),t}function We(){var t,n;return t=ae,ue=ae,(ie()?void 0:i)!==i?(e.substr(ae,14)===h?(n=h,ae+=14):(n=i,0===de&&be(ee)),n!==i?(ue=t,t=Qe):(ae=t,t=i)):(ae=t,t=i),t}const{parseCursor:Ve,cursorSymbol:Qe,allowLeadingWildcards:Ge=!0,helpers:{nodeTypes:Xe}}=t,Ke=Xe.function.buildNodeWithArgumentNodes,He=Xe.literal.buildNode,ze=Xe.wildcard.buildNode,Je=Xe.namedArg.buildNode,{wildcardSymbol:Ye}=Xe.wildcard;if((n=u())!==i&&ae===e.length)return n;throw n!==i&&ae<e.length&&be({type:"end"}),ge(le,se<e.length?e.charAt(se):null,se<e.length?he(se,se+1):he(se,se))}}},568:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19),i=n(61),o=n.n(i);const a=e=>{if(Object(r.isString)(e)&&""!==e.trim()){const t=o()(new Date(e));return t.isValid()||isNaN(+e)?t:o()(new Date(+e))}return o()(new Date(e))}},569:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(823);Object.defineProperty(t,"createEpicMiddleware",{enumerable:!0,get:function(){return r.createEpicMiddleware}});var i=n(570);Object.defineProperty(t,"ActionsObservable",{enumerable:!0,get:function(){return i.ActionsObservable}});var o=n(572);Object.defineProperty(t,"StateObservable",{enumerable:!0,get:function(){return o.StateObservable}});var a=n(825);Object.defineProperty(t,"combineEpics",{enumerable:!0,get:function(){return a.combineEpics}});var u=n(571);Object.defineProperty(t,"ofType",{enumerable:!0,get:function(){return u.ofType}})},570:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionsObservable=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(15),o=n(571);t.ActionsObservable=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.source=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,null,[{key:"of",value:function(){return new this(i.of.apply(void 0,arguments))}},{key:"from",value:function(e,t){return new this((0,i.from)(e,t))}}]),r(t,[{key:"lift",value:function(e){var n=new t(this);return n.operator=e,n}},{key:"ofType",value:function(){return o.ofType.apply(void 0,arguments)(this)}}]),t}(i.Observable)},571:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ofType=void 0;var r=n(25),i=function(e,t){return e===t||"function"==typeof t&&e===t.toString()};t.ofType=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.pipe((0,r.filter)((function(e){var n=e.type,r=t.length;if(1===r)return i(n,t[0]);for(var o=0;o<r;o++)if(i(n,t[o]))return!0;return!1})))}}},572:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateObservable=void 0;var r=n(15);t.StateObservable=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){var t=i.__notifier.subscribe(e);return t&&!t.closed&&e.next(i.value),t})));return i.value=n,i.__notifier=new r.Subject,i.__subscription=e.subscribe((function(e){e!==i.value&&(i.value=e,i.__notifier.next(e))})),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.Observable)},573:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(90),i=n(26);const o=async e=>r.b.get().http.post(i.f,{body:JSON.stringify(e)}),a=async e=>r.b.get().http.post(i.o,{body:JSON.stringify(e)})},574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.bind=t.bindTo=t.getRefinement=t.exists=t.elem=t.option=t.MonadThrow=t.Witherable=t.Traversable=t.Filterable=t.Compactable=t.Extend=t.Alternative=t.Alt=t.Foldable=t.Monad=t.Applicative=t.Functor=t.getMonoid=t.getLastMonoid=t.getFirstMonoid=t.getApplyMonoid=t.getApplySemigroup=t.getOrd=t.getEq=t.getShow=t.URI=t.wilt=t.wither=t.sequence=t.traverse=t.partitionMap=t.partition=t.filterMap=t.filter=t.separate=t.compact=t.reduceRight=t.foldMap=t.reduce=t.duplicate=t.extend=t.throwError=t.zero=t.alt=t.flatten=t.chainFirst=t.chain=t.of=t.apSecond=t.apFirst=t.ap=t.map=t.mapNullable=t.getOrElse=t.getOrElseW=t.toUndefined=t.toNullable=t.fold=t.fromEither=t.getRight=t.getLeft=t.tryCatch=t.fromPredicate=t.fromNullable=t.some=t.none=t.isNone=t.isSome=void 0;var r=n(48);function i(e){return null==e?t.none:t.some(e)}function o(e){return"Right"===e._tag?t.none:t.some(e.left)}function a(e){return"Left"===e._tag?t.none:t.some(e.right)}t.isSome=function(e){return"Some"===e._tag},t.isNone=function(e){return"None"===e._tag},t.none={_tag:"None"},t.some=function(e){return{_tag:"Some",value:e}},t.fromNullable=i,t.fromPredicate=function(e){return function(n){return e(n)?t.some(n):t.none}},t.tryCatch=function(e){try{return t.some(e())}catch(e){return t.none}},t.getLeft=o,t.getRight=a,t.fromEither=function(e){return"Left"===e._tag?t.none:t.some(e.right)},t.fold=function(e,n){return function(r){return t.isNone(r)?e():n(r.value)}},t.toNullable=function(e){return t.isNone(e)?null:e.value},t.toUndefined=function(e){return t.isNone(e)?void 0:e.value},t.getOrElseW=function(e){return function(n){return t.isNone(n)?e():n.value}},t.getOrElse=t.getOrElseW,t.mapNullable=function(e){return function(n){return t.isNone(n)?t.none:i(e(n.value))}};var u=function(e,n){return r.pipe(e,t.map(n))},c=function(e,n){return r.pipe(e,t.ap(n))},s=function(e,n){return r.pipe(e,t.chain(n))},l=function(e,n,i){return r.pipe(e,t.reduce(n,i))},d=function(e){var n=t.foldMap(e);return function(e,t){return r.pipe(e,n(t))}},f=function(e,n,i){return r.pipe(e,t.reduceRight(n,i))},p=function(e){var n=t.traverse(e);return function(e,t){return r.pipe(e,n(t))}},m=function(e,n){return r.pipe(e,t.alt(n))},v=function(e,n){return r.pipe(e,t.filter(n))},h=function(e,n){return r.pipe(e,t.filterMap(n))},b=function(e,n){return r.pipe(e,t.extend(n))},g=function(e,n){return r.pipe(e,t.partition(n))},y=function(e,n){return r.pipe(e,t.partitionMap(n))},O=function(e){var n=t.wither(e);return function(e,t){return r.pipe(e,n(t))}},I=function(e){var n=t.wilt(e);return function(e,t){return r.pipe(e,n(t))}};t.map=function(e){return function(n){return t.isNone(n)?t.none:t.some(e(n.value))}},t.ap=function(e){return function(n){return t.isNone(n)||t.isNone(e)?t.none:t.some(n.value(e.value))}},t.apFirst=function(e){return r.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return r.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=t.some,t.chain=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)}},t.chainFirst=function(e){return t.chain((function(n){return r.pipe(e(n),t.map((function(){return n})))}))},t.flatten=t.chain(r.identity),t.alt=function(e){return function(n){return t.isNone(n)?e():n}},t.zero=function(){return t.none},t.throwError=function(){return t.none},t.extend=function(e){return function(n){return t.isNone(n)?t.none:t.some(e(n))}},t.duplicate=t.extend(r.identity),t.reduce=function(e,n){return function(r){return t.isNone(r)?e:n(e,r.value)}},t.foldMap=function(e){return function(n){return function(r){return t.isNone(r)?e.empty:n(r.value)}}},t.reduceRight=function(e,n){return function(r){return t.isNone(r)?e:n(r.value,e)}},t.compact=t.flatten;var j={left:t.none,right:t.none};function E(e){return{equals:function(n,r){return n===r||(t.isNone(n)?t.isNone(r):!t.isNone(r)&&e.equals(n.value,r.value))}}}function T(e){return{concat:function(n,r){return t.isSome(n)&&t.isSome(r)?t.some(e.concat(n.value,r.value)):t.none}}}t.separate=function(e){var n=r.pipe(e,t.map((function(e){return{left:o(e),right:a(e)}})));return t.isNone(n)?j:n.value},t.filter=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)?n:t.none}},t.filterMap=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)}},t.partition=function(e){return function(n){return{left:r.pipe(n,t.filter((function(t){return!e(t)}))),right:r.pipe(n,t.filter(e))}}},t.partitionMap=function(e){return function(n){return t.separate(r.pipe(n,t.map(e)))}},t.traverse=function(e){return function(n){return function(r){return t.isNone(r)?e.of(t.none):e.map(n(r.value),t.some)}}},t.sequence=function(e){return function(n){return t.isNone(n)?e.of(t.none):e.map(n.value,t.some)}},t.wither=function(e){return function(n){return function(r){return t.isNone(r)?e.of(t.none):n(r.value)}}},t.wilt=function(e){return function(n){return function(i){var u=r.pipe(i,t.map((function(t){return e.map(n(t),(function(e){return{left:o(e),right:a(e)}}))})));return t.isNone(u)?e.of({left:t.none,right:t.none}):u.value}}},t.URI="Option",t.getShow=function(e){return{show:function(n){return t.isNone(n)?"none":"some("+e.show(n.value)+")"}}},t.getEq=E,t.getOrd=function(e){return{equals:E(e).equals,compare:function(n,r){return n===r?0:t.isSome(n)?t.isSome(r)?e.compare(n.value,r.value):1:-1}}},t.getApplySemigroup=T,t.getApplyMonoid=function(e){return{concat:T(e).concat,empty:t.some(e.empty)}},t.getFirstMonoid=function(){return{concat:function(e,n){return t.isNone(e)?n:e},empty:t.none}},t.getLastMonoid=function(){return{concat:function(e,n){return t.isNone(n)?e:n},empty:t.none}},t.getMonoid=function(e){return{concat:function(n,r){return t.isNone(n)?r:t.isNone(r)?n:t.some(e.concat(n.value,r.value))},empty:t.none}},t.Functor={URI:t.URI,map:u},t.Applicative={URI:t.URI,map:u,ap:c,of:t.of},t.Monad={URI:t.URI,map:u,ap:c,of:t.of,chain:s},t.Foldable={URI:t.URI,reduce:l,foldMap:d,reduceRight:f},t.Alt={URI:t.URI,map:u,alt:m},t.Alternative={URI:t.URI,map:u,ap:c,of:t.of,alt:m,zero:t.zero},t.Extend={URI:t.URI,map:u,extend:b},t.Compactable={URI:t.URI,compact:t.compact,separate:t.separate},t.Filterable={URI:t.URI,map:u,compact:t.compact,separate:t.separate,filter:v,filterMap:h,partition:g,partitionMap:y},t.Traversable={URI:t.URI,map:u,reduce:l,foldMap:d,reduceRight:f,traverse:p,sequence:t.sequence},t.Witherable={URI:t.URI,map:u,reduce:l,foldMap:d,reduceRight:f,traverse:p,sequence:t.sequence,compact:t.compact,separate:t.separate,filter:v,filterMap:h,partition:g,partitionMap:y,wither:O,wilt:I},t.MonadThrow={URI:t.URI,map:u,ap:c,of:t.of,chain:s,throwError:t.throwError},t.option={URI:t.URI,map:u,of:t.of,ap:c,chain:s,reduce:l,foldMap:d,reduceRight:f,traverse:p,sequence:t.sequence,zero:t.zero,alt:m,extend:b,compact:t.compact,separate:t.separate,filter:v,filterMap:h,partition:g,partitionMap:y,wither:O,wilt:I,throwError:t.throwError},t.elem=function(e){return function(n,r){return!t.isNone(r)&&e.equals(n,r.value)}},t.exists=function(e){return function(n){return!t.isNone(n)&&e(n.value)}},t.getRefinement=function(e){return function(n){return t.isSome(e(n))}},t.bindTo=function(e){return t.map(r.bindTo_(e))},t.bind=function(e,n){return t.chain((function(i){return r.pipe(n(i),t.map((function(t){return r.bind_(i,e,t)})))}))},t.apS=function(e,n){return r.flow(t.map((function(t){return function(n){return r.bind_(t,e,n)}})),t.ap(n))}},647:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(648),i=n.n(r);const o={macos:!0,windows:!0};function a(e){return e.includes("-")?e.substring(0,e.indexOf("-")):e}function u(e){return(({currentOs:e,supportedOss:t=o})=>!!t[e])({currentOs:e.toLowerCase()})}const c=({osName:e,version:t,capabilities:n})=>!(!t||!(({currentVersion:e,minVersionRequired:t="7.14.0"})=>{const n=a(e);return i()(t,n)})({currentVersion:t}))&&(function(e){const t=a(e);return i()("7.15.0",t)}(t)?function(e=[]){return e.includes("isolation")}(n):u(e))},648:function(e,t,n){const r=n(649);e.exports=(e,t,n)=>r(e,t,n)<=0},649:function(e,t,n){const r=n(909);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},650:function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(378))},651:function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}},784:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(90),i=n(26);const o=e=>r.b.get().http.get(i.a,{query:{agent_ids:e}})},820:function(e,t,n){e.exports=n(46)(2381)},821:function(e,t,n){e.exports=n(46)(2388)},822:function(e,t,n){e.exports=n(46)(2386)},823:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEpicMiddleware=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.queueScheduler.constructor,n=new t(r.queueScheduler.SchedulerAction);0;var u=new r.Subject,c=void 0,s=function(t){c=t;var s=(new r.Subject).pipe((0,i.observeOn)(n)),l=(new r.Subject).pipe((0,i.observeOn)(n)),d=new o.ActionsObservable(s),f=new a.StateObservable(l,c.getState());return u.pipe((0,i.map)((function(t){var n="dependencies"in e?t(d,f,e.dependencies):t(d,f);if(!n)throw new TypeError('Your root Epic "'+(t.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return n})),(0,i.mergeMap)((function(e){return(0,r.from)(e).pipe((0,i.subscribeOn)(n),(0,i.observeOn)(n))}))).subscribe(c.dispatch),function(e){return function(t){var n=e(t);return l.next(c.getState()),s.next(t),n}}};return s.run=function(e){u.next(e)},s};var r=n(15),i=n(25),o=n(570),a=n(572);n(824)},824:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i={},o=(t.resetDeprecationsSeen=function(){i={}},"object"===("undefined"==typeof console?"undefined":r(console))&&"function"==typeof console.warn?function(){var e;return(e=console).warn.apply(e,arguments)}:function(){});t.deprecate=function(e){i[e]||(i[e]=!0,o("redux-observable | DEPRECATION: "+e))},t.warn=function(e){o("redux-observable | WARNING: "+e)}},825:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineEpics=void 0;var r=n(15);function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.combineEpics=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return r.merge.apply(void 0,i(t.map((function(e){var t=e.apply(void 0,n);if(!t)throw new TypeError('combineEpics: one of the provided Epics "'+(e.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return t}))))};try{Object.defineProperty(o,"name",{value:"combineEpics("+t.map((function(e){return e.name||"<anonymous>"})).join(", ")+")"})}catch(e){}return o}},826:function(e,t,n){"use strict";var r=n(157);Object.defineProperty(t,"__esModule",{value:!0}),t.removeIdFromItem=t.addIdToItem=void 0;var i=r(n(24));t.addIdToItem=e=>null!=e.id?e:{...e,id:i.default.v4()};t.removeIdFromItem=e=>{const t=e;if(null!=t.id){const{id:e,...n}=t;return n}return e}},827:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformDataToNdjson=void 0;t.transformDataToNdjson=e=>{if(0!==e.length){return`${e.map((e=>JSON.stringify(e))).join("\n")}\n`}return""}},828:function(e,t,n){e.exports=n(46)(2377)},829:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilterableComposition=void 0;var r=n(830),i=n(574);t.getFilterableComposition=function(e,t){var n=r.getCompactableComposition(e,t),o={map:n.map,compact:n.compact,separate:n.separate,partitionMap:function(e,t){return{left:o.filterMap(e,(function(e){return i.getLeft(t(e))})),right:o.filterMap(e,(function(e){return i.getRight(t(e))}))}},partition:function(e,t){return{left:o.filter(e,(function(e){return!t(e)})),right:o.filter(e,t)}},filterMap:function(n,r){return e.map(n,(function(e){return t.filterMap(e,r)}))},filter:function(n,r){return e.map(n,(function(e){return t.filter(e,r)}))}};return o}},830:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCompactableComposition=void 0;var r=n(831),i=n(574);t.getCompactableComposition=function(e,t){var n=r.getFunctorComposition(e,t),o={map:n.map,compact:function(n){return e.map(n,t.compact)},separate:function(e){return{left:o.compact(n.map(e,i.getLeft)),right:o.compact(n.map(e,i.getRight))}}};return o}},831:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctorComposition=void 0,t.getFunctorComposition=function(e,t){return{map:function(n,r){return e.map(n,(function(e){return t.map(e,r)}))}}}},832:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.bind=t.bindTo=t.never=t.taskSeq=t.task=t.Monad=t.ApplicativeSeq=t.ApplicativePar=t.Functor=t.getRaceMonoid=t.getMonoid=t.getSemigroup=t.URI=t.fromTask=t.flatten=t.chainFirst=t.chain=t.of=t.apSecond=t.apFirst=t.ap=t.map=t.chainIOK=t.fromIOK=t.delay=t.fromIO=void 0;var r=n(48);function i(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.fromIO(e.apply(void 0,n))}}t.fromIO=function(e){return function(){return Promise.resolve(e())}},t.delay=function(e){return function(t){return function(){return new Promise((function(n){setTimeout((function(){t().then(n)}),e)}))}}},t.fromIOK=i,t.chainIOK=function(e){return t.chain(i(e))};var o=function(e,n){return r.pipe(e,t.map(n))},a=function(e,n){return r.pipe(e,t.ap(n))},u=function(e,n){return r.pipe(e,t.chain((function(e){return r.pipe(n,t.map(e))})))},c=function(e,n){return r.pipe(e,t.chain(n))};function s(e){return{concat:function(t,n){return function(){return t().then((function(t){return n().then((function(n){return e.concat(t,n)}))}))}}}}t.map=function(e){return function(t){return function(){return t().then(e)}}},t.ap=function(e){return function(t){return function(){return Promise.all([t(),e()]).then((function(e){return(0,e[0])(e[1])}))}}},t.apFirst=function(e){return r.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return r.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=function(e){return function(){return Promise.resolve(e)}},t.chain=function(e){return function(t){return function(){return t().then((function(t){return e(t)()}))}}},t.chainFirst=function(e){return t.chain((function(n){return r.pipe(e(n),t.map((function(){return n})))}))},t.flatten=t.chain(r.identity),t.fromTask=r.identity,t.URI="Task",t.getSemigroup=s,t.getMonoid=function(e){return{concat:s(e).concat,empty:t.of(e.empty)}},t.getRaceMonoid=function(){return{concat:function(e,t){return function(){return Promise.race([e(),t()])}},empty:t.never}},t.Functor={URI:t.URI,map:o},t.ApplicativePar={URI:t.URI,map:o,ap:a,of:t.of},t.ApplicativeSeq={URI:t.URI,map:o,ap:u,of:t.of},t.Monad={URI:t.URI,map:o,of:t.of,ap:a,chain:c},t.task={URI:t.URI,map:o,of:t.of,ap:a,chain:c,fromIO:t.fromIO,fromTask:t.fromTask},t.taskSeq={URI:t.URI,map:o,of:t.of,ap:u,chain:c,fromIO:t.fromIO,fromTask:t.fromTask},t.never=function(){return new Promise((function(e){}))},t.bindTo=function(e){return t.map(r.bindTo_(e))},t.bind=function(e,n){return t.chain((function(i){return r.pipe(n(i),t.map((function(t){return r.bind_(i,e,t)})))}))},t.apS=function(e,n){return r.flow(t.map((function(t){return function(n){return r.bind_(t,e,n)}})),t.ap(n))}},833:function(e,t,n){e.exports=n(46)(2391)},909:function(e,t,n){const r=n(650),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(651),{re:a,t:u}=n(910),{compareIdentifiers:c}=n(911);class SemVer{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?a[u.LOOSE]:a[u.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=SemVer},910:function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:r}=n(651),i=n(650),o=(t=e.exports={}).re=[],a=t.src=[],u=t.t={};let c=0;const s=(e,t,n)=>{const r=c++;i(r,t),u[e]=r,a[r]=t,o[r]=new RegExp(t,n?"g":void 0)};s("NUMERICIDENTIFIER","0|[1-9]\\d*"),s("NUMERICIDENTIFIERLOOSE","[0-9]+"),s("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),s("MAINVERSION",`(${a[u.NUMERICIDENTIFIER]})\\.(${a[u.NUMERICIDENTIFIER]})\\.(${a[u.NUMERICIDENTIFIER]})`),s("MAINVERSIONLOOSE",`(${a[u.NUMERICIDENTIFIERLOOSE]})\\.(${a[u.NUMERICIDENTIFIERLOOSE]})\\.(${a[u.NUMERICIDENTIFIERLOOSE]})`),s("PRERELEASEIDENTIFIER",`(?:${a[u.NUMERICIDENTIFIER]}|${a[u.NONNUMERICIDENTIFIER]})`),s("PRERELEASEIDENTIFIERLOOSE",`(?:${a[u.NUMERICIDENTIFIERLOOSE]}|${a[u.NONNUMERICIDENTIFIER]})`),s("PRERELEASE",`(?:-(${a[u.PRERELEASEIDENTIFIER]}(?:\\.${a[u.PRERELEASEIDENTIFIER]})*))`),s("PRERELEASELOOSE",`(?:-?(${a[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[u.PRERELEASEIDENTIFIERLOOSE]})*))`),s("BUILDIDENTIFIER","[0-9A-Za-z-]+"),s("BUILD",`(?:\\+(${a[u.BUILDIDENTIFIER]}(?:\\.${a[u.BUILDIDENTIFIER]})*))`),s("FULLPLAIN",`v?${a[u.MAINVERSION]}${a[u.PRERELEASE]}?${a[u.BUILD]}?`),s("FULL",`^${a[u.FULLPLAIN]}$`),s("LOOSEPLAIN",`[v=\\s]*${a[u.MAINVERSIONLOOSE]}${a[u.PRERELEASELOOSE]}?${a[u.BUILD]}?`),s("LOOSE",`^${a[u.LOOSEPLAIN]}$`),s("GTLT","((?:<|>)?=?)"),s("XRANGEIDENTIFIERLOOSE",`${a[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),s("XRANGEIDENTIFIER",`${a[u.NUMERICIDENTIFIER]}|x|X|\\*`),s("XRANGEPLAIN",`[v=\\s]*(${a[u.XRANGEIDENTIFIER]})(?:\\.(${a[u.XRANGEIDENTIFIER]})(?:\\.(${a[u.XRANGEIDENTIFIER]})(?:${a[u.PRERELEASE]})?${a[u.BUILD]}?)?)?`),s("XRANGEPLAINLOOSE",`[v=\\s]*(${a[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[u.XRANGEIDENTIFIERLOOSE]})(?:${a[u.PRERELEASELOOSE]})?${a[u.BUILD]}?)?)?`),s("XRANGE",`^${a[u.GTLT]}\\s*${a[u.XRANGEPLAIN]}$`),s("XRANGELOOSE",`^${a[u.GTLT]}\\s*${a[u.XRANGEPLAINLOOSE]}$`),s("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),s("COERCERTL",a[u.COERCE],!0),s("LONETILDE","(?:~>?)"),s("TILDETRIM",`(\\s*)${a[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",s("TILDE",`^${a[u.LONETILDE]}${a[u.XRANGEPLAIN]}$`),s("TILDELOOSE",`^${a[u.LONETILDE]}${a[u.XRANGEPLAINLOOSE]}$`),s("LONECARET","(?:\\^)"),s("CARETTRIM",`(\\s*)${a[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",s("CARET",`^${a[u.LONECARET]}${a[u.XRANGEPLAIN]}$`),s("CARETLOOSE",`^${a[u.LONECARET]}${a[u.XRANGEPLAINLOOSE]}$`),s("COMPARATORLOOSE",`^${a[u.GTLT]}\\s*(${a[u.LOOSEPLAIN]})$|^$`),s("COMPARATOR",`^${a[u.GTLT]}\\s*(${a[u.FULLPLAIN]})$|^$`),s("COMPARATORTRIM",`(\\s*)${a[u.GTLT]}\\s*(${a[u.LOOSEPLAIN]}|${a[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",s("HYPHENRANGE",`^\\s*(${a[u.XRANGEPLAIN]})\\s+-\\s+(${a[u.XRANGEPLAIN]})\\s*$`),s("HYPHENRANGELOOSE",`^\\s*(${a[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[u.XRANGEPLAINLOOSE]})\\s*$`),s("STAR","(<|>)?=?\\s*\\*"),s("GTE0","^\\s*>=\\s*0.0.0\\s*$"),s("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},911:function(e,t){const n=/^[0-9]+$/,r=(e,t)=>{const r=n.test(e),i=n.test(t);return r&&i&&(e=+e,t=+t),e===t?0:r&&!i?-1:i&&!r?1:e<t?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},94:function(e,t,n){"use strict";var r=n(14);n.d(t,"a",(function(){return r}));var i=n(315);n.d(t,"b",(function(){return i}))}}]);