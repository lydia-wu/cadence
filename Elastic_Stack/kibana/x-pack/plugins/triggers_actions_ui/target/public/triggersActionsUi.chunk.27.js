/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[27],{135:function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return i}));var a=s(0),n=s(6);const r=e=>{switch(e){case"connectors":return{text:a.i18n.translate("xpack.triggersActionsUI.connectors.breadcrumbTitle",{defaultMessage:"Connectors"}),href:`${n.j}`};case"rules":return{text:a.i18n.translate("xpack.triggersActionsUI.rules.breadcrumbTitle",{defaultMessage:"Rules"}),href:`${n.m}`};default:return{text:a.i18n.translate("xpack.triggersActionsUI.home.breadcrumbTitle",{defaultMessage:"Rules and Connectors"}),href:`${n.k}`}}},i=(e,t)=>({text:t,href:`${n.l.replace(":ruleId",e)}`})},136:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(0);const n=e=>{let t;switch(e){case"connectors":t=a.i18n.translate("xpack.triggersActionsUI.connectors.breadcrumbTitle",{defaultMessage:"Connectors"});break;case"rules":t=a.i18n.translate("xpack.triggersActionsUI.rules.breadcrumbTitle",{defaultMessage:"Rules"});break;default:t=a.i18n.translate("xpack.triggersActionsUI.home.breadcrumbTitle",{defaultMessage:"Rules and Connectors"})}return t}},137:function(e,t,s){"use strict";s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return u}));var a=s(1),n=s(36),r=s(13),i=s(17),c=s(90),o=s(5);const l=({selectedStatuses:e,onChange:t})=>{const[s,l]=Object(a.useState)(e),[d,j]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{t&&t(s)}),[s]),Object(a.useEffect)((()=>{l(e)}),[e]),Object(o.jsx)(r.EuiFilterGroup,null,Object(o.jsx)(r.EuiPopover,{isOpen:d,closePopover:()=>j(!1),button:Object(o.jsx)(r.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:s.length>0,numActiveFilters:s.length,numFilters:s.length,onClick:()=>j(!d),"data-test-subj":"alertStatusFilterButton"},Object(o.jsx)(n.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsList.alertStatusFilterLabel",defaultMessage:"Status"}))},Object(o.jsx)("div",{className:"euiFilterSelect__items"},[...i.AlertExecutionStatusValues].sort().map((e=>{const t=u(e);return Object(o.jsx)(r.EuiFilterSelectItem,{key:e,style:{textTransform:"capitalize"},onClick:()=>{const t=s.includes(e);l(t?s.filter((t=>t!==e)):s.concat(e))},checked:s.includes(e)?"on":void 0,"data-test-subj":`alertStatus${e}FilerOption`},Object(o.jsx)(r.EuiHealth,{color:t},c.c[e]))})))))};function u(e){switch(e){case"active":return"success";case"error":return"danger";case"ok":return"primary";case"pending":return"accent";default:return"subdued"}}},191:function(e,t,s){switch(window.__kbnThemeTag__){case"v7dark":return s(192);case"v7light":return s(194);case"v8dark":return s(196);case"v8light":return s(198)}},192:function(e,t,s){var a=s(57),n=s(193);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var r={insert:"head",singleton:!1};a(n,r);e.exports=n.locals||{}},193:function(e,t,s){(t=s(58)(!1)).push([e.i,".actionsInstanceList__health{width:100%}.actionsInstanceList__health .euiFlexItem:last-of-type{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;min-width:0;width:85%}.ruleDurationWarningIcon{bottom:4px;position:relative}\n",""]),e.exports=t},194:function(e,t,s){var a=s(57),n=s(195);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var r={insert:"head",singleton:!1};a(n,r);e.exports=n.locals||{}},195:function(e,t,s){(t=s(58)(!1)).push([e.i,".actionsInstanceList__health{width:100%}.actionsInstanceList__health .euiFlexItem:last-of-type{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;min-width:0;width:85%}.ruleDurationWarningIcon{bottom:4px;position:relative}\n",""]),e.exports=t},196:function(e,t,s){var a=s(57),n=s(197);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var r={insert:"head",singleton:!1};a(n,r);e.exports=n.locals||{}},197:function(e,t,s){(t=s(58)(!1)).push([e.i,".actionsInstanceList__health{width:100%}.actionsInstanceList__health .euiFlexItem:last-of-type{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;min-width:0;width:85%}.ruleDurationWarningIcon{bottom:4px;position:relative}\n",""]),e.exports=t},198:function(e,t,s){var a=s(57),n=s(199);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var r={insert:"head",singleton:!1};a(n,r);e.exports=n.locals||{}},199:function(e,t,s){(t=s(58)(!1)).push([e.i,".actionsInstanceList__health{width:100%}.actionsInstanceList__health .euiFlexItem:last-of-type{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;min-width:0;width:85%}.ruleDurationWarningIcon{bottom:4px;position:relative}\n",""]),e.exports=t},246:function(e,t,s){"use strict";s.r(t),s.d(t,"AlertDetailsRoute",(function(){return Y})),s.d(t,"getRuleData",(function(){return V})),s.d(t,"default",(function(){return J}));var a=s(0),n=s(1),r=s.n(n),i=s(13),c=s(2),o=s(37),l=s(36),u=s(17),d=s(63),j=s(135),p=s(136),b=s(87),g=s(23),x=s.n(g),m=s(51),O=s(6),f=(s(191),s(5));const h=({alertInstance:e,onMuteAction:t,disabled:s})=>{const[a,r]=Object(n.useState)(null==e?void 0:e.isMuted),[c,o]=Object(n.useState)(!1);return c?Object(f.jsx)(i.EuiLoadingSpinner,{size:"m"}):Object(f.jsx)(i.EuiSwitch,{name:"mute",disabled:s,compressed:!0,checked:a,onChange:async()=>{o(!0),await t(e),r(!a),o(!1)},"data-test-subj":`muteAlertInstanceButton_${e.instance}`,showLabel:!1,label:"mute"})};var y=s(137),I=s(90),E=s(99),A=s(52),w=s(53);const v=({executionDuration:e})=>{const t=function(e,t){const s=Object.entries(e);return s.length===t?s:s.length<t?Object(c.assign)(Object(c.fill)(new Array(t),[null,null]),s):s.slice(-t)}(e.valuesWithTimestamp,30);return Object(f.jsx)(i.EuiPanel,{"data-test-subj":"executionDurationChartPanel",hasBorder:!0},Object(f.jsx)(i.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(i.EuiTitle,{size:"xxs"},Object(f.jsx)("h4",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.executionDurationChart.recentDurationsTitle",defaultMessage:"Recent execution durations"})))),Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(i.EuiIconTip,{color:"subdued",type:"questionInCircle",content:a.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.recentDurationsTooltip",{defaultMessage:"Recent rule executions include up to the last {numExecutions} executions.",values:{numExecutions:30}}),position:"top"}))),e.valuesWithTimestamp&&Object.entries(e.valuesWithTimestamp).length>0?Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)(w.Chart,{"data-test-subj":"executionDurationChart",size:{height:80}},Object(f.jsx)(w.Settings,{theme:{lineSeriesStyle:{point:{visible:!1},line:{stroke:A.euiLightVars.euiColorAccent}}}}),Object(f.jsx)(w.BarSeries,{id:"executionDuration",name:a.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.durationLabel",{defaultMessage:"Duration"}),xScaleType:"linear",yScaleType:"linear",xAccessor:0,yAccessors:[1],data:t.map((([e,t],s)=>[e?x()(e).format("D MMM YYYY @ HH:mm:ss"):s,t])),minBarHeight:2}),Object(f.jsx)(w.LineSeries,{id:"rule_duration_avg",name:a.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.avgDurationLabel",{defaultMessage:"Avg Duration"}),xScaleType:"linear",yScaleType:"linear",xAccessor:0,yAccessors:[1],data:t.map((([t,s],a)=>[t?x()(t).format("D MMM YYYY @ HH:mm:ss"):a,s?e.average:null])),curve:w.CurveType.CURVE_NATURAL}),Object(f.jsx)(w.Axis,{id:"left-axis",position:"left",tickFormat:e=>Object(E.a)(e)}))):Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)(i.EuiEmptyPrompt,{"data-test-subj":"executionDurationChartEmpty",body:Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)("p",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.executionDurationChart.executionDurationNoData",defaultMessage:"There are no available executions for this rule."})))})))};const S=(e,t)=>[{field:"instance",name:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.alert",{defaultMessage:"Alert"}),sortable:!1,truncateText:!0,width:"45%","data-test-subj":"alertInstancesTableCell-instance",render:e=>Object(f.jsx)(i.EuiToolTip,{anchorClassName:"eui-textTruncate",content:e},Object(f.jsx)("span",null,e))},{field:"status",name:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.status",{defaultMessage:"Status"}),width:"15%",render:(e,t)=>Object(f.jsx)(i.EuiHealth,{color:e.healthColor,className:"actionsInstanceList__health"},e.label,e.actionGroup?` (${e.actionGroup})`:""),sortable:!1,"data-test-subj":"alertInstancesTableCell-status"},{field:"start",width:"190px",render:(e,t)=>e?x()(e).format("D MMM YYYY @ HH:mm:ss"):"",name:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.start",{defaultMessage:"Start"}),sortable:!1,"data-test-subj":"alertInstancesTableCell-start"},{field:"duration",render:(e,t)=>{return e?[(s=x.a.duration(e)).hours(),s.minutes(),s.seconds()].map((e=>Object(c.padStart)(`${e}`,2,"0"))).join(":"):"";var s},name:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.duration",{defaultMessage:"Duration"}),sortable:!1,width:"80px","data-test-subj":"alertInstancesTableCell-duration"},{field:"",align:m.RIGHT_ALIGNMENT,width:"60px",name:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.mute",{defaultMessage:"Mute"}),render:s=>Object(f.jsx)(h,{disabled:t,onMuteAction:async()=>await e(s),alertInstance:s}),sortable:!1,"data-test-subj":"alertInstancesTableCell-actions"}];const T=Object(b.a)((function({alert:e,alertType:t,readOnly:s,alertInstanceSummary:o,muteAlertInstance:l,unmuteAlertInstance:d,requestRefresh:j,durationEpoch:p=Date.now()}){var b;const[g,x]=Object(n.useState)({index:0,size:O.d}),m=Object.entries(o.instances).map((([e,s])=>function(e,t,s,a){const n=!(null==a||!a.muted),r="Active"===(null==a?void 0:a.status)?{label:k,actionGroup:D(t,null==a?void 0:a.actionGroupId),healthColor:"primary"}:{label:M,healthColor:"subdued"},i=null!=a&&a.activeStartDate?new Date(a.activeStartDate):void 0,c=i?e-i.valueOf():0,o=function(e){switch(e){case"Active":return 0;case"OK":return 1}return 2}(null==a?void 0:a.status);return{instance:s,status:r,start:i,duration:c,isMuted:n,sortPriority:o}}(p,t,e,s))).sort(((e,t)=>e.sortPriority-t.sortPriority)),h=function(e,t){return Object(c.chunk)(e,t.size)[t.index]||[]}(m,g),A=Object(E.b)(t,o.executionDuration.average),w=Object(y.b)(e.executionStatus.status),T=(null===(b=e.executionStatus.error)||void 0===b?void 0:b.reason)===u.AlertExecutionStatusErrorReasons.License?I.a:I.c[e.executionStatus.status];return Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)(i.EuiHorizontalRule,null),Object(f.jsx)(i.EuiFlexGroup,null,Object(f.jsx)(i.EuiFlexItem,{grow:1},Object(f.jsx)(i.EuiPanel,{color:"subdued",hasBorder:!1},Object(f.jsx)(i.EuiStat,{"data-test-subj":`ruleStatus-${e.executionStatus.status}`,titleSize:"xs",title:Object(f.jsx)(i.EuiHealth,{"data-test-subj":`ruleStatus-${e.executionStatus.status}`,textSize:"inherit",color:w},T),description:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.ruleLastExecutionDescription",{defaultMessage:"Last response"})}))),Object(f.jsx)(i.EuiFlexItem,{grow:1},Object(f.jsx)(i.EuiPanel,{"data-test-subj":"avgExecutionDurationPanel",color:A?"warning":"subdued",hasBorder:!1},Object(f.jsx)(i.EuiStat,{"data-test-subj":"avgExecutionDurationStat",titleSize:"xs",title:Object(f.jsx)(i.EuiFlexGroup,{gutterSize:"xs"},A&&Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(i.EuiIconTip,{"data-test-subj":"ruleDurationWarning",anchorClassName:"ruleDurationWarningIcon",type:"alert",color:"warning",content:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.ruleTypeExcessDurationMessage",{defaultMessage:"Duration exceeds the rule's expected run time."}),position:"top"})),Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(E.a)(o.executionDuration.average))),description:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.avgDurationDescription",{defaultMessage:"Average duration"})}))),Object(f.jsx)(i.EuiFlexItem,{grow:4},Object(f.jsx)(v,{executionDuration:o.executionDuration}))),Object(f.jsx)(i.EuiSpacer,{size:"xl"}),Object(f.jsx)("input",{type:"hidden","data-test-subj":"alertInstancesDurationEpoch",name:"alertInstancesDurationEpoch",value:p}),Object(f.jsx)(i.EuiBasicTable,{items:h,pagination:{pageIndex:g.index,pageSize:g.size,totalItemCount:m.length},onChange:({page:e})=>{x(e)},rowProps:()=>({"data-test-subj":"alert-instance-row"}),cellProps:()=>({"data-test-subj":"cell"}),columns:S((async t=>{await(t.isMuted?d(e,t.instance):l(e,t.instance)),j()}),s),"data-test-subj":"alertInstancesList",tableLayout:"fixed",className:"alertInstancesList"}))}));const k=a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.status.active",{defaultMessage:"Active"}),M=a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.status.inactive",{defaultMessage:"Recovered"});function D(e,t){var s;t=t||e.defaultActionGroupId;const a=null==e||null===(s=e.actionGroups)||void 0===s?void 0:s.find((e=>e.id===t));return null==a?void 0:a.name}var F=s(59),L=s(22);const U=Object(b.a)((({alert:e,alertType:t,readOnly:s,requestRefresh:r,loadAlertInstanceSummary:i})=>{const{notifications:{toasts:c}}=Object(F.b)().services,[o,l]=Object(n.useState)(null);return Object(n.useEffect)((()=>{!async function(e,t,s,n){try{s(await t(e))}catch(e){n.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.unableToLoadAlertsMessage",{defaultMessage:"Unable to load alerts: {message}",values:{message:e.message}})})}}(e.id,i,l,c)}),[e]),o?Object(f.jsx)(T,{requestRefresh:r,alert:e,alertType:t,readOnly:s,alertInstanceSummary:o}):Object(f.jsx)(L.a,null)}));var _=s(75),C=s.n(_),R=s(82),B=s(85);const P=!1,z=({alert:e})=>{const{application:{navigateToApp:t},alerting:s}=Object(F.b)().services,[a,r]=Object(n.useState)(null);return Object(n.useEffect)((()=>{Object(B.pipe)(Object(R.fromNullable)(s),Object(R.fold)((()=>r(P)),(t=>t.getNavigation(e.id).then((e=>r(e||P))).catch((()=>{r(P)})))))}),[e.id,s]),Object(f.jsx)(i.EuiButtonEmpty,C()({"data-test-subj":"alertDetails-viewInApp",isLoading:null===a,disabled:!$(a),iconType:"popout"},function(e,t,s){return $(e)?{onClick:()=>{s(t.consumer,e)}}:{}}(a,e,t)),Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.viewAlertInAppButtonLabel",defaultMessage:"View in app"}))};function $(e){return e?e.hasOwnProperty("state")||e.hasOwnProperty("path"):P}var G=s(15),N=s(98),W=s(76);const H=Object(b.a)((({alert:e,alertType:t,actionTypes:s,disableAlert:b,enableAlert:g,unmuteAlert:x,muteAlert:m,requestRefresh:h})=>{var y,E;const A=Object(o.useHistory)(),{application:{capabilities:w},ruleTypeRegistry:v,actionTypeRegistry:S,setBreadcrumbs:T,chrome:k,http:M}=Object(F.b)().services,[{},D]=Object(n.useReducer)(N.a,{alert:e}),[L,_]=Object(n.useState)(!1);Object(n.useEffect)((()=>{T([Object(j.b)("alerts"),Object(j.a)(e.id,e.name)]),k.docTitle.change(Object(p.a)("alerts"))}),[]),Object(n.useEffect)((()=>{(async()=>{let t=[];try{t=await Object(W.e)({http:M})}catch(e){t=[]}if(t.length>0){const s=e.actions.some((e=>!t.find((t=>t.id===e.id))));_&&_(s)}})()}),[]);const C=Object(d.c)(w),R=Object(d.a)(e,t)&&(C||!C&&0===e.actions.length),B=Object(c.keyBy)(s,"id"),P=R&&!!v.has(e.alertTypeId)&&!v.get(e.alertTypeId).requiresAppContext,$=e.actions,H=Array.from(new Set($.map((e=>e.actionTypeId)))),[q,Y]=Object(n.useState)(e.enabled),[V,J]=Object(n.useState)(!1),[K,Q]=Object(n.useState)(!1),[X,Z]=Object(n.useState)(e.muteAll),[ee,te]=Object(n.useState)(!1),[se,ae]=Object(n.useState)(!1),ne=P?[Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)(i.EuiButtonEmpty,{"data-test-subj":"openEditAlertFlyoutButton",iconType:"pencil",onClick:()=>te(!0),name:"edit",disabled:!t.enabledInLicense},Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.editAlertButtonLabel",defaultMessage:"Edit"})),ee&&Object(f.jsx)(G.b,{initialAlert:e,onClose:()=>{D({command:{type:"setAlert"},payload:{key:"alert",value:e}}),te(!1)},actionTypeRegistry:S,ruleTypeRegistry:v,ruleType:t,onSave:async()=>{A.push(O.l.replace(":ruleId",e.id))}}))]:[];return Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)(i.EuiPageHeader,{"data-test-subj":"alertDetailsTitle",bottomBorder:!0,pageTitle:Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.alertDetailsTitle",defaultMessage:"{alertName}",values:{alertName:e.name}}),rightSideItems:[Object(f.jsx)(z,{alert:e}),Object(f.jsx)(i.EuiButtonEmpty,{"data-test-subj":"refreshAlertsButton",iconType:"refresh",onClick:h,name:"refresh",color:"primary"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsList.refreshAlertsButtonLabel",defaultMessage:"Refresh"})),...ne]}),Object(f.jsx)(i.EuiSpacer,{size:"l"}),Object(f.jsx)(i.EuiPageContentBody,null,Object(f.jsx)(i.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"m"},Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(i.EuiText,{size:"s"},Object(f.jsx)("p",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsList.alertsListTable.columns.alertTypeTitle",defaultMessage:"Type"}))),Object(f.jsx)(i.EuiSpacer,{size:"xs"}),Object(f.jsx)(i.EuiBadge,{"data-test-subj":"alertTypeLabel"},t.name)),Object(f.jsx)(i.EuiFlexItem,{grow:1},H&&H.length?Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)(i.EuiText,{size:"s"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsList.alertsListTable.columns.actionsTex",defaultMessage:"Actions"})," ",L&&Object(f.jsx)(i.EuiIconTip,{"data-test-subj":"actionWithBrokenConnector",type:"alert",color:"danger",content:a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertsListTable.columns.actionsWarningTooltip",{defaultMessage:"Unable to load one of the connectors associated with this rule. Edit the rule to select a new connector."}),position:"right"})),Object(f.jsx)(i.EuiSpacer,{size:"xs"}),Object(f.jsx)(i.EuiFlexGroup,{wrap:!0,gutterSize:"s"},H.map(((e,t)=>{var s;return Object(f.jsx)(i.EuiFlexItem,{key:t,grow:!1},Object(f.jsx)(i.EuiBadge,{color:"hollow","data-test-subj":"actionTypeLabel"},null!==(s=B[e].name)&&void 0!==s?s:e))})))):null),Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(i.EuiSpacer,null),Object(f.jsx)(i.EuiFlexGroup,{justifyContent:"flexEnd",wrap:!0,responsive:!1,gutterSize:"m"},Object(f.jsx)(i.EuiFlexItem,{grow:!1},V?Object(f.jsx)(i.EuiFlexGroup,null,Object(f.jsx)(i.EuiFlexItem,null,Object(f.jsx)(i.EuiLoadingSpinner,{"data-test-subj":"enableSpinner",size:"m"})),Object(f.jsx)(i.EuiFlexItem,null,Object(f.jsx)(i.EuiText,{size:"s"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.collapsedItemActons.enableLoadingTitle",defaultMessage:"Enable"})))):Object(f.jsx)(i.EuiSwitch,{name:"enable",disabled:!R||!t.enabledInLicense,checked:q,"data-test-subj":"enableSwitch",onChange:async()=>{J(!0),q?(Y(!1),await b(e),ae(!1)):(Y(!0),await g(e)),h(),J(!1)},label:Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.collapsedItemActons.enableTitle",defaultMessage:"Enable"})})),Object(f.jsx)(i.EuiFlexItem,{grow:!1},K?Object(f.jsx)(i.EuiFlexGroup,null,Object(f.jsx)(i.EuiFlexItem,null,Object(f.jsx)(i.EuiLoadingSpinner,{size:"m"})),Object(f.jsx)(i.EuiFlexItem,null,Object(f.jsx)(i.EuiText,{size:"s"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.collapsedItemActons.muteLoadingTitle",defaultMessage:"Mute"})))):Object(f.jsx)(i.EuiSwitch,{name:"mute",checked:X,disabled:!R||!q||!t.enabledInLicense,"data-test-subj":"muteSwitch",onChange:async()=>{Q(!0),X?(Z(!1),await x(e)):(Z(!0),await m(e)),h(),Q(!1)},label:Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.collapsedItemActons.muteTitle",defaultMessage:"Mute"})}))))),e.enabled&&!se&&"error"===e.executionStatus.status?Object(f.jsx)(i.EuiFlexGroup,null,Object(f.jsx)(i.EuiFlexItem,null,Object(f.jsx)(i.EuiCallOut,{color:"danger","data-test-subj":"alertErrorBanner",size:"s",title:e.executionStatus.error&&e.executionStatus.error.reason?I.b[e.executionStatus.error.reason]:I.b.unknown,iconType:"alert"},Object(f.jsx)(i.EuiText,{size:"s",color:"danger","data-test-subj":"alertErrorMessageText"},null===(y=e.executionStatus.error)||void 0===y?void 0:y.message),Object(f.jsx)(i.EuiSpacer,{size:"s"}),Object(f.jsx)(i.EuiFlexGroup,{gutterSize:"s",wrap:!0},Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(i.EuiButton,{"data-test-subj":"dismiss-execution-error",color:"danger",onClick:()=>ae(!0)},Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.dismissButtonTitle",defaultMessage:"Dismiss"}))),(null===(E=e.executionStatus.error)||void 0===E?void 0:E.reason)===u.AlertExecutionStatusErrorReasons.License&&Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(i.EuiButtonEmpty,{href:`${M.basePath.get()}/app/management/stack/license_management`,color:"danger",target:"_blank"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.manageLicensePlanBannerLinkTitle",defaultMessage:"Manage license"}))))))):null,L&&Object(f.jsx)(i.EuiFlexGroup,null,Object(f.jsx)(i.EuiFlexItem,null,Object(f.jsx)(i.EuiSpacer,{size:"s"}),Object(f.jsx)(i.EuiCallOut,{color:"warning","data-test-subj":"actionWithBrokenConnectorWarningBanner",size:"s",title:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.actionWithBrokenConnectorWarningBannerTitle",{defaultMessage:"There is an issue with one of the connectors associated with this rule."})},P&&Object(f.jsx)(i.EuiFlexGroup,{gutterSize:"s",wrap:!0},Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(i.EuiButton,{"data-test-subj":"actionWithBrokenConnectorWarningBannerEdit",color:"warning",onClick:()=>te(!0)},Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.actionWithBrokenConnectorWarningBannerEditText",defaultMessage:"Edit rule"}))))))),Object(f.jsx)(i.EuiFlexGroup,null,Object(f.jsx)(i.EuiFlexItem,null,e.enabled?Object(f.jsx)(U,{requestRefresh:h,alert:e,alertType:t,readOnly:!R}):Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)(i.EuiSpacer,null),Object(f.jsx)(i.EuiPageTemplate,{template:"empty"},Object(f.jsx)(i.EuiEmptyPrompt,{"data-test-subj":"disabledEmptyPrompt",title:Object(f.jsx)("h2",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.alerts.disabledRuleTitle",defaultMessage:"Disabled Rule"})),body:Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)("p",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.alertInstances.disabledRule",defaultMessage:"This rule is disabled and cannot be displayed."}))),actions:[Object(f.jsx)(i.EuiButton,{"data-test-subj":"disabledEmptyPromptAction",color:"primary",fill:!0,disabled:V,onClick:async()=>{J(!0),Y(!0),await g(e),h(),J(!1)}},"Enable")]})))))))}));var q=s(4);const Y=({match:{params:{ruleId:e}},loadAlertTypes:t,loadActionTypes:s,resolveRule:c})=>{const{http:o,notifications:{toasts:l},spaces:u}=Object(F.b)().services,{basePath:d}=o,[j,p]=Object(n.useState)(null),[b,g]=Object(n.useState)(null),[x,m]=Object(n.useState)(null),[O,h]=r.a.useState();Object(n.useEffect)((()=>{V(e,t,c,s,p,g,m,l)}),[e,o,s,t,c,l,O]),Object(n.useEffect)((()=>{if(j){const e=j.outcome;if(u&&"aliasMatch"===e){const e=d.prepend(`insightsAndAlerting/triggersActions/rule/${j.id}`);u.ui.redirectLegacyUrl(e,a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.redirectObjectNoun",{defaultMessage:"rule"}))}}}),[j]);return j&&b&&x?Object(f.jsx)(r.a.Fragment,null,(()=>{const e=j.outcome;if(u&&"conflict"===e){const e=j.alias_target_id,t=d.prepend(`insightsAndAlerting/triggersActions/rule/${e}`);return Object(f.jsx)(r.a.Fragment,null,Object(f.jsx)(i.EuiSpacer,null),u.ui.components.getLegacyUrlConflict({objectNoun:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.redirectObjectNoun",{defaultMessage:"rule"}),currentObjectId:null==j?void 0:j.id,otherObjectId:e,otherObjectPath:t}))}return null})(),Object(f.jsx)(H,{alert:j,alertType:b,actionTypes:x,requestRefresh:async()=>h(Date.now())})):Object(f.jsx)(L.a,null)};async function V(e,t,s,n,r,i,c,o){try{const a=await s(e);r(a);const[o,l]=await Promise.all([t().then((e=>e.find((e=>e.id===a.alertTypeId)))).then(Object(q.d)(`Invalid Rule Type: ${a.alertTypeId}`)),n().then(Object(q.e)(new Set(a.actions.map((e=>e.actionTypeId))),(e=>`Invalid Connector Type: ${e}`),(e=>e.id)))]);i(o),c(l)}catch(e){o.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.unableToLoadAlertMessage",{defaultMessage:"Unable to load rule: {message}",values:{message:e.message}})})}}const J=(K=Object(b.a)(Y),e=>{const{http:t}=Object(F.b)().services;return Object(f.jsx)(K,C()({},e,{loadActionTypes:async()=>Object(W.d)({http:t})}))});var K},75:function(e,t,s){e.exports=s(30)(1074)},76:function(e,t,s){"use strict";s.d(t,"d",(function(){return a.a})),s.d(t,"e",(function(){return i})),s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return l})),s.d(t,"c",(function(){return u})),s.d(t,"f",(function(){return d}));var a=s(21),n=s(6);const r=({connector_type_id:e,is_preconfigured:t,referenced_by_count:s,is_missing_secrets:a,...n})=>({actionTypeId:e,isPreconfigured:t,referencedByCount:s,isMissingSecrets:a,...n});async function i({http:e}){const t=await e.get(`${n.a}/connectors`);return t.map((e=>r(e)))}const c=({actionTypeId:e,isPreconfigured:t,...s})=>({...s,connector_type_id:e,is_preconfigured:t});async function o({http:e,connector:t}){return(({connector_type_id:e,is_preconfigured:t,is_missing_secrets:s,...a})=>({...a,actionTypeId:e,isPreconfigured:t,isMissingSecrets:s}))(await e.post(`${n.a}/connector`,{body:JSON.stringify(c(t))}))}async function l({ids:e,http:t}){const s=[],a=[];return await Promise.all(e.map((e=>t.delete(`${n.a}/connector/${encodeURIComponent(e)}`)))).then((function(e){s.push(...e)}),(function(e){a.push(...e)})),{successes:s,errors:a}}async function u({id:e,params:t,http:s}){return(({connector_id:e,service_message:t,...s})=>({...s,actionId:e,serviceMessage:t}))(await s.post(`${n.a}/connector/${encodeURIComponent(e)}/_execute`,{body:JSON.stringify({params:t})}))}async function d({http:e,connector:t,id:s}){return(({connector_type_id:e,is_preconfigured:t,is_missing_secrets:s,...a})=>({...a,actionTypeId:e,isPreconfigured:t,isMissingSecrets:s}))(await e.put(`${n.a}/connector/${encodeURIComponent(s)}`,{body:JSON.stringify({name:t.name,config:t.config,secrets:t.secrets})}))}},87:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s(75),n=s.n(a),r=(s(1),s(83)),i=s(59),c=s(5);function o(e){return t=>{const{http:s}=Object(i.b)().services;return Object(c.jsx)(e,n()({},t,{muteAlerts:async e=>Object(r.p)({http:s,ids:e.filter((e=>!u(e))).map((e=>e.id))}),unmuteAlerts:async e=>Object(r.t)({http:s,ids:e.filter(u).map((e=>e.id))}),enableAlerts:async e=>Object(r.g)({http:s,ids:e.filter(l).map((e=>e.id))}),disableAlerts:async e=>Object(r.e)({http:s,ids:e.filter((e=>!l(e))).map((e=>e.id))}),deleteAlerts:async e=>Object(r.c)({http:s,ids:e.map((e=>e.id))}),muteAlert:async e=>{if(!u(e))return await Object(r.n)({http:s,id:e.id})},unmuteAlert:async e=>{if(u(e))return await Object(r.r)({http:s,id:e.id})},muteAlertInstance:async(e,t)=>{if(!d(e,t))return Object(r.o)({http:s,id:e.id,instanceId:t})},unmuteAlertInstance:async(e,t)=>{if(d(e,t))return Object(r.s)({http:s,id:e.id,instanceId:t})},enableAlert:async e=>{if(l(e))return await Object(r.f)({http:s,id:e.id})},disableAlert:async e=>{if(!l(e))return await Object(r.d)({http:s,id:e.id})},deleteAlert:async e=>Object(r.c)({http:s,ids:[e.id]}),loadAlert:async e=>Object(r.h)({http:s,alertId:e}),loadAlertState:async e=>Object(r.k)({http:s,alertId:e}),loadAlertInstanceSummary:async e=>Object(r.j)({http:s,alertId:e}),loadAlertTypes:async()=>Object(r.l)({http:s}),resolveRule:async e=>Object(r.q)({http:s,ruleId:e}),getHealth:async()=>Object(r.a)({http:s})}))}}function l(e){return!1===e.enabled}function u(e){return!0===e.muteAll}function d(e,t){return e.mutedInstanceIds.findIndex((e=>e===t))>=0}},90:function(e,t,s){"use strict";s.d(t,"a",(function(){return c})),s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return u}));var a=s(0);const n=a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusOk",{defaultMessage:"Ok"}),r=a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusActive",{defaultMessage:"Active"}),i=a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusError",{defaultMessage:"Error"}),c=a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusLicenseError",{defaultMessage:"License Error"}),o={ok:n,active:r,error:i,pending:a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusPending",{defaultMessage:"Pending"}),unknown:a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusUnknown",{defaultMessage:"Unknown"})},l=a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonUnknown",{defaultMessage:"An error occurred for unknown reasons."}),u={read:a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonReading",{defaultMessage:"An error occurred when reading the rule."}),decrypt:a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonDecrypting",{defaultMessage:"An error occurred when decrypting the rule."}),execute:a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonRunning",{defaultMessage:"An error occurred when running the rule."}),unknown:l,license:a.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonLicense",{defaultMessage:"Cannot run rule"})}},98:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(2);const n=(e,t)=>{const{alert:s}=e;switch(t.command.type){case"setAlert":{const{key:s,value:a}=t.payload;return"alert"===s?{...e,alert:a}:e}case"setProperty":{const{key:n,value:r}=t.payload;return Object(a.isEqual)(s[n],r)?e:{...e,alert:{...s,[n]:r}}}case"setScheduleProperty":{const{key:n,value:r}=t.payload;return s.schedule&&Object(a.isEqual)(s.schedule[n],r)?e:{...e,alert:{...s,schedule:{...s.schedule,[n]:r}}}}case"setAlertParams":{const{key:n,value:r}=t.payload;return Object(a.isEqual)(s.params[n],r)?e:{...e,alert:{...s,params:{...s.params,[n]:r}}}}case"setAlertActionParams":{const{key:n,value:r,index:i}=t.payload;if(void 0===i||null==s.actions[i]||s.actions[i][n]&&Object(a.isEqual)(s.actions[i][n],r))return e;{const t=s.actions.splice(i,1)[0],a={...t,params:{...t.params,[n]:r}};return s.actions.splice(i,0,a),{...e,alert:{...s,actions:[...s.actions]}}}}case"setAlertActionProperty":{const{key:n,value:r,index:i}=t.payload;if(void 0===i||Object(a.isEqual)(s.actions[i][n],r))return e;{const t={...s.actions.splice(i,1)[0],[n]:r};return s.actions.splice(i,0,t),{...e,alert:{...s,actions:[...s.actions]}}}}}}},99:function(e,t,s){"use strict";s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return o}));var a=s(23),n=s.n(a),r=s(2),i=s(17);function c(e){if(!e)return"00:00:00.000";const t=n.a.duration(e);return`${[t.hours(),t.minutes(),t.seconds()].map((e=>Object(r.padStart)(`${e}`,2,"0"))).join(":")}.${Object(r.padStart)(`${t.milliseconds()}`,3,"0")}`}function o(e,t){if(!e||!e.ruleTaskTimeout)return!1;const s=e.ruleTaskTimeout;return t>Object(i.parseDuration)(s)}}}]);