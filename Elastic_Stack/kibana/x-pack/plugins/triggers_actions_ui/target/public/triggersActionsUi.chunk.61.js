/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[61],{290:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return E}));var a=i(1),s=i.n(a),n=i(13),l=i(59),r=i(74),o=i(77),c=i(73),u=i(103);var d=i(78),b=i(5);const j=["severity"],f=[{label:c.SOURCE,fieldKey:"source"},{label:c.NODE,fieldKey:"node"},{label:c.TYPE,fieldKey:"type"},{label:c.RESOURCE,fieldKey:"resource"},{label:c.METRIC_NAME,fieldKey:"metric_name"},{label:c.EVENT_CLASS,fieldKey:"event_class"},{label:c.MESSAGE_KEY,fieldKey:"message_key"}],m=JSON.stringify({alert:{id:"{{alert.id}}",actionGroup:"{{alert.actionGroup}}",actionSubgroup:"{{alert.actionSubgroup}}",actionGroupName:"{{alert.actionGroupName}}"},rule:{id:"{{rule.id}}",name:"{{rule.name}}",type:"{{rule.type}}"},date:"{{date}}"}),E=({actionConnector:e,actionParams:t,editAction:i,index:E,messageVariables:O,errors:v})=>{var y;const p=Object(a.useMemo)((()=>{var e;return null!==(e=t.subActionParams)&&void 0!==e?e:{}}),[t.subActionParams]),{description:g,severity:A}=p,{http:S,notifications:{toasts:_}}=Object(l.b)().services,x=Object(a.useRef)(null!==(y=null==e?void 0:e.id)&&void 0!==y?y:""),{choices:h,isLoading:C}=(({http:e,actionConnector:t,toastNotifications:i,fields:s})=>{const n=Object(a.useMemo)((()=>s.reduce(((e,t)=>({...e,[t]:[]})),{})),[s]),[l,r]=Object(a.useState)(n),o=Object(a.useCallback)((e=>{r(e.reduce(((e,t)=>{var i;return{...e,[t.element]:[...null!==(i=e[t.element])&&void 0!==i?i:[],t]}}),n))}),[n]),{isLoading:c}=Object(u.a)({http:e,toastNotifications:i,actionConnector:t,fields:s,onSuccess:o});return{choices:l,isLoading:c}})({http:S,toastNotifications:_,actionConnector:e,fields:j}),N=Object(a.useMemo)((()=>Object(d.b)(h.severity)),[h.severity]),K=Object(a.useCallback)(((e,t)=>{i("subActionParams",{...p,[e]:t},E)}),[i,E,p]);return Object(a.useEffect)((()=>{null!=e&&x.current!==e.id&&(x.current=e.id,i("subActionParams",{additional_info:m,message_key:"{{rule.id}}:{{alert.id}}"},E))}),[e]),Object(a.useEffect)((()=>{t.subAction||i("subAction","addEvent",E),t.subActionParams||i("subActionParams",{additional_info:m,message_key:"{{rule.id}}:{{alert.id}}"},E)}),[t]),Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(n.EuiTitle,{size:"s"},Object(b.jsx)("h3",null,c.EVENT)),Object(b.jsx)(n.EuiSpacer,{size:"m"}),f.map((e=>{var t;return Object(b.jsx)(s.a.Fragment,{key:e.fieldKey},Object(b.jsx)(n.EuiFormRow,{fullWidth:!0,label:e.label},Object(b.jsx)(o.a,{index:E,editAction:K,messageVariables:O,paramsProperty:e.fieldKey,inputTargetValue:null!==(t=p[e.fieldKey])&&void 0!==t?t:void 0})),Object(b.jsx)(n.EuiSpacer,{size:"m"}))})),Object(b.jsx)(n.EuiFormRow,{fullWidth:!0,label:c.SEVERITY_REQUIRED_LABEL,error:v.severity,isInvalid:Object(d.d)(A,v.severity)},Object(b.jsx)(n.EuiSelect,{fullWidth:!0,hasNoInitialSelection:!0,"data-test-subj":"severitySelect",isLoading:C,disabled:C,options:N,value:null!=A?A:"",onChange:e=>K("severity",e.target.value),isInvalid:Object(d.d)(A,v.severity)})),Object(b.jsx)(r.a,{index:E,editAction:K,messageVariables:O,paramsProperty:"description",inputTargetValue:null!=g?g:void 0,label:c.DESCRIPTION_LABEL}))}}}]);