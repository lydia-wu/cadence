/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[63],{267:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return p}));var s=i(1),o=i.n(s),n=i(13),c=i(36),a=i(59),r=i(74),l=i(77),u=i(73),b=i(103),d=i(78),j=i(5);const m=["category","subcategory","priority"],O={category:[],subcategory:[],priority:[]},p=({actionConnector:e,actionParams:t,editAction:i,index:p,errors:g,messageVariables:x})=>{var E,A,v,h,y,_,f;const{docLinks:I,http:S,notifications:{toasts:L}}=Object(a.b)().services,P=Object(s.useRef)(null!==(E=null==e?void 0:e.id)&&void 0!==E?E:""),{incident:R,comments:T}=Object(s.useMemo)((()=>{var e;return null!==(e=t.subActionParams)&&void 0!==e?e:{incident:{},comments:[]}}),[t.subActionParams]),[C,F]=Object(s.useState)(O),N=Object(s.useCallback)(((e,t)=>{const s="comments"!==e?{incident:{...R,[e]:t},comments:T}:{incident:R,[e]:t};i("subActionParams",s,p)}),[T,i,R,p]),w=Object(s.useCallback)(((e,t)=>{t.length>0&&N(e,[{commentId:"1",comment:t}])}),[N]),V=Object(s.useCallback)((e=>{F(e.reduce(((e,t)=>({...e,[t.element]:[...null!=e[t.element]?e[t.element]:[],t]})),O))}),[]),{isLoading:W}=Object(b.a)({http:S,toastNotifications:L,actionConnector:e,fields:m,onSuccess:V}),k=Object(s.useMemo)((()=>Object(d.b)(C.category)),[C.category]),M=Object(s.useMemo)((()=>Object(d.b)(C.priority)),[C.priority]),z=Object(s.useMemo)((()=>Object(d.b)(C.subcategory.filter((e=>e.dependent_value===R.category)))),[C.subcategory,R.category]);return Object(s.useEffect)((()=>{null!=e&&P.current!==e.id&&(P.current=e.id,i("subActionParams",{incident:{correlation_id:d.a},comments:[]},p))}),[e]),Object(s.useEffect)((()=>{t.subAction||i("subAction","pushToService",p),t.subActionParams||i("subActionParams",{incident:{correlation_id:d.a},comments:[]},p)}),[t]),Object(j.jsx)(o.a.Fragment,null,Object(j.jsx)(n.EuiTitle,{size:"s"},Object(j.jsx)("h3",null,u.SECURITY_INCIDENT)),Object(j.jsx)(n.EuiSpacer,{size:"m"}),Object(j.jsx)(n.EuiFormRow,{fullWidth:!0,error:g["subActionParams.incident.short_description"],isInvalid:void 0!==g["subActionParams.incident.short_description"]&&g["subActionParams.incident.short_description"].length>0&&void 0!==R.short_description,label:u.SHORT_DESCRIPTION_LABEL},Object(j.jsx)(l.a,{index:p,editAction:N,messageVariables:x,paramsProperty:"short_description",inputTargetValue:null==R?void 0:R.short_description,errors:g["subActionParams.incident.short_description"]})),Object(j.jsx)(n.EuiSpacer,{size:"m"}),Object(j.jsx)(n.EuiFormRow,{fullWidth:!0,label:u.PRIORITY_LABEL},Object(j.jsx)(n.EuiSelect,{fullWidth:!0,"data-test-subj":"prioritySelect",hasNoInitialSelection:!0,isLoading:W,disabled:W,options:M,value:null!==(A=R.priority)&&void 0!==A?A:void 0,onChange:e=>N("priority",e.target.value)})),Object(j.jsx)(n.EuiSpacer,{size:"m"}),Object(j.jsx)(n.EuiFlexGroup,null,Object(j.jsx)(n.EuiFlexItem,null,Object(j.jsx)(n.EuiFormRow,{fullWidth:!0,label:u.CATEGORY_LABEL},Object(j.jsx)(n.EuiSelect,{fullWidth:!0,"data-test-subj":"categorySelect",hasNoInitialSelection:!0,isLoading:W,disabled:W,options:k,value:null!==(v=R.category)&&void 0!==v?v:void 0,onChange:e=>{i("subActionParams",{incident:{...R,category:e.target.value,subcategory:null},comments:T},p)}}))),Object(j.jsx)(n.EuiFlexItem,null,Object(j.jsx)(n.EuiFormRow,{fullWidth:!0,label:u.SUBCATEGORY_LABEL},Object(j.jsx)(n.EuiSelect,{fullWidth:!0,"data-test-subj":"subcategorySelect",hasNoInitialSelection:!0,isLoading:W,disabled:W,options:z,value:null!==(h=R.subcategory)&&void 0!==h?h:"",onChange:e=>N("subcategory",e.target.value)})))),Object(j.jsx)(n.EuiSpacer,{size:"m"}),!Object(d.c)(e)&&Object(j.jsx)(o.a.Fragment,null,Object(j.jsx)(n.EuiFlexGroup,null,Object(j.jsx)(n.EuiFlexItem,null,Object(j.jsx)(n.EuiFormRow,{fullWidth:!0,label:u.CORRELATION_ID,helpText:Object(j.jsx)(n.EuiLink,{href:I.links.alerting.serviceNowSIRAction,target:"_blank"},Object(j.jsx)(c.FormattedMessage,{id:"xpack.triggersActionsUI.components.builtinActionTypes.serviceNowSIRAction.correlationIDHelpLabel",defaultMessage:"Identifier for updating incidents"}))},Object(j.jsx)(l.a,{index:p,editAction:N,messageVariables:x,paramsProperty:"correlation_id",inputTargetValue:null!==(y=null==R?void 0:R.correlation_id)&&void 0!==y?y:void 0}))),Object(j.jsx)(n.EuiFlexItem,null,Object(j.jsx)(n.EuiFormRow,{fullWidth:!0,label:u.CORRELATION_DISPLAY},Object(j.jsx)(l.a,{index:p,editAction:N,messageVariables:x,paramsProperty:"correlation_display",inputTargetValue:null!==(_=null==R?void 0:R.correlation_display)&&void 0!==_?_:void 0})))),Object(j.jsx)(n.EuiSpacer,{size:"m"})),Object(j.jsx)(r.a,{index:p,editAction:N,messageVariables:x,paramsProperty:"description",inputTargetValue:null!==(f=R.description)&&void 0!==f?f:void 0,label:u.DESCRIPTION_LABEL}),Object(j.jsx)(r.a,{index:p,editAction:w,messageVariables:x,paramsProperty:"comments",inputTargetValue:T&&T.length>0?T[0].comment:void 0,label:u.COMMENTS_LABEL}),Object(j.jsx)(n.EuiSpacer,{size:"m"}))}}}]);