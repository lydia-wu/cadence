/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[9],{177:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var a=n(2),l=n.n(a),c=n(6),r=n(3),i=n(20),o=n(56),s=n(94),u=n(81),d=n(15),m=n(49),p=n(66);const b=["category","subcategory","priority"],g={category:[],subcategory:[],priority:[]},E=({isEdit:e=!0,fields:t,connector:n,onChange:E})=>{const f=Object(a.useRef)(!0),{category:h=null,destIp:v=!0,malwareHash:y=!0,malwareUrl:x=!0,priority:j=null,sourceIp:I=!0,subcategory:C=null}=null!=t?t:{},{http:w,notifications:O}=Object(i.d)().services,[k,F]=Object(a.useState)(g),S=Object(a.useMemo)((()=>null!=Object(m.a)(n)),[n]),T=Object(a.useCallback)(((e,n)=>{E({...t,[e]:n})}),[t,E]),{isLoading:N}=Object(s.a)({http:w,toastNotifications:O.toasts,connector:n,fields:b,onSuccess:e=>{F(e.reduce(((e,t)=>({...e,[t.element]:[...null!=e[t.element]?e[t.element]:[],t]})),g))}}),M=Object(a.useMemo)((()=>Object(u.a)(k.category)),[k.category]),R=Object(a.useMemo)((()=>Object(u.a)(k.priority)),[k.priority]),A=Object(a.useMemo)((()=>Object(u.a)(k.subcategory.filter((e=>e.dependent_value===h)))),[k.subcategory,h]),W=Object(a.useMemo)((()=>{var e,t,n;return[...null!=v&&v?[{title:d.e,description:d.b}]:[],...null!=I&&I?[{title:d.k,description:d.b}]:[],...null!=x&&x?[{title:d.h,description:d.b}]:[],...null!=y&&y?[{title:d.g,description:d.b}]:[],...null!=j&&j.length>0?[{title:d.i,description:null===(e=R.find((e=>`${e.value}`===j)))||void 0===e?void 0:e.text}]:[],...null!=h&&h.length>0?[{title:d.c,description:null===(t=M.find((e=>`${e.value}`===h)))||void 0===t?void 0:t.text}]:[],...null!=C&&C.length>0?[{title:d.l,description:null===(n=A.find((e=>`${e.value}`===C)))||void 0===n?void 0:n.text}]:[]]}),[h,M,v,y,x,j,R,I,C,A]);return Object(a.useEffect)((()=>{f.current&&(f.current=!1,E({category:h,destIp:v,malwareHash:y,malwareUrl:x,priority:j,sourceIp:I,subcategory:C}))}),[h,v,y,x,E,j,I,C]),l.a.createElement(l.a.Fragment,null,S&&l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(p.a,null))),e?l.a.createElement("div",{"data-test-subj":"connector-fields-sn-sir"},l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFormRow,{fullWidth:!0,label:d.a},l.a.createElement(l.a.Fragment,null,l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiCheckbox,{id:"destIpCheckbox","data-test-subj":"destIpCheckbox",label:d.e,checked:null!=v&&v,compressed:!0,onChange:e=>T("destIp",e.target.checked)})),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiCheckbox,{id:"sourceIpCheckbox","data-test-subj":"sourceIpCheckbox",label:d.k,checked:null!=I&&I,compressed:!0,onChange:e=>T("sourceIp",e.target.checked)}))),l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiCheckbox,{id:"malwareUrlCheckbox","data-test-subj":"malwareUrlCheckbox",label:d.h,checked:null!=x&&x,compressed:!0,onChange:e=>T("malwareUrl",e.target.checked)})),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiCheckbox,{id:"malwareHashCheckbox","data-test-subj":"malwareHashCheckbox",label:d.g,checked:null!=y&&y,compressed:!0,onChange:e=>T("malwareHash",e.target.checked)}))))))),l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFormRow,{fullWidth:!0,label:d.i},l.a.createElement(c.EuiSelect,{fullWidth:!0,"data-test-subj":"prioritySelect",hasNoInitialSelection:!0,isLoading:N,disabled:N,options:R,value:null!=j?j:void 0,onChange:e=>T("priority",e.target.value)})))),l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFormRow,{fullWidth:!0,label:d.c},l.a.createElement(c.EuiSelect,{fullWidth:!0,"data-test-subj":"categorySelect",options:M,value:null!=h?h:void 0,isLoading:N,disabled:N,hasNoInitialSelection:!0,onChange:e=>E({...t,category:e.target.value,subcategory:null})}))),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFormRow,{fullWidth:!0,label:d.l},l.a.createElement(c.EuiSelect,{fullWidth:!0,"data-test-subj":"subcategorySelect",options:A,value:null!=C?C:"",isLoading:N,disabled:N,hasNoInitialSelection:!0,onChange:e=>T("subcategory",e.target.value)}))))):l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(o.a,{connectorType:r.ConnectorTypes.serviceNowSIR,title:n.name,listItems:W,isLoading:!1}))))}},47:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u}));var a=n(3),l=n(51),c=n(49);const r=(e,t)=>{var n;return null!==(n=t.find((t=>t.id===e)))&&void 0!==n?n:null},i={[a.ConnectorTypes.swimlane]:l.a,[a.ConnectorTypes.serviceNowITSM]:c.a,[a.ConnectorTypes.serviceNowSIR]:c.a},o=({connectors:e=[],config:t={}})=>({...t,validations:[{validator:({value:t})=>{const n=r(t,e);var a;if(null!=n)return null===(a=i[n.actionTypeId])||void 0===a?void 0:a.call(i,n)}}]}),s=(e,t)=>{if(null==t)return"";try{if(e.actionTypeRegistry.has(t))return e.actionTypeRegistry.get(t).iconClass}catch{return""}return""},u=e=>null!=e&&((".servicenow"===e.actionTypeId||".servicenow-sir"===e.actionTypeId)&&!!e.config.usesTableApi)},49:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>{const{config:{usesTableApi:t}}=e;if(t)return{message:"Deprecated connector"}}},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(3);const l=["caseIdConfig","caseNameConfig","descriptionConfig","commentsConfig"],c=e=>{const{config:{mappings:t,connectorType:n}}=e;if(n===a.SwimlaneConnectorType.Alerts||(c=t,l.some((e=>null==(null==c?void 0:c[e])))))return{message:"Invalid connector"};var c}},56:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),l=n.n(a),c=n(6),r=n(33),i=n.n(r),o=n(20),s=n(47);const u=i.a.span.withConfig({displayName:"StyledText",componentId:"sc-10fyrf5-0"})(["span{display:block;}"]),d=({connectorType:e,title:t,listItems:n,isLoading:r})=>{const{triggersActionsUi:i}=Object(o.d)().services,d=Object(a.useMemo)((()=>l.a.createElement(u,null,n.length>0&&n.map(((e,t)=>l.a.createElement("span",{"data-test-subj":"card-list-item",key:`${e.title}-${t}`},l.a.createElement("strong",null,`${e.title}: `),e.description))))),[n]),m=Object(a.useMemo)((()=>l.a.createElement(c.EuiIcon,{size:"xl",type:Object(s.b)(i,e)})),[e]);return l.a.createElement(l.a.Fragment,null,r&&l.a.createElement(c.EuiLoadingSpinner,{"data-test-subj":"connector-card-loading"}),!r&&l.a.createElement(c.EuiFlexGroup,{direction:"row"},l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiCard,{"data-test-subj":"connector-card",description:d,display:"plain",layout:"horizontal",paddingSize:"none",title:t,titleSize:"xs"})),l.a.createElement(c.EuiFlexItem,{grow:!1},m)))},m=Object(a.memo)(d)},61:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=({connector_id:e,service_message:t,...n})=>({...n,actionId:e,...t&&{serviceMessage:t}})},66:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),l=n.n(a),c=n(6),r=n(1);const i=r.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningTitle",{defaultMessage:"This connector type is deprecated"}),o=r.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningDesc",{defaultMessage:"Update this connector, or create a new one."}),s=({type:e="warning"})=>l.a.createElement(c.EuiCallOut,{title:i,color:e,iconType:"alert","data-test-subj":"deprecated-connector-warning-callout"},o),u=l.a.memo(s)},81:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.map((e=>({value:e.value,text:e.label})))},94:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),l=n(22),c=n(61);var r=n(15);const i=({http:e,connector:t,toastNotifications:n,fields:i,onSuccess:o})=>{const[s,u]=Object(a.useState)(!1),[d,m]=Object(a.useState)([]),p=Object(a.useRef)(!1),b=Object(a.useRef)(new AbortController);return Object(a.useEffect)((()=>(p.current=!1,b.current.abort(),(async()=>{if(t)try{b.current=new AbortController,u(!0);const g=await async function({http:e,signal:t,connectorId:n,fields:a}){const r=await e.post(Object(l.d)(n),{body:JSON.stringify({params:{subAction:"getChoices",subActionParams:{fields:a}}}),signal:t});return Object(c.a)(r)}({http:e,signal:b.current.signal,connectorId:t.id,fields:i});var a,s;if(!p.current)if(u(!1),m(null!==(a=g.data)&&void 0!==a?a:[]),g.status&&"error"===g.status)n.addDanger({title:r.d,text:`${null!==(s=g.serviceMessage)&&void 0!==s?s:g.message}`});else if(o){var d;o(null!==(d=g.data)&&void 0!==d?d:[])}}catch(e){p.current||(u(!1),"AbortError"!==e.name&&n.addDanger({title:r.d,text:e.message}))}else u(!1)})(),()=>{p.current=!0,b.current.abort()})),[e,t,n,i]),{choices:d,isLoading:s}}}}]);