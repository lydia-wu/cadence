/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[4],Array(52).concat([function(e,t,n){"use strict";n.d(t,"r",(function(){return i})),n.d(t,"p",(function(){return s})),n.d(t,"q",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"o",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return E})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return C})),n.d(t,"n",(function(){return y})),n.d(t,"v",(function(){return v})),n.d(t,"u",(function(){return x})),n.d(t,"i",(function(){return I})),n.d(t,"h",(function(){return j}));var a=n(1),r=n(12);n.d(t,"s",(function(){return r.u})),n.d(t,"t",(function(){return r.z}));const i=a.i18n.translate("xpack.cases.configureCases.incidentManagementSystemTitle",{defaultMessage:"External incident management system"}),s=a.i18n.translate("xpack.cases.configureCases.incidentManagementSystemDesc",{defaultMessage:"Connect your cases to an external incident management system. You can then push case data as an incident in a third-party system."}),o=a.i18n.translate("xpack.cases.configureCases.incidentManagementSystemLabel",{defaultMessage:"Incident management system"}),c=a.i18n.translate("xpack.cases.configureCases.addNewConnector",{defaultMessage:"Add new connector"}),l=a.i18n.translate("xpack.cases.configureCases.caseClosureOptionsTitle",{defaultMessage:"Case closures"}),u=a.i18n.translate("xpack.cases.configureCases.caseClosureOptionsDesc",{defaultMessage:"Define how to close your cases. Automatic closures require an established connection to an external incident management system."}),d=a.i18n.translate("xpack.cases.configureCases.caseClosureOptionsSubCases",{defaultMessage:"Automatic closure of sub-cases is not supported."}),m=a.i18n.translate("xpack.cases.configureCases.caseClosureOptionsLabel",{defaultMessage:"Case closure options"}),p=a.i18n.translate("xpack.cases.configureCases.caseClosureOptionsManual",{defaultMessage:"Manually close cases"}),f=a.i18n.translate("xpack.cases.configureCases.caseClosureOptionsNewIncident",{defaultMessage:"Automatically close cases when pushing new incident to external system"}),g=e=>a.i18n.translate("xpack.cases.configureCases.fieldMappingTitle",{values:{thirdPartyName:e},defaultMessage:"{ thirdPartyName } field mappings"}),b=e=>a.i18n.translate("xpack.cases.configureCases.fieldMappingDesc",{values:{thirdPartyName:e},defaultMessage:"Map Case fields to { thirdPartyName } fields when pushing data to { thirdPartyName }. Field mappings require an established connection to { thirdPartyName }."}),E=e=>a.i18n.translate("xpack.cases.configureCases.fieldMappingDescErr",{values:{thirdPartyName:e},defaultMessage:"Failed to retrieve mappings for { thirdPartyName }."}),h=a.i18n.translate("xpack.cases.configureCases.fieldMappingFirstCol",{defaultMessage:"Kibana case field"}),C=e=>a.i18n.translate("xpack.cases.configureCases.fieldMappingSecondCol",{values:{thirdPartyName:e},defaultMessage:"{ thirdPartyName } field"}),y=a.i18n.translate("xpack.cases.configureCases.fieldMappingThirdCol",{defaultMessage:"On edit and update"}),v=(a.i18n.translate("xpack.cases.configureCases.fieldMappingEditAppend",{defaultMessage:"Append"}),a.i18n.translate("xpack.cases.configureCases.cancelButton",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.cases.configureCases.saveButton",{defaultMessage:"Save"}),a.i18n.translate("xpack.cases.configureCases.saveAndCloseButton",{defaultMessage:"Save & close"}),a.i18n.translate("xpack.cases.configureCases.warningTitle",{defaultMessage:"Warning"})),x=(a.i18n.translate("xpack.cases.configureCases.commentMapping",{defaultMessage:"Comments"}),a.i18n.translate("xpack.cases.configureCases.updateConnector",{defaultMessage:"Update field mappings"}),e=>a.i18n.translate("xpack.cases.configureCases.updateSelectedConnector",{values:{connectorName:e},defaultMessage:"Update { connectorName }"})),I=a.i18n.translate("xpack.cases.configureCases.deprecatedTooltipText",{defaultMessage:"deprecated"}),j=a.i18n.translate("xpack.cases.configureCases.deprecatedTooltipContent",{defaultMessage:"This connector is deprecated. Update it, or create a new one."})},,,,,,,,function(e,t,n){e.exports=n(28)(915)},,,,function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"j",(function(){return s})),n.d(t,"i",(function(){return o})),n.d(t,"l",(function(){return c}));var a=n(1),r=n(12);n.d(t,"a",(function(){return r.f})),n.d(t,"b",(function(){return r.n})),n.d(t,"c",(function(){return r.o})),n.d(t,"d",(function(){return r.r})),n.d(t,"e",(function(){return r.s})),n.d(t,"f",(function(){return r.x})),n.d(t,"g",(function(){return r.y})),n.d(t,"k",(function(){return r.P})),n.d(t,"m",(function(){return r.Q})),n.d(t,"n",(function(){return r.R})),n.d(t,"o",(function(){return r.S})),n.d(t,"p",(function(){return r.T})),n.d(t,"q",(function(){return r.U})),n.d(t,"r",(function(){return r.V}));const i=a.i18n.translate("xpack.cases.create.stepOneTitle",{defaultMessage:"Case fields"}),s=a.i18n.translate("xpack.cases.create.stepTwoTitle",{defaultMessage:"Case settings"}),o=a.i18n.translate("xpack.cases.create.stepThreeTitle",{defaultMessage:"External Connector Fields"}),c=a.i18n.translate("xpack.cases.create.syncAlertsLabel",{defaultMessage:"Sync alert status with case status"})},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(2),r=n.n(a),i=n(6),s=n(33),o=n.n(s),c=n(3),l=n(52),u=n(20),d=n(47),m=n(37);const p=o()(i.EuiIcon).withConfig({displayName:"EuiIconExtended",componentId:"sc-12z1pzb-0"})(["margin-right:13px;margin-bottom:0 !important;"]),f={value:"none",inputDisplay:r.a.createElement(i.EuiFlexGroup,{gutterSize:"none",alignItems:"center",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(p,{type:"minusInCircle",size:"m"})),r.a.createElement(i.EuiFlexItem,null,r.a.createElement("span",{"data-test-subj":"dropdown-connector-no-connector"},l.t))),"data-test-subj":"dropdown-connector-no-connector"},g={value:"add-connector",inputDisplay:r.a.createElement("span",{className:"euiButtonEmpty euiButtonEmpty--primary euiButtonEmpty--xSmall euiButtonEmpty--flushLeft"},l.a),"data-test-subj":"dropdown-connector-add-connector"},b=Object(m.euiStyled)(i.EuiIconTip)`
  margin-left: ${({theme:e})=>e.eui.euiSizeS}
  margin-bottom: 0 !important;
`,E=({connectors:e,disabled:t,isLoading:n,onChange:s,selectedConnector:o,appendAddConnectorButton:m=!1,hideConnectorServiceNowSir:E=!1})=>{const{triggersActionsUi:h}=Object(u.d)().services,C=Object(a.useMemo)((()=>{const t=e.reduce(((e,t)=>E&&t.actionTypeId===c.ConnectorTypes.serviceNowSIR?e:[...e,{value:t.id,inputDisplay:r.a.createElement(i.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(p,{type:Object(d.b)(h,t.actionTypeId),size:"m"})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement("span",null,t.name,Object(d.d)(t)&&` (${l.i})`)),Object(d.d)(t)&&r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(b,{"aria-label":l.h,size:"m",type:"alert",color:"warning",content:l.h}))),"data-test-subj":`dropdown-connector-${t.id}`}]),[f]);return m?[...t,g]:t}),[e]);return r.a.createElement(i.EuiSuperSelect,{"aria-label":l.q,"data-test-subj":"dropdown-connectors",disabled:t,fullWidth:!0,isLoading:n,onChange:s,options:C,valueOfSelected:o})},h=r.a.memo(E)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));var a=n(3);const r=()=>({id:"none",name:"none",type:a.ConnectorTypes.none,fields:null}),i=(e,t=null)=>{const n={type:e.actionTypeId,fields:t};return{id:e.id,name:e.name,...n}},s=(e,t)=>{var n;return null!==(n=e.find((e=>e.id===t.id)))&&void 0!==n?n:null}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f}));var a=n(3),r=n(46),i=n(64),s=n(6),o=n(2),c=n.n(o),l=n(12);const u=c.a.createElement(s.EuiText,{color:"subdued",size:"xs","data-test-subj":"form-optional-field-label"},l.G),{emptyField:d,maxLengthField:m}=r.g,p={type:r.a.COMBO_BOX,label:i.o,helpText:i.q,labelAppend:u,validations:[{validator:d(i.p),type:r.f.ARRAY_ITEM,isBlocking:!1}]},f={title:{type:r.a.TEXT,label:i.g,validations:[{validator:d(i.r)},{validator:m({length:a.MAX_TITLE_LENGTH,message:i.f("title",a.MAX_TITLE_LENGTH)})}]},description:{label:i.d,validations:[{validator:d(i.e)}]},tags:p,connectorId:{type:r.a.SUPER_SELECT,label:i.b,defaultValue:"none"},fields:{defaultValue:null},syncAlerts:{helpText:i.k,type:r.a.TOGGLE,defaultValue:!0}}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),r=n.n(a),i=n(21),s=n(6),o=n(33),c=n.n(o),l=n(46),u=n(70);const d=c()(s.EuiFormRow).withConfig({displayName:"EuiFormRowWrapper",componentId:"sc-1yy69el-0"})([".euiFormErrorText{display:none;}"]),m=({connectors:e,dataTestSubj:t,disabled:n=!1,field:s,idAria:o,isEdit:c=!0,isLoading:m=!1,handleChange:p,hideConnectorServiceNowSir:f=!1})=>{const{isInvalid:g,errorMessage:b}=Object(l.h)(s),E=Object(a.useCallback)((e=>{p&&p(e),s.setValue(e)}),[p,s]);return c?r.a.createElement(d,{"data-test-subj":t,describedByIds:o?[o]:void 0,error:b,fullWidth:!0,helpText:s.helpText,isInvalid:g,label:s.label,labelAppend:s.labelAppend},r.a.createElement(u.a,{connectors:e,disabled:n,hideConnectorServiceNowSir:f,isLoading:m,onChange:E,selectedConnector:Object(i.isEmpty)(s.value)?"none":s.value})):null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),i=n(6),s=n(26);const o=({connector:e,isEdit:t,onChange:n,fields:o})=>{const{caseConnectorsRegistry:c}=Object(s.b)();if(null==e||null==e.actionTypeId||".none"===e.actionTypeId)return null;const{fieldsComponent:l}=c.get(e.actionTypeId);return r.a.createElement(r.a.Fragment,null,null!=l?r.a.createElement(a.Suspense,{fallback:r.a.createElement(i.EuiFlexGroup,{justifyContent:"center"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiLoadingSpinner,{size:"m"})))},r.a.createElement("div",{"data-test-subj":"connector-fields"},r.a.createElement(l,{isEdit:t,fields:o,connector:e,onChange:n}))):null)},c=Object(a.memo)(o)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n(48),i=n(13),s=n(20);const o=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,isLoading:!0,isError:!1};case"FETCH_SUCCESS":return{...e,isLoading:!1,isError:!1};case"FETCH_FAILURE":return{...e,isLoading:!1,isError:!0};default:return e}},c=()=>{const[e,t]=Object(a.useReducer)(o,{isLoading:!1,isError:!1}),n=Object(s.f)(),c=Object(a.useRef)(!1),l=Object(a.useRef)(new AbortController),u=Object(a.useCallback)((async({caseId:e,connector:a})=>{try{l.current.abort(),c.current=!1,l.current=new AbortController,t({type:"FETCH_INIT"});const s=await Object(r.q)(e,a.id,l.current.signal);return c.current||(t({type:"FETCH_SUCCESS"}),n.addSuccess(i.h(a.name))),s}catch(e){c.current||("AbortError"!==e.name&&n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:i.d}),t({type:"FETCH_FAILURE"}))}}),[]);return Object(a.useEffect)((()=>()=>{l.current.abort(),c.current=!0}),[]),{...e,pushCaseToExternalService:u}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(46),i=n(79);const s=({fieldName:e})=>{var t,n;const{setFieldValue:s,getFormData:o}=Object(r.k)(),c=null===(t=Object(i.a)())||void 0===t?void 0:t.hooks,l=o(),u=Object(a.useCallback)((t=>s(e,t)),[e,s]);return null==c||c.useInsertTimeline(null!==(n=l[e])&&void 0!==n?n:"",u),null}},function(e,t,n){e.exports=n(28)(343)},function(e,t,n){"use strict";var a=n(162);e.exports=function(e,t){if(t||0===e.length||r.test(e)||a(e,"(")!==a(e,")"))return"<"+e+">";return e};var r=/\s/},function(e,t,n){"use strict";e.exports=function(e){var t=-1===e.indexOf('"')?'"':"'";return t+e+t}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var a=n(33),r=n.n(a);const i=r.a.div.withConfig({displayName:"WhitePageWrapper",componentId:"sc-1jiyl3r-0"})(["background-color:",";border-top:",";flex:1 1 auto;"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin)),s=r.a.div.withConfig({displayName:"SectionWrapper",componentId:"sc-1jiyl3r-1"})(["box-sizing:content-box;margin:0 auto;max-width:1175px;width:100%;"]),o=r.a.div.withConfig({displayName:"HeaderWrapper",componentId:"sc-1jiyl3r-2"})(["",";"],(({theme:e})=>`\n      padding: ${e.eui.paddingSizes.l} ${e.eui.paddingSizes.l} 0 ${e.eui.paddingSizes.l};\n      @media only screen and (max-width: ${e.eui.euiBreakpoints.s}) {\n        padding: ${e.eui.paddingSizes.s} ${e.eui.paddingSizes.s} 0\n          ${e.eui.paddingSizes.s};\n      }\n    `)),c=r.a.div.withConfig({displayName:"ContentWrapper",componentId:"sc-1jiyl3r-3"})(["",";"],(({theme:e})=>`\n      padding: ${e.eui.paddingSizes.l} ${e.eui.paddingSizes.l} 70px ${e.eui.paddingSizes.l};\n      @media only screen and (max-width: ${e.eui.euiBreakpoints.s}) {\n        padding: ${e.eui.paddingSizes.s} ${e.eui.paddingSizes.s} 70px\n          ${e.eui.paddingSizes.s};\n      }\n    `))},,,,,,,,,,function(e,t,n){"use strict";e.exports=function(e){return e}},function(e,t,n){"use strict";e.exports={gfm:!0,commonmark:!1,pedantic:!1,entities:"false",setext:!1,closeAtx:!1,tableCellPadding:!0,tablePipeAlign:!0,stringLength:function(e){return e.length},incrementListMarker:!0,tightDefinitions:!1,fences:!1,fence:"`",bullet:"-",listItemIndent:"tab",rule:"*",ruleSpaces:!0,ruleRepetition:3,strong:"*",emphasis:"_"}},function(e,t,n){e.exports=n(28)(401)},function(e,t,n){"use strict";var a=n(137);e.exports=function(e){var t;if("&"!==e.charAt(0))return 0;return(t=e.split("&",2).join("&")).length-a(t).length}},function(e,t,n){"use strict";var a=n(60);e.exports=function(e,t){var n=e.split("\n"),r=n.length,i=a(" ",4*t);for(;r--;)0!==n[r].length&&(n[r]=i+n[r]);return n.join("\n")}},function(e,t,n){"use strict";e.exports=function(e,t){var n,a,r=0,i=0;if("string"!=typeof t||1!==t.length)throw new Error("Expected character");e=String(e),a=e.indexOf(t),n=a;for(;-1!==a;)r++,a===n?r>i&&(i=r):r=1,n=a+1,a=e.indexOf(t,n);return i}},function(e,t,n){"use strict";e.exports=function(e){var t=e.referenceType;if("shortcut"===t)return"";return"["+("collapsed"===t?"":e.label||e.identifier)+"]"}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,r,i;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(r=a;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(r=a;0!=r--;)if(!Object.prototype.hasOwnProperty.call(n,i[r]))return!1;for(r=a;0!=r--;){var s=i[r];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},function(e,t){var n={utf8:{stringToBytes:function(e){return n.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(n.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=n},,,,,,,function(e,t,n){"use strict";var a=n(119),r={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,i,s,o,c,l,u=!1;t||(t={}),n=t.debug||!1;try{if(s=a(),o=document.createRange(),c=document.getSelection(),(l=document.createElement("span")).textContent=e,l.style.all="unset",l.style.position="fixed",l.style.top=0,l.style.clip="rect(0, 0, 0, 0)",l.style.whiteSpace="pre",l.style.webkitUserSelect="text",l.style.MozUserSelect="text",l.style.msUserSelect="text",l.style.userSelect="text",l.addEventListener("copy",(function(a){if(a.stopPropagation(),t.format)if(a.preventDefault(),void 0===a.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=r[t.format]||r.default;window.clipboardData.setData(i,e)}else a.clipboardData.clearData(),a.clipboardData.setData(t.format,e);t.onCopy&&(a.preventDefault(),t.onCopy(a.clipboardData))})),document.body.appendChild(l),o.selectNodeContents(l),c.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(a){n&&console.error("unable to copy using execCommand: ",a),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(a){n&&console.error("unable to copy using clipboardData: ",a),n&&console.error("falling back to prompt"),i=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,e)}}finally{c&&("function"==typeof c.removeRange?c.removeRange(o):c.removeAllRanges()),l&&document.body.removeChild(l),s()}return u}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],a=0;a<e.rangeCount;a++)n.push(e.getRangeAt(a));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},function(e,t,n){e.exports=n(28)(1611)},function(e,t,n){"use strict";var a=n(122),r=n(90),i=n(123);function s(e){var t=a(i);t.prototype.options=r(t.prototype.options,this.data("settings"),e),this.Compiler=t}e.exports=s,s.Compiler=i},function(e,t,n){e.exports=n(28)(3051)},function(e,t,n){"use strict";var a=n(90),r=n(124);function i(e,t){this.inLink=!1,this.inTable=!1,this.tree=e,this.file=t,this.options=a(this.options),this.setOptions({})}e.exports=i;var s=i.prototype;s.enterLink=r("inLink",!1),s.enterTable=r("inTable",!1),s.enterLinkReference=n(125),s.options=n(104),s.setOptions=n(126),s.compile=n(138),s.visit=n(141),s.all=n(142),s.block=n(143),s.visitOrderedItems=n(144),s.visitUnorderedItems=n(145),s.visitors={root:n(146),text:n(147),heading:n(148),paragraph:n(149),blockquote:n(150),list:n(151),listItem:n(152),inlineCode:n(153),code:n(154),html:n(155),thematicBreak:n(156),strong:n(157),emphasis:n(158),break:n(159),delete:n(160),link:n(161),linkReference:n(163),imageReference:n(165),definition:n(166),image:n(167),table:n(168),tableCell:n(170)}},function(e,t,n){e.exports=n(28)(3054)},function(e,t,n){"use strict";var a=n(103);e.exports=function(e,t){var n=e.encode,r=e.escape,i=e.enterLink();if("shortcut"!==t.referenceType&&"collapsed"!==t.referenceType)return i;return e.escape=a,e.encode=a,function(){e.encode=n,e.escape=r,i()}}},function(e,t,n){"use strict";var a=n(90),r=n(127),i=n(104),s=n(133),o=n(103);e.exports=function(e){var t,n,d=this,m=d.options;if(null==e)e={};else{if("object"!=typeof e)throw new Error("Invalid value `"+e+"` for setting `options`");e=a(e)}for(n in i)l[typeof i[n]](e,n,m[n],c[n]);(t=e.ruleRepetition)&&t<3&&u(t,"options.ruleRepetition");return d.encode=function(e){var t={};if("false"===e)return o;"true"===e&&(t.useNamedReferences=!0);"escape"===e&&(t.escapeOnly=!0,t.useNamedReferences=!0);return function(e){return r(e,t)}}(String(e.entities)),d.escape=s(e),d.options=e,d};var c={entities:{true:!0,false:!0,numbers:!0,escape:!0},bullet:{"*":!0,"-":!0,"+":!0},rule:{"-":!0,_:!0,"*":!0},listItemIndent:{tab:!0,mixed:!0,1:!0},emphasis:{_:!0,"*":!0},strong:{_:!0,"*":!0},fence:{"`":!0,"~":!0}},l={boolean:function(e,t,n){var a=e[t];null==a&&(a=n);"boolean"!=typeof a&&u(a,"options."+t);e[t]=a},string:function(e,t,n,a){var r=e[t];null==r&&(r=n);(r=String(r))in a||u(r,"options."+t);e[t]=r},number:function(e,t,n){var a=e[t];null==a&&(a=n);isNaN(a)&&u(a,"options."+t);e[t]=a},function:function(e,t,n){var a=e[t];null==a&&(a=n);"function"!=typeof a&&u(a,"options."+t);e[t]=a}};function u(e,t){throw new Error("Invalid value `"+e+"` for setting `"+t+"`")}},function(e,t,n){"use strict";var a=n(128),r=n(129),i=n(130),s=n(105),o=n(131),c=n(132);e.exports=f,f.escape=function(e){return f(e,{escapeOnly:!0,useNamedReferences:!0})};var l={}.hasOwnProperty,u=function(){var e,t={};for(e in a)t[a[e]]=e;return t}(),d=E(['"',"'","<",">","&","`"]),m=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,p=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g;function f(e,t){var n=t||{},a=n.subset,i=a?E(a):d,s=n.escapeOnly,f=n.omitOptionalSemicolons;return e=e.replace(i,h),a||s?e:e.replace(m,(function(e,t,n){return g(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)-56320+65536,n.charCodeAt(t+2),f)})).replace(p,h);function h(e,t,a){return function(e,t,n){var a,i,s,d,m=n.useShortestReferences,p=n.omitOptionalSemicolons;(m||n.useNamedReferences)&&l.call(u,e)&&(a=function(e,t,n,a){var i="&"+e;if(n&&l.call(r,e)&&-1===c.indexOf(e)&&(!a||t&&61!==t&&!o(t)))return i;return i+";"}(u[e],t,p,n.attribute));!m&&a||(s=g(i=e.charCodeAt(0),t,p),m&&(d=b(i,t,p)).length<s.length&&(s=d));if(a&&(!m||a.length<s.length))return a;return s}(e,a.charCodeAt(t+1),n)}}function g(e,t,n){var a="&#x"+e.toString(16).toUpperCase();return n&&t&&!i(t)?a:a+";"}function b(e,t,n){var a="&#"+String(e);return n&&t&&!s(t)?a:a+";"}function E(e){return new RegExp("["+e.join("")+"]","g")}},function(e){e.exports=JSON.parse('{"nbsp":" ","iexcl":"¡","cent":"¢","pound":"£","curren":"¤","yen":"¥","brvbar":"¦","sect":"§","uml":"¨","copy":"©","ordf":"ª","laquo":"«","not":"¬","shy":"­","reg":"®","macr":"¯","deg":"°","plusmn":"±","sup2":"²","sup3":"³","acute":"´","micro":"µ","para":"¶","middot":"·","cedil":"¸","sup1":"¹","ordm":"º","raquo":"»","frac14":"¼","frac12":"½","frac34":"¾","iquest":"¿","Agrave":"À","Aacute":"Á","Acirc":"Â","Atilde":"Ã","Auml":"Ä","Aring":"Å","AElig":"Æ","Ccedil":"Ç","Egrave":"È","Eacute":"É","Ecirc":"Ê","Euml":"Ë","Igrave":"Ì","Iacute":"Í","Icirc":"Î","Iuml":"Ï","ETH":"Ð","Ntilde":"Ñ","Ograve":"Ò","Oacute":"Ó","Ocirc":"Ô","Otilde":"Õ","Ouml":"Ö","times":"×","Oslash":"Ø","Ugrave":"Ù","Uacute":"Ú","Ucirc":"Û","Uuml":"Ü","Yacute":"Ý","THORN":"Þ","szlig":"ß","agrave":"à","aacute":"á","acirc":"â","atilde":"ã","auml":"ä","aring":"å","aelig":"æ","ccedil":"ç","egrave":"è","eacute":"é","ecirc":"ê","euml":"ë","igrave":"ì","iacute":"í","icirc":"î","iuml":"ï","eth":"ð","ntilde":"ñ","ograve":"ò","oacute":"ó","ocirc":"ô","otilde":"õ","ouml":"ö","divide":"÷","oslash":"ø","ugrave":"ù","uacute":"ú","ucirc":"û","uuml":"ü","yacute":"ý","thorn":"þ","yuml":"ÿ","fnof":"ƒ","Alpha":"Α","Beta":"Β","Gamma":"Γ","Delta":"Δ","Epsilon":"Ε","Zeta":"Ζ","Eta":"Η","Theta":"Θ","Iota":"Ι","Kappa":"Κ","Lambda":"Λ","Mu":"Μ","Nu":"Ν","Xi":"Ξ","Omicron":"Ο","Pi":"Π","Rho":"Ρ","Sigma":"Σ","Tau":"Τ","Upsilon":"Υ","Phi":"Φ","Chi":"Χ","Psi":"Ψ","Omega":"Ω","alpha":"α","beta":"β","gamma":"γ","delta":"δ","epsilon":"ε","zeta":"ζ","eta":"η","theta":"θ","iota":"ι","kappa":"κ","lambda":"λ","mu":"μ","nu":"ν","xi":"ξ","omicron":"ο","pi":"π","rho":"ρ","sigmaf":"ς","sigma":"σ","tau":"τ","upsilon":"υ","phi":"φ","chi":"χ","psi":"ψ","omega":"ω","thetasym":"ϑ","upsih":"ϒ","piv":"ϖ","bull":"•","hellip":"…","prime":"′","Prime":"″","oline":"‾","frasl":"⁄","weierp":"℘","image":"ℑ","real":"ℜ","trade":"™","alefsym":"ℵ","larr":"←","uarr":"↑","rarr":"→","darr":"↓","harr":"↔","crarr":"↵","lArr":"⇐","uArr":"⇑","rArr":"⇒","dArr":"⇓","hArr":"⇔","forall":"∀","part":"∂","exist":"∃","empty":"∅","nabla":"∇","isin":"∈","notin":"∉","ni":"∋","prod":"∏","sum":"∑","minus":"−","lowast":"∗","radic":"√","prop":"∝","infin":"∞","ang":"∠","and":"∧","or":"∨","cap":"∩","cup":"∪","int":"∫","there4":"∴","sim":"∼","cong":"≅","asymp":"≈","ne":"≠","equiv":"≡","le":"≤","ge":"≥","sub":"⊂","sup":"⊃","nsub":"⊄","sube":"⊆","supe":"⊇","oplus":"⊕","otimes":"⊗","perp":"⊥","sdot":"⋅","lceil":"⌈","rceil":"⌉","lfloor":"⌊","rfloor":"⌋","lang":"〈","rang":"〉","loz":"◊","spades":"♠","clubs":"♣","hearts":"♥","diams":"♦","quot":"\\"","amp":"&","lt":"<","gt":">","OElig":"Œ","oelig":"œ","Scaron":"Š","scaron":"š","Yuml":"Ÿ","circ":"ˆ","tilde":"˜","ensp":" ","emsp":" ","thinsp":" ","zwnj":"‌","zwj":"‍","lrm":"‎","rlm":"‏","ndash":"–","mdash":"—","lsquo":"‘","rsquo":"’","sbquo":"‚","ldquo":"“","rdquo":"”","bdquo":"„","dagger":"†","Dagger":"‡","permil":"‰","lsaquo":"‹","rsaquo":"›","euro":"€"}')},function(e,t,n){e.exports=n(28)(2666)},function(e,t,n){e.exports=n(28)(2668)},function(e,t,n){e.exports=n(28)(2669)},function(e){e.exports=JSON.parse('["cent","copy","divide","gt","lt","not","para","times"]')},function(e,t,n){"use strict";var a=n(105),r=n(134),i=n(135),s=n(136),o=n(106);e.exports=function(e){return function(t,n,O){var k,S,T,A,F,L,N=this,D=e.gfm,M=e.commonmark,R=e.pedantic,B=M?[f,")"]:[f],z=O&&O.children,_=z&&z.indexOf(n),V=z&&z[_-1],U=z&&z[_+1],$=t.length,P=s(e),H=-1,G=[],W=G;k=V?j(V)&&x.test(V.value):!O||"root"===O.type||"paragraph"===O.type;for(;++H<$;){if(L=!1,"\n"===(S=t.charAt(H)))k=!0;else if(S===b||"`"===S||S===p||"["===S||"<"===S||S===d&&o(t.slice(H))>0||"]"===S&&N.inLink||D&&S===h&&t.charAt(H+1)===h||D&&"|"===S&&(N.inTable||I(t,H))||S===E&&H>0&&H<$-1&&(R||!r(t.charAt(H-1))||!r(t.charAt(H+1)))||D&&!N.inLink&&S===g&&w(G.join("")))L=!0;else if(k)if(">"===S||"#"===S||S===p||"-"===S||"+"===S)L=!0;else if(a(S)){for(F=H+1;F<$&&a(t.charAt(F));)F++;-1!==B.indexOf(t.charAt(F))&&((U=t.charAt(F+1))&&U!==u&&U!==c&&U!==l||(G.push(t.slice(H,F)),H=F,S=t.charAt(H),L=!0))}k&&!i(S)&&(k=!1),G.push(L?q(S):S)}if(z&&j(n)){if(V&&V.referenceType===v){for(H=-1,$=W.length;++H<$;)if((S=W[H])!==u&&S!==c){S!==m&&S!==g||(W[H]=q(S));break}j(U)&&H===$&&U.value.charAt(0)===m&&W.push(b)}D&&!N.inLink&&j(V)&&t.charAt(0)===g&&w(V.value.slice(-6))&&(W[0]=q(g)),j(U)&&t.charAt($-1)===d&&0!==o(d+U.value)&&(W[W.length-1]=q(d)),U&&"link"===U.type&&t.charAt($-1)===C&&(W[W.length-1]=q(C)),D&&j(U)&&t.charAt($-1)===h&&U.value.charAt(0)===h&&W.splice(-1,0,b),T=j(V)&&r(V.value.slice(-1)),A=j(U)&&r(U.value.charAt(0)),1===$?t!==E||!R&&T&&A||W.unshift(b):(t.charAt(0)!==E||!R&&T&&r(t.charAt(1))||W.unshift(b),t.charAt($-1)!==E||!R&&A&&r(t.charAt($-2))||W.splice(-1,0,b))}return W.join("");function q(e){return-1===P.indexOf(e)?y[e]:b+e}}};var c="\t",l="\n",u=" ",d="&",m="(",p="*",f=".",g=":",b="\\",E="_",h="~",C="!",y={"<":"&lt;",":":"&#x3A;","&":"&amp;","|":"&#x7C;","~":"&#x7E;"},v="shortcut",x=/\n\s*$/;function I(e,t){var n,a=e.lastIndexOf(l,t),r=e.indexOf(l,t);for(r=-1===r?e.length:r;++a<r;)if((n=e.charAt(a))!==g&&"-"!==n&&n!==u&&"|"!==n)return!1;return!0}function j(e){return e&&"text"===e.type}function w(e){var t=e.slice(-6).toLowerCase();return"mailto"===t||"https"===t.slice(-5)||"http"===t.slice(-4)}},function(e,t,n){"use strict";e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return!/[^0-9a-z\xDF-\xFF]/.test(e.toLowerCase())}},function(e,t,n){e.exports=n(28)(268)},function(e,t,n){e.exports=n(28)(3060)},function(e,t,n){e.exports=n(28)(513)},function(e,t,n){"use strict";var a=n(139);e.exports=function(){return this.visit(a(this.tree,this.options.commonmark))}},function(e,t,n){"use strict";var a=n(140);function r(e,t){var n,a;return"text"===e.type?!e.position||(n=e.position.start,a=e.position.end,n.line!==a.line||a.column-n.column===e.value.length):t&&"blockquote"===e.type}e.exports=function(e,t){return a(e,(function(e,n,a){var i=a?a.children:[],s=n&&i[n-1];if(s&&e.type===s.type&&r(s,t)&&r(e,t))return e.value&&(s.value+=e.value),e.children&&(s.children=s.children.concat(e.children)),i.splice(n,1),s.position&&e.position&&(s.position.end=e.position.end),n})),e}},function(e,t,n){e.exports=n(28)(301)},function(e,t,n){"use strict";e.exports=function(e,t){var n=this,a=n.visitors;"function"!=typeof a[e.type]&&n.file.fail(new Error("Missing compiler for node of type `"+e.type+"`: `"+e+"`"),e);return a[e.type].call(n,e,t)}},function(e,t,n){"use strict";e.exports=function(e){var t=e.children,n=t.length,a=[],r=-1;for(;++r<n;)a[r]=this.visit(t[r],e);return a}},function(e,t,n){"use strict";e.exports=function(e){var t,n,i=this.options,s=i.fences,o=i.commonmark?"\n\n\x3c!----\x3e\n\n":"\n\n\n",c=i.tightDefinitions?a:r,l=[],u=e.children,d=u.length,m=-1;for(;++m<d;)t=n,n=u[m],t&&("list"===t.type&&("list"===n.type&&t.ordered===n.ordered||"code"===n.type&&!n.lang&&!s)?l.push(o):"definition"===t.type&&"definition"===n.type?l.push(c):l.push(r)),l.push(this.visit(n,e));return l.join("")};var a="\n",r="\n\n"},function(e,t,n){"use strict";e.exports=function(e){var t,n=this,a=n.visitors.listItem,r=n.options.incrementListMarker,i=[],s=e.start,o=e.children,c=o.length,l=-1;s=null==s?1:s;for(;++l<c;)t=(r?s+l:s)+".",i[l]=a.call(n,o[l],e,l,t);return i.join(e.spread?"\n\n":"\n")}},function(e,t,n){"use strict";e.exports=function(e){var t=this,n=t.options.bullet,a=t.visitors.listItem,r=e.children,i=r.length,s=-1,o=[];for(;++s<i;)o[s]=a.call(t,r[s],e,s,n);return o.join(e.spread?"\n\n":"\n")}},function(e,t,n){"use strict";e.exports=function(e){var t=this.block(e);"\n"!==t.charAt(t.length-1)&&(t+="\n");return t}},function(e,t,n){"use strict";e.exports=function(e,t){return this.encode(this.escape(e.value,e,t),e)}},function(e,t,n){"use strict";var a=n(60);e.exports=function(e){var t,n=this,r=e.depth,i=n.options.setext,s=n.options.closeAtx,o=n.all(e).join("");if(i&&r<3)return o+"\n"+a(1===r?"=":"-",o.length);return(t=a("#",e.depth))+" "+o+(s?" "+t:"")}},function(e,t,n){"use strict";e.exports=function(e){return this.all(e).join("")}},function(e,t,n){"use strict";e.exports=function(e){var t,n=this.block(e).split("\n"),a=[],r=n.length,i=-1;for(;++i<r;)t=n[i],a[i]=(t?" ":"")+t;return">"+a.join("\n>")}},function(e,t,n){"use strict";e.exports=function(e){return(e.ordered?this.visitOrderedItems:this.visitUnorderedItems).call(this,e)}},function(e,t,n){"use strict";var a=n(60),r=n(107);e.exports=function(e,t,n,c){var l,u,d,m=this,p=m.options.listItemIndent,f=c||m.options.bullet,g=null==e.spread||e.spread,b=e.checked,E=e.children,h=E.length,C=[],y=-1;for(;++y<h;)C[y]=m.visit(E[y],e);l=C.join(g?"\n\n":i),"boolean"==typeof b&&(l="["+(b?"x":s)+"]"+s+l);"1"===p||"mixed"===p&&-1===l.indexOf(i)?(u=f.length+1,d=s):(u=4*o((f.length+1)/4),d=a(s,u-f.length));return l?f+d+r(l,u/4).slice(u):f};var i="\n",s=" ",o=Math.ceil},function(e,t,n){"use strict";var a=n(108),r=n(60);e.exports=function(e){var t,n,s=e.value,o=r("`",a(s,"`")+1),c=o,l=o,u=s.charCodeAt(0),d=s.charCodeAt(s.length-1),m=!1;if(96===u||96===d)m=!0;else if(s.length>2&&i(u)&&i(d))for(t=1,n=s.length-1;++t<n;)if(!i(s.charCodeAt(t))){m=!0;break}m&&(c+=" ",l=" "+l);return c+s+l};function i(e){return 10===e||32===e}},function(e,t,n){"use strict";var a=n(108),r=n(60),i=n(107);e.exports=function(e,t){var n,o=this,c=e.value,l=o.options,u=l.fence,d=e.lang||"";d&&e.meta&&(d+=" "+e.meta);if(!(d=o.encode(o.escape(d,e)))&&!l.fences&&c&&c.charAt(0)!==s&&c.charAt(c.length-1)!==s)return t&&"listItem"===t.type&&"tab"!==l.listItemIndent&&l.pedantic&&o.file.fail("Cannot indent code properly. See https://git.io/fxKR8",e.position),i(c,1);"`"===u&&-1!==d.indexOf("`")&&(u="~");return(n=r(u,Math.max(a(c,u)+1,3)))+d+s+c+s+n};var s="\n"},function(e,t,n){"use strict";e.exports=function(e){return e.value}},function(e,t,n){"use strict";var a=n(60);e.exports=function(){var e=this.options,t=a(e.rule,e.ruleRepetition);return e.ruleSpaces?t.split("").join(" "):t}},function(e,t,n){"use strict";var a=n(60);e.exports=function(e){var t=a(this.options.strong,2);return t+this.all(e).join("")+t}},function(e,t,n){"use strict";e.exports=function(e){var t=this.options.emphasis,n=this.all(e).join("");this.options.pedantic&&"_"===t&&-1!==n.indexOf(t)&&(t="*");return t+n+t}},function(e,t,n){"use strict";e.exports=function(){return this.options.commonmark?"\\\n":"  \n"}},function(e,t,n){"use strict";e.exports=function(e){return"~~"+this.all(e).join("")+"~~"}},function(e,t,n){"use strict";var a=n(91),r=n(92);e.exports=function(e){var t=this,n=t.encode(e.url||"",e),s=t.enterLink(),o=t.encode(t.escape(e.url||"",e)),c=t.all(e).join("");if(s(),null==e.title&&i.test(n)&&o===c)return a(t.encode(e.url),!0);n=a(n),e.title&&(n+=" "+r(t.encode(t.escape(e.title,e),e)));return"["+c+"]("+n+")"};var i=/^[a-z][a-z+.-]+:\/?/i},function(e,t,n){e.exports=n(28)(3084)},function(e,t,n){"use strict";var a=n(164),r=n(109);e.exports=function(e){var t=this,n=e.referenceType,i=t.enterLinkReference(t,e),s=t.all(e).join("");i(),("shortcut"===n||"collapsed"===n)&&(s=a(s,e.label||e.identifier));return"["+s+"]"+r(e)}},function(e,t,n){"use strict";var a=n(106);e.exports=function(e,t){var n,i=e.length,s=t.length,o=[],c=0,l=0;for(;l<i;){for(n=l;l<i&&!r.test(e.charAt(l));)l+=1;for(o.push(e.slice(n,l));c<s&&!r.test(t.charAt(c));)c+=1;for(n=c;c<s&&r.test(t.charAt(c));)"&"===t.charAt(c)&&(c+=a(t.slice(c))),c+=1;for(o.push(t.slice(n,c));l<i&&r.test(e.charAt(l));)l+=1}return o.join("")};var r=/[-!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~_]/},function(e,t,n){"use strict";var a=n(109);e.exports=function(e){return"!["+(this.encode(e.alt,e)||"")+"]"+a(e)}},function(e,t,n){"use strict";var a=n(91),r=n(92);e.exports=function(e){var t=a(e.url);e.title&&(t+=" "+r(e.title));return"["+(e.label||e.identifier)+"]: "+t}},function(e,t,n){"use strict";var a=n(91),r=n(92);e.exports=function(e){var t=this,n=a(t.encode(e.url||"",e)),i=t.enterLink(),s=t.encode(t.escape(e.alt||"",e));i(),e.title&&(n+=" "+r(t.encode(e.title,e)));return"!["+s+"]("+n+")"}},function(e,t,n){"use strict";var a=n(169);e.exports=function(e){var t=this,n=t.options,r=n.tableCellPadding,i=n.tablePipeAlign,s=n.stringLength,o=e.children,c=o.length,l=t.enterTable(),u=[];for(;c--;)u[c]=t.all(o[c]);return l(),a(u,{align:e.align,alignDelimiters:i,padding:r,stringLength:s})}},function(e,t,n){"use strict";var a=n(60);e.exports=function(e,t){var n,u,d,m,p,f,g,b,E,h,C,y=t||{},v=!1!==y.padding,x=!1!==y.delimiterStart,I=!1!==y.delimiterEnd,j=(y.align||[]).concat(),w=!1!==y.alignDelimiters,O=[],k=y.stringLength||c,S=-1,T=e.length,A=[],F=[],L=[],N=[],D=[],M=0;for(;++S<T;){for(n=e[S],u=-1,d=n.length,L=[],N=[],d>M&&(M=d);++u<d;)R=n[u],f=null==R?"":String(R),!0===w&&(p=k(f),N[u]=p,(void 0===(m=D[u])||p>m)&&(D[u]=p)),L.push(f);A[S]=L,F[S]=N}var R;if(u=-1,d=M,"object"==typeof j&&"length"in j)for(;++u<d;)O[u]=l(j[u]);else for(C=l(j);++u<d;)O[u]=C;u=-1,d=M,L=[],N=[];for(;++u<d;)C=O[u],E="",h="",108===C?E=s:C===o?h=s:99===C&&(E=s,h=s),p=w?Math.max(1,D[u]-E.length-h.length):1,f=E+a("-",p)+h,!0===w&&((p=E.length+p+h.length)>D[u]&&(D[u]=p),N[u]=p),L[u]=f;A.splice(1,0,L),F.splice(1,0,N),S=-1,T=A.length,g=[];for(;++S<T;){for(L=A[S],N=F[S],u=-1,d=M,b=[];++u<d;)f=L[u]||"",E="",h="",!0===w&&(p=D[u]-(N[u]||0),(C=O[u])===o?E=a(i,p):99===C?p%2==0?(E=a(i,p/2),h=E):(E=a(i,p/2+.5),h=a(i,p/2-.5)):h=a(i,p)),!0===x&&0===u&&b.push("|"),!0!==v||!1===w&&""===f||!0!==x&&0===u||b.push(i),!0===w&&b.push(E),b.push(f),!0===w&&b.push(h),!0===v&&b.push(i),!0!==I&&u===d-1||b.push("|");b=b.join(""),!1===I&&(b=b.replace(r,"")),g.push(b)}return g.join("\n")};var r=/ +$/,i=" ",s=":",o=114;function c(e){return e.length}function l(e){var t="string"==typeof e?e.charCodeAt(0):0;return 76===t||108===t?108:82===t||t===o?o:67===t||99===t?99:0}},function(e,t,n){"use strict";e.exports=function(e){return this.all(e).join("").replace(a," ")};var a=/\r?\n/g},function(e,t,n){e.exports=n(28)(778)},function(e,t,n){var a,r,i,s,o;a=n(173),r=n(111).utf8,i=n(174),s=n(111).bin,(o=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):r.stringToBytes(e):i(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var n=a.bytesToWords(e),c=8*e.length,l=1732584193,u=-271733879,d=-1732584194,m=271733878,p=0;p<n.length;p++)n[p]=16711935&(n[p]<<8|n[p]>>>24)|4278255360&(n[p]<<24|n[p]>>>8);n[c>>>5]|=128<<c%32,n[14+(c+64>>>9<<4)]=c;var f=o._ff,g=o._gg,b=o._hh,E=o._ii;for(p=0;p<n.length;p+=16){var h=l,C=u,y=d,v=m;l=f(l,u,d,m,n[p+0],7,-680876936),m=f(m,l,u,d,n[p+1],12,-389564586),d=f(d,m,l,u,n[p+2],17,606105819),u=f(u,d,m,l,n[p+3],22,-1044525330),l=f(l,u,d,m,n[p+4],7,-176418897),m=f(m,l,u,d,n[p+5],12,1200080426),d=f(d,m,l,u,n[p+6],17,-1473231341),u=f(u,d,m,l,n[p+7],22,-45705983),l=f(l,u,d,m,n[p+8],7,1770035416),m=f(m,l,u,d,n[p+9],12,-1958414417),d=f(d,m,l,u,n[p+10],17,-42063),u=f(u,d,m,l,n[p+11],22,-1990404162),l=f(l,u,d,m,n[p+12],7,1804603682),m=f(m,l,u,d,n[p+13],12,-40341101),d=f(d,m,l,u,n[p+14],17,-1502002290),l=g(l,u=f(u,d,m,l,n[p+15],22,1236535329),d,m,n[p+1],5,-165796510),m=g(m,l,u,d,n[p+6],9,-1069501632),d=g(d,m,l,u,n[p+11],14,643717713),u=g(u,d,m,l,n[p+0],20,-373897302),l=g(l,u,d,m,n[p+5],5,-701558691),m=g(m,l,u,d,n[p+10],9,38016083),d=g(d,m,l,u,n[p+15],14,-660478335),u=g(u,d,m,l,n[p+4],20,-405537848),l=g(l,u,d,m,n[p+9],5,568446438),m=g(m,l,u,d,n[p+14],9,-1019803690),d=g(d,m,l,u,n[p+3],14,-187363961),u=g(u,d,m,l,n[p+8],20,1163531501),l=g(l,u,d,m,n[p+13],5,-1444681467),m=g(m,l,u,d,n[p+2],9,-51403784),d=g(d,m,l,u,n[p+7],14,1735328473),l=b(l,u=g(u,d,m,l,n[p+12],20,-1926607734),d,m,n[p+5],4,-378558),m=b(m,l,u,d,n[p+8],11,-2022574463),d=b(d,m,l,u,n[p+11],16,1839030562),u=b(u,d,m,l,n[p+14],23,-35309556),l=b(l,u,d,m,n[p+1],4,-1530992060),m=b(m,l,u,d,n[p+4],11,1272893353),d=b(d,m,l,u,n[p+7],16,-155497632),u=b(u,d,m,l,n[p+10],23,-1094730640),l=b(l,u,d,m,n[p+13],4,681279174),m=b(m,l,u,d,n[p+0],11,-358537222),d=b(d,m,l,u,n[p+3],16,-722521979),u=b(u,d,m,l,n[p+6],23,76029189),l=b(l,u,d,m,n[p+9],4,-640364487),m=b(m,l,u,d,n[p+12],11,-421815835),d=b(d,m,l,u,n[p+15],16,530742520),l=E(l,u=b(u,d,m,l,n[p+2],23,-995338651),d,m,n[p+0],6,-198630844),m=E(m,l,u,d,n[p+7],10,1126891415),d=E(d,m,l,u,n[p+14],15,-1416354905),u=E(u,d,m,l,n[p+5],21,-57434055),l=E(l,u,d,m,n[p+12],6,1700485571),m=E(m,l,u,d,n[p+3],10,-1894986606),d=E(d,m,l,u,n[p+10],15,-1051523),u=E(u,d,m,l,n[p+1],21,-2054922799),l=E(l,u,d,m,n[p+8],6,1873313359),m=E(m,l,u,d,n[p+15],10,-30611744),d=E(d,m,l,u,n[p+6],15,-1560198380),u=E(u,d,m,l,n[p+13],21,1309151649),l=E(l,u,d,m,n[p+4],6,-145523070),m=E(m,l,u,d,n[p+11],10,-1120210379),d=E(d,m,l,u,n[p+2],15,718787259),u=E(u,d,m,l,n[p+9],21,-343485551),l=l+h>>>0,u=u+C>>>0,d=d+y>>>0,m=m+v>>>0}return a.endian([l,u,d,m])})._ff=function(e,t,n,a,r,i,s){var o=e+(t&n|~t&a)+(r>>>0)+s;return(o<<i|o>>>32-i)+t},o._gg=function(e,t,n,a,r,i,s){var o=e+(t&a|n&~a)+(r>>>0)+s;return(o<<i|o>>>32-i)+t},o._hh=function(e,t,n,a,r,i,s){var o=e+(t^n^a)+(r>>>0)+s;return(o<<i|o>>>32-i)+t},o._ii=function(e,t,n,a,r,i,s){var o=e+(n^(t|~a))+(r>>>0)+s;return(o<<i|o>>>32-i)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var n=a.wordsToBytes(o(e,t));return t&&t.asBytes?n:t&&t.asString?s.bytesToString(n):a.bytesToHex(n)}},function(e,t){var n,a;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&a.rotl(e,8)|4278255360&a.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=a.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,a=0;n<e.length;n++,a+=8)t[a>>>5]|=e[n]<<24-a%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var t=[],a=0;a<e.length;a+=3)for(var r=e[a]<<16|e[a+1]<<8|e[a+2],i=0;i<4;i++)8*a+6*i<=8*e.length?t.push(n.charAt(r>>>6*(3-i)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],a=0,r=0;a<e.length;r=++a%4)0!=r&&t.push((n.indexOf(e.charAt(a-1))&Math.pow(2,-2*r+8)-1)<<2*r|n.indexOf(e.charAt(a))>>>6-2*r);return t}},e.exports=a},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"CaseComponent",(function(){return Vn})),n.d(t,"CaseViewLoading",(function(){return Un})),n.d(t,"CaseView",(function(){return $n})),n.d(t,"default",(function(){return $n}));var a=n(2),r=n.n(a),i=n(33),s=n.n(i),o=n(6),c=n(3),l=n(113),u=n(1),d=n(12);const m=u.i18n.translate("xpack.cases.header.editableTitle.save",{defaultMessage:"Save"}),p=u.i18n.translate("xpack.cases.header.editableTitle.cancel",{defaultMessage:"Cancel"}),f=e=>u.i18n.translate("xpack.cases.header.editableTitle.editButtonAria",{values:{title:e},defaultMessage:"You can edit {title} by clicking"});var g=n(102);const b=s()(o.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-4bg36g-0"})(["",""],(({theme:e})=>Object(i.css)(["margin-left:",";"],e.eui.euiSize))),E=s()(o.EuiLoadingSpinner).withConfig({displayName:"MySpinner",componentId:"sc-4bg36g-1"})(["",""],(({theme:e})=>Object(i.css)(["margin-left:",";"],e.eui.euiSize))),h=({userCanCrud:e=!1,onSubmit:t,isLoading:n,title:i})=>{const[s,l]=Object(a.useState)(!1),[u,h]=Object(a.useState)([]),[C,y]=Object(a.useState)(i),v=Object(a.useCallback)((()=>{l(!1),h([]),y(i)}),[i]),x=Object(a.useCallback)((()=>l(!0)),[]),I=Object(a.useCallback)((()=>{C.length>c.MAX_TITLE_LENGTH?h([d.x("title",c.MAX_TITLE_LENGTH)]):(C!==i&&t(C),l(!1))}),[C,t,i]),j=Object(a.useCallback)((e=>y(e.target.value)),[]),w=u.length>0;return s?r.a.createElement(o.EuiFormRow,{isInvalid:w,error:u,fullWidth:!0},r.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"m",justifyContent:"spaceBetween"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiFieldText,{onChange:j,value:`${C}`,"data-test-subj":"editable-title-input-field"})),r.a.createElement(o.EuiFlexGroup,{gutterSize:"none",responsive:!1,wrap:!0},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{color:"secondary","data-test-subj":"editable-title-submit-btn",fill:!0,iconType:"save",onClick:I,size:"s"},m)),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"editable-title-cancel-btn",iconType:"cross",onClick:v,size:"s"},p))),r.a.createElement(o.EuiFlexItem,null))):r.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(g.a,{title:i})),r.a.createElement(o.EuiFlexItem,{grow:!1},n&&r.a.createElement(E,{"data-test-subj":"editable-title-loading"}),!n&&e&&r.a.createElement(b,{"aria-label":f(i),iconType:"pencil",onClick:x,"data-test-subj":"editable-title-edit-icon"})))},C=r.a.memo(h);var y=n(21);const v=u.i18n.translate("xpack.cases.caseView.editTagsLinkAria",{defaultMessage:"click to edit tags"});var x=n(46);const I={tags:n(80).b};var j=n(78);const w=s()(o.EuiBadge).withConfig({displayName:"MyEuiBadge",componentId:"sc-1rutbhv-0"})(["max-width:200px;"]),O=({tags:e,color:t="default",gutterSize:n})=>r.a.createElement(r.a.Fragment,null,e.length>0&&r.a.createElement(o.EuiBadgeGroup,{gutterSize:n},e.map((e=>r.a.createElement(w,{"data-test-subj":`tag-${e}`,color:t,key:e},e))))),k=Object(a.memo)(O),S=Object(x.i)({component:x.b}),T=s()(o.EuiFlexGroup).withConfig({displayName:"MyFlexGroup",componentId:"sc-7s25zb-0"})(["",""],(({theme:e})=>Object(i.css)(["width:100%;margin-top:",";p{font-size:",";}"],e.eui.euiSizeM,e.eui.euiSizeM))),A=s()(o.EuiFlexGroup).withConfig({displayName:"ColumnFlexGroup",componentId:"sc-7s25zb-1"})(["",""],(({theme:e})=>Object(i.css)(["&{max-width:100%;@media only screen and (max-width:","){flex-direction:row;}}"],e.eui.euiBreakpoints.m))),F=r.a.memo((({userCanCrud:e=!0,isLoading:t,onSubmit:n,tags:i})=>{const s={tags:i},{form:c}=Object(x.j)({defaultValue:s,options:{stripEmptyFields:!1},schema:I}),{submit:l}=c,[u,m]=Object(a.useState)(!1),p=Object(a.useCallback)((async()=>{const{isValid:e,data:t}=await l();e&&t.tags&&(n(t.tags),m(!1))}),[n,l]),{tags:f}=Object(j.a)(),[g,b]=Object(a.useState)(f.map((e=>({label:e}))));return Object(a.useEffect)((()=>b(f.map((e=>({label:e}))))),[f]),r.a.createElement(o.EuiText,null,r.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement("h4",null,d.S)),t&&r.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":"tag-list-loading"}),!t&&e&&r.a.createElement(o.EuiFlexItem,{"data-test-subj":"tag-list-edit",grow:!1},r.a.createElement(o.EuiButtonIcon,{"data-test-subj":"tag-list-edit-button","aria-label":v,iconType:"pencil",onClick:m.bind(null,!0)}))),r.a.createElement(o.EuiHorizontalRule,{margin:"xs"}),r.a.createElement(T,{gutterSize:"none","data-test-subj":"case-tags"},0===i.length&&!u&&r.a.createElement("p",{"data-test-subj":"no-tags"},d.B),!u&&r.a.createElement(o.EuiFlexItem,null,r.a.createElement(k,{tags:i,color:"hollow"})),u&&r.a.createElement(A,{"data-test-subj":"edit-tags",direction:"column"},r.a.createElement(o.EuiFlexItem,null,r.a.createElement(x.c,{form:c},r.a.createElement(S,{path:"tags",componentProps:{idAria:"caseTags","data-test-subj":"caseTags",euiFieldProps:{fullWidth:!0,placeholder:"",options:g,noSuggestions:!1}}}),r.a.createElement(x.d,{pathsToWatch:"tags"},(({tags:e})=>{const t=g.map((e=>e.label)),n=e.reduce(((e,t)=>e.includes(t)?e:[...e,t]),t);return Object(y.isEqual)(t,n)||b(n.map((e=>({label:e})))),null})))),r.a.createElement(o.EuiFlexItem,null,r.a.createElement(o.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{color:"secondary","data-test-subj":"edit-tags-submit",fill:!0,iconType:"save",onClick:p,size:"s"},d.M)),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"edit-tags-cancel",iconType:"cross",onClick:m.bind(null,!1),size:"s"},d.f)))))))}));F.displayName="TagList";var L=n(13),N=n(20),D=n(48);const M=(e,t)=>{var n;switch(t.type){case"FETCH_INIT":return{...e,isLoading:!(null!==(n=t.payload)&&void 0!==n&&n.silent),isError:!1};case"FETCH_SUCCESS":return{...e,isLoading:!1,isError:!1,data:t.payload.case,resolveOutcome:t.payload.outcome,resolveAliasId:t.payload.aliasTargetId};case"FETCH_FAILURE":return{...e,isLoading:!1,isError:!0};case"UPDATE_CASE":return{...e,data:t.payload};default:return e}};var R=n(36),B=n.n(R),z=n(9),_=n(42),V=n(4);const U=u.i18n.translate("xpack.cases.caseView.actionLabel.addedField",{defaultMessage:"added"}),$=u.i18n.translate("xpack.cases.caseView.actionLabel.changededField",{defaultMessage:"changed"}),P=u.i18n.translate("xpack.cases.caseView.actionLabel.removedThirdParty",{defaultMessage:"removed external incident management system"}),H=u.i18n.translate("xpack.cases.caseView.actionLabel.editedField",{defaultMessage:"edited"}),G=u.i18n.translate("xpack.cases.caseView.actionLabel.removedField",{defaultMessage:"removed"}),W=u.i18n.translate("xpack.cases.caseView.actionLabel.pushedNewIncident",{defaultMessage:"pushed as new incident"}),q=u.i18n.translate("xpack.cases.caseView.actionLabel.updateIncident",{defaultMessage:"updated incident"}),K=u.i18n.translate("xpack.cases.caseView.actionLabel.addDescription",{defaultMessage:"added description"}),X=u.i18n.translate("xpack.cases.caseView.edit.description",{defaultMessage:"Edit description"}),Q=u.i18n.translate("xpack.cases.caseView.edit.quote",{defaultMessage:"Quote"}),Y=u.i18n.translate("xpack.cases.caseView.edit.comment",{defaultMessage:"Edit comment"}),J=(u.i18n.translate("xpack.cases.caseView.actionLabel.on",{defaultMessage:"on"}),u.i18n.translate("xpack.cases.caseView.statusLabel",{defaultMessage:"Status"})),Z=u.i18n.translate("xpack.cases.caseView.case",{defaultMessage:"case"}),ee=u.i18n.translate("xpack.cases.caseView.comment",{defaultMessage:"comment"}),te=u.i18n.translate("xpack.cases.caseView.caseRefresh",{defaultMessage:"Refresh case"}),ne=u.i18n.translate("xpack.cases.caseView.fieldChanged",{defaultMessage:"changed connector field"}),ae=u.i18n.translate("xpack.cases.caseView.syncAlertsLabel",{defaultMessage:"Sync alerts"}),re=u.i18n.translate("xpack.cases.caseView.doesNotExist.title",{defaultMessage:"This case does not exist"}),ie=e=>u.i18n.translate("xpack.cases.caseView.doesNotExist.description",{values:{caseId:e},defaultMessage:"A case with id {caseId} could not be found. This likely means the case has been deleted, or the id is incorrect."}),se=u.i18n.translate("xpack.cases.caseView.doesNotExist.button",{defaultMessage:"Back to Cases"}),oe=e=>u.i18n.translate("xpack.cases.caseView.requiredUpdateToExternalService",{values:{externalService:e},defaultMessage:"Requires update to { externalService } incident"}),ce=u.i18n.translate("xpack.cases.caseView.copyCommentLinkAria",{defaultMessage:"Copy reference link"}),le=u.i18n.translate("xpack.cases.caseView.moveToCommentAria",{defaultMessage:"Highlight the referenced comment"}),ue=u.i18n.translate("xpack.cases.caseView.alertCommentLabelTitle",{defaultMessage:"added an alert from"}),de=u.i18n.translate("xpack.cases.caseView.generatedAlertCommentLabelTitle",{defaultMessage:"were added from"}),me=u.i18n.translate("xpack.cases.caseView.showAlertTooltip",{defaultMessage:"Show alert details"}),pe=u.i18n.translate("xpack.cases.caseView.unknownRule.label",{defaultMessage:"Unknown rule"}),fe=u.i18n.translate("xpack.cases.caseView.isolatedHost",{defaultMessage:"submitted isolate request on host"}),ge=u.i18n.translate("xpack.cases.caseView.releasedHost",{defaultMessage:"submitted release request on host"});var be=n(50);const Ee=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,isLoadingIds:[...e.isLoadingIds,t.payload],isError:!1};case"FETCH_SUCCESS":return{...e,isLoadingIds:e.isLoadingIds.filter((e=>t.payload.commentId!==e)),isError:!1};case"FETCH_FAILURE":return{...e,isLoadingIds:e.isLoadingIds.filter((e=>t.payload!==e)),isError:!0};default:return e}};var he=n(74),Ce=n(72);const{emptyField:ye}=x.g,ve={comment:{type:x.a.TEXTAREA,validations:[{validator:ye(d.l)}]}};var xe=n(89);const Ie=s()(o.EuiLoadingSpinner).withConfig({displayName:"MySpinner",componentId:"sc-1b6ejct-0"})(["position:absolute;top:50%;left:50%;"]),je={comment:""},we=r.a.memo(Object(a.forwardRef)((({id:e,caseId:t,userCanCrud:n,onCommentPosted:i,onCommentSaving:s,showLoading:l=!0,statusActionButton:u,subCaseId:m},p)=>{const f=Object(a.useRef)(null),[g,b]=Object(a.useState)(!1),E=Object(be.a)(),{isLoading:h,postComment:C}=Object(he.a)(),{form:y}=Object(x.j)({defaultValue:je,options:{stripEmptyFields:!1},schema:ve}),v="comment",{setFieldValue:I,reset:j,submit:w}=y,[{comment:O}]=Object(x.l)({form:y,watch:[v]}),k=Object(a.useCallback)((e=>{const t=`> ${e.replace(new RegExp("\r?\n","g"),"\n> ")} \n\n`;I(v,`${O}${O.length>0?"\n\n":""}${t}`),b(!0)}),[O,I]),S=Object(a.useCallback)((e=>{I(v,e)}),[I]);Object(a.useImperativeHandle)(p,(()=>({addQuote:k,setComment:S,editor:f.current})));const T=Object(a.useCallback)((async()=>{const{isValid:e,data:n}=await w();e&&(null!=s&&s(),C({caseId:t,data:{...n,type:c.CommentType.user,owner:E[0]},updateCase:i,subCaseId:m}),j())}),[w,s,C,t,E,i,m,j]);return Object(a.useEffect)((()=>{var e,t;Object(z.isEmpty)(O)||(null===(e=f.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus());g&&b(!1)}),[g]),r.a.createElement("span",{id:"add-comment-permLink"},h&&l&&r.a.createElement(Ie,{"data-test-subj":"loading-spinner",size:"xl"}),n&&r.a.createElement(x.c,{form:y},r.a.createElement(x.e,{path:v,component:Ce.a,componentProps:{ref:f,id:e,idAria:"caseComment",isDisabled:h,dataTestSubj:"add-comment",placeholder:d.c,bottomRightContent:r.a.createElement(o.EuiFlexGroup,{gutterSize:"s",alignItems:"flexEnd",responsive:!1,wrap:!0},u&&r.a.createElement(o.EuiFlexItem,{grow:!1},u),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{"data-test-subj":"submit-comment",fill:!0,iconType:"plusInCircle",isDisabled:h,isLoading:h,onClick:T},d.b)))}}),r.a.createElement(xe.a,{fieldName:"comment"})))})));we.displayName="AddComment";const Oe=(e,t)=>{if(null==t)return null;const n=ke(t);return c.CaseUserActionConnectorRt.is(n)?null==e&&n.type===c.ConnectorTypes.none?{...n,id:c.noneConnectorId}:null==e?null:{...n,id:e}:null},ke=e=>{if(null==e)return null;try{return JSON.parse(e)}catch{return null}},Se=(e,t)=>{if(null==t)return null;const n=ke(t);return c.CaseUserActionExternalServiceRt.is(n)?{...n,connector_id:e}:null},Te=({username:e,fullName:t})=>{var n;const a=null!==(n=Object(y.isEmpty)(t)?e:t)&&void 0!==n?n:d.X;return r.a.createElement(o.EuiToolTip,{position:"top",content:r.a.createElement("p",null,a),"data-test-subj":"user-action-username-tooltip"},r.a.createElement("strong",null,null!=e?e:d.X.toLowerCase()))},Ae=Object(a.memo)(Te),Fe=({username:e,fullName:t})=>{var n;return r.a.createElement(o.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"s","data-test-subj":"user-action-username-with-avatar"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiAvatar,{size:"s",name:null!==(n=Object(y.isEmpty)(t)?e:t)&&void 0!==n?n:d.X,"data-test-subj":"user-action-username-avatar"})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(Ae,{username:e,fullName:t})))},Le=Object(a.memo)(Fe);var Ne=n(35),De=n(99);const Me=({createdAt:e,updatedAt:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(De.a,{date:new Date(e)},r.a.createElement(Ne.FormattedRelative,{"data-test-subj":"user-action-title-creation-relative-time",value:e})),t&&r.a.createElement(o.EuiTextColor,{color:"subdued"}," (",H," ",r.a.createElement(De.a,{date:new Date(t)},r.a.createElement(Ne.FormattedRelative,{"data-test-subj":"user-action-title-edited-relative-time",value:t})),")")),Re=Object(a.memo)(Me);var Be=n(118),ze=n.n(Be);const _e=({id:e,getCaseDetailHrefWithCommentId:t})=>{const n=Object(a.useCallback)((()=>{ze()(t(e))}),[t,e]);return r.a.createElement(o.EuiToolTip,{position:"top",content:r.a.createElement("p",null,ce)},r.a.createElement(o.EuiButtonIcon,{"aria-label":ce,"data-test-subj":`copy-link-${e}`,onClick:n,iconType:"link",id:`${e}-permLink`}))},Ve=Object(a.memo)(_e),{emptyField:Ue}=x.g,$e={content:{type:x.a.TEXTAREA,validations:[{validator:Ue(d.L)}]}},Pe=s.a.div.withConfig({displayName:"ContentWrapper",componentId:"sc-p8wsre-0"})(["padding:",";"],(({theme:e})=>`${e.eui.euiSizeM} ${e.eui.euiSizeL}`)),He=Object(a.forwardRef)((({id:e,content:t,isEditable:n,onChangeEditable:i,onSaveContent:s},c)=>{const l=Object(a.useRef)(),u={content:t},{form:m}=Object(x.j)({defaultValue:u,options:{stripEmptyFields:!1},schema:$e}),p="content",{setFieldValue:f,submit:g}=m,b=Object(a.useCallback)((()=>{i(e)}),[e,i]),E=Object(a.useCallback)((async()=>{const{isValid:t,data:n}=await g();t&&s(n.content),i(e)}),[e,i,s,g]),h=Object(a.useCallback)((e=>{f(p,e)}),[f]),C=Object(a.useMemo)((()=>r.a.createElement(o.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"user-action-cancel-markdown",size:"s",onClick:b,iconType:"cross"},d.f)),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{"data-test-subj":"user-action-save-markdown",color:"secondary",fill:!0,iconType:"save",onClick:E,size:"s"},d.M)))),[b,E]);return Object(a.useImperativeHandle)(c,(()=>({setComment:h,editor:l.current}))),n?r.a.createElement(x.c,{form:m,"data-test-subj":"user-action-markdown-form"},r.a.createElement(x.e,{path:p,component:Ce.a,componentProps:{ref:l,"aria-label":"Cases markdown editor",value:t,id:e,bottomRightContent:C}})):r.a.createElement(Pe,{"data-test-subj":"user-action-markdown"},r.a.createElement(Ce.b,null,t))})),Ge=({id:e,outlineComment:t})=>{const n=Object(a.useCallback)((()=>{t(e)}),[e,t]);return r.a.createElement(o.EuiToolTip,{position:"top",content:r.a.createElement("p",null,le)},r.a.createElement(o.EuiButtonIcon,{"aria-label":le,"data-test-subj":`move-to-link-${e}`,onClick:n,iconType:"arrowUp"}))},We=Object(a.memo)(Ge);var qe=n(57);const Ke=({id:e,alertId:t,index:n,onShowAlertDetails:i})=>{const s=Object(a.useCallback)((()=>i(t,n)),[t,n,i]);return r.a.createElement(o.EuiToolTip,{position:"top",content:r.a.createElement("p",null,me)},r.a.createElement(o.EuiButtonIcon,{"aria-label":me,"data-test-subj":`comment-action-show-alert-${e}`,onClick:s,iconType:"arrowRight",id:`${e}-show-alert`}))},Xe=Object(a.memo)(Ke);var Qe=n(54);const Ye=({alertId:e,getRuleDetailsHref:t,loadingAlertData:n=!1,onRuleDetailsClick:i,ruleId:s,ruleName:l,alertsCount:d,commentType:m})=>{const p=Object(a.useCallback)((e=>{e.preventDefault(),i&&i(s,e)}),[s,i]),f=t(s);return m!==c.CommentType.generatedAlert?r.a.createElement(r.a.Fragment,null,`${ue} `,n&&r.a.createElement(o.EuiLoadingSpinner,{size:"m"}),!n&&!Object(z.isEmpty)(s)&&r.a.createElement(Qe.b,{onClick:p,href:f,"data-test-subj":`alert-rule-link-${null!=e?e:"deleted"}`},null!=l?l:pe),!n&&Object(z.isEmpty)(s)&&pe):r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,(g=null!=d?d:0,u.i18n.translate("xpack.cases.caseView.generatedAlertCountCommentLabelTitle",{values:{totalCount:g},defaultMessage:"{totalCount} {totalCount, plural, =1 {alert} other {alerts}}"})))," ",de," ",n&&r.a.createElement(o.EuiLoadingSpinner,{size:"m"}),!n&&""!==s&&r.a.createElement(Qe.b,{onClick:p,href:f,"data-test-subj":`alert-rule-link-${null!=e?e:"deleted"}`},l),!n&&""===s&&r.a.createElement(o.EuiText,null,l));var g},Je=Object(a.memo)(Ye),Ze=({type:e,endpoints:t,href:n,onClick:i})=>{const s=n?n(t[0].endpointId):"",o=Object(a.useCallback)((e=>{e.preventDefault(),i&&i(t[0].endpointId,e)}),[i,t]);return r.a.createElement(r.a.Fragment,null,"isolate"===e?`${fe} `:`${ge} `,r.a.createElement(Qe.b,{onClick:o,href:s,"data-test-subj":`actions-link-${t[0].endpointId}`},t[0].hostname),t.length>1&&(e=>u.i18n.translate("xpack.cases.caseView.otherEndpoints",{values:{endpoints:e},defaultMessage:" and {endpoints} {endpoints, plural, =1 {other} other {others}}"}))(t.length-1))},et=Object(a.memo)(Ze),tt=({action:e,field:t})=>{if("tags"===t)return at(e);if("title"===t&&"update"===e.action)return`${$.toLowerCase()} ${d.g.toLowerCase()}  ${d.W} "${e.newValue}"`;if("description"===t&&"update"===e.action)return`${H} ${d.r.toLowerCase()}`;if("status"===t&&"update"===e.action){var n;const t=null!==(n=e.newValue)&&void 0!==n?n:"";return(e=>Object.prototype.hasOwnProperty.call(qe.c,e))(t)?((e,t)=>r.a.createElement(o.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":`${e}-user-action-status-title`,responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},d.v),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(qe.b,{type:t}))))(e.actionId,t):""}return"comment"===t&&"update"===e.action?`${H} ${ee.toLowerCase()}`:""},nt=({action:e,connectors:t})=>{const n=Oe(e.oldValConnectorId,e.oldValue),a=Oe(e.newValConnectorId,e.newValue);if(!n||!a)return"";if(n.id===a.id)return ne;const r=t.find((e=>e.id===a.id));return a.id!==c.noneConnectorId&&null!=r?(i=r.name,u.i18n.translate("xpack.cases.caseView.actionLabel.selectedThirdParty",{values:{thirdParty:i},defaultMessage:"selected { thirdParty } as incident management system"})):P;var i},at=e=>{const t=null!=e.newValue?e.newValue.split(","):[];return r.a.createElement(o.EuiFlexGroup,{alignItems:"baseline",gutterSize:"xs",component:"span",responsive:!1},r.a.createElement(o.EuiFlexItem,{"data-test-subj":"ua-tags-label",grow:!1},"add"===e.action&&U,"delete"===e.action&&G," ",d.S.toLowerCase()),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(k,{tags:t,gutterSize:"xs"})))},rt=({action:e,getCaseDetailHrefWithCommentId:t,label:n,handleOutlineComment:a})=>{return{username:r.a.createElement(Le,{username:e.actionBy.username,fullName:e.actionBy.fullName}),type:"update",event:n,"data-test-subj":`${e.actionField[0]}-${e.action}-action-${e.actionId}`,timestamp:r.a.createElement(Re,{createdAt:e.actionAt}),timelineIcon:(i=e.actionField[0],"tags"===i?"tag":"status"===i?"folderClosed":"dot"),actions:r.a.createElement(o.EuiFlexGroup,{responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(Ve,{getCaseDetailHrefWithCommentId:t,id:e.actionId})),"update"===e.action&&null!=e.commentId&&r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(We,{id:e.commentId,outlineComment:a})))};var i},it=({action:e,alertId:t,getCaseDetailHrefWithCommentId:n,getRuleDetailsHref:a,index:i,loadingAlertData:s,onRuleDetailsClick:l,onShowAlertDetails:u,ruleId:d,ruleName:m})=>({username:r.a.createElement(Le,{username:e.actionBy.username,fullName:e.actionBy.fullName}),className:"comment-alert",type:"update",event:r.a.createElement(Je,{alertId:t,getRuleDetailsHref:a,loadingAlertData:s,onRuleDetailsClick:l,ruleId:d,ruleName:m,commentType:c.CommentType.alert}),"data-test-subj":`${e.actionField[0]}-${e.action}-action-${e.actionId}`,timestamp:r.a.createElement(Re,{createdAt:e.actionAt}),timelineIcon:"bell",actions:r.a.createElement(o.EuiFlexGroup,{responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(Ve,{id:e.actionId,getCaseDetailHrefWithCommentId:n})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(Xe,{id:e.actionId,alertId:t,index:i,onShowAlertDetails:u})))}),st=({action:e,alertIds:t,getCaseDetailHrefWithCommentId:n,getRuleDetailsHref:a,onRuleDetailsClick:i,renderInvestigateInTimelineActionComponent:s,ruleId:l,ruleName:u})=>({username:r.a.createElement(o.EuiIcon,{type:"logoSecurity",size:"m"}),className:"comment-alert",type:"update",event:r.a.createElement(Je,{alertId:t[0],getRuleDetailsHref:a,onRuleDetailsClick:i,ruleId:l,ruleName:u,alertsCount:t.length,commentType:c.CommentType.generatedAlert}),"data-test-subj":`${e.actionField[0]}-${e.action}-action-${e.actionId}`,timestamp:r.a.createElement(Re,{createdAt:e.actionAt}),timelineIcon:"bell",actions:r.a.createElement(o.EuiFlexGroup,{responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(Ve,{getCaseDetailHrefWithCommentId:n,id:e.actionId})),s?r.a.createElement(o.EuiFlexItem,{grow:!1},s(t)):null)}),ot=r.a.memo((({actionType:e})=>{const t=Object(a.useContext)(i.ThemeContext);return r.a.createElement(o.EuiToken,{style:{marginTop:"8px"},iconType:"isolate"===e?"lock":"lockOpen",size:"m",shape:"circle",color:t.eui.euiColorLightestShade,"data-test-subj":"endpoint-action-icon"})})),ct=({comment:e,userCanCrud:t,isLoadingIds:n,getCaseDetailHrefWithCommentId:a,actionsNavigation:i,action:s})=>({username:r.a.createElement(Le,{username:e.createdBy.username,fullName:e.createdBy.fullName}),className:B()("comment-action",{"empty-comment":0===e.comment.trim().length}),event:r.a.createElement(et,{type:e.actions.type,endpoints:e.actions.targets,href:null==i?void 0:i.href,onClick:null==i?void 0:i.onClick}),"data-test-subj":"endpoint-action",timestamp:r.a.createElement(Re,{createdAt:s.actionAt}),timelineIcon:r.a.createElement(ot,{actionType:e.actions.type}),actions:r.a.createElement(Ve,{id:e.id,getCaseDetailHrefWithCommentId:a}),children:e.comment.trim().length>0&&r.a.createElement(Pe,{"data-test-subj":"user-action-markdown"},r.a.createElement(Ce.b,null,e.comment))}),lt=({username:e,fullName:t})=>{const n=t&&t.length>0?t:null!=e?e:d.X;return r.a.createElement(o.EuiAvatar,{name:n,"data-test-subj":"user-action-avatar"})},ut=Object(a.memo)(lt),dt=u.i18n.translate("xpack.cases.caseView.editActionsLinkAria",{defaultMessage:"click to see all actions"}),mt="property-actions",pt=r.a.memo((({disabled:e=!1,onClick:t,iconType:n,label:a})=>r.a.createElement(o.EuiButtonEmpty,{"aria-label":a,color:"text","data-test-subj":`${mt}-${n}`,iconSide:"left",iconType:n,isDisabled:e,onClick:t},a)));pt.displayName="PropertyActionButton";const ft=r.a.memo((({propertyActions:e})=>{const[t,n]=Object(a.useState)(!1),i=Object(a.useCallback)((()=>{n(!t)}),[t]),s=Object(a.useCallback)((e=>{n(!1),null!=e&&e()}),[]);return r.a.createElement(o.EuiPopover,{anchorPosition:"downRight","data-test-subj":mt,ownFocus:!0,button:r.a.createElement(o.EuiButtonIcon,{"data-test-subj":`${mt}-ellipses`,"aria-label":dt,iconType:"boxesHorizontal",onClick:i}),id:"settingsPopover",isOpen:t,closePopover:s,repositionOnScroll:!0},r.a.createElement(o.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":`${mt}-group`,direction:"column",gutterSize:"none"},e.map(((e,t)=>r.a.createElement(o.EuiFlexItem,{grow:!1,key:`${e.label}${t}`},r.a.createElement("span",null,r.a.createElement(pt,{disabled:e.disabled,iconType:e.iconType,label:e.label,onClick:()=>s(e.onClick)})))))))}));ft.displayName="PropertyActions";var gt=n(120),bt=n.n(gt),Et=(n(121),n(171)),ht=n.n(Et);const Ct="lens",yt=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.lens=function(e,t,n){if(!1===t.startsWith("!{lens"))return!0;const a=t[6];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let r="!{lens",i={};if("{"===a){let n="",a=0;for(let e=6;e<t.length;e++){const r=t[e];if("{"===r)a++,n+=r;else if("}"===r){if(a--,-1===a)break;n+=r}else n+=r}r+=n;try{i=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse lens JSON configuration: ${t}`,{line:n.line,column:n.column+6})}}return r+="}",e(r)({type:Ct,...i})},n.splice(n.indexOf("text"),0,Ct)},vt=u.i18n.translate("xpack.cases.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),xt="timeline",It="[",jt=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods,a=function(e,t,n){if(!1===t.startsWith(It)||!0===t.startsWith(It)&&!t.includes("timelines?timeline=(id"))return!1;let a=0;if(t[a]!==It)return!1;if(n)return!0;function r(e,n){if(t[a]!==e)throw new Error(vt);a++;let r="",i=0;for(;a<t.length;a++){const s=t[a];if(s===n&&0===i)return a++,r;s===n?i--:s===e&&i++,r+=s}return""}const i=`[${r(It,"]")}](${r("(",")")})`;return e(i)({type:xt,match:i})};a.locator=(e,t)=>e.indexOf(It,t),t.timeline=a,n.splice(n.indexOf("url"),0,xt)},wt=({comment:e})=>{var t;const n=(e=>ht()().use([[bt.a,{}],yt,jt]).parse(e))(e),r=(e=>null!=e&&e.length?Object(z.filter)(e,{type:Ct}):[])(null!==(t=null==n?void 0:n.children)&&void 0!==t?t:[]),{lens:{navigateToPrefilledEditor:i,canUseEditor:s}}=Object(N.d)().services,o=Object(a.useCallback)((()=>{i({id:"",timeRange:r[0].timeRange,attributes:r[0].attributes},{openInNewTab:!0})}),[r,i]);return{canUseEditor:s(),actionConfig:r.length?{iconType:"lensApp",label:u.i18n.translate("xpack.cases.markdownEditor.plugins.lens.openVisualizationButtonLabel",{defaultMessage:"Open visualization"}),onClick:o}:null}},Ot=({id:e,editLabel:t,quoteLabel:n,isLoading:i,onEdit:s,onQuote:c,userCanCrud:l,commentMarkdown:u})=>{const{canUseEditor:d,actionConfig:m}=wt({comment:u}),p=Object(a.useCallback)((()=>s(e)),[e,s]),f=Object(a.useCallback)((()=>c(e)),[e,c]),g=Object(a.useMemo)((()=>[l?[{iconType:"pencil",label:t,onClick:p},{iconType:"quote",label:n,onClick:f}]:[],d&&m?[m]:[]].flat()),[l,t,p,n,f,d,m]);return g.length?r.a.createElement(r.a.Fragment,null,i&&r.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":"user-action-title-loading"}),!i&&r.a.createElement(ft,{propertyActions:g})):null},kt=Object(a.memo)(Ot),St=({commentMarkdown:e,id:t,getCaseDetailHrefWithCommentId:n,editLabel:a,quoteLabel:i,isLoading:s,onEdit:c,onQuote:l,userCanCrud:u})=>r.a.createElement(o.EuiFlexGroup,{responsive:!1,alignItems:"center"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(Ve,{id:t,getCaseDetailHrefWithCommentId:n})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(kt,{id:t,editLabel:a,quoteLabel:i,isLoading:s,onEdit:c,onQuote:l,userCanCrud:u,commentMarkdown:e}))),Tt=Object(a.memo)(St);var At=n(84);const Ft=s()(o.EuiFlexGroup).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-el6wot-0"})(["margin-bottom:8px;"]),Lt=s()(o.EuiCommentList).withConfig({displayName:"MyEuiCommentList",componentId:"sc-el6wot-1"})(["",""],(({theme:e})=>`\n    & .userAction__comment.outlined .euiCommentEvent {\n      outline: solid 5px ${e.eui.euiColorVis1_behindText};\n      margin: 0.5em;\n      transition: 0.8s;\n    }\n\n    & .euiComment.isEdit {\n      & .euiCommentEvent {\n        border: none;\n        box-shadow: none;\n      }\n\n      & .euiCommentEvent__body {\n        padding: 0;\n      }\n\n      & .euiCommentEvent__header {\n        display: none;\n      }\n    }\n\n    & .comment-alert .euiCommentEvent {\n      background-color: ${e.eui.euiColorLightestShade};\n      border: ${e.eui.euiFlyoutBorder};\n      padding: ${e.eui.paddingSizes.s};\n      border-radius: ${e.eui.paddingSizes.xs};\n    }\n\n    & .comment-alert .euiCommentEvent__headerData {\n      flex-grow: 1;\n    }\n\n    & .comment-action.empty-comment .euiCommentEvent--regular {\n      box-shadow: none;\n      .euiCommentEvent__header {\n        padding: ${e.eui.euiSizeM} ${e.eui.paddingSizes.s};\n        border-bottom: 0;\n      }\n    }\n  `)),Nt="description",Dt="newComment",Mt=r.a.memo((({caseServices:e,caseUserActions:t,connectors:n,data:i,fetchUserActions:s,getCaseDetailHrefWithCommentId:l,getRuleDetailsHref:d,actionsNavigation:m,isLoadingDescription:p,isLoadingUserActions:f,onRuleDetailsClick:g,onShowAlertDetails:b,onUpdateField:E,renderInvestigateInTimelineActionComponent:h,statusActionButton:C,updateCase:y,useFetchAlertData:v,userCanCrud:x})=>{const{detailName:I,commentId:j,subCaseId:w}=Object(_.useParams)(),O=Object(a.useRef)(0),[k,S]=Object(a.useState)(!0),[T,A]=Object(a.useState)(""),{isLoadingIds:F,patchComment:M}=(()=>{const[e,t]=Object(a.useReducer)(Ee,{isLoadingIds:[],isError:!1}),n=Object(N.f)(),r=Object(a.useRef)(!1),i=Object(a.useRef)(new AbortController),s=Object(be.a)()[0],o=Object(a.useCallback)((async({caseId:e,commentId:a,commentUpdate:o,fetchUserActions:c,subCaseId:l,updateCase:u,version:d})=>{try{r.current=!1,i.current.abort(),i.current=new AbortController,t({type:"FETCH_INIT",payload:a});const n=await Object(D.m)({caseId:e,commentId:a,commentUpdate:o,version:d,signal:i.current.signal,subCaseId:l,owner:s});r.current||(u(n),c(),t({type:"FETCH_SUCCESS",payload:{commentId:a}}))}catch(e){r.current||("AbortError"!==e.name&&n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:L.d}),t({type:"FETCH_FAILURE",payload:a}))}}),[]);return Object(a.useEffect)((()=>()=>{r.current=!0,i.current.abort()}),[]),{...e,patchComment:o}})(),R=Object(N.b)(),[U,$]=Object(a.useState)([]),P=Object(a.useRef)({}),{clearDraftComment:H,draftComment:G,hasIncomingLensState:J,openLensModal:Z}=Object(At.a)(),[ee,te]=v((e=>[...e.reduce(((e,t)=>t.type===c.CommentType.alert&&Object(z.isEmpty)(t.rule.id)?((Array.isArray(t.alertId)?t.alertId:[t.alertId]).forEach((t=>e.add(t))),e):e),new Set)])(i.comments)),ne=Object(a.useCallback)((e=>{H(),$((t=>t.includes(e)?t.filter((t=>e!==t)):t.concat(e)))}),[H]),ae=Object(a.useCallback)((({id:e,version:t},n)=>{M({caseId:I,commentId:e,commentUpdate:n,fetchUserActions:s,version:t,updateCase:y,subCaseId:w})}),[I,s,M,w,y]),re=Object(a.useCallback)((e=>{const t=document.getElementById(`${e}-permLink`);if(null!=t){const n=-60,a=t.getBoundingClientRect().top+window.pageYOffset+n;window.scrollTo({top:a,behavior:"smooth"}),"add-comment"===e&&t.getElementsByTagName("textarea")[0].focus()}window.clearTimeout(O.current),A(e),O.current=window.setTimeout((()=>{A(""),window.clearTimeout(O.current)}),2400)}),[O]),ie=Object(a.useCallback)((e=>{P.current[Dt]&&P.current[Dt].addQuote(e),re("add-comment")}),[re]),se=Object(a.useCallback)((e=>{y(e),s()}),[s,y]),ce=Object(a.useMemo)((()=>r.a.createElement(He,{ref:e=>P.current.description=e,id:Nt,content:i.description,isEditable:U.includes(Nt),onSaveContent:e=>{E({key:Nt,value:e})},onChangeEditable:ne})),[i.description,ne,U,E]),le=Object(a.useMemo)((()=>r.a.createElement(we,{id:Dt,caseId:I,userCanCrud:x,ref:e=>P.current[Dt]=e,onCommentPosted:se,onCommentSaving:ne.bind(null,Dt),showLoading:!1,statusActionButton:C,subCaseId:w})),[I,x,se,ne,C,w]);Object(a.useEffect)((()=>{k&&!f&&0===F.length&&(S(!1),null!=j&&re(j))}),[j,k,f,F,re]);const ue=Object(a.useMemo)((()=>({username:r.a.createElement(Ae,{username:i.createdBy.username,fullName:i.createdBy.fullName}),event:K,"data-test-subj":"description-action",timestamp:r.a.createElement(Re,{createdAt:i.createdAt}),children:ce,timelineIcon:r.a.createElement(ut,{username:i.createdBy.username,fullName:i.createdBy.fullName}),className:B()({isEdit:U.includes(Nt)}),actions:r.a.createElement(Tt,{commentMarkdown:i.description,getCaseDetailHrefWithCommentId:l,id:Nt,editLabel:X,quoteLabel:Q,isLoading:p,onEdit:ne.bind(null,Nt),onQuote:ie.bind(null,i.description),userCanCrud:x})})),[ce,i,l,ne,ie,p,x,U]),de=[...Object(a.useMemo)((()=>t.reduce(((t,a,s)=>{if(null!=a.commentId&&"create"===a.action){const e=i.comments.find((e=>e.id===a.commentId));if(null!=e&&Object(V.isRight)(c.ContextTypeUserRt.decode(e))&&e.type===c.CommentType.user)return[...t,{username:r.a.createElement(Ae,{username:e.createdBy.username,fullName:e.createdBy.fullName}),"data-test-subj":`comment-create-action-${e.id}`,timestamp:r.a.createElement(Re,{createdAt:e.createdAt,updatedAt:e.updatedAt}),className:B()("userAction__comment",{outlined:e.id===T,isEdit:U.includes(e.id)}),children:r.a.createElement(He,{ref:t=>P.current[e.id]=t,id:e.id,content:e.comment,isEditable:U.includes(e.id),onChangeEditable:ne,onSaveContent:ae.bind(null,{id:e.id,version:e.version})}),timelineIcon:r.a.createElement(ut,{username:e.createdBy.username,fullName:e.createdBy.fullName}),actions:r.a.createElement(Tt,{getCaseDetailHrefWithCommentId:l,id:e.id,commentMarkdown:e.comment,editLabel:Y,quoteLabel:Q,isLoading:F.includes(e.id),onEdit:ne.bind(null,e.id),onQuote:ie.bind(null,e.comment),userCanCrud:x})}];if(null!=e&&Object(V.isRight)(c.AlertCommentRequestRt.decode(e))&&e.type===c.CommentType.alert){var p,f,E,C,y,v,I,j,w,O,k,S,A,L;const n=Array.isArray(e.alertId)?e.alertId.length>0?e.alertId[0]:"":e.alertId,r=Array.isArray(e.index)?e.index.length>0?e.index[0]:"":e.index;if(Object(z.isEmpty)(n))return t;const i=null!==(p=null!==(f=null==e||null===(E=e.rule)||void 0===E?void 0:E.id)&&void 0!==f?f:null===(C=te[n])||void 0===C||null===(y=C.signal)||void 0===y||null===(v=y.rule)||void 0===v||null===(I=v.id)||void 0===I?void 0:I[0])&&void 0!==p?p:null,s=null!==(j=null!==(w=null==e||null===(O=e.rule)||void 0===O?void 0:O.name)&&void 0!==w?w:null===(k=te[n])||void 0===k||null===(S=k.signal)||void 0===S||null===(A=S.rule)||void 0===A||null===(L=A.name)||void 0===L?void 0:L[0])&&void 0!==j?j:null;return[...t,...null!=d?[it({action:a,alertId:n,getCaseDetailHrefWithCommentId:l,getRuleDetailsHref:d,index:r,loadingAlertData:ee,onRuleDetailsClick:g,ruleId:i,ruleName:s,onShowAlertDetails:b})]:[]]}if(null!=e&&e.type===c.CommentType.generatedAlert){var N,D,M,R;const n=Array.isArray(e.alertId)?e.alertId:[e.alertId];return Object(z.isEmpty)(n)?t:[...t,...null!=d?[st({action:a,alertIds:n,getCaseDetailHrefWithCommentId:l,getRuleDetailsHref:d,onRuleDetailsClick:g,renderInvestigateInTimelineActionComponent:h,ruleId:null!==(N=null===(D=e.rule)||void 0===D?void 0:D.id)&&void 0!==N?N:"",ruleName:null!==(M=null===(R=e.rule)||void 0===R?void 0:R.name)&&void 0!==M?M:pe})]:[]]}if(null!=e&&Object(V.isRight)(c.ActionsCommentRequestRt.decode(e))&&e.type===c.CommentType.actions)return[...t,...null!==e.actions?[ct({comment:e,userCanCrud:x,isLoadingIds:F,getCaseDetailHrefWithCommentId:l,actionsNavigation:m,action:a})]:[]]}if(1===a.actionField.length&&"connector"===a.actionField[0]){const e=nt({action:a,connectors:n});return[...t,rt({action:a,label:e,getCaseDetailHrefWithCommentId:l,handleOutlineComment:re})]}if(1===a.actionField.length&&"pushed"===a.actionField[0]){var _,$;const n=Se(a.newValConnectorId,a.newValue),{firstPush:i,parsedConnectorId:d,parsedConnectorName:m}=((e,t,n)=>{var a;return null!=t&&null!=t.connector_id?{firstPush:(null===(a=e[t.connector_id])||void 0===a?void 0:a.firstPushIndex)===n,parsedConnectorId:t.connector_id,parsedConnectorName:t.connector_name}:{firstPush:!1,parsedConnectorId:c.noneConnectorId,parsedConnectorName:c.noneConnectorId}})(e,n,s),p=((e,t)=>{const n=Se(e.newValConnectorId,e.newValue);return r.a.createElement(o.EuiFlexGroup,{alignItems:"baseline",gutterSize:"xs","data-test-subj":"pushed-service-label-title",responsive:!1},r.a.createElement(o.EuiFlexItem,{"data-test-subj":"pushed-label"},`${t?W:q} ${null==n?void 0:n.connector_name}`),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiLink,{"data-test-subj":"pushed-value",href:null==n?void 0:n.external_url,target:"_blank"},null==n?void 0:n.external_title)))})(a,i),f="push-to-service"===a.action&&s===(null===(_=e[d])||void 0===_?void 0:_.lastPushIndex),g="push-to-service"===a.action&&s===(null===($=e[d])||void 0===$?void 0:$.lastPushIndex)&&e[d].hasDataToPush;let b=[];return f&&(b=[...b,{username:"",type:"update",event:(H=`${m}`,u.i18n.translate("xpack.cases.caseView.alreadyPushedToExternalService",{values:{externalService:H},defaultMessage:"Already pushed to { externalService } incident"})),timelineIcon:"sortUp","data-test-subj":"top-footer"}]),g&&(b=[...b,{username:"",type:"update",event:oe(`${m}`),timelineIcon:"sortDown","data-test-subj":"bottom-footer"}]),[...t,rt({action:a,label:p,getCaseDetailHrefWithCommentId:l,handleOutlineComment:re}),...b]}var H;if(1===a.actionField.length&&["title","description","comment","tags","status"].includes(a.actionField[0])){const e=a.actionField[0],n=tt({action:a,field:e});return[...t,rt({action:a,label:n,getCaseDetailHrefWithCommentId:l,handleOutlineComment:re})]}return t}),[ue])),[t,ue,i.comments,T,U,ne,ae,l,m,x,F,ie,te,d,ee,g,b,h,n,re,e]),...x?[{username:r.a.createElement(Ae,{username:null==R?void 0:R.username,fullName:null==R?void 0:R.fullName}),"data-test-subj":"add-comment",timelineIcon:r.a.createElement(ut,{username:null==R?void 0:R.username,fullName:null==R?void 0:R.fullName}),className:"isEdit",children:le}]:[]];return Object(a.useEffect)((()=>{var e,t;null!=G&&G.commentId&&($((e=>[Dt].includes(null==G?void 0:G.commentId)||e.includes(null==G?void 0:G.commentId)?e:[null==G?void 0:G.commentId])),P.current&&P.current[G.commentId]&&null!==(e=P.current[G.commentId].editor)&&void 0!==e&&e.textarea&&null!==(t=P.current[G.commentId].editor)&&void 0!==t&&t.toolbar&&(P.current[G.commentId].setComment(G.comment),J?Z({editorRef:P.current[G.commentId].editor}):H()))}),[G,Z,P,J,H,U]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt,{comments:de,"data-test-subj":"user-actions"}),(f||F.includes(Dt))&&r.a.createElement(Ft,{justifyContent:"center",alignItems:"center"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":"user-actions-loading",size:"l"}))))}));Mt.displayName="UserActionTree";const Rt=s()(o.EuiAvatar).withConfig({displayName:"MyAvatar",componentId:"sc-2lwk7k-0"})(["top:-4px;"]),Bt=s()(o.EuiFlexGroup).withConfig({displayName:"MyFlexGroup",componentId:"sc-2lwk7k-1"})(["",""],(({theme:e})=>Object(i.css)(["margin-top:",";"],e.eui.euiSizeM))),zt=r.a.memo((({email:e,headline:t,loading:n,users:i})=>{const s=Object(a.useCallback)((t=>{t&&null!=t&&window.open(`mailto:${t}?subject=${e.subject}&body=${e.body}`,"_blank")}),[e.subject]);return i.filter((({username:e})=>null!=e&&""!==e)).length>0?r.a.createElement(o.EuiText,null,r.a.createElement("h4",null,t),r.a.createElement(o.EuiHorizontalRule,{margin:"xs"}),n&&r.a.createElement(o.EuiFlexGroup,null,r.a.createElement(o.EuiFlexItem,null,r.a.createElement(o.EuiLoadingSpinner,null))),((e,t)=>e.map((({fullName:e,username:n,email:a},i)=>{return r.a.createElement(Bt,{key:i,justifyContent:"spaceBetween",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiFlexGroup,{gutterSize:"xs",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(Rt,{name:e||(null!=n?n:"")})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiToolTip,{position:"top",content:r.a.createElement("p",null,e||(null!=n?n:""))},r.a.createElement("p",null,r.a.createElement("strong",null,r.a.createElement("small",{"data-test-subj":"case-view-username"},n))))))),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonIcon,{"data-test-subj":"user-list-email-button",onClick:t.bind(null,a),iconType:"email","aria-label":(s=e||(null!=n?n:""),u.i18n.translate("xpack.cases.caseView.sendEmalLinkAria",{values:{user:s},defaultMessage:"click to send an email to {user}"})),isDisabled:Object(y.isEmpty)(a)})));var s})))(i.filter((({username:e})=>null!=e&&""!==e)),s)):null}));zt.displayName="UserList";var _t=n(24);const Vt=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,isLoading:!0,isError:!1,updateKey:t.payload};case"FETCH_SUCCESS":return{...e,isLoading:!1,isError:!1,updateKey:null};case"FETCH_FAILURE":return{...e,isLoading:!1,isError:!0,updateKey:null};default:return e}};var Ut=n(93),$t=n(114),Pt=n(82),Ht=n(95);const Gt=({allCasesNavigation:e,caseData:t,currentExternalIncident:n})=>{const{handleToggleModal:i,handleOnDeleteConfirm:s,isDeleted:o,isDisplayConfirmDeleteModal:c}=Object(Pt.a)(),l=Object(a.useMemo)((()=>{var e,t;return[{iconType:"trash",label:d.q(),onClick:i},...null==n||Object(y.isEmpty)(null==n?void 0:n.externalUrl)?[]:[{iconType:"popout",label:(t=null!==(e=null==n?void 0:n.externalTitle)&&void 0!==e?e:"",u.i18n.translate("xpack.cases.caseView.actionLabel.viewIncident",{defaultMessage:"View {incidentNumber}",values:{incidentNumber:t}})),onClick:()=>window.open(null==n?void 0:n.externalUrl,"_blank")}]]}),[i,n]);return o?(e.onClick(null),null):r.a.createElement(r.a.Fragment,null,r.a.createElement(ft,{propertyActions:l}),r.a.createElement(Ht.a,{caseTitle:t.title,isModalVisible:c,onCancel:i,onConfirm:s.bind(null,[{id:t.id,title:t.title,type:t.type}])}))},Wt=r.a.memo(Gt);var qt=n(100);const Kt=({disabled:e,isSynced:t=!0,showLabel:n=!1,onSwitchChange:i})=>{const[s,c]=Object(a.useState)(t),l=Object(a.useCallback)((()=>{i&&i(!s),c(!s)}),[s,i]);return r.a.createElement(o.EuiSwitch,{label:s?d.R:d.Q,showLabel:n,checked:s,onChange:l,disabled:e,"data-test-subj":"sync-alerts-switch"})};Kt.displayName="SyncAlertsSwitchComponent";const Xt=Object(a.memo)(Kt),Qt=s()(o.EuiDescriptionList).withConfig({displayName:"MyDescriptionList",componentId:"sc-ns1eu-0"})(["",""],(({theme:e})=>Object(i.css)(["&{padding-right:",";border-right:",";@media only screen and (max-width:","){padding-right:0;border-right:0;}}"],e.eui.euiSizeL,e.eui.euiBorderThin,e.eui.euiBreakpoints.m))),Yt=({allCasesNavigation:e,caseData:t,currentExternalIncident:n,disableAlerting:i,userCanCrud:s,isLoading:l,onRefresh:u,onUpdateField:m})=>{const p=Object(a.useMemo)((()=>{return(e=t).status===c.CaseStatuses.open?e.createdAt:e.status===c.CaseStatuses["in-progress"]?e.updatedAt:e.status===c.CaseStatuses.closed?e.closedAt:null;var e}),[t]),f=Object(a.useMemo)((()=>{return e=t.status,qe.c[e].actionBar.title;var e}),[t.status]),g=Object(a.useCallback)((e=>m({key:"status",value:e})),[m]),b=Object(a.useCallback)((e=>m({key:"settings",value:{...t.settings,syncAlerts:e}})),[t.settings,m]);return r.a.createElement(o.EuiFlexGroup,{gutterSize:"l",justifyContent:"flexEnd","data-test-subj":"case-action-bar-wrapper"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(Qt,{compressed:!0},r.a.createElement(o.EuiFlexGroup,{responsive:!1,justifyContent:"spaceBetween"},t.type!==c.CaseType.collection&&r.a.createElement(o.EuiFlexItem,{"data-test-subj":"case-view-status"},r.a.createElement(o.EuiDescriptionListTitle,null,J),r.a.createElement(o.EuiDescriptionListDescription,null,r.a.createElement(qt.a,{currentStatus:t.status,disabled:!s||l,onStatusChanged:g}))),r.a.createElement(o.EuiFlexItem,null,r.a.createElement(o.EuiDescriptionListTitle,null,f),r.a.createElement(o.EuiDescriptionListDescription,null,r.a.createElement($t.a,{"data-test-subj":"case-action-bar-status-date",value:p})))))),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiDescriptionList,{compressed:!0},r.a.createElement(o.EuiFlexGroup,{gutterSize:"l",alignItems:"center",responsive:!1,justifyContent:"spaceBetween"},s&&!i&&r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiDescriptionListTitle,null,r.a.createElement(o.EuiFlexGroup,{component:"span",alignItems:"center",gutterSize:"xs",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement("span",null,ae)),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiIconTip,{content:d.P})))),r.a.createElement(o.EuiDescriptionListDescription,null,r.a.createElement(Xt,{disabled:l,isSynced:t.settings.syncAlerts,onSwitchChange:b}))),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement("span",null,r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"case-refresh",flush:"left",iconType:"refresh",onClick:u},te))),s&&r.a.createElement(o.EuiFlexItem,{grow:!1,"data-test-subj":"case-view-actions"},r.a.createElement(Wt,{allCasesNavigation:e,caseData:t,currentExternalIncident:n}))))))},Jt=r.a.memo(Yt);var Zt=n(110),en=n.n(Zt);const tn={caseServices:{},caseUserActions:[],hasDataToPush:!1,isError:!1,isLoading:!0,participants:[]},nn=e=>e.reduce(((e,t)=>{if("connector"!==t.actionField[0])return e;const n=Oe(t.oldValConnectorId,t.oldValue),a=Oe(t.newValConnectorId,t.newValue);return n&&a?{...e,[n.id]:[...e[n.id]||[],...n.id===a.id?[n.fields,a.fields]:[n.fields]],[a.id]:[...e[a.id]||[],...n.id===a.id?[n.fields,a.fields]:[a.fields]]}:e}),{}),an=(e,t)=>{const n=t=>{const n=[...e].reverse(),a=n.findIndex((e=>"push-to-service"===e.action&&e.newValConnectorId===t));if(-1===a)return!0;const r=n.length-a-1,i=e.slice(0,r),s=e.slice(r+1,n.length),o=(({connectorFieldsBeforePush:e,connectorFieldsAfterPush:t,connectorId:n})=>{if(null==t||null==t[n])return!1;const a=t[n];if(null!=e&&null!=e[n]){const t=e[n];return!en()(t[t.length-1],a[a.length-1])}return a.length>=2&&!en()(a[a.length-2],a[a.length-1])})({connectorFieldsBeforePush:nn(i),connectorFieldsAfterPush:nn(s),connectorId:t});return s.some((e=>"connector"!==e.actionField[0]&&"push-to-service"!==e.action))||o},a=e.reduce(((e,t,n)=>"comment"===t.actionField[0]&&null!=t.commentId?[...e,{commentId:t.commentId,commentIndex:n}]:e),[]);let r=e.reduce(((e,t,a)=>{if("push-to-service"!==t.action)return e;const r=((e,t)=>{const n=Se(e,t);return null==n?null:{...Object(_t.c)(n),connectorId:null!=e?e:"unknown"}})(t.newValConnectorId,t.newValue);return null===r?e:{...e,...null!=e[r.connectorId]?{[r.connectorId]:{...e[r.connectorId],...r,lastPushIndex:a,commentsToUpdate:[]}}:{[r.connectorId]:{...r,firstPushIndex:a,lastPushIndex:a,hasDataToPush:n(r.connectorId),commentsToUpdate:[]}}}}),{});r=Object.keys(r).reduce(((e,t)=>({...e,[t]:{...r[t],commentsToUpdate:a.reduce(((e,n)=>n.commentIndex>r[t].lastPushIndex?e.indexOf(n.commentId)>-1?[...e.filter((e=>e!==n.commentId)),n.commentId]:[...e,n.commentId]:e),[])}})),{});return{hasDataToPush:null==r[t]||r[t].hasDataToPush,caseServices:r}};var rn=n(85),sn=n(86);const on={connectorId:{type:x.a.SUPER_SELECT}},cn=(e,t)=>{try{for(const n of[...t].reverse())if(1===n.actionField.length&&"connector"===n.actionField[0]){const t=Oe(n.newValConnectorId,n.newValue);if(t&&e===t.id)return t.fields;const a=Oe(n.oldValConnectorId,n.oldValue);if(a&&e===a.id)return a.fields}return null}catch{return null}},ln=u.i18n.translate("xpack.cases.editConnector.editConnectorLinkAria",{defaultMessage:"click to edit connector"});var un=n(47),dn=n(96),mn=n(88),pn=n(98),fn=n(75);const gn=u.i18n.translate("xpack.cases.addConnector.title",{defaultMessage:"Add connector"}),bn=u.i18n.translate("xpack.cases.caseView.pushToServiceDisableBecauseCaseClosedTitle",{defaultMessage:"Reopen the case"}),En=u.i18n.translate("xpack.cases.caseView.errorsPushServiceCallOutTitle",{defaultMessage:"Select an external connector"}),hn=({handleButtonClick:e,id:t,messages:n,type:i,hasLicenseError:s})=>{const c=Object(a.useCallback)((n=>e(n,t,i)),[e,t,i]),l=Object(a.useMemo)((()=>n.map((e=>e.id)).includes(pn.a)),[n]);return Object(y.isEmpty)(n)?null:r.a.createElement(o.EuiCallOut,{title:l?bn:s?fn.e:En,color:i,iconType:"gear","data-test-subj":`case-callout-${t}`,size:"s"},r.a.createElement(o.EuiDescriptionList,{"data-test-subj":`callout-messages-${t}`,listItems:n}),!l&&!s&&r.a.createElement(o.EuiButton,{"data-test-subj":`callout-onclick-${t}`,color:"success"===i?"secondary":i,onClick:c},gn))},Cn=Object(a.memo)(hn);var yn=n(172),vn=n.n(yn);const xn=({configureCasesNavigation:e,hasConnectors:t,hasLicenseError:n,onEditClick:i,messages:s=[]})=>{const c=Object(a.useCallback)((n=>{t?i():e.onClick(n)}),[t,i,e]),l=Object(a.useMemo)((()=>s.reduce(((e,t)=>{var n,a,r,i;const s=null==t.errorType?"primary":t.errorType;return{...e,[s]:{messagesId:[...null!==(n=null===(a=e[s])||void 0===a?void 0:a.messagesId)&&void 0!==n?n:[],t.id],messages:[...null!==(r=null===(i=e[s])||void 0===i?void 0:i.messages)&&void 0!==r?r:[],t]}}}),{})),[s]);return r.a.createElement(r.a.Fragment,null,Object.keys(l).map((e=>{const t=((e,t="|")=>vn()(e.join(t)))(l[e].messagesId);return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(Cn,{handleButtonClick:c,id:t,messages:l[e].messages,type:e,hasLicenseError:n}),r.a.createElement(o.EuiSpacer,null))})))},In=Object(a.memo)(xn);var jn=n(97);const wn=s()(o.EuiFlexGroup).withConfig({displayName:"MyFlexGroup",componentId:"sc-cj1kee-0"})(["",""],(({theme:e})=>`\n    margin-top: ${e.eui.euiSizeM};\n    p {\n      font-size: ${e.eui.euiSizeM};\n    }\n  `)),On=s()(o.EuiFlexItem).withConfig({displayName:"DisappearingFlexItem",componentId:"sc-cj1kee-1"})(["",""],(({$isHidden:e})=>e&&"\n      margin: 0 !important;\n      & .euiFlexItem {\n        margin: 0 !important;\n      }\n    ")),kn=(e,t)=>{switch(t.type){case"SET_CURRENT_CONNECTOR":return{...e,currentConnector:t.payload};case"SET_FIELDS":return{...e,fields:t.payload};case"SET_EDIT_CONNECTOR":return{...e,editConnector:t.payload};default:return e}},Sn={currentConnector:null,fields:null,editConnector:!1},Tn=r.a.memo((({caseData:e,caseServices:t,configureCasesNavigation:n,connectorName:i,connectors:s,hasDataToPush:l,hideConnectorServiceNowSir:u=!1,isLoading:m,isValidConnector:p,onSubmit:f,permissionsError:g,updateCase:b,userActions:E,userCanCrud:h=!0})=>{const C=e.connector.fields,v=e.connector.id,{form:I}=Object(x.j)({defaultValue:{connectorId:v},options:{stripEmptyFields:!1},schema:on}),{setFieldValue:j,submit:w}=I,[{currentConnector:O,fields:k,editConnector:S},T]=Object(a.useReducer)(kn,{...Sn,fields:C});Object(a.useEffect)((()=>{m||(T({type:"SET_CURRENT_CONNECTOR",payload:Object(un.a)(e.connector.id,s)}),T({type:"SET_FIELDS",payload:C}))}),[e.connector.id,s,m,C]);const A=Object(a.useCallback)((e=>{(null==O?void 0:O.id)!==e&&(T({type:"SET_CURRENT_CONNECTOR",payload:Object(un.a)(e,s)}),T({type:"SET_FIELDS",payload:cn(e,null!=E?E:[])}))}),[O,E,s]),F=Object(a.useCallback)((e=>{en()(e,k)||T({type:"SET_FIELDS",payload:e})}),[k,T]),L=Object(a.useCallback)((()=>{j("connectorId",v),T({type:"SET_EDIT_CONNECTOR",payload:!1})}),[T,j,v]),N=Object(a.useCallback)((()=>{j("connectorId",v),T({type:"SET_FIELDS",payload:C}),T({type:"SET_EDIT_CONNECTOR",payload:!1})}),[T,v,j,C]),D=Object(a.useCallback)((async()=>{const{isValid:e,data:t}=await w();e&&t.connectorId&&(f(t.connectorId,k,L,y.noop),T({type:"SET_EDIT_CONNECTOR",payload:!1}))}),[T,w,k,f,L]),M=Object(a.useCallback)((()=>{T({type:"SET_EDIT_CONNECTOR",payload:!0})}),[T]),R=Object(un.c)({config:on.connectorId,connectors:s}),{pushButton:B,pushCallouts:z}=(({caseId:e,caseServices:t,caseStatus:n,configureCasesNavigation:i,connector:s,connectors:l,hasDataToPush:u,isValidConnector:d,onEditClick:m,updateCase:p,userCanCrud:f})=>{const{isLoading:g,pushCaseToExternalService:b}=Object(mn.a)(),{isLoading:E,actionLicense:h}=Object(dn.a)(),C=null!=h&&!h.enabledInLicense,y=Object(a.useCallback)((async()=>{if(null!=s.id&&"none"!==s.id){const t=await b({caseId:e,connector:s});null!=t&&p(t)}}),[e,s,b,p]),v=Object(a.useMemo)((()=>{const e=[];return f?C?[Object(jn.f)()]:null==h||h.enabledInConfig?"none"!==s.id||E||C?d||E||C?n===c.CaseStatuses.closed?[Object(jn.b)()]:e:[Object(jn.d)()]:[Object(jn.c)()]:[Object(jn.e)()]:e}),[h,n,l.length,s,E,f]),x=Object(a.useMemo)((()=>r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"push-to-external-service",iconType:"importAction",onClick:y,disabled:g||E||v.length>0||!f||!d||!u,isLoading:g},t[s.id]?fn.i(s.name):fn.h(s.name))),[s,l,v,y,u,g,E,f,d]);return Object(a.useMemo)((()=>({pushButton:v.length>0||!u?r.a.createElement(o.EuiToolTip,{position:"top",title:v.length>0?v[0].title:fn.g(s.name),content:r.a.createElement("p",null,v.length>0?v[0].description:fn.f)},x):r.a.createElement(r.a.Fragment,null,x),pushCallouts:v.length>0?r.a.createElement(In,{configureCasesNavigation:i,hasConnectors:l.length>0,hasLicenseError:C,messages:v,onEditClick:m}):null})),[i,s.name,l.length,v,u,C,m,x])})({configureCasesNavigation:n,connector:{...e.connector,name:Object(y.isEmpty)(i)?e.connector.name:i},caseServices:t,caseId:e.id,caseStatus:e.status,connectors:s,hasDataToPush:l,onEditClick:M,updateCase:b,userCanCrud:h,isValidConnector:p});return r.a.createElement(o.EuiText,null,r.a.createElement(wn,{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement("h4",null,d.n)),m&&r.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":"connector-loading"}),!m&&!S&&h&&r.a.createElement(o.EuiFlexItem,{"data-test-subj":"connector-edit",grow:!1},r.a.createElement(o.EuiButtonIcon,{"data-test-subj":"connector-edit-button","aria-label":ln,iconType:"pencil",onClick:M}))),r.a.createElement(o.EuiHorizontalRule,{margin:"xs"}),r.a.createElement(wn,{"data-test-subj":"edit-connectors",direction:"column"},!m&&!S&&z&&null==g&&r.a.createElement(o.EuiFlexItem,{"data-test-subj":"push-callouts"},z),r.a.createElement(On,{$isHidden:!S},r.a.createElement(x.c,{form:I},r.a.createElement(o.EuiFlexGroup,{gutterSize:"none",direction:"row"},r.a.createElement(o.EuiFlexItem,null,r.a.createElement(x.e,{path:"connectorId",config:R,component:rn.a,componentProps:{connectors:s,dataTestSubj:"caseConnectors",defaultValue:v,disabled:!h,hideConnectorServiceNowSir:u,idAria:"caseConnectors",isEdit:S,isLoading:m},onChange:A}))))),r.a.createElement(o.EuiFlexItem,{"data-test-subj":"edit-connector-fields-form-flex-item"},!S&&g&&r.a.createElement(o.EuiText,{"data-test-subj":"edit-connector-permissions-error-msg",size:"s"},r.a.createElement("span",null,g)),r.a.createElement(sn.a,{connector:O,fields:k,isEdit:S,onChange:F})),S&&r.a.createElement(o.EuiFlexItem,null,r.a.createElement(o.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{color:"secondary","data-test-subj":"edit-connectors-submit",fill:!0,iconType:"save",onClick:D,size:"s"},d.M)),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":"edit-connectors-cancel",iconType:"cross",onClick:N,size:"s"},d.f)))),null==z&&!m&&!S&&h&&!g&&r.a.createElement(o.EuiFlexItem,{"data-test-subj":"has-data-to-push-button",grow:!1},r.a.createElement("span",null,B))))}));Tn.displayName="EditConnector";var An=n(65),Fn=n(71),Ln=n(53);const Nn=({status:e,onStatusChanged:t,isLoading:n})=>{const i=Object(a.useMemo)((()=>c.caseStatuses.findIndex((t=>t===e))),[e]),s=Object(a.useMemo)((()=>(i+1)%c.caseStatuses.length),[i]),l=Object(a.useCallback)((()=>{t(c.caseStatuses[s])}),[s,t]);return r.a.createElement(o.EuiButton,{"data-test-subj":"case-view-status-action-button",iconType:Ln.b[c.caseStatuses[s]].icon,isLoading:n,onClick:l},Ln.b[c.caseStatuses[s]].button.label)},Dn=Object(a.memo)(Nn);var Mn=n(83),Rn=n(79),Bn=n(23);const zn=({allCasesNavigation:e,caseId:t})=>r.a.createElement(o.EuiEmptyPrompt,{iconColor:"default",iconType:"addDataApp",title:r.a.createElement("h2",null,re),titleSize:"xs",body:r.a.createElement("p",null,ie(t)),actions:r.a.createElement(o.EuiButton,{onClick:e.onClick,size:"s",color:"primary",fill:!0},se)}),_n=s()(o.EuiFlexGroup).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-bqd51x-0"})(["height:100%;"]),Vn=r.a.memo((({allCasesNavigation:e,caseData:t,caseDetailsNavigation:n,caseId:i,configureCasesNavigation:s,getCaseDetailHrefWithCommentId:m,fetchCase:p,onCaseDataSuccess:f,onComponentInitialized:g,actionsNavigation:b,ruleDetailsNavigation:E,showAlertDetails:h,subCaseId:v,updateCase:x,useFetchAlertData:I,userCanCrud:j,refreshRef:w,hideSyncAlerts:O=!1})=>{var k;const[S,T]=Object(a.useState)(!0),A=Object(a.useRef)(!0),M=null===(k=Object(Rn.a)())||void 0===k?void 0:k.ui,{caseUserActions:R,fetchCaseUserActions:B,caseServices:z,hasDataToPush:_,isLoading:V,participants:U}=((e,t,n)=>{const[r,i]=Object(a.useState)(tn),s=Object(a.useRef)(new AbortController),o=Object(a.useRef)(!1),c=Object(N.f)(),l=Object(a.useCallback)((async(e,t,n)=>{try{o.current=!1,s.current.abort(),s.current=new AbortController,i({...r,isLoading:!0});const a=await(n?Object(D.i)(e,n,s.current.signal):Object(D.d)(e,s.current.signal));if(!o.current){const e=Object(y.isEmpty)(a)?[]:Object(y.uniqBy)("actionBy.username",a).map((e=>e.actionBy)),r=Object(y.isEmpty)(a)?[]:n?a:a.slice(1);i({caseUserActions:r,...an(r,t),isLoading:!1,isError:!1,participants:e})}}catch(e){o.current||("AbortError"!==e.name&&c.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:L.d}),i({caseServices:{},caseUserActions:[],hasDataToPush:!1,isError:!0,isLoading:!1,participants:[]}))}}),[r]);return Object(a.useEffect)((()=>(Object(y.isEmpty)(e)||l(e,t,n),()=>{o.current=!0,s.current.abort()})),[e,n]),{...r,fetchCaseUserActions:l}})(i,t.connector.id,v),{isLoading:$,updateKey:P,updateCaseProperty:H}=(({caseId:e,subCaseId:t})=>{const[n,r]=Object(a.useReducer)(Vt,{isLoading:!1,isError:!1,updateKey:null}),i=Object(N.f)(),s=Object(a.useRef)(!1),o=Object(a.useRef)(new AbortController),c=Object(a.useCallback)((async({fetchCaseUserActions:n,updateKey:a,updateValue:c,updateCase:l,caseData:u,onSuccess:d,onError:m})=>{try{s.current=!1,o.current.abort(),o.current=new AbortController,r({type:"FETCH_INIT",payload:a});const m=await("status"===a&&t?Object(D.n)(e,t,{status:c},u.version,o.current.signal):Object(D.k)(e,{[a]:c},u.version,o.current.signal));s.current||(null!=n&&n(e,m[0].connector.id,t),null!=l&&l(m[0]),r({type:"FETCH_SUCCESS"}),i.addSuccess(Object(_t.d)(u,m[0],a,c)),d&&d())}catch(e){s.current||("AbortError"!==e.name&&i.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:L.d}),r({type:"FETCH_FAILURE"}),m&&m())}}),[e,t]);return Object(a.useEffect)((()=>()=>{s.current=!0,o.current.abort()}),[]),{...n,updateCaseProperty:c}})({caseId:i,subCaseId:v});Object(a.useEffect)((()=>{let e=!1;if(w)return w.current={refreshCase:async()=>{e||await p()},refreshUserActionsAndComments:async()=>{e||V||await Promise.all([p(!0),B(i,t.connector.id,v)])}},()=>{e=!0,w.current=null}}),[t.connector.id,i,p,B,V,w,v,x]);const G=Object(a.useCallback)((({key:e,value:n,onSuccess:a,onError:r})=>{const i=e=>x({...e,comments:t.comments});switch(e){case"title":const e=Object(_t.m)(n);e.length>0&&H({fetchCaseUserActions:B,updateKey:"title",updateValue:e,updateCase:i,caseData:t,onSuccess:a,onError:r});break;case"connector":const s=Object(_t.m)(n);null!=s&&H({fetchCaseUserActions:B,updateKey:"connector",updateValue:s,updateCase:i,caseData:t,onSuccess:a,onError:r});break;case"description":const o=Object(_t.m)(n);o.length>0&&H({fetchCaseUserActions:B,updateKey:"description",updateValue:o,updateCase:i,caseData:t,onSuccess:a,onError:r});break;case"tags":const c=Object(_t.m)(n);H({fetchCaseUserActions:B,updateKey:"tags",updateValue:c,updateCase:i,caseData:t,onSuccess:a,onError:r});break;case"status":const l=Object(_t.m)(n);t.status!==n&&H({fetchCaseUserActions:B,updateKey:"status",updateValue:l,updateCase:i,caseData:t,onSuccess:a,onError:r});break;case"settings":const u=Object(_t.m)(n);t.settings!==n&&H({fetchCaseUserActions:B,updateKey:"settings",updateValue:u,updateCase:i,caseData:t,onSuccess:a,onError:r});break;default:return null}}),[B,H,x,t]),W=Object(a.useCallback)((e=>{x(e),B(i,e.connector.id,v)}),[x,B,i,v]),{loading:q,connectors:K,permissionsError:X}=Object(An.a)({toastPermissionsErrors:!1}),[Q,Y]=Object(a.useMemo)((()=>{var e;const n=K.find((e=>e.id===t.connector.id));return[null!==(e=null==n?void 0:n.name)&&void 0!==e?e:"",!!n]}),[K,t.connector]),J=Object(a.useMemo)((()=>null!=z&&null!=z[t.connector.id]?z[t.connector.id]:null),[z,t.connector]),Z=Object(a.useCallback)(((e,t,n,a)=>{const r=Object(un.a)(e,K),i=r?Object(Fn.b)(r):Object(Fn.a)();G({key:"connector",value:{...i,fields:t},onSuccess:a,onError:n})}),[G,K]),ee=Object(a.useCallback)((e=>G({key:"tags",value:e})),[G]),te=Object(a.useCallback)((e=>G({key:"title",value:e,onSuccess:()=>{f&&f({...t,title:e})}})),[t,G,f]),ne=Object(a.useCallback)((e=>G({key:"status",value:e})),[G]),ae=Object(a.useCallback)((()=>{B(i,t.connector.id,v),p()}),[t.connector.id,i,p,B,v]),re=Object(a.useMemo)((()=>{return{subject:(a=t.title,u.i18n.translate("xpack.cases.caseView.emailSubject",{values:{caseTitle:a},defaultMessage:"Security Case - {caseTitle}"})),body:(e=n.href,u.i18n.translate("xpack.cases.caseView.emailBody",{values:{caseUrl:e},defaultMessage:"Case reference: {caseUrl}"}))};var e,a}),[n.href,t.title]);Object(a.useEffect)((()=>{S&&!V&&T(!1)}),[S,V]);const ie=Object(a.useMemo)((()=>({href:e.href,text:d.e,dataTestSubj:"backToCases",onClick:e.onClick})),[e]),se=Object(a.useCallback)(((e,t)=>{h&&h(e,t)}),[h]);return Object(a.useEffect)((()=>{A.current&&(A.current=!1,g&&g())}),[g]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Ut.b,null,r.a.createElement(l.a,{backOptions:ie,"data-test-subj":"case-view-title",titleNode:r.a.createElement(C,{userCanCrud:j,isLoading:$&&"title"===P,title:t.title,onSubmit:te}),title:t.title},r.a.createElement(Jt,{allCasesNavigation:e,caseData:t,currentExternalIncident:J,userCanCrud:j,disableAlerting:null==E||O,isLoading:$&&("status"===P||"settings"===P),onRefresh:ae,onUpdateField:G}))),r.a.createElement(Ut.d,null,r.a.createElement(Ut.a,null,r.a.createElement(o.EuiFlexGroup,null,r.a.createElement(o.EuiFlexItem,{grow:6},S&&r.a.createElement(o.EuiLoadingContent,{lines:8,"data-test-subj":"case-view-loading-content"}),!S&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Mt,{getCaseDetailHrefWithCommentId:m,getRuleDetailsHref:null==E?void 0:E.href,onRuleDetailsClick:null==E?void 0:E.onClick,caseServices:z,caseUserActions:R,connectors:K,data:t,actionsNavigation:b,fetchUserActions:B.bind(null,i,t.connector.id,v),isLoadingDescription:$&&"description"===P,isLoadingUserActions:V,onShowAlertDetails:se,onUpdateField:G,renderInvestigateInTimelineActionComponent:null==M?void 0:M.renderInvestigateInTimelineActionComponent,statusActionButton:t.type!==c.CaseType.collection&&j?r.a.createElement(Dn,{status:t.status,onStatusChanged:ne,isLoading:$&&"status"===P}):null,updateCase:x,useFetchAlertData:I,userCanCrud:j}))),r.a.createElement(o.EuiFlexItem,{grow:2},r.a.createElement(zt,{"data-test-subj":"case-view-user-list-reporter",email:re,headline:d.K,users:[t.createdBy]}),r.a.createElement(zt,{"data-test-subj":"case-view-user-list-participants",email:re,headline:d.I,loading:V,users:U}),r.a.createElement(F,{"data-test-subj":"case-view-tag-list",userCanCrud:j,tags:t.tags,onSubmit:ee,isLoading:$&&"tags"===P}),r.a.createElement(Tn,{caseData:t,caseServices:z,configureCasesNavigation:s,connectorName:Q,connectors:K,hasDataToPush:_&&j,hideConnectorServiceNowSir:null!=v||t.type===c.CaseType.collection,isLoading:q||$&&"connector"===P,isValidConnector:!!q||Y,onSubmit:Z,permissionsError:X,updateCase:W,userActions:R,userCanCrud:j}))))),null!=M&&M.renderTimelineDetailsPanel?M.renderTimelineDetailsPanel():null)})),Un=()=>r.a.createElement(_n,{gutterSize:"none",justifyContent:"center",alignItems:"center"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":"case-view-loading",size:"xl"}))),$n=r.a.memo((({allCasesNavigation:e,caseDetailsNavigation:t,caseId:n,configureCasesNavigation:i,getCaseDetailHrefWithCommentId:s,onCaseDataSuccess:o,onComponentInitialized:c,actionsNavigation:l,ruleDetailsNavigation:u,showAlertDetails:d,subCaseId:m,timelineIntegration:p,useFetchAlertData:f,userCanCrud:g,refreshRef:b,hideSyncAlerts:E})=>{const{data:h,resolveOutcome:C,resolveAliasId:y,isLoading:v,isError:x,fetchCase:I,updateCase:j}=((e,t)=>{const[n,r]=Object(a.useReducer)(M,{isLoading:!1,isError:!1,data:null,resolveOutcome:null}),i=Object(N.f)(),s=Object(a.useRef)(!1),o=Object(a.useRef)(new AbortController),c=Object(a.useCallback)((e=>{r({type:"UPDATE_CASE",payload:e})}),[]),l=Object(a.useCallback)((async(n=!1)=>{try{s.current=!1,o.current.abort(),o.current=new AbortController,r({type:"FETCH_INIT",payload:{silent:n}});const a=t?{case:await Object(D.h)(e,t,!0,o.current.signal),outcome:"exactMatch"}:await Object(D.r)(e,!0,o.current.signal);s.current||r({type:"FETCH_SUCCESS",payload:a})}catch(e){s.current||("AbortError"!==e.name&&i.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:L.d}),r({type:"FETCH_FAILURE"}))}}),[e,t,i]);return Object(a.useEffect)((()=>(l(),()=>{s.current=!0,o.current.abort()})),[e,t]),{...n,fetchCase:l,updateCase:c}})(n,m),{spaces:w,http:O}=Object(N.d)().services;Object(a.useEffect)((()=>{o&&h&&o(h)}),[h,o]),Object(a.useEffect)((()=>{if(w&&"aliasMatch"===C&&null!=y){const e=O.basePath.prepend(`cases/${y}${window.location.search}${window.location.hash}`);w.ui.redirectLegacyUrl(e,Z)}}),[C,y,w,O]);const k=Object(a.useCallback)((()=>{if(h&&w&&"conflict"===C&&null!=y){const e=y,t=O.basePath.prepend(`cases/${e}${window.location.search}${window.location.hash}`);return w.ui.components.getLegacyUrlConflict({objectNoun:Z,currentObjectId:h.id,otherObjectId:e,otherObjectPath:t})}return null}),[h,y,C,w,O.basePath]);return x?r.a.createElement(zn,{allCasesNavigation:e,caseId:n}):v?r.a.createElement(Un,null):h&&r.a.createElement(Mn.b,{timelineIntegration:p},r.a.createElement(Bn.b,{owner:[h.owner]},k(),r.a.createElement(Vn,{allCasesNavigation:e,caseData:h,caseDetailsNavigation:t,caseId:n,configureCasesNavigation:i,getCaseDetailHrefWithCommentId:s,fetchCase:I,onCaseDataSuccess:o,onComponentInitialized:c,actionsNavigation:l,ruleDetailsNavigation:u,showAlertDetails:d,subCaseId:m,updateCase:j,useFetchAlertData:f,userCanCrud:g,refreshRef:b,hideSyncAlerts:E})))}));Vn.displayName="CaseComponent",Un.displayName="CaseViewLoading",$n.displayName="CaseView"}])]);