(window.savedObjectsManagement_bundle_jsonpfunction=window.savedObjectsManagement_bundle_jsonpfunction||[]).push([[1],Array(20).concat([function(e,t,s){"use strict";var a,n=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},o=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}(),i=[];function r(e){for(var t=-1,s=0;s<i.length;s++)if(i[s].identifier===e){t=s;break}return t}function l(e,t){for(var s={},a=[],n=0;n<e.length;n++){var o=e[n],l=t.base?o[0]+t.base:o[0],c=s[l]||0,d="".concat(l," ").concat(c);s[l]=c+1;var u=r(d),p={css:o[1],media:o[2],sourceMap:o[3]};-1!==u?(i[u].references++,i[u].updater(p)):i.push({identifier:d,updater:g(p,t),references:1}),a.push(d)}return a}function c(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var n=s.nc;n&&(a.nonce=n)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var i=o(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var d,u=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function p(e,t,s,a){var n=s?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=u(t,n);else{var o=document.createTextNode(n),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(o,i[t]):e.appendChild(o)}}function b(e,t,s){var a=s.css,n=s.media,o=s.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var j=null,m=0;function g(e,t){var s,a,n;if(t.singleton){var o=m++;s=j||(j=c(t)),a=p.bind(null,s,o,!1),n=p.bind(null,s,o,!0)}else s=c(t),a=b.bind(null,s,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var s=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<s.length;a++){var n=r(s[a]);i[n].references--}for(var o=l(e,t),c=0;c<s.length;c++){var d=r(s[c]);0===i[d].references&&(i[d].updater(),i.splice(d,1))}s=o}}}},function(e,t,s){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=function(e,t){var s=e[1]||"",a=e[3];if(!a)return s;if(t&&"function"==typeof btoa){var n=(i=a,r=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(l," */")),o=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[s].concat(o).concat([n]).join("\n")}var i,r,l;return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,a){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(a)for(var o=0;o<this.length;o++){var i=this[o][0];null!=i&&(n[i]=!0)}for(var r=0;r<e.length;r++){var l=[].concat(e[r]);a&&n[l[0]]||(s&&(l[2]?l[2]="".concat(s," and ").concat(l[2]):l[2]=s),t.push(l))}},t}},function(e,t,s){"use strict";const a=s(23),n=s(24),o=s(25);function i(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function r(e,t){return t.encode?t.strict?a(e):encodeURIComponent(e):e}function l(e,t){return t.decode?n(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function d(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function u(e){const t=(e=d(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function b(e,t){i((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const s=function(e){let t;switch(e.arrayFormat){case"index":return(e,s,a)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===a[e]&&(a[e]={}),a[e][t[1]]=s):a[e]=s};case"bracket":return(e,s,a)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==a[e]?a[e]=[].concat(a[e],s):a[e]=[s]:a[e]=s};case"comma":case"separator":return(t,s,a)=>{const n="string"==typeof s&&s.split("").indexOf(e.arrayFormatSeparator)>-1?s.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===s?s:l(s,e);a[t]=n};default:return(e,t,s)=>{void 0!==s[e]?s[e]=[].concat(s[e],t):s[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){let[e,i]=o(t.decode?n.replace(/\+/g," "):n,"=");i=void 0===i?null:["comma","separator"].includes(t.arrayFormat)?i:l(i,t),s(l(e,t),i,a)}for(const e of Object.keys(a)){const s=a[e];if("object"==typeof s&&null!==s)for(const e of Object.keys(s))s[e]=p(s[e],t);else a[e]=p(s,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce(((e,t)=>{const s=a[t];return Boolean(s)&&"object"==typeof s&&!Array.isArray(s)?e[t]=c(s):e[t]=s,e}),Object.create(null))}t.extract=u,t.parse=b,t.stringify=(e,t)=>{if(!e)return"";i((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const s=s=>t.skipNull&&null==e[s]||t.skipEmptyString&&""===e[s],a=function(e){switch(e.arrayFormat){case"index":return t=>(s,a)=>{const n=s.length;return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?s:null===a?[...s,[r(t,e),"[",n,"]"].join("")]:[...s,[r(t,e),"[",r(n,e),"]=",r(a,e)].join("")]};case"bracket":return t=>(s,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?s:null===a?[...s,[r(t,e),"[]"].join("")]:[...s,[r(t,e),"[]=",r(a,e)].join("")];case"comma":case"separator":return t=>(s,a)=>null==a||0===a.length?s:0===s.length?[[r(t,e),"=",r(a,e)].join("")]:[[s,r(a,e)].join(e.arrayFormatSeparator)];default:return t=>(s,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?s:null===a?[...s,r(t,e)]:[...s,[r(t,e),"=",r(a,e)].join("")]}}(t),n={};for(const t of Object.keys(e))s(t)||(n[t]=e[t]);const o=Object.keys(n);return!1!==t.sort&&o.sort(t.sort),o.map((s=>{const n=e[s];return void 0===n?"":null===n?r(s,t):Array.isArray(n)?n.reduce(a(s),[]).join("&"):r(s,t)+"="+r(n,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[s,a]=o(e,"#");return Object.assign({url:s.split("?")[0]||"",query:b(u(e),t)},t&&t.parseFragmentIdentifier&&a?{fragmentIdentifier:l(a,t)}:{})},t.stringifyUrl=(e,s)=>{s=Object.assign({encode:!0,strict:!0},s);const a=d(e.url).split("?")[0]||"",n=t.extract(e.url),o=t.parse(n,{sort:!1}),i=Object.assign(o,e.query);let l=t.stringify(i,s);l&&(l=`?${l}`);let c=function(e){let t="";const s=e.indexOf("#");return-1!==s&&(t=e.slice(s)),t}(e.url);return e.fragmentIdentifier&&(c=`#${r(e.fragmentIdentifier,s)}`),`${a}${l}${c}`}},function(e,t,s){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},function(e,t,s){"use strict";var a="%[a-f0-9]{2}",n=new RegExp(a,"gi"),o=new RegExp("("+a+")+","gi");function i(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var s=e.slice(0,t),a=e.slice(t);return Array.prototype.concat.call([],i(s),i(a))}function r(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(n),s=1;s<t.length;s++)t=(e=i(t,s).join("")).match(n);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},s=o.exec(e);s;){try{t[s[0]]=decodeURIComponent(s[0])}catch(e){var a=r(s[0]);a!==s[0]&&(t[s[0]]=a)}s=o.exec(e)}t["%C2"]="�";for(var n=Object.keys(t),i=0;i<n.length;i++){var l=n[i];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},function(e,t,s){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const s=e.indexOf(t);return-1===s?[e]:[e.slice(0,s),e.slice(s+t.length)]}},function(e,t,s){var a,n=n||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,s=function(){return e.URL||e.webkitURL||e},a=t.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in a,o=e.webkitRequestFileSystem,i=e.requestFileSystem||o||e.mozRequestFileSystem,r=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},l="application/octet-stream",c=0,d=function(t){var a=function(){"string"==typeof t?s().revokeObjectURL(t):t.remove()};e.chrome?a():setTimeout(a,500)},u=function(e,t,s){for(var a=(t=[].concat(t)).length;a--;){var n=e["on"+t[a]];if("function"==typeof n)try{n.call(e,s||e)}catch(e){r(e)}}},p=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},b=function(t,r,b){b||(t=p(t));var j,m,g,h=this,f=t.type,O=!1,v=function(){u(h,"writestart progress write writeend".split(" "))},x=function(){(!O&&j||(j=s().createObjectURL(t)),m)?m.location.href=j:null==e.open(j,"_blank")&&"undefined"!=typeof safari&&(e.location.href=j);h.readyState=h.DONE,v(),d(j)},y=function(e){return function(){if(h.readyState!==h.DONE)return e.apply(this,arguments)}},M={create:!0,exclusive:!1};if(h.readyState=h.INIT,r||(r="download"),n)return j=s().createObjectURL(t),a.href=j,a.download=r,void setTimeout((function(){var e,t;e=a,t=new MouseEvent("click"),e.dispatchEvent(t),v(),d(j),h.readyState=h.DONE}));e.chrome&&f&&f!==l&&(g=t.slice||t.webkitSlice,t=g.call(t,0,t.size,l),O=!0),o&&"download"!==r&&(r+=".download"),(f===l||o)&&(m=e),i?(c+=t.size,i(e.TEMPORARY,c,y((function(e){e.root.getDirectory("saved",M,y((function(e){var s=function(){e.getFile(r,M,y((function(e){e.createWriter(y((function(s){s.onwriteend=function(t){m.location.href=e.toURL(),h.readyState=h.DONE,u(h,"writeend",t),d(e)},s.onerror=function(){var e=s.error;e.code!==e.ABORT_ERR&&x()},"writestart progress write abort".split(" ").forEach((function(e){s["on"+e]=h["on"+e]})),s.write(t),h.abort=function(){s.abort(),h.readyState=h.DONE},h.readyState=h.WRITING})),x)})),x)};e.getFile(r,{create:!1},y((function(e){e.remove(),s()})),y((function(e){e.code===e.NOT_FOUND_ERR?s():x()})))})),x)})),x)):x()},j=b.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,s){return s||(e=p(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(j.abort=function(){var e=this;e.readyState=e.DONE,u(e,"abort")},j.readyState=j.INIT=0,j.WRITING=1,j.DONE=2,j.error=j.onwritestart=j.onprogress=j.onwrite=j.onabort=j.onerror=j.onwriteend=null,function(e,t,s){return new b(e,t,s)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */e.exports?e.exports.saveAs=n:null!==s(27)&&null!=s(28)&&(void 0===(a=function(){return n}.apply(t,[]))||(e.exports=a))},function(e,t,s){e.exports=s(9)(1268)},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,s){switch(window.__kbnThemeTag__){case"v7dark":return s(30);case"v7light":return s(32);case"v8dark":return s(34);case"v8light":return s(36)}},function(e,t,s){var a=s(20),n=s(31);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};a(n,o);e.exports=n.locals||{}},function(e,t,s){(t=s(21)(!1)).push([e.i,".savedObjectsManagementImportSummary__row{margin-bottom:4px}.savedObjectsManagementImportSummary__title{min-width:0}.savedObjectsManagementImportSummary__createdCount{color:#7DE2D1}.savedObjectsManagementImportSummary__errorCount{color:#F66}.savedObjectsManagementImportSummary__icon{margin-left:4px}\n",""]),e.exports=t},function(e,t,s){var a=s(20),n=s(33);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};a(n,o);e.exports=n.locals||{}},function(e,t,s){(t=s(21)(!1)).push([e.i,".savedObjectsManagementImportSummary__row{margin-bottom:4px}.savedObjectsManagementImportSummary__title{min-width:0}.savedObjectsManagementImportSummary__createdCount{color:#017D73}.savedObjectsManagementImportSummary__errorCount{color:#BD271E}.savedObjectsManagementImportSummary__icon{margin-left:4px}\n",""]),e.exports=t},function(e,t,s){var a=s(20),n=s(35);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};a(n,o);e.exports=n.locals||{}},function(e,t,s){(t=s(21)(!1)).push([e.i,".savedObjectsManagementImportSummary__row{margin-bottom:4px}.savedObjectsManagementImportSummary__title{min-width:0}.savedObjectsManagementImportSummary__createdCount{color:#7DDED8}.savedObjectsManagementImportSummary__errorCount{color:#F86B63}.savedObjectsManagementImportSummary__icon{margin-left:4px}\n",""]),e.exports=t},function(e,t,s){var a=s(20),n=s(37);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};a(n,o);e.exports=n.locals||{}},function(e,t,s){(t=s(21)(!1)).push([e.i,".savedObjectsManagementImportSummary__row{margin-bottom:4px}.savedObjectsManagementImportSummary__title{min-width:0}.savedObjectsManagementImportSummary__createdCount{color:#007e77}.savedObjectsManagementImportSummary__errorCount{color:#BD271E}.savedObjectsManagementImportSummary__icon{margin-left:4px}\n",""]),e.exports=t},function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return q}));var a=s(6),n=s.n(a),o=s(15),i=s(2),r=s.n(i),l=s(13),c=s(22),d=s(1),u=s(0),p=s.n(u),b=s(26),j=s(16),m=s(7),g=s(14),h=s(3);const f=({onExportAll:e,onImport:t,onRefresh:s,filteredCount:a})=>Object(h.jsx)(l.EuiPageHeader,{pageTitle:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.header.savedObjectsTitle",defaultMessage:"Saved Objects"}),description:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.howToDeleteSavedObjectsDescription",defaultMessage:"Manage and share your saved objects. To edit the underlying data of an object, go to its associated application."}),bottomBorder:!0,rightSideItems:[Object(h.jsx)(l.EuiButtonEmpty,{size:"s",iconType:"exportAction","data-test-subj":"exportAllObjects",onClick:e},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.header.exportButtonLabel",defaultMessage:"Export {filteredCount, plural, one{# object} other {# objects}}",values:{filteredCount:a}})),Object(h.jsx)(l.EuiButtonEmpty,{size:"s",iconType:"importAction","data-test-subj":"importObjects",onClick:t},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.header.importButtonLabel",defaultMessage:"Import"})),Object(h.jsx)(l.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:s},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.header.refreshButtonLabel",defaultMessage:"Refresh"}))]}),O=1e4;class table_Table extends a.PureComponent{constructor(e){super(e),p()(this,"state",{isSearchTextValid:!0,parseErrorMessage:null,isExportPopoverOpen:!1,isIncludeReferencesDeepChecked:!0,activeAction:void 0}),p()(this,"onChange",(({query:e,error:t})=>{t?this.setState({isSearchTextValid:!1,parseErrorMessage:t.message}):(this.setState({isSearchTextValid:!0,parseErrorMessage:null}),this.props.onQueryChange({query:e}))})),p()(this,"closeExportPopover",(()=>{this.setState({isExportPopoverOpen:!1})})),p()(this,"toggleExportPopoverVisibility",(()=>{this.setState((e=>({isExportPopoverOpen:!e.isExportPopoverOpen})))})),p()(this,"toggleIsIncludeReferencesDeepChecked",(()=>{this.setState((e=>({isIncludeReferencesDeepChecked:!e.isIncludeReferencesDeepChecked})))})),p()(this,"onExportClick",(()=>{const{onExport:e}=this.props,{isIncludeReferencesDeepChecked:t}=this.state;e(t),this.setState({isExportPopoverOpen:!1})}))}render(){var e,t;const{pageIndex:s,pageSize:o,itemId:i,items:r,totalItemCount:c,isSearching:u,filterOptions:p,selectionConfig:b,capabilities:j,onDelete:f,onActionRefresh:v,selectedSavedObjects:x,onTableChange:y,goInspectObject:M,onShowRelationships:T,basePath:S,actionRegistry:C,columnRegistry:w,taggingApi:E,allowedTypes:I}=this.props,F={pageIndex:s,pageSize:o,totalItemCount:Math.min(c,O),pageSizeOptions:[5,10,20,50]},R=[{type:"field_value_selection",field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.table.typeFilterName",{defaultMessage:"Type"}),multiSelect:"or",options:p},...E?[E.ui.getSearchBarFilter({useName:!0})]:[]],D=[{field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnTypeName",{defaultMessage:"Type"}),width:"50px",align:"center",description:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnTypeDescription",{defaultMessage:"Type of the saved object"}),sortable:!1,"data-test-subj":"savedObjectsTableRowType",render:(e,t)=>{const s=Object(m.getSavedObjectLabel)(e,I);return Object(h.jsx)(l.EuiToolTip,{position:"top",content:s},Object(h.jsx)(l.EuiIcon,{"aria-label":s,type:t.meta.icon||"apps",size:"s","data-test-subj":"objectType"}))}},{field:"meta.title",name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnTitleName",{defaultMessage:"Title"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnTitleDescription",{defaultMessage:"Title of the saved object"}),dataType:"string",sortable:!1,"data-test-subj":"savedObjectsTableRowTitle",render:(e,t)=>{const{path:s=""}=t.meta.inAppUrl||{};return this.props.canGoInApp(t)?Object(h.jsx)(l.EuiLink,{href:S.prepend(s)},e||Object(m.getDefaultTitle)(t)):Object(h.jsx)(l.EuiText,{size:"s"},e||Object(m.getDefaultTitle)(t))}},...E?[E.ui.getTableColumnDefinition()]:[],...w.getAll().map((e=>({...e.euiColumn,sortable:!1,"data-test-subj":`savedObjectsTableColumn-${e.id}`}))),{name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActionsName",{defaultMessage:"Actions"}),width:"80px",actions:[{name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActions.inspectActionName",{defaultMessage:"Inspect"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActions.inspectActionDescription",{defaultMessage:"Inspect this saved object"}),type:"icon",icon:"inspect",onClick:e=>M(e),available:e=>!!e.meta.editUrl,"data-test-subj":"savedObjectsTableAction-inspect"},{name:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActions.viewRelationshipsActionName",{defaultMessage:"Relationships"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.table.columnActions.viewRelationshipsActionDescription",{defaultMessage:"View the relationships this saved object has to other saved objects"}),type:"icon",icon:"kqlSelector",onClick:e=>T(e),"data-test-subj":"savedObjectsTableAction-relationships"},...C.getAll().map((e=>(e.setActionContext({capabilities:j}),{...e.euiAction,"data-test-subj":`savedObjectsTableAction-${e.id}`,onClick:t=>{this.setState({activeAction:e}),e.registerOnFinishCallback((()=>{this.setState({activeAction:void 0});const{refreshOnFinish:t=(()=>[])}=e,s=t();v(s)})),e.euiAction.onClick&&e.euiAction.onClick(t)}})))]}];let A;if(!this.state.isSearchTextValid){const e=d.i18n.translate("savedObjectsManagement.objectsTable.searchBar.unableToParseQueryErrorMessage",{defaultMessage:"Unable to parse query"});A=Object(h.jsx)(l.EuiFormErrorText,null,`${e}. ${this.state.parseErrorMessage}`)}const _=Object(h.jsx)(l.EuiButton,{iconType:"arrowDown",iconSide:"right",onClick:this.toggleExportPopoverVisibility,isDisabled:0===x.length},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.table.exportPopoverButtonLabel",defaultMessage:"Export"})),k=null!==(e=null===(t=this.state.activeAction)||void 0===t?void 0:t.render())&&void 0!==e?e:null,P=c>O;return Object(h.jsx)(a.Fragment,null,k,Object(h.jsx)(l.EuiSearchBar,{box:{"data-test-subj":"savedObjectSearchBar"},filters:R,onChange:this.onChange,defaultQuery:this.props.initialQuery,toolsRight:[Object(h.jsx)(l.EuiButton,{key:"deleteSO",iconType:"trash",color:"danger",onClick:f,isDisabled:0===x.length||!j.savedObjectsManagement.delete,title:j.savedObjectsManagement.delete?void 0:d.i18n.translate("savedObjectsManagement.objectsTable.table.deleteButtonTitle",{defaultMessage:"Unable to delete saved objects"}),"data-test-subj":"savedObjectsManagementDelete"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.table.deleteButtonLabel",defaultMessage:"Delete"})),Object(h.jsx)(l.EuiPopover,{key:"exportSOOptions",button:_,isOpen:this.state.isExportPopoverOpen,closePopover:this.closeExportPopover},Object(h.jsx)(l.EuiFormRow,{label:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.exportOptionsLabel",defaultMessage:"Options"})},Object(h.jsx)(l.EuiSwitch,{name:"includeReferencesDeep",label:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.includeReferencesDeepLabel",defaultMessage:"Include related objects"}),checked:this.state.isIncludeReferencesDeepChecked,onChange:this.toggleIsIncludeReferencesDeepChecked})),Object(h.jsx)(l.EuiFormRow,null,Object(h.jsx)(l.EuiButton,{key:"exportSO",iconType:"exportAction",onClick:this.onExportClick,fill:!0},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.table.exportButtonLabel",defaultMessage:"Export"}))))]}),A,Object(h.jsx)(l.EuiSpacer,{size:"s"}),P&&Object(h.jsx)(n.a.Fragment,null,Object(h.jsx)(l.EuiText,{color:"subdued",size:"s","data-test-subj":"savedObjectsTableTooManyResultsLabel"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.table.tooManyResultsLabel",defaultMessage:"Showing {limit} of {totalItemCount, plural, one {# object} other {# objects}}",values:{totalItemCount:c,limit:O}})),Object(h.jsx)(l.EuiSpacer,{size:"s"})),Object(h.jsx)("div",{"data-test-subj":"savedObjectsTable"},Object(h.jsx)(l.EuiBasicTable,{loading:u,itemId:i,items:r,columns:D,pagination:F,selection:b,onChange:y,rowProps:e=>({"data-test-subj":`savedObjectsTableRow row-${e.id}`})})))}}var v=s(4),x=s(19),y=s.n(x);const M=({conflict:e,onFinish:t})=>{const{obj:s,error:n}=e;let o,i=null;o="conflict"===n.type?n.destinationId:n.destinations[0].id;const[r,c]=Object(a.useState)(o);if("ambiguous_conflict"===n.type){const e={options:n.destinations.map((e=>{var t;const s=null!==(t=e.title)&&void 0!==t?t:`${u} [id=${e.id}]`,n=e.updatedAt?y()(e.updatedAt).fromNow():"never",o=`ID: ${e.id}`,i=`Last updated: ${n}`;return{value:e.id,inputDisplay:e.id,dropdownDisplay:Object(h.jsx)(a.Fragment,null,Object(h.jsx)("strong",null,s),Object(h.jsx)(l.EuiText,{size:"s",color:"subdued"},Object(h.jsx)("p",{className:"euiTextColor--subdued"},o,Object(h.jsx)("br",null),i)))}})),onChange:e=>{c(e)}};i=Object(h.jsx)(l.EuiSuperSelect,{options:e.options,valueOfSelected:r,onChange:e.onChange,prepend:d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.selectControlLabel",{defaultMessage:"Object ID"}),hasDividers:!0,fullWidth:!0,compressed:!0})}const{type:u,meta:p}=s,b=p.title||Object(m.getDefaultTitle)(s),j="conflict"===n.type?d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.body.conflict",{defaultMessage:'"{title}" conflicts with an existing object. Overwrite it?',values:{title:b}}):d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.body.ambiguousConflict",{defaultMessage:'"{title}" conflicts with multiple existing objects. Overwrite one?',values:{title:b}});return Object(h.jsx)(l.EuiConfirmModal,{title:d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.title",{defaultMessage:"Overwrite {type}?",values:{type:u}}),cancelButtonText:d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.cancelButtonText",{defaultMessage:"Skip"}),confirmButtonText:d.i18n.translate("savedObjectsManagement.objectsTable.overwriteModal.overwriteButtonText",{defaultMessage:"Overwrite"}),buttonColor:"danger",onCancel:()=>t(!1),onConfirm:()=>t(!0,r),defaultFocusedButton:l.EUI_MODAL_CONFIRM_BUTTON,maxWidth:"500px"},Object(h.jsx)("p",null,j),i)},T={id:"createNewCopiesDisabled",text:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.createNewCopies.disabledTitle",{defaultMessage:"Check for existing objects"}),tooltip:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.createNewCopies.disabledText",{defaultMessage:"Check if objects were previously copied or imported."})},S={id:"createNewCopiesEnabled",text:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.createNewCopies.enabledTitle",{defaultMessage:"Create new objects with random IDs"}),tooltip:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.createNewCopies.enabledText",{defaultMessage:"Use this option to create one or more copies of the object."})},C={id:"overwriteEnabled",label:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.overwrite.enabledLabel",{defaultMessage:"Automatically overwrite conflicts"})},w={id:"overwriteDisabled",label:d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.overwrite.disabledLabel",{defaultMessage:"Request action on conflict"})},E=d.i18n.translate("savedObjectsManagement.objectsTable.importModeControl.importOptionsTitle",{defaultMessage:"Import options"}),I=({text:e,tooltip:t})=>Object(h.jsx)(l.EuiFlexGroup,null,Object(h.jsx)(l.EuiFlexItem,null,Object(h.jsx)(l.EuiText,null,e)),Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiIconTip,{content:t,position:"left",type:"iInCircle"}))),F=({initialValues:e,isLegacyFile:t,updateSelection:s})=>{const[n,o]=Object(a.useState)(e.createNewCopies),[i,r]=Object(a.useState)(e.overwrite),c=e=>{void 0!==e.createNewCopies?o(e.createNewCopies):void 0!==e.overwrite&&r(e.overwrite),s({createNewCopies:n,overwrite:i,...e})},d=Object(h.jsx)(l.EuiRadioGroup,{options:[C,w],idSelected:i?C.id:w.id,onChange:e=>c({overwrite:e===C.id}),disabled:n&&!t,"data-test-subj":"savedObjectsManagement-importModeControl-overwriteRadioGroup"});return t?d:Object(h.jsx)(l.EuiFormFieldset,{legend:{children:Object(h.jsx)(l.EuiTitle,{size:"xs"},Object(h.jsx)("span",null,E))}},Object(h.jsx)(l.EuiCheckableCard,{id:T.id,label:I(T),checked:!n,onChange:()=>c({createNewCopies:!1})},d),Object(h.jsx)(l.EuiSpacer,{size:"s"}),Object(h.jsx)(l.EuiCheckableCard,{id:S.id,label:I(S),checked:n,onChange:()=>c({createNewCopies:!0})}))};s(29);const R="apps",D=d.i18n.translate("savedObjectsManagement.objectsTable.importSummary.unsupportedTypeError",{defaultMessage:"Unsupported object type"}),A=e=>{const{obj:t}=e,{type:s,id:a,meta:n}=t;return{type:s,id:a,title:n.title||Object(m.getDefaultTitle)(t),icon:n.icon||R,outcome:"error",errorMessage:(({error:e})=>"unknown"===e.type?e.message:"unsupported_type"===e.type?D:void 0)(e)}},_=({importItems:e})=>{if(!e.length)return null;const t=e.reduce(((e,{outcome:t})=>{var s;return e.set(t,(null!==(s=e.get(t))&&void 0!==s?s:0)+1)}),new Map),s=t.get("created"),a=t.get("overwritten"),n=t.get("error");return Object(h.jsx)(l.EuiFlexGroup,null,s&&Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiTitle,{size:"xs"},Object(h.jsx)("h4",{className:"savedObjectsManagementImportSummary__createdCount"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.importSummary.createdCountHeader",defaultMessage:"{createdCount} new",values:{createdCount:s}})))),a&&Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiTitle,{size:"xs"},Object(h.jsx)("h4",{className:"savedObjectsManagementImportSummary__overwrittenCount"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.importSummary.overwrittenCountHeader",defaultMessage:"{overwrittenCount} overwritten",values:{overwrittenCount:a}})))),n&&Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiTitle,{size:"xs"},Object(h.jsx)("h4",{"data-test-subj":"importSavedObjectsErrorsCount",className:"savedObjectsManagementImportSummary__errorCount"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.importSummary.errorCountHeader",defaultMessage:"{errorCount} error",values:{errorCount:n}})))))},k=({item:e})=>{const{outcome:t,errorMessage:s="Error"}=e;switch(t){case"created":return Object(h.jsx)(l.EuiIconTip,{type:"checkInCircleFilled",color:"success",content:d.i18n.translate("savedObjectsManagement.importSummary.createdOutcomeLabel",{defaultMessage:"Created"})});case"overwritten":return Object(h.jsx)(l.EuiIconTip,{type:"check",content:d.i18n.translate("savedObjectsManagement.importSummary.overwrittenOutcomeLabel",{defaultMessage:"Overwritten"})});case"error":return Object(h.jsx)(l.EuiIconTip,{type:"alert",color:"danger",content:d.i18n.translate("savedObjectsManagement.importSummary.errorOutcomeLabel",{defaultMessage:"{errorMessage}",values:{errorMessage:s}})})}},P=({warnings:e,basePath:t})=>e.length?Object(h.jsx)(n.a.Fragment,null,Object(h.jsx)(l.EuiSpacer,{size:"m"}),e.map(((s,n)=>Object(h.jsx)(a.Fragment,{key:`warning-${n}`},Object(h.jsx)(N,{warning:s,basePath:t}),n<e.length-1&&Object(h.jsx)(l.EuiSpacer,{size:"s"}))))):null,N=({warning:e,basePath:t})=>{const s=Object(a.useMemo)((()=>"action_required"===e.type?Object(h.jsx)(l.EuiFlexGroup,{alignItems:"flexEnd",justifyContent:"flexEnd",gutterSize:"s"},Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiButton,{size:"s",color:"warning",href:t.prepend(e.actionPath),target:"_blank"},e.buttonLabel||Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.importSummary.warnings.defaultButtonLabel",defaultMessage:"Go"})))):null),[e,t]);return Object(h.jsx)(l.EuiCallOut,{color:"warning",size:"s",iconType:"alert","data-test-subj":"importSavedObjectsWarning",title:e.message},s)},L=({failedImports:e,successfulImports:t,importWarnings:s,basePath:n,allowedTypes:o})=>{const i=Object(a.useMemo)((()=>r.a.sortBy([...e.map((e=>A(e))),...t.map((e=>(e=>{const{type:t,id:s,meta:a,overwrite:n}=e;return{type:t,id:s,title:a.title||Object(m.getDefaultTitle)(e),icon:a.icon||R,outcome:n?"overwritten":"created"}})(e)))],["type","title"])),[t,e]);return Object(h.jsx)(a.Fragment,null,Object(h.jsx)(l.EuiTitle,{size:"s","data-test-subj":i.length?"importSavedObjectsSuccess":"importSavedObjectsSuccessNoneImported"},Object(h.jsx)("h3",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.importSummary.headerLabel",defaultMessage:"{importCount, plural, one {1 object} other {# objects}} imported",values:{importCount:i.length}}))),Object(h.jsx)(l.EuiSpacer,{size:"s"}),Object(h.jsx)(_,{importItems:i}),Object(h.jsx)(P,{warnings:s,basePath:n}),Object(h.jsx)(l.EuiHorizontalRule,null),i.map(((e,t)=>{const{type:s,title:a,icon:n}=e,i=Object(m.getSavedObjectLabel)(s,o);return Object(h.jsx)(l.EuiFlexGroup,{responsive:!1,key:t,alignItems:"center",gutterSize:"s",className:"savedObjectsManagementImportSummary__row"},Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiToolTip,{position:"top",content:i},Object(h.jsx)(l.EuiIcon,{"aria-label":i,type:n,size:"s"}))),Object(h.jsx)(l.EuiFlexItem,{className:"savedObjectsManagementImportSummary__title"},Object(h.jsx)(l.EuiText,{size:"s"},Object(h.jsx)("p",{className:"eui-textTruncate",title:a},a))),Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)("div",{className:"eui-textRight"},Object(h.jsx)(k,{item:e}))))})))},B=e=>{var t,s;const a=null!==(t=e.body)&&void 0!==t&&t.error&&null!==(s=e.body)&&void 0!==s&&s.message?`${e.body.error}: ${e.body.message}`:e.message;return d.i18n.translate("savedObjectsManagement.objectsTable.flyout.importFileErrorMessage",{defaultMessage:'The file could not be processed due to error: "{error}"',values:{error:a}})};class flyout_Flyout extends a.Component{constructor(e){super(e),p()(this,"fetchIndexPatterns",(async()=>{var e;const t=null===(e=await this.props.indexPatterns.getCache())||void 0===e?void 0:e.map((e=>({id:e.id,title:e.attributes.title})));this.setState({indexPatterns:t})})),p()(this,"changeImportMode",(e=>{this.setState((()=>({importMode:e})))})),p()(this,"setImportFile",(e=>{if(!e||!e[0])return void this.setState({file:void 0,isLegacyFile:!1});const t=e[0];this.setState({file:t,isLegacyFile:/\.json$/i.test(t.name)||"application/json"===t.type})})),p()(this,"import",(async()=>{const{http:e}=this.props,{file:t,importMode:s}=this.state;this.setState({status:"loading",error:void 0});try{const a=await Object(m.importFile)(e,t,s);this.setState(Object(m.processImportResponse)(a),(()=>{var e;0===(null===(e=this.state.unmatchedReferences)||void 0===e?void 0:e.length)&&this.resolveImportErrors()}))}catch(e){return void this.setState({status:"error",error:B(e)})}})),p()(this,"getConflictResolutions",(async e=>{const t={};for(const s of e){const[e,a]=await new Promise((e=>{this.setState({conflictingRecord:{conflict:s,done:e}})}));if(e){const{type:e,id:n}=s.obj;t[`${e}:${n}`]={retry:!0,options:{overwrite:!0,...a&&{destinationId:a}}}}this.setState({conflictingRecord:void 0})}return t})),p()(this,"resolveImportErrors",(async()=>{this.setState({error:void 0,status:"loading",loadingMessage:void 0});try{const e=await Object(m.resolveImportErrors)({http:this.props.http,state:this.state,getConflictResolutions:this.getConflictResolutions});this.setState(e)}catch(e){this.setState({status:"error",error:B(e)})}})),p()(this,"legacyImport",(async()=>{const{serviceRegistry:e,indexPatterns:t,overlays:s,http:a,allowedTypes:n}=this.props,{file:o,importMode:i}=this.state;let r;this.setState({status:"loading",error:void 0}),Object(m.logLegacyImport)(a);try{r=await Object(m.importLegacyFile)(o)}catch(e){return void this.setState({status:"error",error:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.importLegacyFileErrorMessage",{defaultMessage:"The file could not be processed."})})}if(!Array.isArray(r))return void this.setState({status:"error",error:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.invalidFormatOfImportedFileErrorMessage",{defaultMessage:"Saved objects file format is invalid and cannot be imported."})});const l=n.map((e=>e.name));r=r.filter((e=>l.includes(e._type))).map((e=>({...e,_migrationVersion:e._migrationVersion||{}})));const{conflictedIndexPatterns:c,conflictedSavedObjectsLinkedToSavedSearches:u,conflictedSearchDocs:p,importedObjectCount:b,failedImports:j}=await Object(v.b)(r,i.overwrite,e.all().map((e=>e.service)),t,s.openConfirm),g={};c.map((({doc:e,obj:t})=>({doc:e,obj:t._serialize()}))).forEach((({doc:e,obj:t})=>t.references.forEach((s=>{g[s.id]=null!=g[s.id]?g[s.id].concat({doc:e,obj:t}):[{doc:e,obj:t}]}))));const h=Object.entries(g).reduce(((e,[t,s])=>(e.push({existingIndexPatternId:t,newIndexPatternId:void 0,list:s.map((({doc:e})=>({id:t,type:e._type,title:e._source.title})))}),e)),[]);this.setState({conflictedIndexPatterns:c,conflictedSavedObjectsLinkedToSavedSearches:u,conflictedSearchDocs:p,failedImports:j,unmatchedReferences:h,importCount:b,status:0===h.length?"success":"idle"})})),p()(this,"confirmLegacyImport",(async()=>{const{conflictedIndexPatterns:e,importMode:t,conflictedSavedObjectsLinkedToSavedSearches:s,conflictedSearchDocs:a,failedImports:n}=this.state,{serviceRegistry:o,indexPatterns:i,search:r}=this.props;this.setState({error:void 0,status:"loading",loadingMessage:void 0});let l=this.state.importCount;if(this.hasUnmatchedReferences)try{const c=this.resolutions;this.setState({loadingMessage:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.confirmLegacyImport.resolvingConflictsLoadingMessage",{defaultMessage:"Resolving conflicts…"})}),c.length&&(l+=await Object(v.a)(c,e,t.overwrite,{indexPatterns:i,search:r})),this.setState({loadingMessage:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.confirmLegacyImport.savingConflictsLoadingMessage",{defaultMessage:"Saving conflicts…"})}),l+=await Object(v.e)(s,t.overwrite),this.setState({loadingMessage:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.confirmLegacyImport.savedSearchAreLinkedProperlyLoadingMessage",{defaultMessage:"Ensure saved searches are linked properly…"})}),l+=await Object(v.c)(a,o.all().map((e=>e.service)),i,t.overwrite),this.setState({loadingMessage:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.confirmLegacyImport.retryingFailedObjectsLoadingMessage",{defaultMessage:"Retrying failed objects…"})}),l+=await Object(v.e)(n.map((({obj:e})=>e)),t.overwrite)}catch(e){return void this.setState({status:"error",error:B(e),loadingMessage:void 0})}this.setState({status:"success",importCount:l})})),p()(this,"onIndexChanged",((e,t)=>{const s=t.target.value;this.setState((t=>{var a;const n=null===(a=t.unmatchedReferences)||void 0===a?void 0:a.findIndex((t=>t.existingIndexPatternId===e));return void 0===n||-1===n?t:{unmatchedReferences:[...t.unmatchedReferences.slice(0,n),{...t.unmatchedReferences[n],newIndexPatternId:s},...t.unmatchedReferences.slice(n+1)]}}))})),this.state={conflictedIndexPatterns:void 0,conflictedSavedObjectsLinkedToSavedSearches:void 0,conflictedSearchDocs:void 0,unmatchedReferences:void 0,unmatchedReferencesTablePagination:{pageIndex:0,pageSize:5},conflictingRecord:void 0,error:void 0,file:void 0,importCount:0,indexPatterns:void 0,importMode:{createNewCopies:false,overwrite:true},loadingMessage:void 0,isLegacyFile:!1,status:"idle"}}componentDidMount(){this.fetchIndexPatterns()}get hasUnmatchedReferences(){return this.state.unmatchedReferences&&this.state.unmatchedReferences.length>0}get resolutions(){return this.state.unmatchedReferences.reduce(((e,{existingIndexPatternId:t,newIndexPatternId:s})=>(s&&e.push({oldId:t,newId:s}),e)),[])}renderUnmatchedReferences(){const{unmatchedReferences:e,unmatchedReferencesTablePagination:t}=this.state;if(!e)return null;const s=[{field:"existingIndexPatternId",name:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnIdName",{defaultMessage:"ID"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnIdDescription",{defaultMessage:"ID of the index pattern"}),sortable:!0},{field:"list",name:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnCountName",{defaultMessage:"Count"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnCountDescription",{defaultMessage:"How many affected objects"}),render:e=>Object(h.jsx)(a.Fragment,null,e.length)},{field:"list",name:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnSampleOfAffectedObjectsName",{defaultMessage:"Sample of affected objects"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnSampleOfAffectedObjectsDescription",{defaultMessage:"Sample of affected objects"}),render:e=>Object(h.jsx)("ul",{style:{listStyle:"none"}},Object(i.take)(e,3).map(((e,t)=>Object(h.jsx)("li",{key:t},e.title))))},{field:"existingIndexPatternId",name:d.i18n.translate("savedObjectsManagement.objectsTable.flyout.renderConflicts.columnNewIndexPatternName",{defaultMessage:"New index pattern"}),render:t=>{var s,a;const n=[{text:"-- Skip Import --",value:""},...this.state.indexPatterns.map((e=>({text:e.title,value:e.id,"data-test-subj":`indexPatternOption-${e.title}`})))],o=null!==(s=null==e||null===(a=e.find((e=>e.existingIndexPatternId===t)))||void 0===a?void 0:a.newIndexPatternId)&&void 0!==s?s:"";return Object(h.jsx)(l.EuiSelect,{value:o,"data-test-subj":`managementChangeIndexSelection-${t}`,onChange:e=>this.onIndexChanged(t,e),options:n})}}],n={...t,pageSizeOptions:[5,10,25]};return Object(h.jsx)(l.EuiInMemoryTable,{items:e,columns:s,pagination:n,onTableChange:({page:e})=>{e&&this.setState({unmatchedReferencesTablePagination:{pageSize:e.size,pageIndex:e.index}})}})}renderError(){const{error:e,status:t}=this.state;return"error"!==t?null:Object(h.jsx)(a.Fragment,null,Object(h.jsx)(l.EuiCallOut,{title:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.errorCalloutTitle",defaultMessage:"Sorry, there was an error"}),color:"danger"},Object(h.jsx)("p",{"data-test-subj":"importSavedObjectsErrorText"},e)),Object(h.jsx)(l.EuiSpacer,{size:"s"}))}renderBody(){const{allowedTypes:e}=this.props,{status:t,loadingMessage:s,importCount:a,failedImports:n=[],successfulImports:o=[],isLegacyFile:r,importMode:c,importWarnings:u}=this.state;return"loading"===t?Object(h.jsx)(l.EuiFlexGroup,{justifyContent:"spaceAround"},Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiLoadingElastic,{size:"xl"}),Object(h.jsx)(l.EuiSpacer,{size:"m"}),Object(h.jsx)(l.EuiText,null,Object(h.jsx)("p",null,s)))):r||"success"!==t?n.length&&!this.hasUnmatchedReferences?Object(h.jsx)(l.EuiCallOut,{"data-test-subj":"importSavedObjectsFailedWarning",title:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importFailedTitle",defaultMessage:"Import failed"}),color:"warning",iconType:"help"},Object(h.jsx)("p",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importFailedDescription",defaultMessage:"Failed to import {failedImportCount} of {totalImportCount} objects. Import failed",values:{failedImportCount:n.length,totalImportCount:a+n.length}})),Object(h.jsx)("p",null,n.map((({error:e,obj:t})=>{var s;return"missing_references"===e.type?e.references.map((e=>d.i18n.translate("savedObjectsManagement.objectsTable.flyout.importFailedMissingReference",{defaultMessage:"{type} [id={id}] could not locate {refType} [id={refId}]",values:{id:t.id,type:t.type,refId:e.id,refType:e.type}}))):"unsupported_type"===e.type?d.i18n.translate("savedObjectsManagement.objectsTable.flyout.importFailedUnsupportedType",{defaultMessage:"{type} [id={id}] unsupported type",values:{id:t.id,type:t.type}}):Object(i.get)(e,"body.message",null!==(s=e.message)&&void 0!==s?s:"")})).join(" "))):"success"===t?0===a?Object(h.jsx)(l.EuiCallOut,{"data-test-subj":"importSavedObjectsSuccessNoneImported",title:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importSuccessfulCallout.noObjectsImportedTitle",defaultMessage:"No objects imported"}),color:"primary"}):Object(h.jsx)(l.EuiCallOut,{"data-test-subj":"importSavedObjectsSuccess",title:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importSuccessfulTitle",defaultMessage:"Import successful"}),color:"success",iconType:"check"},Object(h.jsx)("p",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importSuccessfulDescription",defaultMessage:"Successfully imported {importCount} objects.",values:{importCount:a}}))):this.hasUnmatchedReferences?this.renderUnmatchedReferences():Object(h.jsx)(l.EuiForm,null,Object(h.jsx)(l.EuiFormRow,{fullWidth:!0,label:Object(h.jsx)(l.EuiTitle,{size:"xs"},Object(h.jsx)("span",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.selectFileToImportFormRowLabel",defaultMessage:"Select a file to import"})))},Object(h.jsx)(l.EuiFilePicker,{accept:".ndjson, .json",fullWidth:!0,initialPromptText:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importPromptText",defaultMessage:"Import"}),onChange:this.setImportFile})),Object(h.jsx)(l.EuiFormRow,{fullWidth:!0},Object(h.jsx)(F,{initialValues:c,isLegacyFile:r,updateSelection:e=>this.changeImportMode(e)}))):Object(h.jsx)(L,{basePath:this.props.http.basePath,failedImports:n,successfulImports:o,importWarnings:null!=u?u:[],allowedTypes:e})}renderFooter(){const{isLegacyFile:e,status:t}=this.state,{done:s,close:a}=this.props;let n;return n="success"===t?Object(h.jsx)(l.EuiButton,{onClick:s,size:"s",fill:!0,"data-test-subj":"importSavedObjectsDoneBtn"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importSuccessful.confirmButtonLabel",defaultMessage:"Done"})):this.hasUnmatchedReferences?Object(h.jsx)(l.EuiButton,{onClick:e?this.confirmLegacyImport:this.resolveImportErrors,size:"s",fill:!0,isLoading:"loading"===t,"data-test-subj":"importSavedObjectsConfirmBtn"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importSuccessful.confirmAllChangesButtonLabel",defaultMessage:"Confirm all changes"})):Object(h.jsx)(l.EuiButton,{onClick:e?this.legacyImport:this.import,size:"s",fill:!0,isLoading:"loading"===t,"data-test-subj":"importSavedObjectsImportBtn"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.import.confirmButtonLabel",defaultMessage:"Import"})),Object(h.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiButtonEmpty,{onClick:a,size:"s",disabled:"loading"===t||!1===e&&"success"===t,"data-test-subj":"importSavedObjectsCancelBtn"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.import.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(h.jsx)(l.EuiFlexItem,{grow:!1},n))}renderSubheader(){if("loading"===this.state.status||"success"===this.state.status)return null;let e,t;return this.state.isLegacyFile&&(e=Object(h.jsx)(n.a.Fragment,null,Object(h.jsx)(l.EuiCallOut,{"data-test-subj":"importSavedObjectsLegacyWarning",title:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.legacyFileUsedTitle",defaultMessage:"Support for JSON files is going away"}),color:"warning",iconType:"help"},Object(h.jsx)("p",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.legacyFileUsedBody",defaultMessage:"Use our updated export to generate NDJSON files, and you'll be all set."}))),Object(h.jsx)(l.EuiSpacer,{size:"m"}))),this.hasUnmatchedReferences&&(t=Object(h.jsx)(l.EuiCallOut,{"data-test-subj":"importSavedObjectsConflictsWarning",title:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.indexPatternConflictsTitle",defaultMessage:"Index Pattern Conflicts"}),color:"warning",iconType:"help"},Object(h.jsx)("p",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.indexPatternConflictsDescription",defaultMessage:"The following saved objects use index patterns that do not exist. Please select the index patterns you'd like re-associated with them. You can {indexPatternLink} if necessary.",values:{indexPatternLink:Object(h.jsx)(l.EuiLink,{href:this.props.newIndexPatternUrl},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.indexPatternConflictsCalloutLinkText",defaultMessage:"create a new index pattern"}))}})))),e||t?Object(h.jsx)(a.Fragment,null,e&&Object(h.jsx)("span",null,Object(h.jsx)(l.EuiSpacer,{size:"s"}),e),t&&Object(h.jsx)("span",null,Object(h.jsx)(l.EuiSpacer,{size:"s"}),t)):null}render(){const{close:e}=this.props;let t;const{conflictingRecord:s}=this.state;if(s){const{conflict:e}=s,a=(e,t)=>s.done([e,t]);t=Object(h.jsx)(M,{conflict:e,onFinish:a})}return Object(h.jsx)(l.EuiFlyout,{onClose:e,size:"s","data-test-subj":"importSavedObjectsFlyout"},Object(h.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(h.jsx)(l.EuiTitle,{size:"m"},Object(h.jsx)("h2",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.flyout.importSavedObjectTitle",defaultMessage:"Import saved objects"})))),Object(h.jsx)(l.EuiFlyoutBody,null,this.renderSubheader(),this.renderError(),this.renderBody()),Object(h.jsx)(l.EuiFlyoutFooter,null,this.renderFooter()),t)}}const z={field:"relationship",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnRelationshipName",{defaultMessage:"Direct relationship"}),dataType:"string",sortable:!1,width:"125px","data-test-subj":"directRelationship",render:e=>Object(h.jsx)(l.EuiText,{size:"s"},"parent"===e?Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.relationships.columnRelationship.parentAsValue",defaultMessage:"Parent"}):Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.relationships.columnRelationship.childAsValue",defaultMessage:"Child"}))};class relationships_Relationships extends a.Component{constructor(e){super(e),this.state={relations:[],invalidRelations:[],isLoading:!1,error:void 0}}UNSAFE_componentWillMount(){this.getRelationshipData()}UNSAFE_componentWillReceiveProps(e){e.savedObject.id!==this.props.savedObject.id&&this.getRelationshipData()}async getRelationshipData(){const{savedObject:e,getRelationships:t}=this.props;this.setState({isLoading:!0});try{const{relations:s,invalidRelations:a}=await t(e.type,e.id);this.setState({relations:s,invalidRelations:a,isLoading:!1,error:void 0})}catch(e){this.setState({error:e.message,isLoading:!1})}}renderError(){const{error:e}=this.state;return e?Object(h.jsx)(l.EuiCallOut,{title:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.relationships.renderErrorMessage",defaultMessage:"Error"}),color:"danger"},e):null}renderInvalidRelationship(){const{invalidRelations:e}=this.state;if(!e.length)return null;const t=[{field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTypeName",{defaultMessage:"Type"}),width:"150px",description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTypeDescription",{defaultMessage:"Type of the saved object"}),sortable:!1,"data-test-subj":"relationshipsObjectType"},{field:"id",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnIdName",{defaultMessage:"Id"}),width:"150px",description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnIdDescription",{defaultMessage:"Id of the saved object"}),sortable:!1,"data-test-subj":"relationshipsObjectId"},z,{field:"error",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnErrorName",{defaultMessage:"Error"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnErrorDescription",{defaultMessage:"Error encountered with the relation"}),sortable:!1,"data-test-subj":"relationshipsError"}];return Object(h.jsx)(n.a.Fragment,null,Object(h.jsx)(l.EuiCallOut,{color:"warning",iconType:"alert",title:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.invalidRelationShip",{defaultMessage:"This saved object has some invalid relations."})}),Object(h.jsx)(l.EuiSpacer,null),Object(h.jsx)(l.EuiInMemoryTable,{items:e,columns:t,pagination:!0,rowProps:()=>({"data-test-subj":"invalidRelationshipsTableRow"})}),Object(h.jsx)(l.EuiSpacer,null))}renderRelationshipsTable(){const{goInspectObject:e,basePath:t,savedObject:s,allowedTypes:a}=this.props,{relations:o,isLoading:i,error:r}=this.state;if(r)return this.renderError();if(i)return Object(h.jsx)(l.EuiLoadingElastic,{size:"xl"});const c=[{field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTypeName",{defaultMessage:"Type"}),width:"50px",align:"center",description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTypeDescription",{defaultMessage:"Type of the saved object"}),sortable:!1,render:(e,t)=>{const s=Object(m.getSavedObjectLabel)(e,a);return Object(h.jsx)(l.EuiToolTip,{position:"top",content:s},Object(h.jsx)(l.EuiIcon,{"aria-label":s,type:t.meta.icon||"apps",size:"s","data-test-subj":"relationshipsObjectType"}))}},z,{field:"meta.title",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTitleName",{defaultMessage:"Title"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnTitleDescription",{defaultMessage:"Title of the saved object"}),dataType:"string",sortable:!1,render:(e,s)=>{const{path:a=""}=s.meta.inAppUrl||{};return this.props.canGoInApp(s)?Object(h.jsx)(l.EuiLink,{href:t.prepend(a),"data-test-subj":"relationshipsTitle"},e||Object(m.getDefaultTitle)(s)):Object(h.jsx)(l.EuiText,{size:"s","data-test-subj":"relationshipsTitle"},e||Object(m.getDefaultTitle)(s))}},{name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnActionsName",{defaultMessage:"Actions"}),actions:[{name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnActions.inspectActionName",{defaultMessage:"Inspect"}),description:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.columnActions.inspectActionDescription",{defaultMessage:"Inspect this saved object"}),type:"icon",icon:"inspect","data-test-subj":"relationshipsTableAction-inspect",onClick:t=>e(t),available:e=>!!e.meta.editUrl}]}],u=new Map(o.map((e=>[e.type,{value:e.type,name:e.type,view:e.type}]))),p={filters:[{type:"field_value_selection",field:"relationship",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.search.filters.relationship.name",{defaultMessage:"Direct relationship"}),multiSelect:"or",options:[{value:"parent",name:"parent",view:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.search.filters.relationship.parentAsValue.view",{defaultMessage:"Parent"})},{value:"child",name:"child",view:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.search.filters.relationship.childAsValue.view",{defaultMessage:"Child"})}]},{type:"field_value_selection",field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.relationships.search.filters.type.name",{defaultMessage:"Type"}),multiSelect:"or",options:[...u.values()]}]};return Object(h.jsx)(n.a.Fragment,null,Object(h.jsx)(l.EuiCallOut,null,Object(h.jsx)("p",null,d.i18n.translate("savedObjectsManagement.objectsTable.relationships.relationshipsTitle",{defaultMessage:"Here are the saved objects related to {title}. Deleting this {type} affects its parent objects, but not its children.",values:{type:s.type,title:s.meta.title||Object(m.getDefaultTitle)(s)}}))),Object(h.jsx)(l.EuiSpacer,null),Object(h.jsx)(l.EuiInMemoryTable,{items:o,columns:c,pagination:!0,search:p,rowProps:()=>({"data-test-subj":"relationshipsTableRow"})}))}render(){const{close:e,savedObject:t,allowedTypes:s}=this.props,a=Object(m.getSavedObjectLabel)(t.type,s);return Object(h.jsx)(l.EuiFlyout,{onClose:e},Object(h.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(h.jsx)(l.EuiTitle,{size:"m"},Object(h.jsx)("h2",null,Object(h.jsx)(l.EuiToolTip,{position:"top",content:a},Object(h.jsx)(l.EuiIcon,{"aria-label":a,size:"m",type:t.meta.icon||"apps"})),"  ",t.meta.title||Object(m.getDefaultTitle)(t)))),Object(h.jsx)(l.EuiFlyoutBody,null,this.renderInvalidRelationship(),this.renderRelationshipsTable()))}}const U=({isDeleting:e,onConfirm:t,onCancel:s,selectedObjects:o,allowedTypes:i})=>{const r=Object(a.useMemo)((()=>o.filter((e=>e.meta.hiddenType))),[o]),c=Object(a.useMemo)((()=>o.filter((e=>!e.meta.hiddenType)).map((({type:e,id:t,meta:s,namespaces:a=[]})=>{const{title:n="",icon:o="apps"}=s;return{type:e,id:t,icon:o,title:n,isShared:a.length>1||a.includes("*")}}))),[o]),u=Object(a.useMemo)((()=>c.filter((e=>e.isShared)).length),[c]);return e?Object(h.jsx)(l.EuiOverlayMask,null,Object(h.jsx)(l.EuiLoadingElastic,{size:"xl"})):Object(h.jsx)(l.EuiModal,{initialFocus:"soDeleteConfirmModalConfirmBtn",onClose:s},Object(h.jsx)(l.EuiModalHeader,null,Object(h.jsx)(l.EuiModalHeaderTitle,null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModalTitle",defaultMessage:"Delete saved objects"}))),Object(h.jsx)(l.EuiModalBody,null,r.length>0&&Object(h.jsx)(n.a.Fragment,null,Object(h.jsx)(l.EuiCallOut,{"data-test-subj":"cannotDeleteObjectsConfirmWarning",title:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteConfirmModal.cannotDeleteCallout.title",defaultMessage:"Some objects cannot be deleted"}),iconType:"alert",color:"warning"},Object(h.jsx)("p",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteConfirmModal.cannotDeleteCallout.content",defaultMessage:"{objectCount, plural, one {# object is} other {# objects are}} hidden and cannot be deleted. {objectCount, plural, one {It was} other {They were}} excluded from the table summary.",values:{objectCount:r.length}}))),Object(h.jsx)(l.EuiSpacer,{size:"s"})),u>0&&Object(h.jsx)(n.a.Fragment,null,Object(h.jsx)(l.EuiCallOut,{"data-test-subj":"sharedObjectsWarning",title:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteConfirmModal.sharedObjectsCallout.title",defaultMessage:"{sharedObjectsCount, plural, one {# saved object is shared} other {# of your saved objects are shared}}",values:{sharedObjectsCount:u}}),iconType:"alert",color:"warning"},Object(h.jsx)("p",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteConfirmModal.sharedObjectsCallout.content",defaultMessage:"Shared objects are deleted from every space they are in."}))),Object(h.jsx)(l.EuiSpacer,{size:"s"})),Object(h.jsx)("p",null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.deleteSavedObjectsConfirmModalDescription",defaultMessage:"This action will delete the following saved objects:"})),Object(h.jsx)(l.EuiSpacer,{size:"m"}),Object(h.jsx)(l.EuiInMemoryTable,{items:c,columns:[{field:"type",name:d.i18n.translate("savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.typeColumnName",{defaultMessage:"Type"}),width:"50px",render:(e,{icon:t})=>Object(h.jsx)(l.EuiToolTip,{position:"top",content:Object(m.getSavedObjectLabel)(e,i)},Object(h.jsx)(l.EuiIcon,{type:t}))},{field:"id",name:d.i18n.translate("savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.idColumnName",{defaultMessage:"Id"})},{field:"title",name:d.i18n.translate("savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.titleColumnName",{defaultMessage:"Title"})}],pagination:!0,sorting:!1})),Object(h.jsx)(l.EuiModalFooter,null,Object(h.jsx)(l.EuiFlexGroup,{justifyContent:"flexEnd"},Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiFlexGroup,null,Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiButtonEmpty,{onClick:s,"data-test-subj":"confirmModalCancelButton"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiButton,{id:"soDeleteConfirmModalConfirmBtn",fill:!0,color:"danger",onClick:t,disabled:0===c.length,"data-test-subj":"confirmModalConfirmButton"},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.deleteSavedObjectsConfirmModal.deleteButtonLabel",defaultMessage:"Delete {objectsCount, plural, one {# object} other {# objects}}",values:{objectsCount:c.length}}))))))))},$=({onCancel:e,onExport:t,onSelectedOptionsChange:s,options:a,filteredItemCount:n,selectedOptions:o,includeReferences:i,onIncludeReferenceChange:r})=>Object(h.jsx)(l.EuiModal,{onClose:e},Object(h.jsx)(l.EuiModalHeader,null,Object(h.jsx)(l.EuiModalHeaderTitle,null,Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModalTitle",defaultMessage:"Export {filteredItemCount, plural, one{# object} other {# objects}}",values:{filteredItemCount:n}}))),Object(h.jsx)(l.EuiModalBody,null,Object(h.jsx)(l.EuiFormRow,{label:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModalDescription",defaultMessage:"Select which types to export"}),labelType:"legend"},Object(h.jsx)(l.EuiCheckboxGroup,{options:a,idToSelectedMap:o,onChange:e=>{s({...o,[e]:!o[e]})}})),Object(h.jsx)(l.EuiSpacer,{size:"m"}),Object(h.jsx)(l.EuiSwitch,{name:"includeReferencesDeep",label:Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.includeReferencesDeepLabel",defaultMessage:"Include related objects"}),checked:i,onChange:()=>r(!i)})),Object(h.jsx)(l.EuiModalFooter,null,Object(h.jsx)(l.EuiFlexGroup,{justifyContent:"flexEnd"},Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiFlexGroup,null,Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiButtonEmpty,{onClick:e},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(h.jsx)(l.EuiFlexItem,{grow:!1},Object(h.jsx)(l.EuiButton,{fill:!0,onClick:t},Object(h.jsx)(g.FormattedMessage,{id:"savedObjectsManagement.objectsTable.exportObjectsConfirmModal.exportAllButtonLabel",defaultMessage:"Export all"})))))))),G=d.i18n.translate("savedObjectsManagement.objectsTable.unableFindSavedObjectsNotificationMessage",{defaultMessage:"Unable find saved objects"}),Q=d.i18n.translate("savedObjectsManagement.objectsTable.unableFindSavedObjectNotificationMessage",{defaultMessage:"Unable to find saved object"});class saved_objects_table_SavedObjectsTable extends a.Component{constructor(e){var t;super(e),p()(this,"_isMounted",!1),p()(this,"fetchCounts",(async()=>{const{taggingApi:e}=this.props,{queryText:t,visibleTypes:s,selectedTags:a}=Object(m.parseQuery)(this.state.activeQuery,this.props.allowedTypes),n=this.props.allowedTypes.map((e=>e.name)),o=n.filter((e=>!s||s.includes(e))),i=Object(m.getTagFindReferences)({selectedTags:a,taggingApi:e}),r=await Object(m.getSavedObjectCounts)({http:this.props.http,typesToInclude:o,searchString:t,references:i}),l=Object.entries(r).map((([e,t])=>({id:e,label:`${e} (${t||0})`}))),c=l.reduce(((e,{id:t})=>({...e,[t]:!0})),{}),d=await Object(m.getSavedObjectCounts)({http:this.props.http,typesToInclude:n,searchString:t});this.setState((e=>({...e,savedObjectCounts:d,exportAllOptions:l,exportAllSelectedOptions:c})))})),p()(this,"fetchAllSavedObjects",(()=>{this.setState({isSearching:!0},this.debouncedFindObjects)})),p()(this,"fetchSavedObjects",(e=>{this.setState({isSearching:!0},(()=>this.debouncedBulkGetObjects(e)))})),p()(this,"debouncedFindObjects",Object(i.debounce)((async()=>{const{activeQuery:e,page:t,perPage:s}=this.state,{notifications:a,http:n,allowedTypes:o,taggingApi:i}=this.props,{queryText:r,visibleTypes:l,selectedTags:c}=Object(m.parseQuery)(e,o),d={search:r?`${r}*`:void 0,perPage:s,page:t+1,fields:["id"],type:o.map((e=>e.name)).filter((e=>!l||l.includes(e)))};d.type.length>1&&(d.sortField="type"),d.hasReference=Object(m.getTagFindReferences)({selectedTags:c,taggingApi:i});try{const t=await Object(m.findObjects)(n,d);if(!this._isMounted)return;this.setState((({activeQuery:s})=>s.text!==e.text?null:{savedObjects:t.savedObjects,filteredItemCount:t.total,isSearching:!1}))}catch(e){this._isMounted&&this.setState({isSearching:!1}),a.toasts.addDanger({title:G,text:`${e}`})}}),300)),p()(this,"debouncedBulkGetObjects",Object(i.debounce)((async e=>{const{notifications:t,http:s}=this.props;try{const a=await Object(m.bulkGetObjects)(s,e);if(!this._isMounted)return;const{map:n,errors:o}=a.reduce((({map:e,errors:t},s)=>(s.error?t.push(s.error.message):e.set(W(s),s),{map:e,errors:t})),{map:new Map,errors:[]});o.length&&t.toasts.addDanger({title:Q,text:o.join(", ")}),this.setState((({savedObjects:e,filteredItemCount:t})=>({savedObjects:e.map((e=>{const t=n.get(W(e));return null!=t?t:e})),filteredItemCount:t,isSearching:!1})))}catch(e){this._isMounted&&this.setState({isSearching:!1}),t.toasts.addDanger({title:G,text:`${e}`})}}),300)),p()(this,"refreshAllObjects",(async()=>{await Promise.all([this.fetchAllSavedObjects(),this.fetchCounts()])})),p()(this,"refreshObjects",(async e=>{const t=this.state.savedObjects.reduce(((e,t)=>e.add(W(t))),new Set),s=e.filter((e=>t.has(W(e))));s.length&&this.fetchSavedObjects(s)})),p()(this,"onSelectionChanged",(e=>{this.setState({selectedSavedObjects:e})})),p()(this,"onQueryChange",(({query:e})=>{this.setState({activeQuery:e,page:0,selectedSavedObjects:[]},(()=>{this.fetchAllSavedObjects(),this.fetchCounts()}))})),p()(this,"onTableChange",(async e=>{const{index:t,size:s}=e.page||{};this.setState({page:t,perPage:s,selectedSavedObjects:[]},this.fetchAllSavedObjects)})),p()(this,"onShowRelationships",(e=>{this.setState({isShowingRelationships:!0,relationshipObject:e})})),p()(this,"onHideRelationships",(()=>{this.setState({isShowingRelationships:!1,relationshipObject:void 0})})),p()(this,"onExport",(async e=>{const{selectedSavedObjects:t}=this.state,{notifications:s,http:a}=this.props,n=t.map((e=>({id:e.id,type:e.type})));let o;try{o=await Object(m.fetchExportObjects)(a,n,e)}catch(e){var i,r;throw s.toasts.addDanger({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.toastErrorMessage",{defaultMessage:"Unable to generate export: {error}",values:{error:null!==(i=null===(r=e.body)||void 0===r?void 0:r.message)&&void 0!==i?i:e}})}),e}Object(b.saveAs)(o,"export.ndjson");const l=await Object(m.extractExportDetails)(o);this.showExportCompleteMessage(l)})),p()(this,"onExportAll",(async()=>{const{exportAllSelectedOptions:e,isIncludeReferencesDeepChecked:t,activeQuery:s}=this.state,{notifications:a,http:n,taggingApi:o,allowedTypes:i}=this.props,{queryText:r,selectedTags:l}=Object(m.parseQuery)(s,i),c=Object.entries(e).reduce(((e,[t,s])=>(s&&e.push(t),e)),[]),u=Object(m.getTagFindReferences)({selectedTags:l,taggingApi:o});let p;try{p=await Object(m.fetchExportByTypeAndSearch)({http:n,search:r?`${r}*`:void 0,types:c,references:u,includeReferencesDeep:t})}catch(e){var j,g;throw a.toasts.addDanger({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.toastErrorMessage",{defaultMessage:"Unable to generate export: {error}",values:{error:null!==(j=null===(g=e.body)||void 0===g?void 0:g.message)&&void 0!==j?j:e}})}),e}Object(b.saveAs)(p,"export.ndjson");const h=await Object(m.extractExportDetails)(p);this.showExportCompleteMessage(h),this.setState({isShowingExportAllOptionsModal:!1})})),p()(this,"showExportCompleteMessage",(e=>{const{notifications:t}=this.props;if(e){if(e.missingReferences.length>0)return t.toasts.addWarning({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.successWithMissingRefsNotification",{defaultMessage:"Your file is downloading in the background. Some related objects could not be found. Please see the last line in the exported file for a list of missing objects."})});if(e.excludedObjects.length>0)return t.toasts.addSuccess({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.successWithExcludedObjectsNotification",{defaultMessage:"Your file is downloading in the background. Some objects were excluded from the export. Please see the last line in the exported file for a list of excluded objects."})})}return t.toasts.addSuccess({title:d.i18n.translate("savedObjectsManagement.objectsTable.export.successNotification",{defaultMessage:"Your file is downloading in the background"})})})),p()(this,"finishImport",(()=>{this.hideImportFlyout(),this.fetchAllSavedObjects(),this.fetchCounts()})),p()(this,"showImportFlyout",(()=>{this.setState({isShowingImportFlyout:!0})})),p()(this,"hideImportFlyout",(()=>{this.setState({isShowingImportFlyout:!1})})),p()(this,"onDelete",(()=>{this.setState({isShowingDeleteConfirmModal:!0})})),p()(this,"delete",(async()=>{const{savedObjectsClient:e}=this.props,{selectedSavedObjects:t,isDeleting:s}=this.state;if(s)return;this.setState({isDeleting:!0});t.filter((e=>"index-pattern"===e.type)).length&&await this.props.indexPatterns.clearCache();const a=t.filter((e=>!e.meta.hiddenType)).map((t=>e.delete(t.type,t.id,{force:!0})));await Promise.all(a),this.setState({selectedSavedObjects:[]}),this.fetchAllSavedObjects(),await this.fetchCounts(),this.setState({isShowingDeleteConfirmModal:!1,isDeleting:!1})})),p()(this,"getRelationships",(async(e,t)=>{const{http:s}=this.props,a=this.props.allowedTypes.map((e=>e.name));return await Object(m.getRelationships)(s,e,t,a)})),this.state={totalCount:0,page:0,perPage:e.perPageConfig||50,savedObjects:[],savedObjectCounts:e.allowedTypes.reduce(((e,t)=>(e[t.name]=0,e)),{}),activeQuery:null!==(t=e.initialQuery)&&void 0!==t?t:l.Query.parse(""),selectedSavedObjects:[],isShowingImportFlyout:!1,isSearching:!1,filteredItemCount:0,isShowingRelationships:!1,relationshipObject:void 0,isShowingDeleteConfirmModal:!1,isShowingExportAllOptionsModal:!1,isDeleting:!1,exportAllOptions:[],exportAllSelectedOptions:{},isIncludeReferencesDeepChecked:!0}}componentDidMount(){this._isMounted=!0,this.fetchAllSavedObjects(),this.fetchCounts()}componentWillUnmount(){this._isMounted=!1,this.debouncedFindObjects.cancel(),this.debouncedBulkGetObjects.cancel()}renderFlyout(){if(!this.state.isShowingImportFlyout)return null;const{applications:e}=this.props,t=e.getUrlForApp("management",{path:"kibana/indexPatterns"});return Object(h.jsx)(flyout_Flyout,{close:this.hideImportFlyout,done:this.finishImport,http:this.props.http,serviceRegistry:this.props.serviceRegistry,indexPatterns:this.props.indexPatterns,newIndexPatternUrl:t,overlays:this.props.overlays,basePath:this.props.http.basePath,search:this.props.search,allowedTypes:this.props.allowedTypes})}renderRelationships(){return this.state.isShowingRelationships?Object(h.jsx)(relationships_Relationships,{basePath:this.props.http.basePath,savedObject:this.state.relationshipObject,getRelationships:this.getRelationships,close:this.onHideRelationships,goInspectObject:this.props.goInspectObject,canGoInApp:this.props.canGoInApp,allowedTypes:this.props.allowedTypes}):null}renderDeleteConfirmModal(){const{isShowingDeleteConfirmModal:e,isDeleting:t,selectedSavedObjects:s}=this.state,{allowedTypes:a}=this.props;return e?Object(h.jsx)(U,{isDeleting:t,onConfirm:()=>{this.delete()},onCancel:()=>{this.setState({isShowingDeleteConfirmModal:!1})},selectedObjects:s,allowedTypes:a}):null}renderExportAllOptionsModal(){const{isShowingExportAllOptionsModal:e,filteredItemCount:t,exportAllOptions:s,exportAllSelectedOptions:a,isIncludeReferencesDeepChecked:n}=this.state;return e?Object(h.jsx)($,{onExport:this.onExportAll,onCancel:()=>{this.setState({isShowingExportAllOptionsModal:!1})},onSelectedOptionsChange:e=>{this.setState({exportAllSelectedOptions:e})},filteredItemCount:t,options:s,selectedOptions:a,includeReferences:n,onIncludeReferenceChange:e=>{this.setState({isIncludeReferencesDeepChecked:e})}}):null}render(){const{selectedSavedObjects:e,page:t,perPage:s,savedObjects:a,filteredItemCount:n,isSearching:o,savedObjectCounts:i}=this.state,{http:r,taggingApi:c,allowedTypes:d,applications:u}=this.props,p={onSelectionChange:this.onSelectionChanged},b=d.map((e=>({value:e.displayName,name:e.displayName,view:`${e.displayName} (${i[e.name]||0})`})));return Object(h.jsx)("div",null,this.renderFlyout(),this.renderRelationships(),this.renderDeleteConfirmModal(),this.renderExportAllOptionsModal(),Object(h.jsx)(f,{onExportAll:()=>this.setState({isShowingExportAllOptionsModal:!0}),onImport:this.showImportFlyout,onRefresh:this.refreshAllObjects,filteredCount:n}),Object(h.jsx)(l.EuiSpacer,{size:"l"}),Object(h.jsx)(j.RedirectAppLinks,{application:u},Object(h.jsx)(table_Table,{basePath:r.basePath,taggingApi:c,initialQuery:this.props.initialQuery,allowedTypes:d,itemId:"id",actionRegistry:this.props.actionRegistry,columnRegistry:this.props.columnRegistry,selectionConfig:p,selectedSavedObjects:e,onQueryChange:this.onQueryChange,onTableChange:this.onTableChange,filterOptions:b,onExport:this.onExport,capabilities:u.capabilities,onDelete:this.onDelete,onActionRefresh:this.refreshObjects,goInspectObject:this.props.goInspectObject,pageIndex:t,pageSize:s,items:a,totalItemCount:n,isSearching:o,onShowRelationships:this.onShowRelationships,canGoInApp:this.props.canGoInApp})))}}function W(e){return`${e.type}:${e.id}`}const H=({children:e})=>Object(h.jsx)(n.a.Fragment,null,e),q=({coreStart:e,dataStart:t,taggingApi:s,spacesApi:n,allowedTypes:r,serviceRegistry:u,actionRegistry:p,columnRegistry:b,setBreadcrumbs:j})=>{const m=e.application.capabilities,g=e.uiSettings.get("savedObjects:perPage",50),{search:f}=Object(o.useLocation)(),O=Object(a.useMemo)((()=>{const e=Object(c.parse)(f);try{var t;return l.Query.parse(null!==(t=e.initialQuery)&&void 0!==t?t:"")}catch(e){return l.Query.parse("")}}),[f]);Object(a.useEffect)((()=>{j([{text:d.i18n.translate("savedObjectsManagement.breadcrumb.index",{defaultMessage:"Saved objects"}),href:"/"}])}),[j]);const v=Object(a.useMemo)((()=>n?n.ui.components.getSpacesContextProvider:H),[n]);return Object(h.jsx)(v,null,Object(h.jsx)(saved_objects_table_SavedObjectsTable,{initialQuery:O,allowedTypes:r,serviceRegistry:u,actionRegistry:p,columnRegistry:b,taggingApi:s,savedObjectsClient:e.savedObjects.client,indexPatterns:t.indexPatterns,search:t.search,http:e.http,overlays:e.overlays,notifications:e.notifications,applications:e.application,perPageConfig:g,goInspectObject:t=>{const{editUrl:s}=t.meta;if(s)return e.application.navigateToUrl(e.http.basePath.prepend(`/app${s}`))},canGoInApp:e=>{const{inAppUrl:t}=e.meta;return!!t&&(!t.uiCapabilitiesPath||Boolean(Object(i.get)(m,t.uiCapabilitiesPath)))}}))}}])]);