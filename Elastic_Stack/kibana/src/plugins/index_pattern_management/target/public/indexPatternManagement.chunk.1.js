(window.indexPatternManagement_bundle_jsonpfunction=window.indexPatternManagement_bundle_jsonpfunction||[]).push([[1],[,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(12)(1073)},function(e,t,a){e.exports=a(12)(1074)},function(e,t,a){"use strict";var n,i=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},s=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),r=[];function l(e){for(var t=-1,a=0;a<r.length;a++)if(r[a].identifier===e){t=a;break}return t}function d(e,t){for(var a={},n=[],i=0;i<e.length;i++){var s=e[i],d=t.base?s[0]+t.base:s[0],o=a[d]||0,c="".concat(d," ").concat(o);a[d]=o+1;var u=l(c),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(r[u].references++,r[u].updater(p)):r.push({identifier:c,updater:b(p,t),references:1}),n.push(c)}return n}function o(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var i=a.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var r=s(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function p(e,t,a,n){var i=a?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,i);else{var s=document.createTextNode(i),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}function g(e,t,a){var n=a.css,i=a.media,s=a.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var m=null,x=0;function b(e,t){var a,n,i;if(t.singleton){var s=x++;a=m||(m=o(t)),n=p.bind(null,a,s,!1),i=p.bind(null,a,s,!0)}else a=o(t),n=g.bind(null,a,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var a=d(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<a.length;n++){var i=l(a[n]);r[i].references--}for(var s=d(e,t),o=0;o<a.length;o++){var c=l(a[o]);0===r[c].references&&(r[c].updater(),r.splice(c,1))}a=s}}}},function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a=e[1]||"",n=e[3];if(!n)return a;if(t&&"function"==typeof btoa){var i=(r=n,l=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),d="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(d," */")),s=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[a].concat(s).concat([i]).join("\n")}var r,l,d;return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,n){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(n)for(var s=0;s<this.length;s++){var r=this[s][0];null!=r&&(i[r]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);n&&i[d[0]]||(a&&(d[2]?d[2]="".concat(a," and ").concat(d[2]):d[2]=a),t.push(d))}},t}},function(e,t,a){"use strict";function n(e,t){return e===t}function i(e,t,a){if(null===t||null===a||t.length!==a.length)return!1;for(var n=t.length,i=0;i<n;i++)if(!e(t[i],a[i]))return!1;return!0}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,a=null,s=null;return function(){return i(t,a,arguments)||(s=e.apply(null,arguments)),a=arguments,s}}function r(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var a=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+a+"]")}return t}function l(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var s=0,l=n.pop(),d=r(n),o=e.apply(void 0,[function(){return s++,l.apply(null,arguments)}].concat(a)),c=e((function(){for(var e=[],t=d.length,a=0;a<t;a++)e.push(d[a].apply(null,arguments));return o.apply(null,e)}));return c.resultFunc=l,c.dependencies=d,c.recomputations=function(){return s},c.resetRecomputations=function(){return s=0},c}}t.__esModule=!0,t.defaultMemoize=s,t.createSelectorCreator=l,t.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var a=Object.keys(e);return t(a.map((function(t){return e[t]})),(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t,n){return e[a[n]]=t,e}),{})}))};var d=t.createSelector=l(s)},function(e,t,a){switch(window.__kbnThemeTag__){case"v7dark":return a(23);case"v7light":return a(25);case"v8dark":return a(27);case"v8light":return a(29)}},function(e,t,a){var n=a(19),i=a(24);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(20)(!1)).push([e.i,".testScript__searchBar .globalQueryBar{padding:16px 0 0}\n",""]),e.exports=t},function(e,t,a){var n=a(19),i=a(26);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(20)(!1)).push([e.i,".testScript__searchBar .globalQueryBar{padding:16px 0 0}\n",""]),e.exports=t},function(e,t,a){var n=a(19),i=a(28);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(20)(!1)).push([e.i,".testScript__searchBar .globalQueryBar{padding:16px 0 0}\n",""]),e.exports=t},function(e,t,a){var n=a(19),i=a(30);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(20)(!1)).push([e.i,".testScript__searchBar .globalQueryBar{padding:16px 0 0}\n",""]),e.exports=t},function(e,t,a){"use strict";a.r(t),a.d(t,"mountManagementSection",(function(){return ot}));var n=a(4),i=a.n(n),s=a(14),r=a.n(s),l=a(9),d=a(0),o=a(7),c=a(8),u=a(18),p=a.n(u),g=a(6);const m=d.i18n.translate("indexPatternManagement.editIndexPattern.list.defaultIndexPatternListName",{defaultMessage:"Default"}),x=d.i18n.translate("indexPatternManagement.editIndexPattern.list.rollupIndexPatternListName",{defaultMessage:"Rollup"}),b=(e="")=>"rollup"===e;const f=(e,t)=>{const a=[];return t&&a.push({key:"default",name:m}),b(e.type)&&a.push({key:"rollup",name:x}),a},j=(e,t)=>{var a;if(!b(e.type))return[];const n=null===(a=e.typeMeta)||void 0===a?void 0:a.aggs,i=n&&Object.keys(n).filter((e=>n[e][t.name]));return i&&i.length?["Rollup aggregations:"].concat(i.map((e=>{const a=n[e][t.name];switch(e){case"date_histogram":return d.i18n.translate("indexPatternManagement.editIndexPattern.list.dateHistogramSummary",{defaultMessage:"{aggName} (interval: {interval}, {delay} {time_zone})",values:{aggName:e,interval:a.fixed_interval,delay:a.delay?d.i18n.translate("indexPatternManagement.editIndexPattern.list.DateHistogramDelaySummary",{defaultMessage:"delay: {delay},",values:{delay:a.delay}}):"",time_zone:a.time_zone}});case"histogram":return d.i18n.translate("indexPatternManagement.editIndexPattern.list.histogramSummary",{defaultMessage:"{aggName} (interval: {interval})",values:{aggName:e,interval:a.interval}});default:return e}}))):[]};function h(){return[{text:d.i18n.translate("indexPatternManagement.indexPatterns.listBreadcrumb",{defaultMessage:"Index patterns"}),href:"/"}]}function M(e){return[...h(),{text:e.title,href:`/patterns/${e.id}`}]}var O=a(5);const F={initialPageSize:10,pageSizeOptions:[5,10,25,50]},P={sort:{field:"title",direction:"asc"}},v={box:{incremental:!0,schema:{fields:{title:{type:"string"}}}}},y=d.i18n.translate("indexPatternManagement.indexPatternTable.title",{defaultMessage:"Index patterns"}),S=Object(l.withRouter)((({history:e,canSave:t,showCreateDialog:a=!1})=>{const{setBreadcrumbs:s,uiSettings:r,indexPatternManagementStart:d,chrome:u,data:m,IndexPatternEditor:x}=Object(c.useKibana)().services,[b,j]=Object(n.useState)([]),[M,S]=Object(n.useState)(!0),[E,I]=Object(n.useState)(a);s(h()),Object(n.useEffect)((()=>{!async function(){const e=await async function(e,t){return(await t.getIdsWithTitle(!0)).map((t=>{const{id:a,title:n}=t,i=e===a;return{id:a,title:n,default:i,tags:f(t,i),sort:`${i?"0":"1"}${n}`}})).sort(((e,t)=>e.sort<t.sort?-1:e.sort>t.sort?1:0))||[]}(r.get("defaultIndex"),m.dataViews);j(e),S(!1),0!==e.length&&await m.dataViews.hasUserDataView().catch((()=>!1))||I(!0)}()}),[d,r,m]),u.docTitle.change(y);const T="rollup"===new URLSearchParams(Object(l.useLocation)().search).get("type"),C=[{field:"title",name:"Pattern",render:(t,a)=>Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(g.EuiButtonEmpty,p()({size:"s"},Object(c.reactRouterNavigate)(e,`patterns/${a.id}`)),t)," ",Object(O.jsx)(g.EuiBadgeGroup,{gutterSize:"s"},a.tags&&a.tags.map((({key:e,name:t})=>Object(O.jsx)(g.EuiBadge,{key:e},t))))),dataType:"string",sortable:({sort:e})=>e}],w=t?Object(O.jsx)(g.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:()=>I(!0),"data-test-subj":"createIndexPatternButton"},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.indexPatternTable.createBtn",defaultMessage:"Create index pattern"})):Object(O.jsx)(i.a.Fragment,null);if(M)return Object(O.jsx)(i.a.Fragment,null);const L=E?Object(O.jsx)(x,{onSave:t=>{e.push(`patterns/${t.id}`)},onCancel:()=>I(!1),defaultTypeIsRollup:T}):Object(O.jsx)(i.a.Fragment,null);return Object(O.jsx)("div",{"data-test-subj":"indexPatternTable",role:"region","aria-label":y},Object(O.jsx)(g.EuiPageHeader,{pageTitle:y,description:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.indexPatternTable.indexPatternExplanation",defaultMessage:"Create and manage the index patterns that help you retrieve your data from Elasticsearch."}),bottomBorder:!0,rightSideItems:[w]}),Object(O.jsx)(g.EuiSpacer,{size:"l"}),Object(O.jsx)(g.EuiInMemoryTable,{allowNeutralSort:!1,itemId:"id",isSelectable:!1,items:b,columns:C,pagination:F,sorting:P,search:v}),L)}));var E=a(10),I=a(13),T=a(11),C=a(15);const w="indexedFields",L="scriptedFields",D="sourceFilters";var k=a(17),_=a.n(k),B=a(21);const N=d.i18n.translate("indexPatternManagement.editIndexPattern.sourcePlaceholder",{defaultMessage:"field filter, accepts wildcards (e.g., `user*` to filter fields starting with 'user')"}),A=({onAddFilter:e})=>{const[t,a]=Object(n.useState)(""),i=Object(n.useCallback)((()=>{e(t),a("")}),[t,e]);return Object(O.jsx)(g.EuiFlexGroup,null,Object(O.jsx)(g.EuiFlexItem,{grow:10},Object(O.jsx)(g.EuiFieldText,{fullWidth:!0,value:t,onChange:e=>a(e.target.value.trim()),placeholder:N})),Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiButton,{isDisabled:0===t.length,onClick:i},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.addButtonLabel",defaultMessage:"Add"}))))},R=({filterToDeleteValue:e,onCancelConfirmationModal:t,onDeleteFilter:a})=>Object(O.jsx)(g.EuiConfirmModal,{title:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteSourceFilterLabel",defaultMessage:"Delete field filter '{value}'?",values:{value:e}}),onCancel:t,onConfirm:a,cancelButtonText:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteFilter.cancelButtonLabel",defaultMessage:"Cancel"}),buttonColor:"danger",confirmButtonText:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteFilter.deleteButtonLabel",defaultMessage:"Delete"}),defaultFocusedButton:g.EUI_MODAL_CONFIRM_BUTTON}),H=()=>Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(g.EuiText,{size:"s"},Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.sourceLabel",defaultMessage:"Field filters can be used to exclude one or more fields when fetching a document. This happens when viewing a document in the Discover app, or with a table displaying results from a saved search in the Dashboard app. If you have documents with large or unimportant fields you may benefit from filtering those out at this lower level."})),Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.noteLabel",defaultMessage:"Note that multi-fields will incorrectly appear as matches in the table below. These filters only actually apply to fields in the original source document, so matching multi-fields are not actually being filtered."}))),Object(O.jsx)(g.EuiSpacer,{size:"s"})),z=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.filterHeader",{defaultMessage:"Filter"}),U=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.filterDescription",{defaultMessage:"Filter name"}),V=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.matchesHeader",{defaultMessage:"Matches"}),K=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.matchesDescription",{defaultMessage:"Language used for the field"}),W=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.editAria",{defaultMessage:"Edit"}),q=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.saveAria",{defaultMessage:"Save"}),Q=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.deleteAria",{defaultMessage:"Delete"}),$=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.cancelAria",{defaultMessage:"Cancel"});class table_Table extends n.Component{constructor(e){super(e),_()(this,"startEditingFilter",((e,t)=>this.setState({editingFilterId:e,editingFilterValue:t}))),_()(this,"stopEditingFilter",(()=>this.setState({editingFilterId:""}))),_()(this,"onEditingFilterChange",(e=>this.setState({editingFilterValue:e.target.value}))),_()(this,"onEditFieldKeyDown",(({key:e})=>{g.keys.ENTER===e&&this.state.editingFilterId&&this.state.editingFilterValue&&(this.props.saveFilter({clientId:this.state.editingFilterId,value:this.state.editingFilterValue}),this.stopEditingFilter()),g.keys.ESCAPE===e&&this.stopEditingFilter()})),this.state={editingFilterId:"",editingFilterValue:""}}getColumns(){const{deleteFilter:e,fieldWildcardMatcher:t,indexPattern:a,saveFilter:n}=this.props;return[{field:"value",name:z,description:U,dataType:"string",sortable:!0,render:(e,t)=>this.state.editingFilterId&&this.state.editingFilterId===t.clientId?Object(O.jsx)(g.EuiFieldText,{autoFocus:!0,value:this.state.editingFilterValue,onChange:this.onEditingFilterChange,onKeyDown:this.onEditFieldKeyDown}):Object(O.jsx)("span",null,e)},{field:"value",name:V,description:K,dataType:"string",sortable:!0,render:(e,n)=>{const i=t([this.state.editingFilterId===n.clientId?this.state.editingFilterValue:e]),s=a.getNonScriptedFields().map((e=>e.name)).filter(i).sort();return s.length?Object(O.jsx)("span",null,s.join(", ")):Object(O.jsx)("em",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.table.notMatchedLabel",defaultMessage:"The source filter doesn't match any known fields."}))}},{name:"",align:g.RIGHT_ALIGNMENT,width:"100",render:t=>this.state.editingFilterId===t.clientId?Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(g.EuiButtonIcon,{size:"s",onClick:()=>{n({clientId:this.state.editingFilterId,value:this.state.editingFilterValue}),this.stopEditingFilter()},iconType:"checkInCircleFilled","aria-label":q}),Object(O.jsx)(g.EuiButtonIcon,{size:"s",onClick:()=>{this.stopEditingFilter()},iconType:"cross","aria-label":$})):Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(g.EuiButtonIcon,{size:"s",onClick:()=>this.startEditingFilter(t.clientId,t.value),iconType:"pencil","aria-label":W}),Object(O.jsx)(g.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>e(t),iconType:"trash","aria-label":Q}))}]}render(){const{items:e,isSaving:t}=this.props,a=this.getColumns();return Object(O.jsx)(g.EuiInMemoryTable,{loading:t,items:e,columns:a,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:!0})}}class source_filters_table_SourceFiltersTable extends n.Component{constructor(e){super(e),_()(this,"clientSideId",0),_()(this,"updateFilters",(()=>{const e=(this.props.indexPattern.sourceFilters||[]).map((e=>({...e,clientId:++this.clientSideId})));this.setState({filters:e})})),_()(this,"getFilteredFilters",Object(B.createSelector)((e=>e.filters),((e,t)=>t.filterFilter),((e,t)=>{if(t){const a=t.toLowerCase();return e.filter((e=>e.value.toLowerCase().includes(a)))}return e}))),_()(this,"startDeleteFilter",(e=>{this.setState({filterToDelete:e,isDeleteConfirmationModalVisible:!0})})),_()(this,"hideDeleteConfirmationModal",(()=>{this.setState({filterToDelete:void 0,isDeleteConfirmationModalVisible:!1})})),_()(this,"deleteFilter",(async()=>{const{indexPattern:e,onAddOrRemoveFilter:t,saveIndexPattern:a}=this.props,{filterToDelete:n,filters:i}=this.state;e.sourceFilters=i.filter((e=>e.clientId!==n.clientId)),this.setState({isSaving:!0}),await a(e),t&&t(),this.updateFilters(),this.setState({isSaving:!1}),this.hideDeleteConfirmationModal()})),_()(this,"onAddFilter",(async e=>{const{indexPattern:t,onAddOrRemoveFilter:a,saveIndexPattern:n}=this.props;t.sourceFilters=[...t.sourceFilters||[],{value:e}],this.setState({isSaving:!0}),await n(t),a&&a(),this.updateFilters(),this.setState({isSaving:!1})})),_()(this,"saveFilter",(async({clientId:e,value:t})=>{const{indexPattern:a,saveIndexPattern:n}=this.props,{filters:i}=this.state;a.sourceFilters=i.map((a=>a.clientId===e?{value:t,clientId:e}:a)),this.setState({isSaving:!0}),await n(a),this.updateFilters(),this.setState({isSaving:!1})})),this.state={filterToDelete:void 0,isDeleteConfirmationModalVisible:!1,isSaving:!1,filters:[]}}UNSAFE_componentWillMount(){this.updateFilters()}render(){const{indexPattern:e,fieldWildcardMatcher:t}=this.props,{isSaving:a,filterToDelete:n}=this.state,s=this.getFilteredFilters(this.state,this.props);return Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(H,null),Object(O.jsx)(A,{onAddFilter:this.onAddFilter}),Object(O.jsx)(g.EuiSpacer,{size:"l"}),Object(O.jsx)(table_Table,{isSaving:a,indexPattern:e,items:s,fieldWildcardMatcher:t,deleteFilter:this.startDeleteFilter,saveFilter:this.saveFilter}),n&&Object(O.jsx)(R,{filterToDeleteValue:n.value,onCancelConfirmationModal:this.hideDeleteConfirmationModal,onDeleteFilter:this.deleteFilter}))}}const G=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.additionalInfoAriaLabel",{defaultMessage:"Additional field information"}),J=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictDetailIconAria",{defaultMessage:"Conflict Detail"}),Y=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.primaryTimeAriaLabel",{defaultMessage:"Primary time field"}),X=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.primaryTimeTooltip",{defaultMessage:"This field represents the time that events occurred."}),Z=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.nameHeader",{defaultMessage:"Name"}),ee=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.typeHeader",{defaultMessage:"Type"}),te=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.formatHeader",{defaultMessage:"Format"}),ae=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.searchableHeader",{defaultMessage:"Searchable"}),ne=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.searchableDescription",{defaultMessage:"These fields can be used in the filter bar"}),ie=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isSearchableAria",{defaultMessage:"Is searchable"}),se=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.aggregatableLabel",{defaultMessage:"Aggregatable"}),re=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.aggregatableDescription",{defaultMessage:"These fields can be used in visualization aggregations"}),le=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isAggregatableAria",{defaultMessage:"Is aggregatable"}),de=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.excludedLabel",{defaultMessage:"Excluded"}),oe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.excludedDescription",{defaultMessage:"Fields that are excluded from _source when it is fetched"}),ce=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isExcludedAria",{defaultMessage:"Is excluded"}),ue=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.editLabel",{defaultMessage:"Edit"}),pe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.editDescription",{defaultMessage:"Edit"}),ge=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.deleteLabel",{defaultMessage:"Delete"}),me=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.deleteDescription",{defaultMessage:"Delete"}),xe=d.i18n.translate("indexPatternManagement.editDataView.fields.table.conflictType",{defaultMessage:"Conflict"}),be=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.customLabelTooltip",{defaultMessage:"A custom label for the field."}),fe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.runtimeIconTipTitle",{defaultMessage:"Runtime field"}),je=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.runtimeIconTipText",{defaultMessage:"This field exists on the index pattern only."}),he=e=>{const t=[];return Object.keys(e).forEach((a=>{t.push({type:a,indices:e[a].slice(0,99).join(", ")})})),t},Me=[{field:"type",name:d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictModalTypeColumn",{defaultMessage:"Type"})},{field:"indices",name:d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictModalIndicesColumn",{defaultMessage:"Indices"})}],Oe=(e,t,a)=>{const n=()=>{const n=a(Object(c.toMountPoint)((({closeFn:e,fieldName:t,conflictDescriptions:a})=>Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(g.EuiModalHeader,null,Object(O.jsx)(g.EuiModalHeaderTitle,null,Object(O.jsx)("h1",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.title",defaultMessage:"This field has a type conflict"})))),Object(O.jsx)(g.EuiModalBody,null,Object(O.jsx)(g.EuiText,null,Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.description",defaultMessage:"The type of the {fieldName} field changes across indices and might not be available for search, visualizations, and other analysis.",values:{fieldName:Object(O.jsx)(g.EuiCode,null,t)}})),Object(O.jsx)(g.EuiBasicTable,{tableCaption:"Demo of EuiBasicTable",items:he(a),rowHeader:"firstName",columns:Me,tableLayout:"auto"}))),Object(O.jsx)(g.EuiModalFooter,null,Object(O.jsx)(g.EuiButton,{onClick:e,fill:!0},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.closeBtn",defaultMessage:"Close"})))))({closeFn:()=>{n.close()},fieldName:e,conflictDescriptions:t})))};return Object(O.jsx)("span",null,Object(O.jsx)(g.EuiBadge,{color:"warning",iconType:"alert",onClick:n,iconOnClick:n,iconOnClickAriaLabel:J,onClickAriaLabel:J},xe))};class table_table_Table extends n.PureComponent{renderBooleanTemplate(e,t){return e?Object(O.jsx)(g.EuiIcon,{type:"dot",color:"secondary","aria-label":t}):Object(O.jsx)("span",null)}renderFieldType(e,t){const a=t.conflictDescriptions&&t.conflictDescriptions[t.name];return Object(O.jsx)("span",null,"conflict"===e&&a?"":e,t.conflictDescriptions?Oe(t.name,t.conflictDescriptions,this.props.openModal):"")}render(){const{items:e,editField:t,deleteField:a,indexPattern:n}=this.props,i=[{field:"displayName",name:Z,dataType:"string",sortable:!0,render:(e,t)=>((e,t)=>Object(O.jsx)("span",null,e.name,e.info&&e.info.length?Object(O.jsx)("span",null," ",Object(O.jsx)(g.EuiIconTip,{type:"questionInCircle",color:"primary","aria-label":G,content:e.info.map(((e,t)=>Object(O.jsx)("div",{key:t},e)))})):null,t===e.name?Object(O.jsx)("span",null," ",Object(O.jsx)(g.EuiIconTip,{type:"clock",color:"primary","aria-label":Y,content:X})):null,!e.isMapped&&e.hasRuntime?Object(O.jsx)("span",null," ",Object(O.jsx)(g.EuiIconTip,{type:"indexRuntime",title:fe,content:Object(O.jsx)("span",null,je)})):null,e.customLabel&&e.customLabel!==e.name?Object(O.jsx)("div",null,Object(O.jsx)(g.EuiToolTip,{content:be},Object(O.jsx)(g.EuiBadge,{iconType:"flag",iconSide:"left"},e.customLabel))):null))(t,n.timeFieldName),width:"38%","data-test-subj":"indexedFieldName"},{field:"type",name:ee,dataType:"string",sortable:!0,render:(e,t)=>this.renderFieldType(e,t),"data-test-subj":"indexedFieldType"},{field:"format",name:te,dataType:"string",sortable:!0},{field:"searchable",name:ae,description:ne,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,ie)},{field:"aggregatable",name:se,description:re,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,le)},{field:"excluded",name:de,description:oe,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,ce)},{name:"",actions:[{name:ue,description:pe,icon:"pencil",onClick:t,type:"icon","data-test-subj":"editFieldFormat",available:e=>e.isUserEditable}],width:"40px"},{name:"",actions:[{name:ge,description:me,icon:"trash",onClick:e=>a(e.name),type:"icon","data-test-subj":"deleteField",available:e=>!e.isMapped&&e.isUserEditable}],width:"40px"}];return Object(O.jsx)(g.EuiInMemoryTable,{items:e,columns:i,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:{sort:{field:"displayName",direction:"asc"}}})}}class indexed_fields_table_IndexedFields extends n.Component{constructor(e){super(e),_()(this,"getFilteredFields",Object(B.createSelector)((e=>e.fields),((e,t)=>t.fieldFilter),((e,t)=>t.indexedFieldTypeFilter),((e,t,a)=>{if(t){const a=t.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(a)||e.displayName&&e.displayName.toLowerCase().includes(a)))}return a&&(e=e.filter((e=>{var t,n;return"conflict"===a&&"conflict"===e.kbnType||(null===(t=e.esTypes)||void 0===t?void 0:t.length)&&-1!==(null===(n=e.esTypes)||void 0===n?void 0:n.indexOf(a))}))),e}))),this.state={fields:this.mapFields(this.props.fields)}}UNSAFE_componentWillReceiveProps(e){e.fields!==this.props.fields&&this.setState({fields:this.mapFields(e.fields)})}mapFields(e){const{indexPattern:t,fieldWildcardMatcher:a,helpers:n,userEditPermission:i}=this.props,s=a(t.sourceFilters&&t.sourceFilters.map((e=>e.value))||[]);return e&&e.map((e=>{var a,r,l;return{...e.spec,type:(null===(a=e.esTypes)||void 0===a?void 0:a.join(", "))||"",kbnType:e.type,displayName:e.displayName,format:(null===(r=t.getFormatterForFieldNoDefault(e.name))||void 0===r||null===(l=r.type)||void 0===l?void 0:l.title)||"",excluded:!!s&&s(e.name),info:n.getFieldInfo&&n.getFieldInfo(t,e),isMapped:!!e.isMapped,isUserEditable:i,hasRuntime:!!e.runtimeField}}))||[]}render(){const{indexPattern:e}=this.props,t=this.getFilteredFields(this.state,this.props);return Object(O.jsx)("div",null,Object(O.jsx)(table_table_Table,{indexPattern:e,items:t,editField:e=>this.props.helpers.editField(e.name),deleteField:e=>this.props.helpers.deleteField(e),openModal:this.props.openModal}))}}const Fe=(Pe=indexed_fields_table_IndexedFields,e=>{var t,a;const{application:n}=Object(c.useKibana)().services,i=!(null==n||null===(t=n.capabilities)||void 0===t||null===(a=t.indexPatterns)||void 0===a||!a.save);return Object(O.jsx)(Pe,p()({userEditPermission:i},e))});var Pe;class components_table_table_Table extends n.PureComponent{constructor(...e){super(...e),_()(this,"renderFormatCell",(e=>{const{indexPattern:t}=this.props,a=Object(E.get)(t,["fieldFormatMap",e,"type","title"],"");return Object(O.jsx)("span",null,a)}))}render(){const{items:e,editField:t,deleteField:a}=this.props,n=[{field:"displayName",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.nameHeader",{defaultMessage:"Name"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.nameDescription",{defaultMessage:"Name of the field"}),dataType:"string",sortable:!0,width:"38%"},{field:"lang",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.langHeader",{defaultMessage:"Lang"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.langDescription",{defaultMessage:"Language used for the field"}),dataType:"string",sortable:!0,"data-test-subj":"scriptedFieldLang"},{field:"script",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.scriptHeader",{defaultMessage:"Script"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.scriptDescription",{defaultMessage:"Script for the field"}),dataType:"string",sortable:!0},{field:"name",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.formatHeader",{defaultMessage:"Format"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.formatDescription",{defaultMessage:"Format used for the field"}),render:this.renderFormatCell,sortable:!1},{name:"",actions:[{type:"icon",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.editHeader",{defaultMessage:"Edit"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.editDescription",{defaultMessage:"Edit this field"}),icon:"pencil",onClick:t,available:e=>!!e.isUserEditable},{type:"icon",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.deleteHeader",{defaultMessage:"Delete"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.deleteDescription",{defaultMessage:"Delete this field"}),icon:"trash",color:"danger",onClick:a,available:e=>!!e.isUserEditable}],width:"40px"}];return Object(O.jsx)(g.EuiInMemoryTable,{items:e,columns:n,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:!0})}}const ve=Object(l.withRouter)((({indexPatternId:e,history:t})=>{var a,n;const{application:i,docLinks:s}=Object(c.useKibana)().services,r=null==s?void 0:s.links,l=!(null==i||null===(a=i.capabilities)||void 0===a||null===(n=a.indexPatterns)||void 0===n||!n.save);return Object(O.jsx)(g.EuiFlexGroup,{alignItems:"center"},Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiText,{size:"s"},Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scriptedLabel",defaultMessage:"Scripted fields can be used in visualizations and displayed in documents. However, they cannot be searched."}),Object(O.jsx)("br",null),Object(O.jsx)(g.EuiIcon,{type:"alert",color:"warning",style:{marginRight:"4px"}}),Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.deprecation",defaultMessage:"Scripted fields are deprecated. Use {runtimeDocs} instead.",values:{runtimeDocs:Object(O.jsx)(g.EuiLink,{target:"_blank",href:r.runtimeFields.overview},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.header.runtimeLink",defaultMessage:"runtime fields"}))}})))),l&&Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiButton,p()({"data-test-subj":"addScriptedFieldLink"},Object(c.reactRouterNavigate)(t,`patterns/${e}/create-field/`)),Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.addFieldButton",defaultMessage:"Add scripted field"}))))})),ye=({deprecatedLangsInUse:e,painlessDocLink:t})=>e.length?Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(g.EuiCallOut,{title:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangHeader",defaultMessage:"Deprecation languages in use"}),color:"danger",iconType:"cross"},Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangLabel.deprecationLangDetail",defaultMessage:"The following deprecated languages are in use: {deprecatedLangsInUse}. Support for these languages will be removed in the next major version of Kibana and Elasticsearch. Convert you scripted fields to {link} to avoid any problems.",values:{deprecatedLangsInUse:e.join(", "),link:Object(O.jsx)(g.EuiLink,{href:t},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangLabel.painlessDescription",defaultMessage:"Painless"}))}}))),Object(O.jsx)(g.EuiSpacer,{size:"m"})):null,Se=({field:e,hideDeleteConfirmationModal:t,deleteField:a})=>{const n=d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteFieldLabel",{defaultMessage:"Delete scripted field '{fieldName}'?",values:{fieldName:e.name}}),i=d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteField.cancelButton",{defaultMessage:"Cancel"}),s=d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteField.deleteButton",{defaultMessage:"Delete"});return Object(O.jsx)(g.EuiConfirmModal,{title:n,onCancel:t,onConfirm:a,cancelButtonText:i,confirmButtonText:s,defaultFocusedButton:g.EUI_MODAL_CONFIRM_BUTTON})};class scripted_fields_table_ScriptedFields extends n.Component{constructor(e){super(e),_()(this,"fetchFields",(async()=>{const e=await this.props.indexPattern.getScriptedFields(),t=[],a=[],n=["painless"];for(const i of e){const e=i.lang;!a.includes(e)&&n.includes(e)||t.push(e)}this.setState({fields:e,deprecatedLangsInUse:t})})),_()(this,"getFilteredItems",(()=>{const{fields:e}=this.state,{fieldFilter:t,scriptedFieldLanguageFilter:a,userEditPermission:n}=this.props;let i=e;a&&(i=e.filter((e=>e.lang===this.props.scriptedFieldLanguageFilter)));let s=i;if(t){const e=t.toLowerCase();s=i.filter((t=>t.name.toLowerCase().includes(e)))}return s.forEach((e=>e.isUserEditable=n)),s})),_()(this,"startDeleteField",(e=>{this.setState({fieldToDelete:e,isDeleteConfirmationModalVisible:!0})})),_()(this,"hideDeleteConfirmationModal",(()=>{this.setState({fieldToDelete:void 0,isDeleteConfirmationModalVisible:!1})})),_()(this,"deleteField",(()=>{const{indexPattern:e,onRemoveField:t,saveIndexPattern:a}=this.props,{fieldToDelete:n}=this.state;e.removeScriptedField(n.name),a(e),t&&t(),this.fetchFields(),this.hideDeleteConfirmationModal()})),this.state={deprecatedLangsInUse:[],fieldToDelete:void 0,isDeleteConfirmationModalVisible:!1,fields:[]}}UNSAFE_componentWillMount(){this.fetchFields()}render(){const{indexPattern:e,painlessDocLink:t}=this.props,{fieldToDelete:a,deprecatedLangsInUse:n}=this.state,s=this.getFilteredItems();return Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(ve,{indexPatternId:e.id||""}),Object(O.jsx)(ye,{deprecatedLangsInUse:n,painlessDocLink:t}),Object(O.jsx)(g.EuiSpacer,{size:"l"}),Object(O.jsx)(components_table_table_Table,{indexPattern:e,items:s,editField:e=>this.props.helpers.redirectToRoute(e),deleteField:this.startDeleteField}),a&&Object(O.jsx)(Se,{deleteField:this.deleteField,field:a,hideDeleteConfirmationModal:this.hideDeleteConfirmationModal}))}}const Ee=(e=>t=>{var a,n;const{application:i}=Object(c.useKibana)().services,s=!(null==i||null===(a=i.capabilities)||void 0===a||null===(n=a.indexPatterns)||void 0===n||!n.save);return Object(O.jsx)(e,p()({userEditPermission:s},t))})(scripted_fields_table_ScriptedFields);function Ie(e,t,a=""){const n=Object(E.countBy)(function(e,t){const a=(t||"").toLowerCase();return e.filter((e=>e.name.toLowerCase().includes(a)))}(e,a),(function(e){return e.scripted?"scripted":"indexed"}));return Object(E.defaults)(n,{indexed:0,scripted:0,sourceFilters:t.excludes?t.excludes.filter((e=>e.toLowerCase().includes(a.toLowerCase()))).length:0}),n}function Te(e,t,a){let n="";switch(e){case"indexed":n=d.i18n.translate("indexPatternManagement.editIndexPattern.tabs.fieldsHeader",{defaultMessage:"Fields"});break;case"scripted":n=d.i18n.translate("indexPatternManagement.editIndexPattern.tabs.scriptedHeader",{defaultMessage:"Scripted fields"});break;case"sourceFilters":n=d.i18n.translate("indexPatternManagement.editIndexPattern.tabs.sourceHeader",{defaultMessage:"Field filters"})}return n+` (${t[e]===a[e]?t[e]:t[e]+" / "+a[e]})`}function Ce(e,t){const a=Ie(e.fields.getAll(),e.getSourceFiltering()),n=Ie(e.fields.getAll(),e.getSourceFiltering(),t),i=[];return i.push({name:Te("indexed",n,a),id:w,"data-test-subj":"tab-indexedFields"}),(e=>!b(e.type))(e)&&i.push({name:Te("scripted",n,a),id:L,"data-test-subj":"tab-scriptedFields"}),i.push({name:Te("sourceFilters",n,a),id:D,"data-test-subj":"tab-sourceFilters"}),i}const we=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.allTypesDropDown",{defaultMessage:"All field types"}),Le=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.allLangsDropDown",{defaultMessage:"All languages"});function De(e,t){return(e.length>0?[{value:"",text:"scriptedFieldLanguages"===t?Le:we}]:[]).concat(Object(E.uniq)(e).map((e=>({value:e,text:e}))))}const ke=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.searchAria",{defaultMessage:"Search fields"}),_e=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.filterAria",{defaultMessage:"Filter field types"}),Be=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.filterPlaceholder",{defaultMessage:"Search"}),Ne=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.addFieldButtonLabel",{defaultMessage:"Add field"});function Ae({indexPattern:e,saveIndexPattern:t,fields:a,history:s,location:r,refreshFields:l}){var d,o;const{application:u,uiSettings:p,docLinks:m,indexPatternFieldEditor:x,overlays:b}=Object(c.useKibana)().services,[f,h]=Object(n.useState)(""),[M,F]=Object(n.useState)(""),[P,v]=Object(n.useState)(""),[y,S]=Object(n.useState)([]),[E,k]=Object(n.useState)([]),[_,B]=Object(n.useState)({getCurrentTab:()=>w}),N=Object(n.useRef)(),{DeleteRuntimeFieldProvider:A}=x,R=Object(n.useCallback)((()=>{const t=[],a=[];e.fields.getAll().forEach((e=>{e.scripted?e.lang&&a.push(e.lang):("conflict"===e.type&&t.push("conflict"),e.esTypes&&e.esTypes.forEach((e=>t.push(e))))})),S(De(t,"indexedFiledTypes")),k(De(a,"scriptedFieldLanguages"))}),[e]),H=Object(n.useCallback)((()=>{N.current&&N.current()}),[]),z=Object(n.useCallback)((t=>{N.current=x.openEditor({ctx:{indexPattern:e},onSave:l,fieldName:t})}),[x,e,l]);Object(n.useEffect)((()=>{R()}),[e,e.fields,R]),Object(n.useEffect)((()=>()=>{H()}),[H]);const U=Object(n.useCallback)((e=>Object(I.fieldWildcardMatcher)(e,p.get(T.UI_SETTINGS.META_FIELDS))),[p]),V=!(null==u||null===(d=u.capabilities)||void 0===d||null===(o=d.indexPatterns)||void 0===o||!o.save),K=Object(n.useCallback)((e=>Object(O.jsx)(g.EuiFlexGroup,null,Object(O.jsx)(g.EuiFlexItem,{grow:!0},Object(O.jsx)(g.EuiFieldSearch,{fullWidth:!0,placeholder:Be,value:f,onChange:e=>h(e.target.value),"data-test-subj":"indexPatternFieldFilter","aria-label":ke})),e===w&&y.length>0&&Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiSelect,{options:y,value:M,onChange:e=>F(e.target.value),"data-test-subj":"indexedFieldTypeFilterDropdown","aria-label":_e})),V&&Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiButton,{fill:!0,onClick:()=>z(),"data-test-subj":"addField"},Ne))),e===L&&E.length>0&&Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiSelect,{options:E,value:P,onChange:e=>v(e.target.value),"data-test-subj":"scriptedFieldLanguageFilterDropdown"})))),[f,M,y,P,E,z,V]),W=Object(n.useCallback)((i=>{switch(i){case w:return Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiSpacer,{size:"m"}),K(i),Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(A,{indexPattern:e,onDelete:l},(t=>Object(O.jsx)(Fe,{fields:a,indexPattern:e,fieldFilter:f,fieldWildcardMatcher:U,indexedFieldTypeFilter:M,helpers:{editField:z,deleteField:t,getFieldInfo:j},openModal:b.openModal}))));case L:return Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiSpacer,{size:"m"}),K(i),Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(Ee,{indexPattern:e,saveIndexPattern:t,fieldFilter:f,scriptedFieldLanguageFilter:P,helpers:{redirectToRoute:t=>{s.push(function(e,t){return`/patterns/${null==t?void 0:t.id}/field/${encodeURIComponent(e.name)}`}(t,e))}},onRemoveField:R,painlessDocLink:m.links.scriptedFields.painless}));case D:return Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiSpacer,{size:"m"}),K(i),Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(source_filters_table_SourceFiltersTable,{saveIndexPattern:t,indexPattern:e,filterFilter:f,fieldWildcardMatcher:U,onAddOrRemoveFilter:R}))}}),[m.links.scriptedFields.painless,f,U,a,K,s,e,M,R,P,t,z,A,l,b]),q=Object(n.useMemo)((()=>Ce(e,f).map((e=>({...e,content:W(e.id)})))),[f,W,e]),[Q,$]=Object(n.useState)(q[0].id);return Object(n.useEffect)((()=>{const{startSyncingState:e,stopSyncingState:t,setCurrentTab:a,getCurrentTab:n}=function({defaultTab:e,useHashedUrl:t}){const a=Object(C.createHashHistory)(),n="_a",i={tab:e},s=Object(I.createKbnUrlStateStorage)({useHash:t,history:a}),r=s.get(n),l=Object(I.createStateContainer)({...i,...r},{setTab:e=>t=>({...e,tab:t})},{tab:e=>()=>e.tab}),{start:d,stop:o}=Object(I.syncState)({storageKey:n,stateContainer:{...l,set:e=>e&&l.set(e)},stateStorage:s});return s.set(n,l.getState(),{replace:!0}),{startSyncingState:d,stopSyncingState:o,setCurrentTab:e=>l.transitions.setTab(e),getCurrentTab:()=>l.selectors.tab()}}({useHashedUrl:p.get("state:storeInSessionStorage"),defaultTab:w});return e(),B({setCurrentTab:a,getCurrentTab:n}),$(n()),()=>{t()}}),[p]),Object(O.jsx)(g.EuiTabbedContent,{tabs:q,selectedTab:q.find((e=>e.id===Q)),onTabClick:e=>{$(e.id),_.setCurrentTab(e.id)}})}const Re=d.i18n.translate("indexPatternManagement.editIndexPattern.setDefaultAria",{defaultMessage:"Set as default index."}),He=d.i18n.translate("indexPatternManagement.editIndexPattern.setDefaultTooltip",{defaultMessage:"Set as default index."}),ze=d.i18n.translate("indexPatternManagement.editIndexPattern.removeAria",{defaultMessage:"Delete index pattern."}),Ue=d.i18n.translate("indexPatternManagement.editIndexPattern.removeTooltip",{defaultMessage:"Delete index pattern."}),Ve=({defaultIndex:e,indexPattern:t,setDefault:a,deleteIndexPatternClick:n,children:i})=>Object(O.jsx)(g.EuiPageHeader,{pageTitle:Object(O.jsx)("span",{"data-test-subj":"indexPatternTitle"},t.title),rightSideItems:[e!==t.id&&a&&Object(O.jsx)(g.EuiToolTip,{content:He},Object(O.jsx)(g.EuiButtonIcon,{color:"text",onClick:a,iconType:"starFilled","aria-label":Re,"data-test-subj":"setDefaultIndexPatternButton"})),n&&Object(O.jsx)(g.EuiToolTip,{content:Ue},Object(O.jsx)(g.EuiButtonIcon,{color:"danger",onClick:n,iconType:"trash","aria-label":ze,"data-test-subj":"deleteIndexPatternButton"}))].filter(Boolean)},i),Ke=d.i18n.translate("indexPatternManagement.editIndexPattern.timeFilterLabel.mappingAPILink",{defaultMessage:"field mappings"}),We=d.i18n.translate("indexPatternManagement.editIndexPattern.mappingConflictHeader",{defaultMessage:"Mapping conflict"}),qe={confirmButtonText:d.i18n.translate("indexPatternManagement.editIndexPattern.deleteButton",{defaultMessage:"Delete"}),title:d.i18n.translate("indexPatternManagement.editIndexPattern.deleteHeader",{defaultMessage:"Delete index pattern?"})},Qe=Object(l.withRouter)((({indexPattern:e,history:t,location:a})=>{var s,r;const{application:l,uiSettings:u,overlays:m,chrome:x,data:b}=Object(c.useKibana)().services,[j,h]=Object(n.useState)(e.getNonScriptedFields()),[M,F]=Object(n.useState)(e.fields.getAll().filter((e=>"conflict"===e.type))),[P,v]=Object(n.useState)(u.get("defaultIndex")),[y,S]=Object(n.useState)([]);Object(n.useEffect)((()=>{h(e.getNonScriptedFields()),F(e.fields.getAll().filter((e=>"conflict"===e.type)))}),[e]),Object(n.useEffect)((()=>{S(f(e,e.id===P))}),[P,e]);const I=Object(n.useCallback)((()=>{u.set("defaultIndex",e.id),v(e.id||"")}),[u,e.id]),T=d.i18n.translate("indexPatternManagement.editIndexPattern.timeFilterHeader",{defaultMessage:"Time field: '{timeFieldName}'",values:{timeFieldName:e.timeFieldName}}),C=d.i18n.translate("indexPatternManagement.editIndexPattern.mappingConflictLabel",{defaultMessage:"{conflictFieldsLength, plural, one {A field is} other {# fields are}} defined as several types (string, integer, etc) across the indices that match this pattern. You may still be able to use these conflict fields in parts of Kibana, but they will be unavailable for functions that require Kibana to know their type. Correcting this issue will require reindexing your data.",values:{conflictFieldsLength:M.length}}),w=d.i18n.translate("indexPatternManagement.editIndexPattern.detailsAria",{defaultMessage:"Index pattern details"});x.docTitle.change(e.title);const L=Boolean(e.timeFieldName||y&&y.length>0),D=Object(c.useKibana)().services.docLinks.links.elasticsearch.mapping,k=!(null==l||null===(s=l.capabilities)||void 0===s||null===(r=s.indexPatterns)||void 0===r||!r.save);return Object(O.jsx)("div",{"data-test-subj":"editIndexPattern",role:"region","aria-label":w},Object(O.jsx)(Ve,p()({indexPattern:e,setDefault:I},k?{deleteIndexPatternClick:()=>{m.openConfirm("",qe).then((a=>{a&&async function(){if(e.id===P){const t=await b.dataViews.getIdsWithTitle();u.remove("defaultIndex");const a=Object(E.filter)(t,(t=>t.id!==e.id));a.length&&u.set("defaultIndex",a[0].id)}e.id&&Promise.resolve(b.dataViews.delete(e.id)).then((function(){t.push("")}))}()}))}}:{},{defaultIndex:P}),L&&Object(O.jsx)(g.EuiFlexGroup,{wrap:!0},Boolean(e.timeFieldName)&&Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiBadge,{color:"warning"},T)),y.map((e=>Object(O.jsx)(g.EuiFlexItem,{grow:!1,key:e.key},Object(O.jsx)(g.EuiBadge,{color:"hollow"},e.name))))),Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(g.EuiText,null,Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.timeFilterLabel.timeFilterDetail",defaultMessage:"View and edit fields in {indexPatternTitle}. Field attributes, such as type and searchability, are based on {mappingAPILink} in Elasticsearch.",values:{indexPatternTitle:Object(O.jsx)("strong",null,e.title),mappingAPILink:Object(O.jsx)(g.EuiLink,{href:D,target:"_blank",external:!0},Ke)}})," ")),M.length>0&&Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(g.EuiSpacer,null),Object(O.jsx)(g.EuiCallOut,{title:We,color:"warning",iconType:"alert"},Object(O.jsx)("p",null,C)))),Object(O.jsx)(g.EuiSpacer,null),Object(O.jsx)(Ae,{indexPattern:e,saveIndexPattern:b.indexPatterns.updateSavedObject.bind(b.indexPatterns),fields:j,history:t,location:a,refreshFields:()=>{h(e.getNonScriptedFields())}}))})),$e=Object(l.withRouter)((({...e})=>{const{data:t,setBreadcrumbs:a}=Object(c.useKibana)().services,[s,r]=Object(n.useState)();return Object(n.useEffect)((()=>{t.indexPatterns.get(e.match.params.id).then((e=>{r(e),a(M(e))}))}),[t.indexPatterns,e.match.params.id,a]),s?Object(O.jsx)(Qe,{indexPattern:s}):Object(O.jsx)(i.a.Fragment,null)}));var Ge=a(16);const Je=({isVisible:e=!1})=>e?Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiCallOut,{title:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.disabledCallOutHeader",defaultMessage:"Scripting disabled",description:"Showing the status that scripting is disabled in Elasticsearch. Not an update message, that it JUST got disabled."}),color:"danger",iconType:"alert"},Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.disabledCallOutLabel",defaultMessage:"All inline scripting has been disabled in Elasticsearch. You must enable inline scripting for at least one language in order to use scripted fields in Kibana."}))),Object(O.jsx)(g.EuiSpacer,{size:"m"})):null;Je.displayName="ScriptingDisabledCallOut";const Ye=({isVisible:e=!1})=>{var t;const a=null===(t=Object(c.useKibana)().services.docLinks)||void 0===t?void 0:t.links;return e?Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiText,{size:"s"},Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.callOutDetail",defaultMessage:"Familiarize yourself with {scripFields} and {scriptsInAggregation} before using this feature. Scripted fields can be used to display and aggregate calculated values. As such, they can be very slow and, if done incorrectly, can cause Kibana to become unusable.",values:{scripFields:Object(O.jsx)(g.EuiLink,{target:"_blank",href:a.scriptedFields.scriptFields},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.scripFieldsLink",defaultMessage:"scripted fields"})),scriptsInAggregation:Object(O.jsx)(g.EuiLink,{target:"_blank",href:a.scriptedFields.scriptAggs},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.scriptsInAggregationLink",defaultMessage:"scripts in aggregations"}))}}))),Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(g.EuiCallOut,{color:"warning",iconType:"alert",title:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.scriptedFieldsDeprecatedTitle",defaultMessage:"Scripted fields are deprecated",description:"Deprecation warning title within scripted field editor"})},Object(O.jsx)(g.EuiText,{size:"s"},Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.scriptedFieldsDeprecatedBody",defaultMessage:"For greater flexibility and Painless script support, use {runtimeDocs}.",values:{runtimeDocs:Object(O.jsx)(g.EuiLink,{target:"_blank",href:a.runtimeFields.overview},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.runtimeLink",defaultMessage:"runtime fields"}))}})))),Object(O.jsx)(g.EuiSpacer,{size:"m"})):null};Ye.displayName="ScriptingWarningCallOut";const Xe=()=>{var e;const t=null===(e=Object(c.useKibana)().services.docLinks)||void 0===e?void 0:e.links.scriptedFields;return Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiSpacer,null),Object(O.jsx)(g.EuiText,null,Object(O.jsx)("h3",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntaxHeader",defaultMessage:"Syntax"})),Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.defaultLabel.defaultDetail",defaultMessage:"By default, Kibana scripted fields use {painless}, a simple and secure scripting language designed specifically for use with Elasticsearch, to access values in the document use the following format:",values:{painless:Object(O.jsx)(g.EuiLink,{target:"_blank",href:t.painless},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.defaultLabel.painlessLink",defaultMessage:"Painless"})," ",Object(O.jsx)(g.EuiIcon,{type:"link"}))}})),Object(O.jsx)("p",null,Object(O.jsx)(g.EuiCode,null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.default.formatLabel",defaultMessage:"doc['some_field'].value"}))),Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.painlessDetail",defaultMessage:"Painless is powerful but easy to use. It provides access to many {javaAPIs}. Read up on its {syntax} and you'll be up to speed in no time!",values:{javaAPIs:Object(O.jsx)(g.EuiLink,{target:"_blank",href:t.painlessApi},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.javaAPIsLink",defaultMessage:"native Java APIs"})," ",Object(O.jsx)(g.EuiIcon,{type:"link"})),syntax:Object(O.jsx)(g.EuiLink,{target:"_blank",href:t.painlessSyntax},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.syntaxLink",defaultMessage:"syntax"})," ",Object(O.jsx)(g.EuiIcon,{type:"link"}))}})),Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.kibanaLabel",defaultMessage:"Kibana currently imposes one special limitation on the painless scripts you write. They cannot contain named functions."})),Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.commonLabel.commonDetail",defaultMessage:"Coming from an older version of Kibana? The {lucene} you know and love are still available. Lucene expressions are a lot like JavaScript, but limited to basic arithmetic, bitwise and comparison operations.",values:{lucene:Object(O.jsx)(g.EuiLink,{target:"_blank",href:t.luceneExpressions},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.commonLabel.luceneLink",defaultMessage:"Lucene Expressions"})," ",Object(O.jsx)(g.EuiIcon,{type:"link"}))}})),Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limitsLabel",defaultMessage:"There are a few limitations when using Lucene Expressions:"})),Object(O.jsx)("ul",null,Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.typesLabel",defaultMessage:"Only numeric, boolean, date, and geo_point fields may be accessed"})),Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.fieldsLabel",defaultMessage:"Stored fields are not available"})),Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.sparseLabel",defaultMessage:"If a field is sparse (only some documents contain a value), documents missing the field will have a value of 0"}))),Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operationsLabel",defaultMessage:"Here are all the operations available to lucene expressions:"})),Object(O.jsx)("ul",null,Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.arithmeticLabel",defaultMessage:"Arithmetic operators: {operators}",values:{operators:Object(O.jsx)("code",null,"+ - * / %")}})),Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.bitwiseLabel",defaultMessage:"Bitwise operators: {operators}",values:{operators:Object(O.jsx)("code",null,"| & ^ ~ << >> >>>")}})),Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.booleanLabel",defaultMessage:"Boolean operators (including the ternary operator): {operators}",values:{operators:Object(O.jsx)("code",null,"&& || ! ?:")}})),Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.comparisonLabel",defaultMessage:"Comparison operators: {operators}",values:{operators:Object(O.jsx)("code",null,"< <= == >= >")}})),Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.mathLabel",defaultMessage:"Common mathematic functions: {operators}",values:{operators:Object(O.jsx)("code",null,"abs ceil exp floor ln log10 logn max min sqrt pow")}})),Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.trigLabel",defaultMessage:"Trigonometric library functions: {operators}",values:{operators:Object(O.jsx)("code",null,"acosh acos asinh asin atanh atan atan2 cosh cos sinh sin tanh tan")}})),Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.distanceLabel",defaultMessage:"Distance functions: {operators}",values:{operators:Object(O.jsx)("code",null,"haversin")}})),Object(O.jsx)("li",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.miscellaneousLabel",defaultMessage:"Miscellaneous functions: {operators}",values:{operators:Object(O.jsx)("code",null,"min, max")}})))))};a(22);class test_script_TestScript extends n.Component{constructor(...e){super(...e),_()(this,"context",void 0),_()(this,"defaultProps",{name:"myScriptedField"}),_()(this,"state",{isLoading:!1,additionalFields:[],previewData:void 0}),_()(this,"previewScript",(async e=>{var t;const{indexPattern:a,name:n,script:i,executeScript:s}=this.props;if(!i||0===i.length)return;let r;if(this.setState({isLoading:!0}),e){const t=T.esQuery.getEsQueryConfig(this.context.services.uiSettings);r=T.esQuery.buildEsQuery(this.props.indexPattern,e.query||[],[],t)}const l=await s({name:n,script:i,indexPatternTitle:a.title,query:r,additionalFields:this.state.additionalFields.map((e=>e.value)),http:this.context.services.http});200===l.status?this.setState({isLoading:!1,previewData:null===(t=l.hits)||void 0===t?void 0:t.hits.map((e=>({_id:e._id,...e._source,...e.fields})))}):this.setState({isLoading:!1,previewData:l})})),_()(this,"onAdditionalFieldsChange",(e=>{this.setState({additionalFields:e})}))}componentDidMount(){this.props.script&&this.previewScript()}renderPreview(e){return e?e.error?Object(O.jsx)(g.EuiCallOut,{title:d.i18n.translate("indexPatternManagement.testScript.errorMessage",{defaultMessage:"There's an error in your script"}),color:"danger",iconType:"cross"},Object(O.jsx)(g.EuiCodeBlock,{language:"json",className:"scriptPreviewCodeBlock","data-test-subj":"scriptedFieldPreview"},JSON.stringify(e.error,null," "))):Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiTitle,{size:"xs"},Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.testScript.resultsLabel",defaultMessage:"First 10 results"}))),Object(O.jsx)(g.EuiSpacer,{size:"s"}),Object(O.jsx)(g.EuiCodeBlock,{language:"json",className:"scriptPreviewCodeBlock","data-test-subj":"scriptedFieldPreview"},JSON.stringify(e,null," "))):null}renderToolbar(){const e=new Map,t=[];return this.props.indexPattern.fields.getAll().filter((e=>{const t=e.isSubtypeMulti();return!e.name.startsWith("_")&&!t&&!e.scripted})).forEach((t=>{if(e.has(t.type)){const a=e.get(t.type);a.push(t.name),e.set(t.type,a)}else e.set(t.type,[t.name])})),e.forEach(((e,a)=>{t.push({label:a,options:e.sort().map((e=>({value:e,label:e})))})})),t.sort(((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)),Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.testScript.fieldsLabel",{defaultMessage:"Additional fields"}),fullWidth:!0},Object(O.jsx)(g.EuiComboBox,{placeholder:d.i18n.translate("indexPatternManagement.testScript.fieldsPlaceholder",{defaultMessage:"Select..."}),options:t,selectedOptions:this.state.additionalFields,onChange:e=>this.onAdditionalFieldsChange(e),"data-test-subj":"additionalFieldsSelect",fullWidth:!0})),Object(O.jsx)("div",{className:"testScript__searchBar"},Object(O.jsx)(this.context.services.data.ui.SearchBar,{appName:"indexPatternManagement",showFilterBar:!1,showDatePicker:!1,showQueryInput:!0,query:this.context.services.data.query.queryString.getDefaultQuery(),onQuerySubmit:this.previewScript,indexPatterns:[this.props.indexPattern],customSubmitButton:Object(O.jsx)(g.EuiButton,{disabled:!this.props.script,isLoading:this.state.isLoading,"data-test-subj":"runScriptButton"},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.testScript.submitButtonLabel",defaultMessage:"Run script"}))})))}render(){return Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiSpacer,null),Object(O.jsx)(g.EuiText,null,Object(O.jsx)("h3",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.testScript.resultsTitle",defaultMessage:"Preview results"})),Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.testScript.instructions",defaultMessage:"Run your script to preview the first 10 results. You can also select some additional fields to include in your results to gain more context or add a query to filter on specific documents."}))),Object(O.jsx)(g.EuiSpacer,null),this.renderToolbar(),Object(O.jsx)(g.EuiSpacer,null),this.renderPreview(this.state.previewData))}}_()(test_script_TestScript,"contextType",c.context);const Ze=({isVisible:e=!1,onClose:t=(()=>{}),indexPattern:a,lang:n,name:i,script:s,executeScript:r})=>{const l=[{id:"syntax",name:"Syntax","data-test-subj":"syntaxTab",content:Object(O.jsx)(Xe,null)},{id:"test",name:"Preview results","data-test-subj":"testTab",content:Object(O.jsx)(test_script_TestScript,{indexPattern:a,lang:n,name:i,script:s,executeScript:r})}];return e?Object(O.jsx)(g.EuiFlyout,{onClose:t,"data-test-subj":"scriptedFieldsHelpFlyout"},Object(O.jsx)(g.EuiFlyoutBody,null,Object(O.jsx)(g.EuiTabbedContent,{tabs:l,initialSelectedTab:l[0]}))):null};Ze.displayName="ScriptingHelpFlyout";const et=Object(E.memoize)((e=>e?i.a.lazy((()=>e().then((e=>({default:e}))))):null));class field_format_editor_FieldFormatEditor extends n.PureComponent{constructor(e){super(e),this.state={EditorComponent:et(e.fieldFormatEditors.getById(e.fieldFormatId))}}static getDerivedStateFromProps(e){return{EditorComponent:et(e.fieldFormatEditors.getById(e.fieldFormatId))}}render(){const{EditorComponent:e}=this.state,{fieldType:t,fieldFormat:a,fieldFormatParams:n,onChange:s,onError:r}=this.props;return Object(O.jsx)(i.a.Fragment,null,e?Object(O.jsx)(i.a.Suspense,{fallback:Object(O.jsx)("div",{style:{minHeight:430,marginTop:8}},Object(O.jsx)(g.EuiDelayRender,null,Object(O.jsx)(g.EuiLoadingContent,{lines:4})))},Object(O.jsx)(e,{fieldType:t,format:a,formatParams:n,onChange:s,onError:r})):null)}}const tt={painless:["number","string","date","boolean"],expression:["number"]},at=Object(T.getKbnTypeNames)(),nt=async({name:e,script:t,indexPatternTitle:a,query:n,additionalFields:i=[],http:s})=>s.post("/internal/index-pattern-management/preview_scripted_field",{body:JSON.stringify({index:a,name:e,script:t,query:n,additionalFields:i})}).then((e=>({status:e.statusCode,hits:e.body.hits}))).catch((e=>({status:e.statusCode,error:e.body.attributes.error}))),it=(e,t,a)=>{const n=a.getByFieldType(e.type).map((({id:e,title:t})=>({id:e,title:t})));return[{id:"",defaultFieldFormat:t,title:d.i18n.translate("indexPatternManagement.defaultFormatDropDown",{defaultMessage:"- Default -"})},...n]};class field_editor_FieldEditor extends n.PureComponent{constructor(e,t){super(e,t),_()(this,"context",void 0),_()(this,"supportedLangs",[]),_()(this,"deprecatedLangs",[]),_()(this,"onFieldChange",((e,t)=>{const{spec:a}=this.state;a[e]=t,this.forceUpdate()})),_()(this,"onTypeChange",(e=>{const{data:t}=this.context.services,{spec:a,format:n}=this.state,i=t.fieldFormats.getDefaultType(e);a.type=e,this.setState({fieldTypeFormats:it(a,i,t.fieldFormats),fieldFormatId:i.id,fieldFormatParams:n.params()})})),_()(this,"onLangChange",(e=>{const{spec:t}=this.state,a=Object(E.get)(tt,e,at);t.lang=e,t.type=a.includes(t.type)?t.type:a[0],this.setState({fieldTypes:a})})),_()(this,"onFormatChange",((e,t)=>{const{fieldTypeFormats:a}=this.state,{uiSettings:n,data:i}=this.context.services,s=new(i.fieldFormats.getType(e||a[0].defaultFieldFormat.id))(t,(e=>n.get(e)));this.setState({fieldFormatId:e,fieldFormatParams:t,format:s})})),_()(this,"onFormatParamsChange",(e=>{const{fieldFormatId:t}=this.state;this.onFormatChange(t,e)})),_()(this,"onFormatParamsError",(e=>{this.setState({hasFormatError:!!e})})),_()(this,"onScriptChange",(e=>{this.setState({hasScriptError:!1}),this.onFieldChange("script",e)})),_()(this,"showScriptingHelp",(()=>{this.setState({showScriptingHelp:!0})})),_()(this,"hideScriptingHelp",(()=>{this.setState({showScriptingHelp:!1})})),_()(this,"renderDeleteModal",(()=>{const{spec:e}=this.state;return this.state.showDeleteModal?Object(O.jsx)(g.EuiConfirmModal,{title:d.i18n.translate("indexPatternManagement.deleteFieldHeader",{defaultMessage:"Delete field '{fieldName}'",values:{fieldName:e.name}}),onCancel:this.hideDeleteModal,onConfirm:()=>{this.hideDeleteModal(),this.deleteField()},cancelButtonText:d.i18n.translate("indexPatternManagement.deleteField.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:d.i18n.translate("indexPatternManagement.deleteField.deleteButton",{defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:g.EUI_MODAL_CONFIRM_BUTTON},Object(O.jsx)("p",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.deleteFieldLabel",defaultMessage:"You can't recover a deleted field.{separator}Are you sure you want to do this?",values:{separator:Object(O.jsx)("span",null,Object(O.jsx)("br",null),Object(O.jsx)("br",null))}}))):null})),_()(this,"showDeleteModal",(()=>{this.setState({showDeleteModal:!0})})),_()(this,"hideDeleteModal",(()=>{this.setState({showDeleteModal:!1})})),_()(this,"renderScriptingPanels",(()=>{const{scriptingLangs:e,spec:t,showScriptingHelp:a}=this.state;if(t.scripted)return Object(O.jsx)(n.Fragment,null,Object(O.jsx)(Je,{isVisible:!e.length}),Object(O.jsx)(Ye,{isVisible:!0}),Object(O.jsx)(Ze,{isVisible:a,onClose:this.hideScriptingHelp,indexPattern:this.props.indexPattern,lang:t.lang,name:t.name,script:t.script,executeScript:nt}))})),_()(this,"deleteField",(()=>{const{redirectAway:e,indexPatternService:t}=this.props.services,{indexPattern:a}=this.props,{spec:n}=this.state;a.removeScriptedField(n.name),t.updateSavedObject(a).then((()=>{const t=d.i18n.translate("indexPatternManagement.deleteField.deletedHeader",{defaultMessage:"Deleted '{fieldName}'",values:{fieldName:n.name}});this.context.services.notifications.toasts.addSuccess(t),e()}))})),_()(this,"saveField",(async()=>{const e=this.state.spec,{indexPattern:t}=this.props,{fieldFormatId:a,fieldFormatParams:n,customLabel:i}=this.state;if(e.scripted){this.setState({isSaving:!0});if(!await(async({name:e,script:t,indexPatternTitle:a,http:n})=>200===(await nt({name:e,script:t,indexPatternTitle:a,http:n})).status)({name:e.name,script:e.script,indexPatternTitle:t.title,http:this.context.services.http}))return void this.setState({hasScriptError:!0,isSaving:!1})}const{redirectAway:s,indexPatternService:r}=this.props.services;let l;return!!t.fields.getByName(e.name)?(l=t.fields.getByName(e.name).spec,t.fields.update(e)):t.fields.add(e),a?t.setFieldFormat(e.name,{id:a,params:n}):t.deleteFieldFormat(e.name),e.customLabel!==i&&(e.customLabel=i,t.fields.update(e)),r.updateSavedObject(t).then((()=>{const t=d.i18n.translate("indexPatternManagement.deleteField.savedHeader",{defaultMessage:"Saved '{fieldName}'",values:{fieldName:e.name}});this.context.services.notifications.toasts.addSuccess(t),s()})).catch((()=>{l?t.fields.update(l):t.fields.remove(e)}))}));const{spec:a,indexPattern:i}=e;this.state={isReady:!1,isCreating:!1,isDeprecatedLang:!1,scriptingLangs:[],fieldTypes:[],fieldTypeFormats:[],existingFieldNames:i.fields.getAll().map((e=>e.name)),fieldFormatId:void 0,fieldFormatParams:{},showScriptingHelp:!1,showDeleteModal:!1,hasFormatError:!1,hasScriptError:!1,isSaving:!1,format:e.indexPattern.getFormatterForField(a),spec:{...a},customLabel:""},this.supportedLangs=["painless"],this.deprecatedLangs=[],this.init(t)}async init(e){var t,a;const{http:n,notifications:i,data:s}=e.services,{format:r,spec:l}=this.state,{indexPattern:o}=this.props,c=await((e,t)=>e.get("/api/kibana/scripts/languages").catch((()=>(t.addDanger(d.i18n.translate("indexPatternManagement.scriptingLanguages.errorFetchingToastDescription",{defaultMessage:"Error getting available scripting languages from Elasticsearch"})),[]))))(n,i.toasts),u=Object(E.intersection)(c,Object(E.union)(this.supportedLangs,this.deprecatedLangs));l.lang=l.lang&&u.includes(l.lang)?l.lang:void 0,l.scripted&&!l.lang&&(l.lang=u[0]);const p=Object(E.get)(tt,l.lang||"",at);l.type=p.includes(l.type)?l.type:p[0];const g=s.fieldFormats.getDefaultType(l.type,l.esTypes);this.setState({isReady:!0,isCreating:!o.fields.getByName(l.name),isDeprecatedLang:this.deprecatedLangs.includes(l.lang||""),errors:[],scriptingLangs:u,fieldTypes:p,fieldTypeFormats:it(l,g,s.fieldFormats),fieldFormatId:null===(t=o.getFormatterForFieldNoDefault(l.name))||void 0===t||null===(a=t.type)||void 0===a?void 0:a.id,customLabel:l.customLabel||"",fieldFormatParams:r.params()})}isDuplicateName(){const{isCreating:e,spec:t,existingFieldNames:a}=this.state;return e&&a.includes(t.name)}renderName(){const{isCreating:e,spec:t}=this.state,a=!t.name||!t.name.trim();return e?Object(O.jsx)(g.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.nameLabel",{defaultMessage:"Name"}),helpText:this.isDuplicateName()?Object(O.jsx)("span",null,Object(O.jsx)(g.EuiIcon,{type:"alert",color:"warning",size:"s"})," ",Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.mappingConflictLabel.mappingConflictDetail",defaultMessage:"{mappingConflict} You already have a field with the name {fieldName}. Naming your scripted field with the same name means you won't be able to query both fields at the same time.",values:{mappingConflict:Object(O.jsx)("strong",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.mappingConflictLabel.mappingConflictLabel",defaultMessage:"Mapping Conflict:"})),fieldName:Object(O.jsx)(g.EuiCode,null,t.name)}})):null,isInvalid:a,error:a?d.i18n.translate("indexPatternManagement.nameErrorMessage",{defaultMessage:"Name is required"}):null},Object(O.jsx)(g.EuiFieldText,{value:t.name||"",placeholder:d.i18n.translate("indexPatternManagement.namePlaceholder",{defaultMessage:"New scripted field"}),"data-test-subj":"editorFieldName",onChange:e=>{this.onFieldChange("name",e.target.value)},isInvalid:a})):null}renderLanguage(){const{spec:e,scriptingLangs:t,isDeprecatedLang:a}=this.state;return e.scripted?Object(O.jsx)(g.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.languageLabel",{defaultMessage:"Language"}),helpText:a?Object(O.jsx)("span",null,Object(O.jsx)(g.EuiIcon,{type:"alert",color:"warning",size:"s"})," ",Object(O.jsx)("strong",null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningHeader",defaultMessage:"Deprecation Warning:"}))," ",Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningLabel.warningDetail",defaultMessage:"{language} is deprecated and support will be removed in the next major version of Kibana and Elasticsearch. We recommend using {painlessLink} for new scripted fields.",values:{language:Object(O.jsx)(g.EuiCode,null,e.lang),painlessLink:Object(O.jsx)(g.EuiLink,{target:"_blank",href:this.context.services.docLinks.links.scriptedFields.painless},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningLabel.painlessLinkLabel",defaultMessage:"Painless"}))}})):null},Object(O.jsx)(g.EuiSelect,{value:e.lang,options:t.map((e=>({value:e,text:e}))),"data-test-subj":"editorFieldLang",onChange:e=>{this.onLangChange(e.target.value)}})):null}renderType(){const{spec:e,fieldTypes:t}=this.state;return Object(O.jsx)(g.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.typeLabel",{defaultMessage:"Type"})},Object(O.jsx)(g.EuiSelect,{value:e.type,disabled:!e.scripted,options:t.map((e=>({value:e,text:e}))),"data-test-subj":"editorFieldType",onChange:e=>{this.onTypeChange(e.target.value)}}))}renderCustomLabel(){const{customLabel:e,spec:t}=this.state;return Object(O.jsx)(g.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.customLabel",{defaultMessage:"Custom label"}),helpText:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.labelHelpText",defaultMessage:"Set a custom label to use when this field is displayed in Discover, Maps, and Visualize. Queries and filters don't currently support a custom label and will use the original field name."})},Object(O.jsx)(g.EuiFieldText,{value:e||"",placeholder:t.name,"data-test-subj":"editorFieldCustomLabel",onChange:e=>{this.setState({customLabel:e.target.value})}}))}renderTypeConflict(){const{spec:e}=this.state;if(!e.conflictDescriptions||"object"!=typeof e.conflictDescriptions)return null;const t=[{field:"type",name:d.i18n.translate("indexPatternManagement.typeLabel",{defaultMessage:"Type"}),width:"100px"},{field:"indices",name:d.i18n.translate("indexPatternManagement.indexNameLabel",{defaultMessage:"Index names"})}],a=Object.entries(e.conflictDescriptions).map((([e,t])=>({type:e,indices:Array.isArray(t)?t.join(", "):"Index names unavailable"})));return Object(O.jsx)("div",null,Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(g.EuiCallOut,{color:"warning",iconType:"alert",title:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.fieldTypeConflict",defaultMessage:"Field type conflict"}),size:"s"},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.multiTypeLabelDesc",defaultMessage:"The type of this field changes across indices. It is unavailable for many analysis functions. The indices per type are as follows:"})),Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(g.EuiBasicTable,{items:a,columns:t}),Object(O.jsx)(g.EuiSpacer,{size:"m"}))}renderFormat(){const{spec:e,fieldTypeFormats:t,fieldFormatId:a,fieldFormatParams:i,format:s}=this.state,{fieldFormatEditors:r}=this.context.services,l=t[0].defaultFieldFormat.title,d=l?Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.defaultFormatHeader",defaultMessage:"Format (Default: {defaultFormat})",values:{defaultFormat:Object(O.jsx)(g.EuiCode,null,l)}}):Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.formatHeader",defaultMessage:"Format"});return Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiFormRow,{label:d,helpText:Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.formatLabel",defaultMessage:"Formatting controls how values are displayed. Changing this setting might also affect the field value and highlighting in Discover."})},Object(O.jsx)(g.EuiSelect,{value:a,options:t.map((e=>({value:e.id||"",text:e.title}))),"data-test-subj":"editorSelectedFormatId",onChange:e=>{this.onFormatChange(e.target.value)}})),a?Object(O.jsx)(field_format_editor_FieldFormatEditor,{fieldType:e.type,fieldFormat:s,fieldFormatId:a,fieldFormatParams:i||{},fieldFormatEditors:r,onChange:this.onFormatParamsChange,onError:this.onFormatParamsError}):null)}renderPopularity(){const{spec:e}=this.state;return Object(O.jsx)(g.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.popularityLabel",{defaultMessage:"Popularity",description:'"Popularity" refers to Kibana\'s measurement how popular a field is (i.e. how commonly it is used).'})},Object(O.jsx)(g.EuiFieldNumber,{value:e.count,"data-test-subj":"editorFieldCount",onChange:e=>{this.onFieldChange("count",e.target.value?Number(e.target.value):"")}}))}renderScript(){var e;const{spec:t,hasScriptError:a}=this.state,i=!t.script||!t.script.trim()||a,s=a?Object(O.jsx)("span",{"data-test-subj":"invalidScriptError"},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.scriptInvalidErrorMessage",defaultMessage:"Script is invalid. View script preview for details"})):Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.scriptRequiredErrorMessage",defaultMessage:"Script is required"});return t.scripted?Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiFormRow,{fullWidth:!0,label:d.i18n.translate("indexPatternManagement.scriptLabel",{defaultMessage:"Script"}),isInvalid:i,error:i?s:null},Object(O.jsx)(c.CodeEditor,{languageId:Ge.PainlessLang.ID,width:"100%",height:"300px",value:null!==(e=t.script)&&void 0!==e?e:"",onChange:this.onScriptChange,"data-test-subj":"editorFieldScript","aria-label":d.i18n.translate("indexPatternManagement.scriptLabelAriaLabel",{defaultMessage:"Script editor"})})),Object(O.jsx)(g.EuiFormRow,null,Object(O.jsx)(n.Fragment,null,Object(O.jsx)(g.EuiText,null,Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.script.accessWithLabel",defaultMessage:"Access fields with {code}.",values:{code:Object(O.jsx)("code",null,"doc['some_field'].value")}})),Object(O.jsx)("br",null),Object(O.jsx)(g.EuiLink,{onClick:this.showScriptingHelp,"data-test-subj":"scriptedFieldsHelpLink"},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.script.getHelpLabel",defaultMessage:"Get help with the syntax and preview the results of your script."}))))):null}renderActions(){const{isCreating:e,spec:t,isSaving:a}=this.state,{redirectAway:n}=this.props.services;return Object(O.jsx)(g.EuiFormRow,null,Object(O.jsx)(g.EuiFlexGroup,null,Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiButton,{fill:!0,onClick:this.saveField,isDisabled:this.isSavingDisabled(),isLoading:a,"data-test-subj":"fieldSaveButton"},e?Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.actions.createButton",defaultMessage:"Create field"}):Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.actions.saveButton",defaultMessage:"Save field"}))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiButtonEmpty,{onClick:n,"data-test-subj":"fieldCancelButton"},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.actions.cancelButton",defaultMessage:"Cancel"}))),!e&&t.scripted?Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiFlexGroup,{justifyContent:"flexEnd"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiButtonEmpty,{color:"danger",onClick:this.showDeleteModal},Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.actions.deleteButton",defaultMessage:"Delete"}))))):null))}isSavingDisabled(){const{spec:e,hasFormatError:t,hasScriptError:a}=this.state;return!(!t&&!a&&e.name&&e.name.trim()&&(!e.scripted||e.script&&e.script.trim()))}render(){const{isReady:e,isCreating:t,spec:a}=this.state;return e?Object(O.jsx)("div",null,Object(O.jsx)(g.EuiText,null,Object(O.jsx)("h3",null,t?Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createHeader",defaultMessage:"Create scripted field"}):Object(O.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editHeader",defaultMessage:"Edit {fieldName}",values:{fieldName:a.name}}))),Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(g.EuiForm,null,this.renderScriptingPanels(),this.renderName(),this.renderCustomLabel(),this.renderLanguage(),this.renderType(),this.renderTypeConflict(),this.renderFormat(),this.renderPopularity(),this.renderScript(),this.renderActions(),this.renderDeleteModal()),Object(O.jsx)(g.EuiSpacer,{size:"l"})):null}}_()(field_editor_FieldEditor,"contextType",c.context);const st=d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.newFieldPlaceholder",{defaultMessage:"New Scripted Field"}),rt=Object(l.withRouter)((({indexPattern:e,mode:t,fieldName:a,history:n})=>{var s;const{uiSettings:r,chrome:l,notifications:o,data:u}=Object(c.useKibana)().services,p="edit"===t&&a?null===(s=e.fields.getByName(a))||void 0===s?void 0:s.spec:{scripted:!0,type:"number",name:void 0},m=`/patterns/${e.id}`;if("edit"===t&&!p){const t=d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.noFieldLabel",{defaultMessage:"'{indexPatternTitle}' index pattern doesn't have a scripted field called '{fieldName}'",values:{indexPatternTitle:e.title,fieldName:a}});o.toasts.addWarning(t),n.push(m)}const x=(null==p?void 0:p.name)||st;l.docTitle.change([x,e.title]);const b=()=>{n.push(`${m}#/?_a=(tab:${null!=p&&p.scripted?L:w})`)};return p?Object(O.jsx)(i.a.Fragment,null,Object(O.jsx)(Ve,{indexPattern:e,defaultIndex:r.get("defaultIndex")}),Object(O.jsx)(g.EuiSpacer,{size:"l"}),Object(O.jsx)(field_editor_FieldEditor,{indexPattern:e,spec:p,services:{indexPatternService:u.indexPatterns,redirectAway:b}})):Object(O.jsx)(i.a.Fragment,null)})),lt=Object(l.withRouter)((({...e})=>{const{setBreadcrumbs:t,data:a}=Object(c.useKibana)().services,[s,r]=Object(n.useState)(),l=e.match.params.fieldName&&decodeURIComponent(e.match.params.fieldName);return Object(n.useEffect)((()=>{a.indexPatterns.get(e.match.params.id).then((e=>{r(e),e&&t(l?function(e,t){return[...M(e),{text:t}]}(e,l):function(e){return[...M(e),{text:d.i18n.translate("indexPatternManagement.indexPatterns.createFieldBreadcrumb",{defaultMessage:"Create field"})}]}(e))}))}),[e.match.params.id,l,t,a.indexPatterns]),s?Object(O.jsx)(rt,{indexPattern:s,mode:l?"edit":"create",fieldName:l}):Object(O.jsx)(i.a.Fragment,null)})),dt={text:d.i18n.translate("indexPatternManagement.indexPatterns.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:d.i18n.translate("indexPatternManagement.indexPatterns.badge.readOnly.tooltip",{defaultMessage:"Unable to save index patterns"}),iconType:"glasses"};async function ot(e,t){const[{chrome:a,application:n,uiSettings:i,notifications:s,overlays:d,http:u,docLinks:p},{data:g,indexPatternFieldEditor:m,indexPatternEditor:x},b]=await e(),f=Boolean(n.capabilities.indexPatterns.save);f||a.setBadge(dt);const j={chrome:a,application:n,uiSettings:i,notifications:s,overlays:d,http:u,docLinks:p,data:g,indexPatternFieldEditor:m,indexPatternManagementStart:b,setBreadcrumbs:t.setBreadcrumbs,fieldFormatEditors:m.fieldFormatEditors,IndexPatternEditor:x.IndexPatternEditorComponent};return r.a.render(Object(O.jsx)(c.KibanaContextProvider,{services:j},Object(O.jsx)(o.I18nProvider,null,Object(O.jsx)(l.Router,{history:t.history},Object(O.jsx)(l.Switch,null,Object(O.jsx)(l.Route,{path:["/create"]},Object(O.jsx)(S,{canSave:f,showCreateDialog:!0})),Object(O.jsx)(l.Route,{path:["/patterns/:id/field/:fieldName","/patterns/:id/create-field/"]},Object(O.jsx)(lt,null)),Object(O.jsx)(l.Route,{path:["/patterns/:id"]},Object(O.jsx)($e,null)),Object(O.jsx)(l.Route,{path:["/"]},Object(O.jsx)(S,{canSave:f})))))),t.element),()=>{a.docTitle.reset(),r.a.unmountComponentAtNode(t.element)}}}]]);